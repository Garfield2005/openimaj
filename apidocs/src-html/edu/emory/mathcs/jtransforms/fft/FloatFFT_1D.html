<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<title>Source code</title>
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span>/* ***** BEGIN LICENSE BLOCK *****<a name="line.1"></a>
<span class="sourceLineNo">002</span> * Version: MPL 1.1/GPL 2.0/LGPL 2.1<a name="line.2"></a>
<span class="sourceLineNo">003</span> *<a name="line.3"></a>
<span class="sourceLineNo">004</span> * The contents of this file are subject to the Mozilla Public License Version<a name="line.4"></a>
<span class="sourceLineNo">005</span> * 1.1 (the "License"); you may not use this file except in compliance with<a name="line.5"></a>
<span class="sourceLineNo">006</span> * the License. You may obtain a copy of the License at<a name="line.6"></a>
<span class="sourceLineNo">007</span> * http://www.mozilla.org/MPL/<a name="line.7"></a>
<span class="sourceLineNo">008</span> *<a name="line.8"></a>
<span class="sourceLineNo">009</span> * Software distributed under the License is distributed on an "AS IS" basis,<a name="line.9"></a>
<span class="sourceLineNo">010</span> * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License<a name="line.10"></a>
<span class="sourceLineNo">011</span> * for the specific language governing rights and limitations under the<a name="line.11"></a>
<span class="sourceLineNo">012</span> * License.<a name="line.12"></a>
<span class="sourceLineNo">013</span> *<a name="line.13"></a>
<span class="sourceLineNo">014</span> * The Original Code is JTransforms.<a name="line.14"></a>
<span class="sourceLineNo">015</span> *<a name="line.15"></a>
<span class="sourceLineNo">016</span> * The Initial Developer of the Original Code is<a name="line.16"></a>
<span class="sourceLineNo">017</span> * Piotr Wendykier, Emory University.<a name="line.17"></a>
<span class="sourceLineNo">018</span> * Portions created by the Initial Developer are Copyright (C) 2007-2009<a name="line.18"></a>
<span class="sourceLineNo">019</span> * the Initial Developer. All Rights Reserved.<a name="line.19"></a>
<span class="sourceLineNo">020</span> *<a name="line.20"></a>
<span class="sourceLineNo">021</span> * Alternatively, the contents of this file may be used under the terms of<a name="line.21"></a>
<span class="sourceLineNo">022</span> * either the GNU General Public License Version 2 or later (the "GPL"), or<a name="line.22"></a>
<span class="sourceLineNo">023</span> * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),<a name="line.23"></a>
<span class="sourceLineNo">024</span> * in which case the provisions of the GPL or the LGPL are applicable instead<a name="line.24"></a>
<span class="sourceLineNo">025</span> * of those above. If you wish to allow use of your version of this file only<a name="line.25"></a>
<span class="sourceLineNo">026</span> * under the terms of either the GPL or the LGPL, and not to allow others to<a name="line.26"></a>
<span class="sourceLineNo">027</span> * use your version of this file under the terms of the MPL, indicate your<a name="line.27"></a>
<span class="sourceLineNo">028</span> * decision by deleting the provisions above and replace them with the notice<a name="line.28"></a>
<span class="sourceLineNo">029</span> * and other provisions required by the GPL or the LGPL. If you do not delete<a name="line.29"></a>
<span class="sourceLineNo">030</span> * the provisions above, a recipient may use your version of this file under<a name="line.30"></a>
<span class="sourceLineNo">031</span> * the terms of any one of the MPL, the GPL or the LGPL.<a name="line.31"></a>
<span class="sourceLineNo">032</span> *<a name="line.32"></a>
<span class="sourceLineNo">033</span> * ***** END LICENSE BLOCK ***** */<a name="line.33"></a>
<span class="sourceLineNo">034</span><a name="line.34"></a>
<span class="sourceLineNo">035</span>package edu.emory.mathcs.jtransforms.fft;<a name="line.35"></a>
<span class="sourceLineNo">036</span><a name="line.36"></a>
<span class="sourceLineNo">037</span>import java.util.concurrent.Future;<a name="line.37"></a>
<span class="sourceLineNo">038</span><a name="line.38"></a>
<span class="sourceLineNo">039</span>import edu.emory.mathcs.utils.ConcurrencyUtils;<a name="line.39"></a>
<span class="sourceLineNo">040</span><a name="line.40"></a>
<span class="sourceLineNo">041</span>/**<a name="line.41"></a>
<span class="sourceLineNo">042</span> * Computes 1D Discrete Fourier Transform (DFT) of complex and real, single<a name="line.42"></a>
<span class="sourceLineNo">043</span> * precision data. The size of the data can be an arbitrary number. This is a<a name="line.43"></a>
<span class="sourceLineNo">044</span> * parallel implementation of split-radix and mixed-radix algorithms optimized<a name="line.44"></a>
<span class="sourceLineNo">045</span> * for SMP systems. &lt;br&gt;<a name="line.45"></a>
<span class="sourceLineNo">046</span> * &lt;br&gt;<a name="line.46"></a>
<span class="sourceLineNo">047</span> * This code is derived from General Purpose FFT Package written by Takuya Ooura<a name="line.47"></a>
<span class="sourceLineNo">048</span> * (http://www.kurims.kyoto-u.ac.jp/~ooura/fft.html) and from JFFTPack written<a name="line.48"></a>
<span class="sourceLineNo">049</span> * by Baoshe Zhang (http://jfftpack.sourceforge.net/)<a name="line.49"></a>
<span class="sourceLineNo">050</span> * <a name="line.50"></a>
<span class="sourceLineNo">051</span> * @author Piotr Wendykier (piotr.wendykier@gmail.com)<a name="line.51"></a>
<span class="sourceLineNo">052</span> * <a name="line.52"></a>
<span class="sourceLineNo">053</span> */<a name="line.53"></a>
<span class="sourceLineNo">054</span>public strictfp class FloatFFT_1D {<a name="line.54"></a>
<span class="sourceLineNo">055</span><a name="line.55"></a>
<span class="sourceLineNo">056</span>    private static enum Plans {<a name="line.56"></a>
<span class="sourceLineNo">057</span>        SPLIT_RADIX, MIXED_RADIX, BLUESTEIN<a name="line.57"></a>
<span class="sourceLineNo">058</span>    }<a name="line.58"></a>
<span class="sourceLineNo">059</span><a name="line.59"></a>
<span class="sourceLineNo">060</span>    private int n;<a name="line.60"></a>
<span class="sourceLineNo">061</span><a name="line.61"></a>
<span class="sourceLineNo">062</span>    private int nBluestein;<a name="line.62"></a>
<span class="sourceLineNo">063</span><a name="line.63"></a>
<span class="sourceLineNo">064</span>    private int[] ip;<a name="line.64"></a>
<span class="sourceLineNo">065</span><a name="line.65"></a>
<span class="sourceLineNo">066</span>    private float[] w;<a name="line.66"></a>
<span class="sourceLineNo">067</span><a name="line.67"></a>
<span class="sourceLineNo">068</span>    private int nw;<a name="line.68"></a>
<span class="sourceLineNo">069</span><a name="line.69"></a>
<span class="sourceLineNo">070</span>    private int nc;<a name="line.70"></a>
<span class="sourceLineNo">071</span><a name="line.71"></a>
<span class="sourceLineNo">072</span>    private float[] wtable;<a name="line.72"></a>
<span class="sourceLineNo">073</span><a name="line.73"></a>
<span class="sourceLineNo">074</span>    private float[] wtable_r;<a name="line.74"></a>
<span class="sourceLineNo">075</span><a name="line.75"></a>
<span class="sourceLineNo">076</span>    private float[] bk1;<a name="line.76"></a>
<span class="sourceLineNo">077</span><a name="line.77"></a>
<span class="sourceLineNo">078</span>    private float[] bk2;<a name="line.78"></a>
<span class="sourceLineNo">079</span><a name="line.79"></a>
<span class="sourceLineNo">080</span>    private Plans plan;<a name="line.80"></a>
<span class="sourceLineNo">081</span><a name="line.81"></a>
<span class="sourceLineNo">082</span>    private static final int[] factors = { 4, 2, 3, 5 };<a name="line.82"></a>
<span class="sourceLineNo">083</span><a name="line.83"></a>
<span class="sourceLineNo">084</span>    private static final float PI = 3.14159265358979311599796346854418516f;<a name="line.84"></a>
<span class="sourceLineNo">085</span><a name="line.85"></a>
<span class="sourceLineNo">086</span>    private static final float TWO_PI = 6.28318530717958623199592693708837032f;<a name="line.86"></a>
<span class="sourceLineNo">087</span><a name="line.87"></a>
<span class="sourceLineNo">088</span>    /**<a name="line.88"></a>
<span class="sourceLineNo">089</span>     * Creates new instance of FloatFFT_1D.<a name="line.89"></a>
<span class="sourceLineNo">090</span>     * <a name="line.90"></a>
<span class="sourceLineNo">091</span>     * @param n<a name="line.91"></a>
<span class="sourceLineNo">092</span>     *            size of data<a name="line.92"></a>
<span class="sourceLineNo">093</span>     */<a name="line.93"></a>
<span class="sourceLineNo">094</span>    public FloatFFT_1D(int n) {<a name="line.94"></a>
<span class="sourceLineNo">095</span>        if (n &lt; 1) {<a name="line.95"></a>
<span class="sourceLineNo">096</span>            throw new IllegalArgumentException("n must be greater than 0");<a name="line.96"></a>
<span class="sourceLineNo">097</span>        }<a name="line.97"></a>
<span class="sourceLineNo">098</span>        this.n = n;<a name="line.98"></a>
<span class="sourceLineNo">099</span><a name="line.99"></a>
<span class="sourceLineNo">100</span>        if (!ConcurrencyUtils.isPowerOf2(n)) {<a name="line.100"></a>
<span class="sourceLineNo">101</span>            if (getReminder(n, factors) &gt;= 211) {<a name="line.101"></a>
<span class="sourceLineNo">102</span>                plan = Plans.BLUESTEIN;<a name="line.102"></a>
<span class="sourceLineNo">103</span>                nBluestein = ConcurrencyUtils.nextPow2(n * 2 - 1);<a name="line.103"></a>
<span class="sourceLineNo">104</span>                bk1 = new float[2 * nBluestein];<a name="line.104"></a>
<span class="sourceLineNo">105</span>                bk2 = new float[2 * nBluestein];<a name="line.105"></a>
<span class="sourceLineNo">106</span>                this.ip = new int[2 + (int) Math.ceil(2 + (1 &lt;&lt; (int) (Math.log(nBluestein + 0.5) / Math.log(2)) / 2))];<a name="line.106"></a>
<span class="sourceLineNo">107</span>                this.w = new float[nBluestein];<a name="line.107"></a>
<span class="sourceLineNo">108</span>                int twon = 2 * nBluestein;<a name="line.108"></a>
<span class="sourceLineNo">109</span>                nw = ip[0];<a name="line.109"></a>
<span class="sourceLineNo">110</span>                if (twon &gt; (nw &lt;&lt; 2)) {<a name="line.110"></a>
<span class="sourceLineNo">111</span>                    nw = twon &gt;&gt; 2;<a name="line.111"></a>
<span class="sourceLineNo">112</span>                    makewt(nw);<a name="line.112"></a>
<span class="sourceLineNo">113</span>                }<a name="line.113"></a>
<span class="sourceLineNo">114</span>                nc = ip[1];<a name="line.114"></a>
<span class="sourceLineNo">115</span>                if (nBluestein &gt; (nc &lt;&lt; 2)) {<a name="line.115"></a>
<span class="sourceLineNo">116</span>                    nc = nBluestein &gt;&gt; 2;<a name="line.116"></a>
<span class="sourceLineNo">117</span>                    makect(nc, w, nw);<a name="line.117"></a>
<span class="sourceLineNo">118</span>                }<a name="line.118"></a>
<span class="sourceLineNo">119</span>                bluesteini();<a name="line.119"></a>
<span class="sourceLineNo">120</span>            } else {<a name="line.120"></a>
<span class="sourceLineNo">121</span>                plan = Plans.MIXED_RADIX;<a name="line.121"></a>
<span class="sourceLineNo">122</span>                wtable = new float[4 * n + 15];<a name="line.122"></a>
<span class="sourceLineNo">123</span>                wtable_r = new float[2 * n + 15];<a name="line.123"></a>
<span class="sourceLineNo">124</span>                cffti();<a name="line.124"></a>
<span class="sourceLineNo">125</span>                rffti();<a name="line.125"></a>
<span class="sourceLineNo">126</span>            }<a name="line.126"></a>
<span class="sourceLineNo">127</span>        } else {<a name="line.127"></a>
<span class="sourceLineNo">128</span>            plan = Plans.SPLIT_RADIX;<a name="line.128"></a>
<span class="sourceLineNo">129</span>            this.ip = new int[2 + (int) Math.ceil(2 + (1 &lt;&lt; (int) (Math.log(n + 0.5) / Math.log(2)) / 2))];<a name="line.129"></a>
<span class="sourceLineNo">130</span>            this.w = new float[n];<a name="line.130"></a>
<span class="sourceLineNo">131</span>            int twon = 2 * n;<a name="line.131"></a>
<span class="sourceLineNo">132</span>            nw = ip[0];<a name="line.132"></a>
<span class="sourceLineNo">133</span>            if (twon &gt; (nw &lt;&lt; 2)) {<a name="line.133"></a>
<span class="sourceLineNo">134</span>                nw = twon &gt;&gt; 2;<a name="line.134"></a>
<span class="sourceLineNo">135</span>                makewt(nw);<a name="line.135"></a>
<span class="sourceLineNo">136</span>            }<a name="line.136"></a>
<span class="sourceLineNo">137</span>            nc = ip[1];<a name="line.137"></a>
<span class="sourceLineNo">138</span>            if (n &gt; (nc &lt;&lt; 2)) {<a name="line.138"></a>
<span class="sourceLineNo">139</span>                nc = n &gt;&gt; 2;<a name="line.139"></a>
<span class="sourceLineNo">140</span>                makect(nc, w, nw);<a name="line.140"></a>
<span class="sourceLineNo">141</span>            }<a name="line.141"></a>
<span class="sourceLineNo">142</span>        }<a name="line.142"></a>
<span class="sourceLineNo">143</span>    }<a name="line.143"></a>
<span class="sourceLineNo">144</span><a name="line.144"></a>
<span class="sourceLineNo">145</span>    /**<a name="line.145"></a>
<span class="sourceLineNo">146</span>     * Computes 1D forward DFT of complex data leaving the result in<a name="line.146"></a>
<span class="sourceLineNo">147</span>     * &lt;code&gt;a&lt;/code&gt;. Complex number is stored as two float values in<a name="line.147"></a>
<span class="sourceLineNo">148</span>     * sequence: the real and imaginary part, i.e. the size of the input array<a name="line.148"></a>
<span class="sourceLineNo">149</span>     * must be greater or equal 2*n. The physical layout of the input data has<a name="line.149"></a>
<span class="sourceLineNo">150</span>     * to be as follows:&lt;br&gt;<a name="line.150"></a>
<span class="sourceLineNo">151</span>     * <a name="line.151"></a>
<span class="sourceLineNo">152</span>     * &lt;pre&gt;<a name="line.152"></a>
<span class="sourceLineNo">153</span>     * a[2*k] = Re[k], <a name="line.153"></a>
<span class="sourceLineNo">154</span>     * a[2*k+1] = Im[k], 0&amp;lt;=k&amp;lt;n<a name="line.154"></a>
<span class="sourceLineNo">155</span>     * &lt;/pre&gt;<a name="line.155"></a>
<span class="sourceLineNo">156</span>     * <a name="line.156"></a>
<span class="sourceLineNo">157</span>     * @param a<a name="line.157"></a>
<span class="sourceLineNo">158</span>     *            data to transform<a name="line.158"></a>
<span class="sourceLineNo">159</span>     */<a name="line.159"></a>
<span class="sourceLineNo">160</span>    public void complexForward(float[] a) {<a name="line.160"></a>
<span class="sourceLineNo">161</span>        complexForward(a, 0);<a name="line.161"></a>
<span class="sourceLineNo">162</span>    }<a name="line.162"></a>
<span class="sourceLineNo">163</span><a name="line.163"></a>
<span class="sourceLineNo">164</span>    /**<a name="line.164"></a>
<span class="sourceLineNo">165</span>     * Computes 1D forward DFT of complex data leaving the result in<a name="line.165"></a>
<span class="sourceLineNo">166</span>     * &lt;code&gt;a&lt;/code&gt;. Complex number is stored as two float values in<a name="line.166"></a>
<span class="sourceLineNo">167</span>     * sequence: the real and imaginary part, i.e. the size of the input array<a name="line.167"></a>
<span class="sourceLineNo">168</span>     * must be greater or equal 2*n. The physical layout of the input data has<a name="line.168"></a>
<span class="sourceLineNo">169</span>     * to be as follows:&lt;br&gt;<a name="line.169"></a>
<span class="sourceLineNo">170</span>     * <a name="line.170"></a>
<span class="sourceLineNo">171</span>     * &lt;pre&gt;<a name="line.171"></a>
<span class="sourceLineNo">172</span>     * a[offa+2*k] = Re[k], <a name="line.172"></a>
<span class="sourceLineNo">173</span>     * a[offa+2*k+1] = Im[k], 0&amp;lt;=k&amp;lt;n<a name="line.173"></a>
<span class="sourceLineNo">174</span>     * &lt;/pre&gt;<a name="line.174"></a>
<span class="sourceLineNo">175</span>     * <a name="line.175"></a>
<span class="sourceLineNo">176</span>     * @param a<a name="line.176"></a>
<span class="sourceLineNo">177</span>     *            data to transform<a name="line.177"></a>
<span class="sourceLineNo">178</span>     * @param offa<a name="line.178"></a>
<span class="sourceLineNo">179</span>     *            index of the first element in array &lt;code&gt;a&lt;/code&gt;<a name="line.179"></a>
<span class="sourceLineNo">180</span>     */<a name="line.180"></a>
<span class="sourceLineNo">181</span>    public void complexForward(float[] a, int offa) {<a name="line.181"></a>
<span class="sourceLineNo">182</span>        if (n == 1)<a name="line.182"></a>
<span class="sourceLineNo">183</span>            return;<a name="line.183"></a>
<span class="sourceLineNo">184</span>        switch (plan) {<a name="line.184"></a>
<span class="sourceLineNo">185</span>        case SPLIT_RADIX:<a name="line.185"></a>
<span class="sourceLineNo">186</span>            cftbsub(2 * n, a, offa, ip, nw, w);<a name="line.186"></a>
<span class="sourceLineNo">187</span>            break;<a name="line.187"></a>
<span class="sourceLineNo">188</span>        case MIXED_RADIX:<a name="line.188"></a>
<span class="sourceLineNo">189</span>            cfftf(a, offa, -1);<a name="line.189"></a>
<span class="sourceLineNo">190</span>            break;<a name="line.190"></a>
<span class="sourceLineNo">191</span>        case BLUESTEIN:<a name="line.191"></a>
<span class="sourceLineNo">192</span>            bluestein_complex(a, offa, -1);<a name="line.192"></a>
<span class="sourceLineNo">193</span>            break;<a name="line.193"></a>
<span class="sourceLineNo">194</span>        }<a name="line.194"></a>
<span class="sourceLineNo">195</span>    }<a name="line.195"></a>
<span class="sourceLineNo">196</span><a name="line.196"></a>
<span class="sourceLineNo">197</span>    /**<a name="line.197"></a>
<span class="sourceLineNo">198</span>     * Computes 1D inverse DFT of complex data leaving the result in<a name="line.198"></a>
<span class="sourceLineNo">199</span>     * &lt;code&gt;a&lt;/code&gt;. Complex number is stored as two float values in<a name="line.199"></a>
<span class="sourceLineNo">200</span>     * sequence: the real and imaginary part, i.e. the size of the input array<a name="line.200"></a>
<span class="sourceLineNo">201</span>     * must be greater or equal 2*n. The physical layout of the input data has<a name="line.201"></a>
<span class="sourceLineNo">202</span>     * to be as follows:&lt;br&gt;<a name="line.202"></a>
<span class="sourceLineNo">203</span>     * <a name="line.203"></a>
<span class="sourceLineNo">204</span>     * &lt;pre&gt;<a name="line.204"></a>
<span class="sourceLineNo">205</span>     * a[2*k] = Re[k], <a name="line.205"></a>
<span class="sourceLineNo">206</span>     * a[2*k+1] = Im[k], 0&amp;lt;=k&amp;lt;n<a name="line.206"></a>
<span class="sourceLineNo">207</span>     * &lt;/pre&gt;<a name="line.207"></a>
<span class="sourceLineNo">208</span>     * <a name="line.208"></a>
<span class="sourceLineNo">209</span>     * @param a<a name="line.209"></a>
<span class="sourceLineNo">210</span>     *            data to transform<a name="line.210"></a>
<span class="sourceLineNo">211</span>     * @param scale<a name="line.211"></a>
<span class="sourceLineNo">212</span>     *            if true then scaling is performed<a name="line.212"></a>
<span class="sourceLineNo">213</span>     */<a name="line.213"></a>
<span class="sourceLineNo">214</span>    public void complexInverse(float[] a, boolean scale) {<a name="line.214"></a>
<span class="sourceLineNo">215</span>        complexInverse(a, 0, scale);<a name="line.215"></a>
<span class="sourceLineNo">216</span>    }<a name="line.216"></a>
<span class="sourceLineNo">217</span><a name="line.217"></a>
<span class="sourceLineNo">218</span>    /**<a name="line.218"></a>
<span class="sourceLineNo">219</span>     * Computes 1D inverse DFT of complex data leaving the result in<a name="line.219"></a>
<span class="sourceLineNo">220</span>     * &lt;code&gt;a&lt;/code&gt;. Complex number is stored as two float values in<a name="line.220"></a>
<span class="sourceLineNo">221</span>     * sequence: the real and imaginary part, i.e. the size of the input array<a name="line.221"></a>
<span class="sourceLineNo">222</span>     * must be greater or equal 2*n. The physical layout of the input data has<a name="line.222"></a>
<span class="sourceLineNo">223</span>     * to be as follows:&lt;br&gt;<a name="line.223"></a>
<span class="sourceLineNo">224</span>     * <a name="line.224"></a>
<span class="sourceLineNo">225</span>     * &lt;pre&gt;<a name="line.225"></a>
<span class="sourceLineNo">226</span>     * a[offa+2*k] = Re[k], <a name="line.226"></a>
<span class="sourceLineNo">227</span>     * a[offa+2*k+1] = Im[k], 0&amp;lt;=k&amp;lt;n<a name="line.227"></a>
<span class="sourceLineNo">228</span>     * &lt;/pre&gt;<a name="line.228"></a>
<span class="sourceLineNo">229</span>     * <a name="line.229"></a>
<span class="sourceLineNo">230</span>     * @param a<a name="line.230"></a>
<span class="sourceLineNo">231</span>     *            data to transform<a name="line.231"></a>
<span class="sourceLineNo">232</span>     * @param offa<a name="line.232"></a>
<span class="sourceLineNo">233</span>     *            index of the first element in array &lt;code&gt;a&lt;/code&gt;<a name="line.233"></a>
<span class="sourceLineNo">234</span>     * @param scale<a name="line.234"></a>
<span class="sourceLineNo">235</span>     *            if true then scaling is performed<a name="line.235"></a>
<span class="sourceLineNo">236</span>     */<a name="line.236"></a>
<span class="sourceLineNo">237</span>    public void complexInverse(float[] a, int offa, boolean scale) {<a name="line.237"></a>
<span class="sourceLineNo">238</span>        if (n == 1)<a name="line.238"></a>
<span class="sourceLineNo">239</span>            return;<a name="line.239"></a>
<span class="sourceLineNo">240</span>        switch (plan) {<a name="line.240"></a>
<span class="sourceLineNo">241</span>        case SPLIT_RADIX:<a name="line.241"></a>
<span class="sourceLineNo">242</span>            cftfsub(2 * n, a, offa, ip, nw, w);<a name="line.242"></a>
<span class="sourceLineNo">243</span>            break;<a name="line.243"></a>
<span class="sourceLineNo">244</span>        case MIXED_RADIX:<a name="line.244"></a>
<span class="sourceLineNo">245</span>            cfftf(a, offa, +1);<a name="line.245"></a>
<span class="sourceLineNo">246</span>            break;<a name="line.246"></a>
<span class="sourceLineNo">247</span>        case BLUESTEIN:<a name="line.247"></a>
<span class="sourceLineNo">248</span>            bluestein_complex(a, offa, 1);<a name="line.248"></a>
<span class="sourceLineNo">249</span>            break;<a name="line.249"></a>
<span class="sourceLineNo">250</span>        }<a name="line.250"></a>
<span class="sourceLineNo">251</span>        if (scale) {<a name="line.251"></a>
<span class="sourceLineNo">252</span>            scale(n, a, offa, true);<a name="line.252"></a>
<span class="sourceLineNo">253</span>        }<a name="line.253"></a>
<span class="sourceLineNo">254</span>    }<a name="line.254"></a>
<span class="sourceLineNo">255</span><a name="line.255"></a>
<span class="sourceLineNo">256</span>    /**<a name="line.256"></a>
<span class="sourceLineNo">257</span>     * Computes 1D forward DFT of real data leaving the result in &lt;code&gt;a&lt;/code&gt;<a name="line.257"></a>
<span class="sourceLineNo">258</span>     * . The physical layout of the output data is as follows:&lt;br&gt;<a name="line.258"></a>
<span class="sourceLineNo">259</span>     * <a name="line.259"></a>
<span class="sourceLineNo">260</span>     * if n is even then<a name="line.260"></a>
<span class="sourceLineNo">261</span>     * <a name="line.261"></a>
<span class="sourceLineNo">262</span>     * &lt;pre&gt;<a name="line.262"></a>
<span class="sourceLineNo">263</span>     * a[2*k] = Re[k], 0&amp;lt;=k&amp;lt;n/2<a name="line.263"></a>
<span class="sourceLineNo">264</span>     * a[2*k+1] = Im[k], 0&amp;lt;k&amp;lt;n/2<a name="line.264"></a>
<span class="sourceLineNo">265</span>     * a[1] = Re[n/2]<a name="line.265"></a>
<span class="sourceLineNo">266</span>     * &lt;/pre&gt;<a name="line.266"></a>
<span class="sourceLineNo">267</span>     * <a name="line.267"></a>
<span class="sourceLineNo">268</span>     * if n is odd then<a name="line.268"></a>
<span class="sourceLineNo">269</span>     * <a name="line.269"></a>
<span class="sourceLineNo">270</span>     * &lt;pre&gt;<a name="line.270"></a>
<span class="sourceLineNo">271</span>     * a[2*k] = Re[k], 0&amp;lt;=k&amp;lt;(n+1)/2<a name="line.271"></a>
<span class="sourceLineNo">272</span>     * a[2*k+1] = Im[k], 0&amp;lt;k&amp;lt;(n-1)/2<a name="line.272"></a>
<span class="sourceLineNo">273</span>     * a[1] = Im[(n-1)/2]<a name="line.273"></a>
<span class="sourceLineNo">274</span>     * &lt;/pre&gt;<a name="line.274"></a>
<span class="sourceLineNo">275</span>     * <a name="line.275"></a>
<span class="sourceLineNo">276</span>     * This method computes only half of the elements of the real transform. The<a name="line.276"></a>
<span class="sourceLineNo">277</span>     * other half satisfies the symmetry condition. If you want the full real<a name="line.277"></a>
<span class="sourceLineNo">278</span>     * forward transform, use &lt;code&gt;realForwardFull&lt;/code&gt;. To get back the<a name="line.278"></a>
<span class="sourceLineNo">279</span>     * original data, use &lt;code&gt;realInverse&lt;/code&gt; on the output of this method.<a name="line.279"></a>
<span class="sourceLineNo">280</span>     * <a name="line.280"></a>
<span class="sourceLineNo">281</span>     * @param a<a name="line.281"></a>
<span class="sourceLineNo">282</span>     *            data to transform<a name="line.282"></a>
<span class="sourceLineNo">283</span>     */<a name="line.283"></a>
<span class="sourceLineNo">284</span>    public void realForward(float[] a) {<a name="line.284"></a>
<span class="sourceLineNo">285</span>        realForward(a, 0);<a name="line.285"></a>
<span class="sourceLineNo">286</span>    }<a name="line.286"></a>
<span class="sourceLineNo">287</span><a name="line.287"></a>
<span class="sourceLineNo">288</span>    /**<a name="line.288"></a>
<span class="sourceLineNo">289</span>     * Computes 1D forward DFT of real data leaving the result in &lt;code&gt;a&lt;/code&gt;<a name="line.289"></a>
<span class="sourceLineNo">290</span>     * . The physical layout of the output data is as follows:&lt;br&gt;<a name="line.290"></a>
<span class="sourceLineNo">291</span>     * <a name="line.291"></a>
<span class="sourceLineNo">292</span>     * if n is even then<a name="line.292"></a>
<span class="sourceLineNo">293</span>     * <a name="line.293"></a>
<span class="sourceLineNo">294</span>     * &lt;pre&gt;<a name="line.294"></a>
<span class="sourceLineNo">295</span>     * a[offa+2*k] = Re[k], 0&amp;lt;=k&amp;lt;n/2<a name="line.295"></a>
<span class="sourceLineNo">296</span>     * a[offa+2*k+1] = Im[k], 0&amp;lt;k&amp;lt;n/2<a name="line.296"></a>
<span class="sourceLineNo">297</span>     * a[offa+1] = Re[n/2]<a name="line.297"></a>
<span class="sourceLineNo">298</span>     * &lt;/pre&gt;<a name="line.298"></a>
<span class="sourceLineNo">299</span>     * <a name="line.299"></a>
<span class="sourceLineNo">300</span>     * if n is odd then<a name="line.300"></a>
<span class="sourceLineNo">301</span>     * <a name="line.301"></a>
<span class="sourceLineNo">302</span>     * &lt;pre&gt;<a name="line.302"></a>
<span class="sourceLineNo">303</span>     * a[offa+2*k] = Re[k], 0&amp;lt;=k&amp;lt;(n+1)/2<a name="line.303"></a>
<span class="sourceLineNo">304</span>     * a[offa+2*k+1] = Im[k], 0&amp;lt;k&amp;lt;(n-1)/2<a name="line.304"></a>
<span class="sourceLineNo">305</span>     * a[offa+1] = Im[(n-1)/2]<a name="line.305"></a>
<span class="sourceLineNo">306</span>     * &lt;/pre&gt;<a name="line.306"></a>
<span class="sourceLineNo">307</span>     * <a name="line.307"></a>
<span class="sourceLineNo">308</span>     * This method computes only half of the elements of the real transform. The<a name="line.308"></a>
<span class="sourceLineNo">309</span>     * other half satisfies the symmetry condition. If you want the full real<a name="line.309"></a>
<span class="sourceLineNo">310</span>     * forward transform, use &lt;code&gt;realForwardFull&lt;/code&gt;. To get back the<a name="line.310"></a>
<span class="sourceLineNo">311</span>     * original data, use &lt;code&gt;realInverse&lt;/code&gt; on the output of this method.<a name="line.311"></a>
<span class="sourceLineNo">312</span>     * <a name="line.312"></a>
<span class="sourceLineNo">313</span>     * @param a<a name="line.313"></a>
<span class="sourceLineNo">314</span>     *            data to transform<a name="line.314"></a>
<span class="sourceLineNo">315</span>     * @param offa<a name="line.315"></a>
<span class="sourceLineNo">316</span>     *            index of the first element in array &lt;code&gt;a&lt;/code&gt;<a name="line.316"></a>
<span class="sourceLineNo">317</span>     */<a name="line.317"></a>
<span class="sourceLineNo">318</span>    public void realForward(float[] a, int offa) {<a name="line.318"></a>
<span class="sourceLineNo">319</span>        if (n == 1)<a name="line.319"></a>
<span class="sourceLineNo">320</span>            return;<a name="line.320"></a>
<span class="sourceLineNo">321</span><a name="line.321"></a>
<span class="sourceLineNo">322</span>        switch (plan) {<a name="line.322"></a>
<span class="sourceLineNo">323</span>        case SPLIT_RADIX:<a name="line.323"></a>
<span class="sourceLineNo">324</span>            float xi;<a name="line.324"></a>
<span class="sourceLineNo">325</span><a name="line.325"></a>
<span class="sourceLineNo">326</span>            if (n &gt; 4) {<a name="line.326"></a>
<span class="sourceLineNo">327</span>                cftfsub(n, a, offa, ip, nw, w);<a name="line.327"></a>
<span class="sourceLineNo">328</span>                rftfsub(n, a, offa, nc, w, nw);<a name="line.328"></a>
<span class="sourceLineNo">329</span>            } else if (n == 4) {<a name="line.329"></a>
<span class="sourceLineNo">330</span>                cftx020(a, offa);<a name="line.330"></a>
<span class="sourceLineNo">331</span>            }<a name="line.331"></a>
<span class="sourceLineNo">332</span>            xi = a[offa] - a[offa + 1];<a name="line.332"></a>
<span class="sourceLineNo">333</span>            a[offa] += a[offa + 1];<a name="line.333"></a>
<span class="sourceLineNo">334</span>            a[offa + 1] = xi;<a name="line.334"></a>
<span class="sourceLineNo">335</span>            break;<a name="line.335"></a>
<span class="sourceLineNo">336</span>        case MIXED_RADIX:<a name="line.336"></a>
<span class="sourceLineNo">337</span>            rfftf(a, offa);<a name="line.337"></a>
<span class="sourceLineNo">338</span>            for (int k = n - 1; k &gt;= 2; k--) {<a name="line.338"></a>
<span class="sourceLineNo">339</span>                int idx = offa + k;<a name="line.339"></a>
<span class="sourceLineNo">340</span>                float tmp = a[idx];<a name="line.340"></a>
<span class="sourceLineNo">341</span>                a[idx] = a[idx - 1];<a name="line.341"></a>
<span class="sourceLineNo">342</span>                a[idx - 1] = tmp;<a name="line.342"></a>
<span class="sourceLineNo">343</span>            }<a name="line.343"></a>
<span class="sourceLineNo">344</span>            break;<a name="line.344"></a>
<span class="sourceLineNo">345</span>        case BLUESTEIN:<a name="line.345"></a>
<span class="sourceLineNo">346</span>            bluestein_real_forward(a, offa);<a name="line.346"></a>
<span class="sourceLineNo">347</span>            break;<a name="line.347"></a>
<span class="sourceLineNo">348</span>        }<a name="line.348"></a>
<span class="sourceLineNo">349</span>    }<a name="line.349"></a>
<span class="sourceLineNo">350</span><a name="line.350"></a>
<span class="sourceLineNo">351</span>    /**<a name="line.351"></a>
<span class="sourceLineNo">352</span>     * Computes 1D forward DFT of real data leaving the result in &lt;code&gt;a&lt;/code&gt;<a name="line.352"></a>
<span class="sourceLineNo">353</span>     * . This method computes the full real forward transform, i.e. you will get<a name="line.353"></a>
<span class="sourceLineNo">354</span>     * the same result as from &lt;code&gt;complexForward&lt;/code&gt; called with all<a name="line.354"></a>
<span class="sourceLineNo">355</span>     * imaginary parts equal 0. Because the result is stored in &lt;code&gt;a&lt;/code&gt;,<a name="line.355"></a>
<span class="sourceLineNo">356</span>     * the size of the input array must greater or equal 2*n, with only the<a name="line.356"></a>
<span class="sourceLineNo">357</span>     * first n elements filled with real data. To get back the original data,<a name="line.357"></a>
<span class="sourceLineNo">358</span>     * use &lt;code&gt;complexInverse&lt;/code&gt; on the output of this method.<a name="line.358"></a>
<span class="sourceLineNo">359</span>     * <a name="line.359"></a>
<span class="sourceLineNo">360</span>     * @param a<a name="line.360"></a>
<span class="sourceLineNo">361</span>     *            data to transform<a name="line.361"></a>
<span class="sourceLineNo">362</span>     */<a name="line.362"></a>
<span class="sourceLineNo">363</span>    public void realForwardFull(float[] a) {<a name="line.363"></a>
<span class="sourceLineNo">364</span>        realForwardFull(a, 0);<a name="line.364"></a>
<span class="sourceLineNo">365</span>    }<a name="line.365"></a>
<span class="sourceLineNo">366</span><a name="line.366"></a>
<span class="sourceLineNo">367</span>    /**<a name="line.367"></a>
<span class="sourceLineNo">368</span>     * Computes 1D forward DFT of real data leaving the result in &lt;code&gt;a&lt;/code&gt;<a name="line.368"></a>
<span class="sourceLineNo">369</span>     * . This method computes the full real forward transform, i.e. you will get<a name="line.369"></a>
<span class="sourceLineNo">370</span>     * the same result as from &lt;code&gt;complexForward&lt;/code&gt; called with all<a name="line.370"></a>
<span class="sourceLineNo">371</span>     * imaginary part equal 0. Because the result is stored in &lt;code&gt;a&lt;/code&gt;,<a name="line.371"></a>
<span class="sourceLineNo">372</span>     * the size of the input array must greater or equal 2*n, with only the<a name="line.372"></a>
<span class="sourceLineNo">373</span>     * first n elements filled with real data. To get back the original data,<a name="line.373"></a>
<span class="sourceLineNo">374</span>     * use &lt;code&gt;complexInverse&lt;/code&gt; on the output of this method.<a name="line.374"></a>
<span class="sourceLineNo">375</span>     * <a name="line.375"></a>
<span class="sourceLineNo">376</span>     * @param a<a name="line.376"></a>
<span class="sourceLineNo">377</span>     *            data to transform<a name="line.377"></a>
<span class="sourceLineNo">378</span>     * @param offa<a name="line.378"></a>
<span class="sourceLineNo">379</span>     *            index of the first element in array &lt;code&gt;a&lt;/code&gt;<a name="line.379"></a>
<span class="sourceLineNo">380</span>     */<a name="line.380"></a>
<span class="sourceLineNo">381</span>    public void realForwardFull(final float[] a, final int offa) {<a name="line.381"></a>
<span class="sourceLineNo">382</span><a name="line.382"></a>
<span class="sourceLineNo">383</span>        final int twon = 2 * n;<a name="line.383"></a>
<span class="sourceLineNo">384</span>        switch (plan) {<a name="line.384"></a>
<span class="sourceLineNo">385</span>        case SPLIT_RADIX:<a name="line.385"></a>
<span class="sourceLineNo">386</span>            realForward(a, offa);<a name="line.386"></a>
<span class="sourceLineNo">387</span>            int nthreads = ConcurrencyUtils.getNumberOfThreads();<a name="line.387"></a>
<span class="sourceLineNo">388</span>            if ((nthreads &gt; 1) &amp;&amp; (n / 2 &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_2Threads())) {<a name="line.388"></a>
<span class="sourceLineNo">389</span>                Future&lt;?&gt;[] futures = new Future[nthreads];<a name="line.389"></a>
<span class="sourceLineNo">390</span>                int k = n / 2 / nthreads;<a name="line.390"></a>
<span class="sourceLineNo">391</span>                for (int i = 0; i &lt; nthreads; i++) {<a name="line.391"></a>
<span class="sourceLineNo">392</span>                    final int firstIdx = i * k;<a name="line.392"></a>
<span class="sourceLineNo">393</span>                    final int lastIdx = (i == (nthreads - 1)) ? n / 2 : firstIdx + k;<a name="line.393"></a>
<span class="sourceLineNo">394</span>                    futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.394"></a>
<span class="sourceLineNo">395</span>                        @Override<a name="line.395"></a>
<span class="sourceLineNo">396</span>                                                public void run() {<a name="line.396"></a>
<span class="sourceLineNo">397</span>                            int idx1, idx2;<a name="line.397"></a>
<span class="sourceLineNo">398</span>                            for (int k = firstIdx; k &lt; lastIdx; k++) {<a name="line.398"></a>
<span class="sourceLineNo">399</span>                                idx1 = 2 * k;<a name="line.399"></a>
<span class="sourceLineNo">400</span>                                idx2 = offa + ((twon - idx1) % twon);<a name="line.400"></a>
<span class="sourceLineNo">401</span>                                a[idx2] = a[offa + idx1];<a name="line.401"></a>
<span class="sourceLineNo">402</span>                                a[idx2 + 1] = -a[offa + idx1 + 1];<a name="line.402"></a>
<span class="sourceLineNo">403</span>                            }<a name="line.403"></a>
<span class="sourceLineNo">404</span>                        }<a name="line.404"></a>
<span class="sourceLineNo">405</span>                    });<a name="line.405"></a>
<span class="sourceLineNo">406</span>                }<a name="line.406"></a>
<span class="sourceLineNo">407</span>                ConcurrencyUtils.waitForCompletion(futures);<a name="line.407"></a>
<span class="sourceLineNo">408</span>            } else {<a name="line.408"></a>
<span class="sourceLineNo">409</span>                int idx1, idx2;<a name="line.409"></a>
<span class="sourceLineNo">410</span>                for (int k = 0; k &lt; n / 2; k++) {<a name="line.410"></a>
<span class="sourceLineNo">411</span>                    idx1 = 2 * k;<a name="line.411"></a>
<span class="sourceLineNo">412</span>                    idx2 = offa + ((twon - idx1) % twon);<a name="line.412"></a>
<span class="sourceLineNo">413</span>                    a[idx2] = a[offa + idx1];<a name="line.413"></a>
<span class="sourceLineNo">414</span>                    a[idx2 + 1] = -a[offa + idx1 + 1];<a name="line.414"></a>
<span class="sourceLineNo">415</span>                }<a name="line.415"></a>
<span class="sourceLineNo">416</span>            }<a name="line.416"></a>
<span class="sourceLineNo">417</span>            a[offa + n] = -a[offa + 1];<a name="line.417"></a>
<span class="sourceLineNo">418</span>            a[offa + 1] = 0;<a name="line.418"></a>
<span class="sourceLineNo">419</span>            break;<a name="line.419"></a>
<span class="sourceLineNo">420</span>        case MIXED_RADIX:<a name="line.420"></a>
<span class="sourceLineNo">421</span>            rfftf(a, offa);<a name="line.421"></a>
<span class="sourceLineNo">422</span>            int m;<a name="line.422"></a>
<span class="sourceLineNo">423</span>            if (n % 2 == 0) {<a name="line.423"></a>
<span class="sourceLineNo">424</span>                m = n / 2;<a name="line.424"></a>
<span class="sourceLineNo">425</span>            } else {<a name="line.425"></a>
<span class="sourceLineNo">426</span>                m = (n + 1) / 2;<a name="line.426"></a>
<span class="sourceLineNo">427</span>            }<a name="line.427"></a>
<span class="sourceLineNo">428</span>            for (int k = 1; k &lt; m; k++) {<a name="line.428"></a>
<span class="sourceLineNo">429</span>                int idx1 = offa + twon - 2 * k;<a name="line.429"></a>
<span class="sourceLineNo">430</span>                int idx2 = offa + 2 * k;<a name="line.430"></a>
<span class="sourceLineNo">431</span>                a[idx1 + 1] = -a[idx2];<a name="line.431"></a>
<span class="sourceLineNo">432</span>                a[idx1] = a[idx2 - 1];<a name="line.432"></a>
<span class="sourceLineNo">433</span>            }<a name="line.433"></a>
<span class="sourceLineNo">434</span>            for (int k = 1; k &lt; n; k++) {<a name="line.434"></a>
<span class="sourceLineNo">435</span>                int idx = offa + n - k;<a name="line.435"></a>
<span class="sourceLineNo">436</span>                float tmp = a[idx + 1];<a name="line.436"></a>
<span class="sourceLineNo">437</span>                a[idx + 1] = a[idx];<a name="line.437"></a>
<span class="sourceLineNo">438</span>                a[idx] = tmp;<a name="line.438"></a>
<span class="sourceLineNo">439</span>            }<a name="line.439"></a>
<span class="sourceLineNo">440</span>            a[offa + 1] = 0;<a name="line.440"></a>
<span class="sourceLineNo">441</span>            break;<a name="line.441"></a>
<span class="sourceLineNo">442</span>        case BLUESTEIN:<a name="line.442"></a>
<span class="sourceLineNo">443</span>            bluestein_real_full(a, offa, -1);<a name="line.443"></a>
<span class="sourceLineNo">444</span>            break;<a name="line.444"></a>
<span class="sourceLineNo">445</span>        }<a name="line.445"></a>
<span class="sourceLineNo">446</span>    }<a name="line.446"></a>
<span class="sourceLineNo">447</span><a name="line.447"></a>
<span class="sourceLineNo">448</span>    /**<a name="line.448"></a>
<span class="sourceLineNo">449</span>     * Computes 1D inverse DFT of real data leaving the result in &lt;code&gt;a&lt;/code&gt;<a name="line.449"></a>
<span class="sourceLineNo">450</span>     * . The physical layout of the input data has to be as follows:&lt;br&gt;<a name="line.450"></a>
<span class="sourceLineNo">451</span>     * <a name="line.451"></a>
<span class="sourceLineNo">452</span>     * if n is even then<a name="line.452"></a>
<span class="sourceLineNo">453</span>     * <a name="line.453"></a>
<span class="sourceLineNo">454</span>     * &lt;pre&gt;<a name="line.454"></a>
<span class="sourceLineNo">455</span>     * a[2*k] = Re[k], 0&amp;lt;=k&amp;lt;n/2<a name="line.455"></a>
<span class="sourceLineNo">456</span>     * a[2*k+1] = Im[k], 0&amp;lt;k&amp;lt;n/2<a name="line.456"></a>
<span class="sourceLineNo">457</span>     * a[1] = Re[n/2]<a name="line.457"></a>
<span class="sourceLineNo">458</span>     * &lt;/pre&gt;<a name="line.458"></a>
<span class="sourceLineNo">459</span>     * <a name="line.459"></a>
<span class="sourceLineNo">460</span>     * if n is odd then<a name="line.460"></a>
<span class="sourceLineNo">461</span>     * <a name="line.461"></a>
<span class="sourceLineNo">462</span>     * &lt;pre&gt;<a name="line.462"></a>
<span class="sourceLineNo">463</span>     * a[2*k] = Re[k], 0&amp;lt;=k&amp;lt;(n+1)/2<a name="line.463"></a>
<span class="sourceLineNo">464</span>     * a[2*k+1] = Im[k], 0&amp;lt;k&amp;lt;(n-1)/2<a name="line.464"></a>
<span class="sourceLineNo">465</span>     * a[1] = Im[(n-1)/2]<a name="line.465"></a>
<span class="sourceLineNo">466</span>     * &lt;/pre&gt;<a name="line.466"></a>
<span class="sourceLineNo">467</span>     * <a name="line.467"></a>
<span class="sourceLineNo">468</span>     * This method computes only half of the elements of the real transform. The<a name="line.468"></a>
<span class="sourceLineNo">469</span>     * other half satisfies the symmetry condition. If you want the full real<a name="line.469"></a>
<span class="sourceLineNo">470</span>     * inverse transform, use &lt;code&gt;realInverseFull&lt;/code&gt;.<a name="line.470"></a>
<span class="sourceLineNo">471</span>     * <a name="line.471"></a>
<span class="sourceLineNo">472</span>     * @param a<a name="line.472"></a>
<span class="sourceLineNo">473</span>     *            data to transform<a name="line.473"></a>
<span class="sourceLineNo">474</span>     * <a name="line.474"></a>
<span class="sourceLineNo">475</span>     * @param scale<a name="line.475"></a>
<span class="sourceLineNo">476</span>     *            if true then scaling is performed<a name="line.476"></a>
<span class="sourceLineNo">477</span>     * <a name="line.477"></a>
<span class="sourceLineNo">478</span>     */<a name="line.478"></a>
<span class="sourceLineNo">479</span>    public void realInverse(float[] a, boolean scale) {<a name="line.479"></a>
<span class="sourceLineNo">480</span>        realInverse(a, 0, scale);<a name="line.480"></a>
<span class="sourceLineNo">481</span>    }<a name="line.481"></a>
<span class="sourceLineNo">482</span><a name="line.482"></a>
<span class="sourceLineNo">483</span>    /**<a name="line.483"></a>
<span class="sourceLineNo">484</span>     * Computes 1D inverse DFT of real data leaving the result in &lt;code&gt;a&lt;/code&gt;<a name="line.484"></a>
<span class="sourceLineNo">485</span>     * . The physical layout of the input data has to be as follows:&lt;br&gt;<a name="line.485"></a>
<span class="sourceLineNo">486</span>     * <a name="line.486"></a>
<span class="sourceLineNo">487</span>     * if n is even then<a name="line.487"></a>
<span class="sourceLineNo">488</span>     * <a name="line.488"></a>
<span class="sourceLineNo">489</span>     * &lt;pre&gt;<a name="line.489"></a>
<span class="sourceLineNo">490</span>     * a[offa+2*k] = Re[k], 0&amp;lt;=k&amp;lt;n/2<a name="line.490"></a>
<span class="sourceLineNo">491</span>     * a[offa+2*k+1] = Im[k], 0&amp;lt;k&amp;lt;n/2<a name="line.491"></a>
<span class="sourceLineNo">492</span>     * a[offa+1] = Re[n/2]<a name="line.492"></a>
<span class="sourceLineNo">493</span>     * &lt;/pre&gt;<a name="line.493"></a>
<span class="sourceLineNo">494</span>     * <a name="line.494"></a>
<span class="sourceLineNo">495</span>     * if n is odd then<a name="line.495"></a>
<span class="sourceLineNo">496</span>     * <a name="line.496"></a>
<span class="sourceLineNo">497</span>     * &lt;pre&gt;<a name="line.497"></a>
<span class="sourceLineNo">498</span>     * a[offa+2*k] = Re[k], 0&amp;lt;=k&amp;lt;(n+1)/2<a name="line.498"></a>
<span class="sourceLineNo">499</span>     * a[offa+2*k+1] = Im[k], 0&amp;lt;k&amp;lt;(n-1)/2<a name="line.499"></a>
<span class="sourceLineNo">500</span>     * a[offa+1] = Im[(n-1)/2]<a name="line.500"></a>
<span class="sourceLineNo">501</span>     * &lt;/pre&gt;<a name="line.501"></a>
<span class="sourceLineNo">502</span>     * <a name="line.502"></a>
<span class="sourceLineNo">503</span>     * This method computes only half of the elements of the real transform. The<a name="line.503"></a>
<span class="sourceLineNo">504</span>     * other half satisfies the symmetry condition. If you want the full real<a name="line.504"></a>
<span class="sourceLineNo">505</span>     * inverse transform, use &lt;code&gt;realInverseFull&lt;/code&gt;.<a name="line.505"></a>
<span class="sourceLineNo">506</span>     * <a name="line.506"></a>
<span class="sourceLineNo">507</span>     * @param a<a name="line.507"></a>
<span class="sourceLineNo">508</span>     *            data to transform<a name="line.508"></a>
<span class="sourceLineNo">509</span>     * @param offa<a name="line.509"></a>
<span class="sourceLineNo">510</span>     *            index of the first element in array &lt;code&gt;a&lt;/code&gt;<a name="line.510"></a>
<span class="sourceLineNo">511</span>     * @param scale<a name="line.511"></a>
<span class="sourceLineNo">512</span>     *            if true then scaling is performed<a name="line.512"></a>
<span class="sourceLineNo">513</span>     * <a name="line.513"></a>
<span class="sourceLineNo">514</span>     */<a name="line.514"></a>
<span class="sourceLineNo">515</span>    public void realInverse(float[] a, int offa, boolean scale) {<a name="line.515"></a>
<span class="sourceLineNo">516</span>        if (n == 1)<a name="line.516"></a>
<span class="sourceLineNo">517</span>            return;<a name="line.517"></a>
<span class="sourceLineNo">518</span>        switch (plan) {<a name="line.518"></a>
<span class="sourceLineNo">519</span>        case SPLIT_RADIX:<a name="line.519"></a>
<span class="sourceLineNo">520</span>            a[offa + 1] = (float)(0.5 * (a[offa] - a[offa + 1]));<a name="line.520"></a>
<span class="sourceLineNo">521</span>            a[offa] -= a[offa + 1];<a name="line.521"></a>
<span class="sourceLineNo">522</span>            if (n &gt; 4) {<a name="line.522"></a>
<span class="sourceLineNo">523</span>                rftfsub(n, a, offa, nc, w, nw);<a name="line.523"></a>
<span class="sourceLineNo">524</span>                cftbsub(n, a, offa, ip, nw, w);<a name="line.524"></a>
<span class="sourceLineNo">525</span>            } else if (n == 4) {<a name="line.525"></a>
<span class="sourceLineNo">526</span>                cftxc020(a, offa);<a name="line.526"></a>
<span class="sourceLineNo">527</span>            }<a name="line.527"></a>
<span class="sourceLineNo">528</span>            if (scale) {<a name="line.528"></a>
<span class="sourceLineNo">529</span>                scale(n / 2, a, offa, false);<a name="line.529"></a>
<span class="sourceLineNo">530</span>            }<a name="line.530"></a>
<span class="sourceLineNo">531</span>            break;<a name="line.531"></a>
<span class="sourceLineNo">532</span>        case MIXED_RADIX:<a name="line.532"></a>
<span class="sourceLineNo">533</span>            for (int k = 2; k &lt; n; k++) {<a name="line.533"></a>
<span class="sourceLineNo">534</span>                int idx = offa + k;<a name="line.534"></a>
<span class="sourceLineNo">535</span>                float tmp = a[idx - 1];<a name="line.535"></a>
<span class="sourceLineNo">536</span>                a[idx - 1] = a[idx];<a name="line.536"></a>
<span class="sourceLineNo">537</span>                a[idx] = tmp;<a name="line.537"></a>
<span class="sourceLineNo">538</span>            }<a name="line.538"></a>
<span class="sourceLineNo">539</span>            rfftb(a, offa);<a name="line.539"></a>
<span class="sourceLineNo">540</span>            if (scale) {<a name="line.540"></a>
<span class="sourceLineNo">541</span>                scale(n, a, offa, false);<a name="line.541"></a>
<span class="sourceLineNo">542</span>            }<a name="line.542"></a>
<span class="sourceLineNo">543</span>            break;<a name="line.543"></a>
<span class="sourceLineNo">544</span>        case BLUESTEIN:<a name="line.544"></a>
<span class="sourceLineNo">545</span>            bluestein_real_inverse(a, offa);<a name="line.545"></a>
<span class="sourceLineNo">546</span>            if (scale) {<a name="line.546"></a>
<span class="sourceLineNo">547</span>                scale(n, a, offa, false);<a name="line.547"></a>
<span class="sourceLineNo">548</span>            }<a name="line.548"></a>
<span class="sourceLineNo">549</span>            break;<a name="line.549"></a>
<span class="sourceLineNo">550</span>        }<a name="line.550"></a>
<span class="sourceLineNo">551</span><a name="line.551"></a>
<span class="sourceLineNo">552</span>    }<a name="line.552"></a>
<span class="sourceLineNo">553</span><a name="line.553"></a>
<span class="sourceLineNo">554</span>    /**<a name="line.554"></a>
<span class="sourceLineNo">555</span>     * Computes 1D inverse DFT of real data leaving the result in &lt;code&gt;a&lt;/code&gt;<a name="line.555"></a>
<span class="sourceLineNo">556</span>     * . This method computes the full real inverse transform, i.e. you will get<a name="line.556"></a>
<span class="sourceLineNo">557</span>     * the same result as from &lt;code&gt;complexInverse&lt;/code&gt; called with all<a name="line.557"></a>
<span class="sourceLineNo">558</span>     * imaginary part equal 0. Because the result is stored in &lt;code&gt;a&lt;/code&gt;,<a name="line.558"></a>
<span class="sourceLineNo">559</span>     * the size of the input array must greater or equal 2*n, with only the<a name="line.559"></a>
<span class="sourceLineNo">560</span>     * first n elements filled with real data.<a name="line.560"></a>
<span class="sourceLineNo">561</span>     * <a name="line.561"></a>
<span class="sourceLineNo">562</span>     * @param a<a name="line.562"></a>
<span class="sourceLineNo">563</span>     *            data to transform<a name="line.563"></a>
<span class="sourceLineNo">564</span>     * @param scale<a name="line.564"></a>
<span class="sourceLineNo">565</span>     *            if true then scaling is performed<a name="line.565"></a>
<span class="sourceLineNo">566</span>     */<a name="line.566"></a>
<span class="sourceLineNo">567</span>    public void realInverseFull(float[] a, boolean scale) {<a name="line.567"></a>
<span class="sourceLineNo">568</span>        realInverseFull(a, 0, scale);<a name="line.568"></a>
<span class="sourceLineNo">569</span>    }<a name="line.569"></a>
<span class="sourceLineNo">570</span><a name="line.570"></a>
<span class="sourceLineNo">571</span>    /**<a name="line.571"></a>
<span class="sourceLineNo">572</span>     * Computes 1D inverse DFT of real data leaving the result in &lt;code&gt;a&lt;/code&gt;<a name="line.572"></a>
<span class="sourceLineNo">573</span>     * . This method computes the full real inverse transform, i.e. you will get<a name="line.573"></a>
<span class="sourceLineNo">574</span>     * the same result as from &lt;code&gt;complexInverse&lt;/code&gt; called with all<a name="line.574"></a>
<span class="sourceLineNo">575</span>     * imaginary part equal 0. Because the result is stored in &lt;code&gt;a&lt;/code&gt;,<a name="line.575"></a>
<span class="sourceLineNo">576</span>     * the size of the input array must greater or equal 2*n, with only the<a name="line.576"></a>
<span class="sourceLineNo">577</span>     * first n elements filled with real data.<a name="line.577"></a>
<span class="sourceLineNo">578</span>     * <a name="line.578"></a>
<span class="sourceLineNo">579</span>     * @param a<a name="line.579"></a>
<span class="sourceLineNo">580</span>     *            data to transform<a name="line.580"></a>
<span class="sourceLineNo">581</span>     * @param offa<a name="line.581"></a>
<span class="sourceLineNo">582</span>     *            index of the first element in array &lt;code&gt;a&lt;/code&gt;<a name="line.582"></a>
<span class="sourceLineNo">583</span>     * @param scale<a name="line.583"></a>
<span class="sourceLineNo">584</span>     *            if true then scaling is performed<a name="line.584"></a>
<span class="sourceLineNo">585</span>     */<a name="line.585"></a>
<span class="sourceLineNo">586</span>    public void realInverseFull(final float[] a, final int offa, boolean scale) {<a name="line.586"></a>
<span class="sourceLineNo">587</span>        final int twon = 2 * n;<a name="line.587"></a>
<span class="sourceLineNo">588</span>        switch (plan) {<a name="line.588"></a>
<span class="sourceLineNo">589</span>        case SPLIT_RADIX:<a name="line.589"></a>
<span class="sourceLineNo">590</span>            realInverse2(a, offa, scale);<a name="line.590"></a>
<span class="sourceLineNo">591</span>            int nthreads = ConcurrencyUtils.getNumberOfThreads();<a name="line.591"></a>
<span class="sourceLineNo">592</span>            if ((nthreads &gt; 1) &amp;&amp; (n / 2 &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_2Threads())) {<a name="line.592"></a>
<span class="sourceLineNo">593</span>                Future&lt;?&gt;[] futures = new Future[nthreads];<a name="line.593"></a>
<span class="sourceLineNo">594</span>                int k = n / 2 / nthreads;<a name="line.594"></a>
<span class="sourceLineNo">595</span>                for (int i = 0; i &lt; nthreads; i++) {<a name="line.595"></a>
<span class="sourceLineNo">596</span>                    final int firstIdx = i * k;<a name="line.596"></a>
<span class="sourceLineNo">597</span>                    final int lastIdx = (i == (nthreads - 1)) ? n / 2 : firstIdx + k;<a name="line.597"></a>
<span class="sourceLineNo">598</span>                    futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.598"></a>
<span class="sourceLineNo">599</span>                        @Override<a name="line.599"></a>
<span class="sourceLineNo">600</span>                                                public void run() {<a name="line.600"></a>
<span class="sourceLineNo">601</span>                            int idx1, idx2;<a name="line.601"></a>
<span class="sourceLineNo">602</span>                            for (int k = firstIdx; k &lt; lastIdx; k++) {<a name="line.602"></a>
<span class="sourceLineNo">603</span>                                idx1 = 2 * k;<a name="line.603"></a>
<span class="sourceLineNo">604</span>                                idx2 = offa + ((twon - idx1) % twon);<a name="line.604"></a>
<span class="sourceLineNo">605</span>                                a[idx2] = a[offa + idx1];<a name="line.605"></a>
<span class="sourceLineNo">606</span>                                a[idx2 + 1] = -a[offa + idx1 + 1];<a name="line.606"></a>
<span class="sourceLineNo">607</span>                            }<a name="line.607"></a>
<span class="sourceLineNo">608</span>                        }<a name="line.608"></a>
<span class="sourceLineNo">609</span>                    });<a name="line.609"></a>
<span class="sourceLineNo">610</span>                }<a name="line.610"></a>
<span class="sourceLineNo">611</span>                ConcurrencyUtils.waitForCompletion(futures);<a name="line.611"></a>
<span class="sourceLineNo">612</span>            } else {<a name="line.612"></a>
<span class="sourceLineNo">613</span>                int idx1, idx2;<a name="line.613"></a>
<span class="sourceLineNo">614</span>                for (int k = 0; k &lt; n / 2; k++) {<a name="line.614"></a>
<span class="sourceLineNo">615</span>                    idx1 = 2 * k;<a name="line.615"></a>
<span class="sourceLineNo">616</span>                    idx2 = offa + ((twon - idx1) % twon);<a name="line.616"></a>
<span class="sourceLineNo">617</span>                    a[idx2] = a[offa + idx1];<a name="line.617"></a>
<span class="sourceLineNo">618</span>                    a[idx2 + 1] = -a[offa + idx1 + 1];<a name="line.618"></a>
<span class="sourceLineNo">619</span>                }<a name="line.619"></a>
<span class="sourceLineNo">620</span>            }<a name="line.620"></a>
<span class="sourceLineNo">621</span>            a[offa + n] = -a[offa + 1];<a name="line.621"></a>
<span class="sourceLineNo">622</span>            a[offa + 1] = 0;<a name="line.622"></a>
<span class="sourceLineNo">623</span>            break;<a name="line.623"></a>
<span class="sourceLineNo">624</span>        case MIXED_RADIX:<a name="line.624"></a>
<span class="sourceLineNo">625</span>            rfftf(a, offa);<a name="line.625"></a>
<span class="sourceLineNo">626</span>            if (scale) {<a name="line.626"></a>
<span class="sourceLineNo">627</span>                scale(n, a, offa, false);<a name="line.627"></a>
<span class="sourceLineNo">628</span>            }<a name="line.628"></a>
<span class="sourceLineNo">629</span>            int m;<a name="line.629"></a>
<span class="sourceLineNo">630</span>            if (n % 2 == 0) {<a name="line.630"></a>
<span class="sourceLineNo">631</span>                m = n / 2;<a name="line.631"></a>
<span class="sourceLineNo">632</span>            } else {<a name="line.632"></a>
<span class="sourceLineNo">633</span>                m = (n + 1) / 2;<a name="line.633"></a>
<span class="sourceLineNo">634</span>            }<a name="line.634"></a>
<span class="sourceLineNo">635</span>            for (int k = 1; k &lt; m; k++) {<a name="line.635"></a>
<span class="sourceLineNo">636</span>                int idx1 = offa + 2 * k;<a name="line.636"></a>
<span class="sourceLineNo">637</span>                int idx2 = offa + twon - 2 * k;<a name="line.637"></a>
<span class="sourceLineNo">638</span>                a[idx1] = -a[idx1];<a name="line.638"></a>
<span class="sourceLineNo">639</span>                a[idx2 + 1] = -a[idx1];<a name="line.639"></a>
<span class="sourceLineNo">640</span>                a[idx2] = a[idx1 - 1];<a name="line.640"></a>
<span class="sourceLineNo">641</span>            }<a name="line.641"></a>
<span class="sourceLineNo">642</span>            for (int k = 1; k &lt; n; k++) {<a name="line.642"></a>
<span class="sourceLineNo">643</span>                int idx = offa + n - k;<a name="line.643"></a>
<span class="sourceLineNo">644</span>                float tmp = a[idx + 1];<a name="line.644"></a>
<span class="sourceLineNo">645</span>                a[idx + 1] = a[idx];<a name="line.645"></a>
<span class="sourceLineNo">646</span>                a[idx] = tmp;<a name="line.646"></a>
<span class="sourceLineNo">647</span>            }<a name="line.647"></a>
<span class="sourceLineNo">648</span>            a[offa + 1] = 0;<a name="line.648"></a>
<span class="sourceLineNo">649</span>            break;<a name="line.649"></a>
<span class="sourceLineNo">650</span>        case BLUESTEIN:<a name="line.650"></a>
<span class="sourceLineNo">651</span>            bluestein_real_full(a, offa, 1);<a name="line.651"></a>
<span class="sourceLineNo">652</span>            if (scale) {<a name="line.652"></a>
<span class="sourceLineNo">653</span>                scale(n, a, offa, true);<a name="line.653"></a>
<span class="sourceLineNo">654</span>            }<a name="line.654"></a>
<span class="sourceLineNo">655</span>            break;<a name="line.655"></a>
<span class="sourceLineNo">656</span>        }<a name="line.656"></a>
<span class="sourceLineNo">657</span>    }<a name="line.657"></a>
<span class="sourceLineNo">658</span><a name="line.658"></a>
<span class="sourceLineNo">659</span>    protected void realInverse2(float[] a, int offa, boolean scale) {<a name="line.659"></a>
<span class="sourceLineNo">660</span>        if (n == 1)<a name="line.660"></a>
<span class="sourceLineNo">661</span>            return;<a name="line.661"></a>
<span class="sourceLineNo">662</span>        switch (plan) {<a name="line.662"></a>
<span class="sourceLineNo">663</span>        case SPLIT_RADIX:<a name="line.663"></a>
<span class="sourceLineNo">664</span>            float xi;<a name="line.664"></a>
<span class="sourceLineNo">665</span><a name="line.665"></a>
<span class="sourceLineNo">666</span>            if (n &gt; 4) {<a name="line.666"></a>
<span class="sourceLineNo">667</span>                cftfsub(n, a, offa, ip, nw, w);<a name="line.667"></a>
<span class="sourceLineNo">668</span>                rftbsub(n, a, offa, nc, w, nw);<a name="line.668"></a>
<span class="sourceLineNo">669</span>            } else if (n == 4) {<a name="line.669"></a>
<span class="sourceLineNo">670</span>                cftbsub(n, a, offa, ip, nw, w);<a name="line.670"></a>
<span class="sourceLineNo">671</span>            }<a name="line.671"></a>
<span class="sourceLineNo">672</span>            xi = a[offa] - a[offa + 1];<a name="line.672"></a>
<span class="sourceLineNo">673</span>            a[offa] += a[offa + 1];<a name="line.673"></a>
<span class="sourceLineNo">674</span>            a[offa + 1] = xi;<a name="line.674"></a>
<span class="sourceLineNo">675</span>            if (scale) {<a name="line.675"></a>
<span class="sourceLineNo">676</span>                scale(n, a, offa, false);<a name="line.676"></a>
<span class="sourceLineNo">677</span>            }<a name="line.677"></a>
<span class="sourceLineNo">678</span>            break;<a name="line.678"></a>
<span class="sourceLineNo">679</span>        case MIXED_RADIX:<a name="line.679"></a>
<span class="sourceLineNo">680</span>            rfftf(a, offa);<a name="line.680"></a>
<span class="sourceLineNo">681</span>            for (int k = n - 1; k &gt;= 2; k--) {<a name="line.681"></a>
<span class="sourceLineNo">682</span>                int idx = offa + k;<a name="line.682"></a>
<span class="sourceLineNo">683</span>                float tmp = a[idx];<a name="line.683"></a>
<span class="sourceLineNo">684</span>                a[idx] = a[idx - 1];<a name="line.684"></a>
<span class="sourceLineNo">685</span>                a[idx - 1] = tmp;<a name="line.685"></a>
<span class="sourceLineNo">686</span>            }<a name="line.686"></a>
<span class="sourceLineNo">687</span>            if (scale) {<a name="line.687"></a>
<span class="sourceLineNo">688</span>                scale(n, a, offa, false);<a name="line.688"></a>
<span class="sourceLineNo">689</span>            }<a name="line.689"></a>
<span class="sourceLineNo">690</span>            int m;<a name="line.690"></a>
<span class="sourceLineNo">691</span>            if (n % 2 == 0) {<a name="line.691"></a>
<span class="sourceLineNo">692</span>                m = n / 2;<a name="line.692"></a>
<span class="sourceLineNo">693</span>                for (int i = 1; i &lt; m; i++) {<a name="line.693"></a>
<span class="sourceLineNo">694</span>                    int idx = offa + 2 * i + 1;<a name="line.694"></a>
<span class="sourceLineNo">695</span>                    a[idx] = -a[idx];<a name="line.695"></a>
<span class="sourceLineNo">696</span>                }<a name="line.696"></a>
<span class="sourceLineNo">697</span>            } else {<a name="line.697"></a>
<span class="sourceLineNo">698</span>                m = (n - 1) / 2;<a name="line.698"></a>
<span class="sourceLineNo">699</span>                for (int i = 0; i &lt; m; i++) {<a name="line.699"></a>
<span class="sourceLineNo">700</span>                    int idx = offa + 2 * i + 1;<a name="line.700"></a>
<span class="sourceLineNo">701</span>                    a[idx] = -a[idx];<a name="line.701"></a>
<span class="sourceLineNo">702</span>                }<a name="line.702"></a>
<span class="sourceLineNo">703</span>            }<a name="line.703"></a>
<span class="sourceLineNo">704</span>            break;<a name="line.704"></a>
<span class="sourceLineNo">705</span>        case BLUESTEIN:<a name="line.705"></a>
<span class="sourceLineNo">706</span>            bluestein_real_inverse2(a, offa);<a name="line.706"></a>
<span class="sourceLineNo">707</span>            if (scale) {<a name="line.707"></a>
<span class="sourceLineNo">708</span>                scale(n, a, offa, false);<a name="line.708"></a>
<span class="sourceLineNo">709</span>            }<a name="line.709"></a>
<span class="sourceLineNo">710</span>            break;<a name="line.710"></a>
<span class="sourceLineNo">711</span>        }<a name="line.711"></a>
<span class="sourceLineNo">712</span>    }<a name="line.712"></a>
<span class="sourceLineNo">713</span><a name="line.713"></a>
<span class="sourceLineNo">714</span>    private static int getReminder(int n, int factors[]) {<a name="line.714"></a>
<span class="sourceLineNo">715</span>        int reminder = n;<a name="line.715"></a>
<span class="sourceLineNo">716</span><a name="line.716"></a>
<span class="sourceLineNo">717</span>        if (n &lt;= 0) {<a name="line.717"></a>
<span class="sourceLineNo">718</span>            throw new IllegalArgumentException("n must be positive integer");<a name="line.718"></a>
<span class="sourceLineNo">719</span>        }<a name="line.719"></a>
<span class="sourceLineNo">720</span><a name="line.720"></a>
<span class="sourceLineNo">721</span>        for (int i = 0; i &lt; factors.length &amp;&amp; reminder != 1; i++) {<a name="line.721"></a>
<span class="sourceLineNo">722</span>            int factor = factors[i];<a name="line.722"></a>
<span class="sourceLineNo">723</span>            while ((reminder % factor) == 0) {<a name="line.723"></a>
<span class="sourceLineNo">724</span>                reminder /= factor;<a name="line.724"></a>
<span class="sourceLineNo">725</span>            }<a name="line.725"></a>
<span class="sourceLineNo">726</span>        }<a name="line.726"></a>
<span class="sourceLineNo">727</span>        return reminder;<a name="line.727"></a>
<span class="sourceLineNo">728</span>    }<a name="line.728"></a>
<span class="sourceLineNo">729</span><a name="line.729"></a>
<span class="sourceLineNo">730</span>    /* -------- initializing routines -------- */<a name="line.730"></a>
<span class="sourceLineNo">731</span><a name="line.731"></a>
<span class="sourceLineNo">732</span>    /*---------------------------------------------------------<a name="line.732"></a>
<span class="sourceLineNo">733</span>       cffti: initialization of Complex FFT<a name="line.733"></a>
<span class="sourceLineNo">734</span>      --------------------------------------------------------*/<a name="line.734"></a>
<span class="sourceLineNo">735</span><a name="line.735"></a>
<span class="sourceLineNo">736</span>    void cffti(int n, int offw) {<a name="line.736"></a>
<span class="sourceLineNo">737</span>        if (n == 1)<a name="line.737"></a>
<span class="sourceLineNo">738</span>            return;<a name="line.738"></a>
<span class="sourceLineNo">739</span><a name="line.739"></a>
<span class="sourceLineNo">740</span>        final int twon = 2 * n;<a name="line.740"></a>
<span class="sourceLineNo">741</span>        final int fourn = 4 * n;<a name="line.741"></a>
<span class="sourceLineNo">742</span>        float argh;<a name="line.742"></a>
<span class="sourceLineNo">743</span>        int idot, ntry = 0, i, j;<a name="line.743"></a>
<span class="sourceLineNo">744</span>        float argld;<a name="line.744"></a>
<span class="sourceLineNo">745</span>        int i1, k1, l1, l2, ib;<a name="line.745"></a>
<span class="sourceLineNo">746</span>        float fi;<a name="line.746"></a>
<span class="sourceLineNo">747</span>        int ld, ii, nf, ip, nl, nq, nr;<a name="line.747"></a>
<span class="sourceLineNo">748</span>        float arg;<a name="line.748"></a>
<span class="sourceLineNo">749</span>        int ido, ipm;<a name="line.749"></a>
<span class="sourceLineNo">750</span><a name="line.750"></a>
<span class="sourceLineNo">751</span>        nl = n;<a name="line.751"></a>
<span class="sourceLineNo">752</span>        nf = 0;<a name="line.752"></a>
<span class="sourceLineNo">753</span>        j = 0;<a name="line.753"></a>
<span class="sourceLineNo">754</span><a name="line.754"></a>
<span class="sourceLineNo">755</span>        factorize_loop: while (true) {<a name="line.755"></a>
<span class="sourceLineNo">756</span>            j++;<a name="line.756"></a>
<span class="sourceLineNo">757</span>            if (j &lt;= 4)<a name="line.757"></a>
<span class="sourceLineNo">758</span>                ntry = factors[j - 1];<a name="line.758"></a>
<span class="sourceLineNo">759</span>            else<a name="line.759"></a>
<span class="sourceLineNo">760</span>                ntry += 2;<a name="line.760"></a>
<span class="sourceLineNo">761</span>            do {<a name="line.761"></a>
<span class="sourceLineNo">762</span>                nq = nl / ntry;<a name="line.762"></a>
<span class="sourceLineNo">763</span>                nr = nl - ntry * nq;<a name="line.763"></a>
<span class="sourceLineNo">764</span>                if (nr != 0)<a name="line.764"></a>
<span class="sourceLineNo">765</span>                    continue factorize_loop;<a name="line.765"></a>
<span class="sourceLineNo">766</span>                nf++;<a name="line.766"></a>
<span class="sourceLineNo">767</span>                wtable[offw + nf + 1 + fourn] = ntry;<a name="line.767"></a>
<span class="sourceLineNo">768</span>                nl = nq;<a name="line.768"></a>
<span class="sourceLineNo">769</span>                if (ntry == 2 &amp;&amp; nf != 1) {<a name="line.769"></a>
<span class="sourceLineNo">770</span>                    for (i = 2; i &lt;= nf; i++) {<a name="line.770"></a>
<span class="sourceLineNo">771</span>                        ib = nf - i + 2;<a name="line.771"></a>
<span class="sourceLineNo">772</span>                        int idx = ib + fourn;<a name="line.772"></a>
<span class="sourceLineNo">773</span>                        wtable[offw + idx + 1] = wtable[offw + idx];<a name="line.773"></a>
<span class="sourceLineNo">774</span>                    }<a name="line.774"></a>
<span class="sourceLineNo">775</span>                    wtable[offw + 2 + fourn] = 2;<a name="line.775"></a>
<span class="sourceLineNo">776</span>                }<a name="line.776"></a>
<span class="sourceLineNo">777</span>            } while (nl != 1);<a name="line.777"></a>
<span class="sourceLineNo">778</span>            break factorize_loop;<a name="line.778"></a>
<span class="sourceLineNo">779</span>        }<a name="line.779"></a>
<span class="sourceLineNo">780</span>        wtable[offw + fourn] = n;<a name="line.780"></a>
<span class="sourceLineNo">781</span>        wtable[offw + 1 + fourn] = nf;<a name="line.781"></a>
<span class="sourceLineNo">782</span>        argh = TWO_PI / (float) n;<a name="line.782"></a>
<span class="sourceLineNo">783</span>        i = 1;<a name="line.783"></a>
<span class="sourceLineNo">784</span>        l1 = 1;<a name="line.784"></a>
<span class="sourceLineNo">785</span>        for (k1 = 1; k1 &lt;= nf; k1++) {<a name="line.785"></a>
<span class="sourceLineNo">786</span>            ip = (int) wtable[offw + k1 + 1 + fourn];<a name="line.786"></a>
<span class="sourceLineNo">787</span>            ld = 0;<a name="line.787"></a>
<span class="sourceLineNo">788</span>            l2 = l1 * ip;<a name="line.788"></a>
<span class="sourceLineNo">789</span>            ido = n / l2;<a name="line.789"></a>
<span class="sourceLineNo">790</span>            idot = ido + ido + 2;<a name="line.790"></a>
<span class="sourceLineNo">791</span>            ipm = ip - 1;<a name="line.791"></a>
<span class="sourceLineNo">792</span>            for (j = 1; j &lt;= ipm; j++) {<a name="line.792"></a>
<span class="sourceLineNo">793</span>                i1 = i;<a name="line.793"></a>
<span class="sourceLineNo">794</span>                wtable[offw + i - 1 + twon] = 1;<a name="line.794"></a>
<span class="sourceLineNo">795</span>                wtable[offw + i + twon] = 0;<a name="line.795"></a>
<span class="sourceLineNo">796</span>                ld += l1;<a name="line.796"></a>
<span class="sourceLineNo">797</span>                fi = 0;<a name="line.797"></a>
<span class="sourceLineNo">798</span>                argld = ld * argh;<a name="line.798"></a>
<span class="sourceLineNo">799</span>                for (ii = 4; ii &lt;= idot; ii += 2) {<a name="line.799"></a>
<span class="sourceLineNo">800</span>                    i += 2;<a name="line.800"></a>
<span class="sourceLineNo">801</span>                    fi += 1;<a name="line.801"></a>
<span class="sourceLineNo">802</span>                    arg = fi * argld;<a name="line.802"></a>
<span class="sourceLineNo">803</span>                    int idx = i + twon;<a name="line.803"></a>
<span class="sourceLineNo">804</span>                    wtable[offw + idx - 1] = (float)Math.cos(arg);<a name="line.804"></a>
<span class="sourceLineNo">805</span>                    wtable[offw + idx] = (float)Math.sin(arg);<a name="line.805"></a>
<span class="sourceLineNo">806</span>                }<a name="line.806"></a>
<span class="sourceLineNo">807</span>                if (ip &gt; 5) {<a name="line.807"></a>
<span class="sourceLineNo">808</span>                    int idx1 = i1 + twon;<a name="line.808"></a>
<span class="sourceLineNo">809</span>                    int idx2 = i + twon;<a name="line.809"></a>
<span class="sourceLineNo">810</span>                    wtable[offw + idx1 - 1] = wtable[offw + idx2 - 1];<a name="line.810"></a>
<span class="sourceLineNo">811</span>                    wtable[offw + idx1] = wtable[offw + idx2];<a name="line.811"></a>
<span class="sourceLineNo">812</span>                }<a name="line.812"></a>
<span class="sourceLineNo">813</span>            }<a name="line.813"></a>
<span class="sourceLineNo">814</span>            l1 = l2;<a name="line.814"></a>
<span class="sourceLineNo">815</span>        }<a name="line.815"></a>
<span class="sourceLineNo">816</span><a name="line.816"></a>
<span class="sourceLineNo">817</span>    }<a name="line.817"></a>
<span class="sourceLineNo">818</span><a name="line.818"></a>
<span class="sourceLineNo">819</span>    void cffti() {<a name="line.819"></a>
<span class="sourceLineNo">820</span>        if (n == 1)<a name="line.820"></a>
<span class="sourceLineNo">821</span>            return;<a name="line.821"></a>
<span class="sourceLineNo">822</span><a name="line.822"></a>
<span class="sourceLineNo">823</span>        final int twon = 2 * n;<a name="line.823"></a>
<span class="sourceLineNo">824</span>        final int fourn = 4 * n;<a name="line.824"></a>
<span class="sourceLineNo">825</span>        float argh;<a name="line.825"></a>
<span class="sourceLineNo">826</span>        int idot, ntry = 0, i, j;<a name="line.826"></a>
<span class="sourceLineNo">827</span>        float argld;<a name="line.827"></a>
<span class="sourceLineNo">828</span>        int i1, k1, l1, l2, ib;<a name="line.828"></a>
<span class="sourceLineNo">829</span>        float fi;<a name="line.829"></a>
<span class="sourceLineNo">830</span>        int ld, ii, nf, ip, nl, nq, nr;<a name="line.830"></a>
<span class="sourceLineNo">831</span>        float arg;<a name="line.831"></a>
<span class="sourceLineNo">832</span>        int ido, ipm;<a name="line.832"></a>
<span class="sourceLineNo">833</span><a name="line.833"></a>
<span class="sourceLineNo">834</span>        nl = n;<a name="line.834"></a>
<span class="sourceLineNo">835</span>        nf = 0;<a name="line.835"></a>
<span class="sourceLineNo">836</span>        j = 0;<a name="line.836"></a>
<span class="sourceLineNo">837</span><a name="line.837"></a>
<span class="sourceLineNo">838</span>        factorize_loop: while (true) {<a name="line.838"></a>
<span class="sourceLineNo">839</span>            j++;<a name="line.839"></a>
<span class="sourceLineNo">840</span>            if (j &lt;= 4)<a name="line.840"></a>
<span class="sourceLineNo">841</span>                ntry = factors[j - 1];<a name="line.841"></a>
<span class="sourceLineNo">842</span>            else<a name="line.842"></a>
<span class="sourceLineNo">843</span>                ntry += 2;<a name="line.843"></a>
<span class="sourceLineNo">844</span>            do {<a name="line.844"></a>
<span class="sourceLineNo">845</span>                nq = nl / ntry;<a name="line.845"></a>
<span class="sourceLineNo">846</span>                nr = nl - ntry * nq;<a name="line.846"></a>
<span class="sourceLineNo">847</span>                if (nr != 0)<a name="line.847"></a>
<span class="sourceLineNo">848</span>                    continue factorize_loop;<a name="line.848"></a>
<span class="sourceLineNo">849</span>                nf++;<a name="line.849"></a>
<span class="sourceLineNo">850</span>                wtable[nf + 1 + fourn] = ntry;<a name="line.850"></a>
<span class="sourceLineNo">851</span>                nl = nq;<a name="line.851"></a>
<span class="sourceLineNo">852</span>                if (ntry == 2 &amp;&amp; nf != 1) {<a name="line.852"></a>
<span class="sourceLineNo">853</span>                    for (i = 2; i &lt;= nf; i++) {<a name="line.853"></a>
<span class="sourceLineNo">854</span>                        ib = nf - i + 2;<a name="line.854"></a>
<span class="sourceLineNo">855</span>                        int idx = ib + fourn;<a name="line.855"></a>
<span class="sourceLineNo">856</span>                        wtable[idx + 1] = wtable[idx];<a name="line.856"></a>
<span class="sourceLineNo">857</span>                    }<a name="line.857"></a>
<span class="sourceLineNo">858</span>                    wtable[2 + fourn] = 2;<a name="line.858"></a>
<span class="sourceLineNo">859</span>                }<a name="line.859"></a>
<span class="sourceLineNo">860</span>            } while (nl != 1);<a name="line.860"></a>
<span class="sourceLineNo">861</span>            break factorize_loop;<a name="line.861"></a>
<span class="sourceLineNo">862</span>        }<a name="line.862"></a>
<span class="sourceLineNo">863</span>        wtable[fourn] = n;<a name="line.863"></a>
<span class="sourceLineNo">864</span>        wtable[1 + fourn] = nf;<a name="line.864"></a>
<span class="sourceLineNo">865</span>        argh = TWO_PI / (float) n;<a name="line.865"></a>
<span class="sourceLineNo">866</span>        i = 1;<a name="line.866"></a>
<span class="sourceLineNo">867</span>        l1 = 1;<a name="line.867"></a>
<span class="sourceLineNo">868</span>        for (k1 = 1; k1 &lt;= nf; k1++) {<a name="line.868"></a>
<span class="sourceLineNo">869</span>            ip = (int) wtable[k1 + 1 + fourn];<a name="line.869"></a>
<span class="sourceLineNo">870</span>            ld = 0;<a name="line.870"></a>
<span class="sourceLineNo">871</span>            l2 = l1 * ip;<a name="line.871"></a>
<span class="sourceLineNo">872</span>            ido = n / l2;<a name="line.872"></a>
<span class="sourceLineNo">873</span>            idot = ido + ido + 2;<a name="line.873"></a>
<span class="sourceLineNo">874</span>            ipm = ip - 1;<a name="line.874"></a>
<span class="sourceLineNo">875</span>            for (j = 1; j &lt;= ipm; j++) {<a name="line.875"></a>
<span class="sourceLineNo">876</span>                i1 = i;<a name="line.876"></a>
<span class="sourceLineNo">877</span>                wtable[i - 1 + twon] = 1;<a name="line.877"></a>
<span class="sourceLineNo">878</span>                wtable[i + twon] = 0;<a name="line.878"></a>
<span class="sourceLineNo">879</span>                ld += l1;<a name="line.879"></a>
<span class="sourceLineNo">880</span>                fi = 0;<a name="line.880"></a>
<span class="sourceLineNo">881</span>                argld = ld * argh;<a name="line.881"></a>
<span class="sourceLineNo">882</span>                for (ii = 4; ii &lt;= idot; ii += 2) {<a name="line.882"></a>
<span class="sourceLineNo">883</span>                    i += 2;<a name="line.883"></a>
<span class="sourceLineNo">884</span>                    fi += 1;<a name="line.884"></a>
<span class="sourceLineNo">885</span>                    arg = fi * argld;<a name="line.885"></a>
<span class="sourceLineNo">886</span>                    int idx = i + twon;<a name="line.886"></a>
<span class="sourceLineNo">887</span>                    wtable[idx - 1] = (float)Math.cos(arg);<a name="line.887"></a>
<span class="sourceLineNo">888</span>                    wtable[idx] = (float)Math.sin(arg);<a name="line.888"></a>
<span class="sourceLineNo">889</span>                }<a name="line.889"></a>
<span class="sourceLineNo">890</span>                if (ip &gt; 5) {<a name="line.890"></a>
<span class="sourceLineNo">891</span>                    int idx1 = i1 + twon;<a name="line.891"></a>
<span class="sourceLineNo">892</span>                    int idx2 = i + twon;<a name="line.892"></a>
<span class="sourceLineNo">893</span>                    wtable[idx1 - 1] = wtable[idx2 - 1];<a name="line.893"></a>
<span class="sourceLineNo">894</span>                    wtable[idx1] = wtable[idx2];<a name="line.894"></a>
<span class="sourceLineNo">895</span>                }<a name="line.895"></a>
<span class="sourceLineNo">896</span>            }<a name="line.896"></a>
<span class="sourceLineNo">897</span>            l1 = l2;<a name="line.897"></a>
<span class="sourceLineNo">898</span>        }<a name="line.898"></a>
<span class="sourceLineNo">899</span><a name="line.899"></a>
<span class="sourceLineNo">900</span>    }<a name="line.900"></a>
<span class="sourceLineNo">901</span><a name="line.901"></a>
<span class="sourceLineNo">902</span>    void rffti() {<a name="line.902"></a>
<span class="sourceLineNo">903</span><a name="line.903"></a>
<span class="sourceLineNo">904</span>        if (n == 1)<a name="line.904"></a>
<span class="sourceLineNo">905</span>            return;<a name="line.905"></a>
<span class="sourceLineNo">906</span>        final int twon = 2 * n;<a name="line.906"></a>
<span class="sourceLineNo">907</span>        float argh;<a name="line.907"></a>
<span class="sourceLineNo">908</span>        int ntry = 0, i, j;<a name="line.908"></a>
<span class="sourceLineNo">909</span>        float argld;<a name="line.909"></a>
<span class="sourceLineNo">910</span>        int k1, l1, l2, ib;<a name="line.910"></a>
<span class="sourceLineNo">911</span>        float fi;<a name="line.911"></a>
<span class="sourceLineNo">912</span>        int ld, ii, nf, ip, nl, is, nq, nr;<a name="line.912"></a>
<span class="sourceLineNo">913</span>        float arg;<a name="line.913"></a>
<span class="sourceLineNo">914</span>        int ido, ipm;<a name="line.914"></a>
<span class="sourceLineNo">915</span>        int nfm1;<a name="line.915"></a>
<span class="sourceLineNo">916</span><a name="line.916"></a>
<span class="sourceLineNo">917</span>        nl = n;<a name="line.917"></a>
<span class="sourceLineNo">918</span>        nf = 0;<a name="line.918"></a>
<span class="sourceLineNo">919</span>        j = 0;<a name="line.919"></a>
<span class="sourceLineNo">920</span><a name="line.920"></a>
<span class="sourceLineNo">921</span>        factorize_loop: while (true) {<a name="line.921"></a>
<span class="sourceLineNo">922</span>            ++j;<a name="line.922"></a>
<span class="sourceLineNo">923</span>            if (j &lt;= 4)<a name="line.923"></a>
<span class="sourceLineNo">924</span>                ntry = factors[j - 1];<a name="line.924"></a>
<span class="sourceLineNo">925</span>            else<a name="line.925"></a>
<span class="sourceLineNo">926</span>                ntry += 2;<a name="line.926"></a>
<span class="sourceLineNo">927</span>            do {<a name="line.927"></a>
<span class="sourceLineNo">928</span>                nq = nl / ntry;<a name="line.928"></a>
<span class="sourceLineNo">929</span>                nr = nl - ntry * nq;<a name="line.929"></a>
<span class="sourceLineNo">930</span>                if (nr != 0)<a name="line.930"></a>
<span class="sourceLineNo">931</span>                    continue factorize_loop;<a name="line.931"></a>
<span class="sourceLineNo">932</span>                ++nf;<a name="line.932"></a>
<span class="sourceLineNo">933</span>                wtable_r[nf + 1 + twon] = ntry;<a name="line.933"></a>
<span class="sourceLineNo">934</span><a name="line.934"></a>
<span class="sourceLineNo">935</span>                nl = nq;<a name="line.935"></a>
<span class="sourceLineNo">936</span>                if (ntry == 2 &amp;&amp; nf != 1) {<a name="line.936"></a>
<span class="sourceLineNo">937</span>                    for (i = 2; i &lt;= nf; i++) {<a name="line.937"></a>
<span class="sourceLineNo">938</span>                        ib = nf - i + 2;<a name="line.938"></a>
<span class="sourceLineNo">939</span>                        int idx = ib + twon;<a name="line.939"></a>
<span class="sourceLineNo">940</span>                        wtable_r[idx + 1] = wtable_r[idx];<a name="line.940"></a>
<span class="sourceLineNo">941</span>                    }<a name="line.941"></a>
<span class="sourceLineNo">942</span>                    wtable_r[2 + twon] = 2;<a name="line.942"></a>
<span class="sourceLineNo">943</span>                }<a name="line.943"></a>
<span class="sourceLineNo">944</span>            } while (nl != 1);<a name="line.944"></a>
<span class="sourceLineNo">945</span>            break factorize_loop;<a name="line.945"></a>
<span class="sourceLineNo">946</span>        }<a name="line.946"></a>
<span class="sourceLineNo">947</span>        wtable_r[twon] = n;<a name="line.947"></a>
<span class="sourceLineNo">948</span>        wtable_r[1 + twon] = nf;<a name="line.948"></a>
<span class="sourceLineNo">949</span>        argh = TWO_PI / (float) (n);<a name="line.949"></a>
<span class="sourceLineNo">950</span>        is = 0;<a name="line.950"></a>
<span class="sourceLineNo">951</span>        nfm1 = nf - 1;<a name="line.951"></a>
<span class="sourceLineNo">952</span>        l1 = 1;<a name="line.952"></a>
<span class="sourceLineNo">953</span>        if (nfm1 == 0)<a name="line.953"></a>
<span class="sourceLineNo">954</span>            return;<a name="line.954"></a>
<span class="sourceLineNo">955</span>        for (k1 = 1; k1 &lt;= nfm1; k1++) {<a name="line.955"></a>
<span class="sourceLineNo">956</span>            ip = (int) wtable_r[k1 + 1 + twon];<a name="line.956"></a>
<span class="sourceLineNo">957</span>            ld = 0;<a name="line.957"></a>
<span class="sourceLineNo">958</span>            l2 = l1 * ip;<a name="line.958"></a>
<span class="sourceLineNo">959</span>            ido = n / l2;<a name="line.959"></a>
<span class="sourceLineNo">960</span>            ipm = ip - 1;<a name="line.960"></a>
<span class="sourceLineNo">961</span>            for (j = 1; j &lt;= ipm; ++j) {<a name="line.961"></a>
<span class="sourceLineNo">962</span>                ld += l1;<a name="line.962"></a>
<span class="sourceLineNo">963</span>                i = is;<a name="line.963"></a>
<span class="sourceLineNo">964</span>                argld = (float) ld * argh;<a name="line.964"></a>
<span class="sourceLineNo">965</span><a name="line.965"></a>
<span class="sourceLineNo">966</span>                fi = 0;<a name="line.966"></a>
<span class="sourceLineNo">967</span>                for (ii = 3; ii &lt;= ido; ii += 2) {<a name="line.967"></a>
<span class="sourceLineNo">968</span>                    i += 2;<a name="line.968"></a>
<span class="sourceLineNo">969</span>                    fi += 1;<a name="line.969"></a>
<span class="sourceLineNo">970</span>                    arg = fi * argld;<a name="line.970"></a>
<span class="sourceLineNo">971</span>                    int idx = i + n;<a name="line.971"></a>
<span class="sourceLineNo">972</span>                    wtable_r[idx - 2] = (float)Math.cos(arg);<a name="line.972"></a>
<span class="sourceLineNo">973</span>                    wtable_r[idx - 1] = (float)Math.sin(arg);<a name="line.973"></a>
<span class="sourceLineNo">974</span>                }<a name="line.974"></a>
<span class="sourceLineNo">975</span>                is += ido;<a name="line.975"></a>
<span class="sourceLineNo">976</span>            }<a name="line.976"></a>
<span class="sourceLineNo">977</span>            l1 = l2;<a name="line.977"></a>
<span class="sourceLineNo">978</span>        }<a name="line.978"></a>
<span class="sourceLineNo">979</span>    }<a name="line.979"></a>
<span class="sourceLineNo">980</span><a name="line.980"></a>
<span class="sourceLineNo">981</span>    private void bluesteini() {<a name="line.981"></a>
<span class="sourceLineNo">982</span>        int k = 0;<a name="line.982"></a>
<span class="sourceLineNo">983</span>        float arg;<a name="line.983"></a>
<span class="sourceLineNo">984</span>        float pi_n = PI / n;<a name="line.984"></a>
<span class="sourceLineNo">985</span>        bk1[0] = 1;<a name="line.985"></a>
<span class="sourceLineNo">986</span>        bk1[1] = 0;<a name="line.986"></a>
<span class="sourceLineNo">987</span>        for (int i = 1; i &lt; n; i++) {<a name="line.987"></a>
<span class="sourceLineNo">988</span>            k += 2 * i - 1;<a name="line.988"></a>
<span class="sourceLineNo">989</span>            if (k &gt;= 2 * n)<a name="line.989"></a>
<span class="sourceLineNo">990</span>                k -= 2 * n;<a name="line.990"></a>
<span class="sourceLineNo">991</span>            arg = pi_n * k;<a name="line.991"></a>
<span class="sourceLineNo">992</span>            bk1[2 * i] = (float)Math.cos(arg);<a name="line.992"></a>
<span class="sourceLineNo">993</span>            bk1[2 * i + 1] = (float)Math.sin(arg);<a name="line.993"></a>
<span class="sourceLineNo">994</span>        }<a name="line.994"></a>
<span class="sourceLineNo">995</span>        float scale = (float)(1.0 / nBluestein);<a name="line.995"></a>
<span class="sourceLineNo">996</span>        bk2[0] = bk1[0] * scale;<a name="line.996"></a>
<span class="sourceLineNo">997</span>        bk2[1] = bk1[1] * scale;<a name="line.997"></a>
<span class="sourceLineNo">998</span>        for (int i = 2; i &lt; 2 * n; i += 2) {<a name="line.998"></a>
<span class="sourceLineNo">999</span>            bk2[i] = bk1[i] * scale;<a name="line.999"></a>
<span class="sourceLineNo">1000</span>            bk2[i + 1] = bk1[i + 1] * scale;<a name="line.1000"></a>
<span class="sourceLineNo">1001</span>            bk2[2 * nBluestein - i] = bk2[i];<a name="line.1001"></a>
<span class="sourceLineNo">1002</span>            bk2[2 * nBluestein - i + 1] = bk2[i + 1];<a name="line.1002"></a>
<span class="sourceLineNo">1003</span>        }<a name="line.1003"></a>
<span class="sourceLineNo">1004</span>        cftbsub(2 * nBluestein, bk2, 0, ip, nw, w);<a name="line.1004"></a>
<span class="sourceLineNo">1005</span>    }<a name="line.1005"></a>
<span class="sourceLineNo">1006</span><a name="line.1006"></a>
<span class="sourceLineNo">1007</span>    private void makewt(int nw) {<a name="line.1007"></a>
<span class="sourceLineNo">1008</span>        int j, nwh, nw0, nw1;<a name="line.1008"></a>
<span class="sourceLineNo">1009</span>        float delta, wn4r, wk1r, wk1i, wk3r, wk3i;<a name="line.1009"></a>
<span class="sourceLineNo">1010</span>        float delta2, deltaj, deltaj3;<a name="line.1010"></a>
<span class="sourceLineNo">1011</span><a name="line.1011"></a>
<span class="sourceLineNo">1012</span>        ip[0] = nw;<a name="line.1012"></a>
<span class="sourceLineNo">1013</span>        ip[1] = 1;<a name="line.1013"></a>
<span class="sourceLineNo">1014</span>        if (nw &gt; 2) {<a name="line.1014"></a>
<span class="sourceLineNo">1015</span>            nwh = nw &gt;&gt; 1;<a name="line.1015"></a>
<span class="sourceLineNo">1016</span>            delta = (float)(0.785398163397448278999490867136046290 / nwh);<a name="line.1016"></a>
<span class="sourceLineNo">1017</span>            delta2 = delta * 2;<a name="line.1017"></a>
<span class="sourceLineNo">1018</span>            wn4r = (float)Math.cos(delta * nwh);<a name="line.1018"></a>
<span class="sourceLineNo">1019</span>            w[0] = 1;<a name="line.1019"></a>
<span class="sourceLineNo">1020</span>            w[1] = wn4r;<a name="line.1020"></a>
<span class="sourceLineNo">1021</span>            if (nwh == 4) {<a name="line.1021"></a>
<span class="sourceLineNo">1022</span>                w[2] = (float)Math.cos(delta2);<a name="line.1022"></a>
<span class="sourceLineNo">1023</span>                w[3] = (float)Math.sin(delta2);<a name="line.1023"></a>
<span class="sourceLineNo">1024</span>            } else if (nwh &gt; 4) {<a name="line.1024"></a>
<span class="sourceLineNo">1025</span>                makeipt(nw);<a name="line.1025"></a>
<span class="sourceLineNo">1026</span>                w[2] = (float)(0.5 / Math.cos(delta2));<a name="line.1026"></a>
<span class="sourceLineNo">1027</span>                w[3] = (float)(0.5 / Math.cos(delta * 6));<a name="line.1027"></a>
<span class="sourceLineNo">1028</span>                for (j = 4; j &lt; nwh; j += 4) {<a name="line.1028"></a>
<span class="sourceLineNo">1029</span>                    deltaj = delta * j;<a name="line.1029"></a>
<span class="sourceLineNo">1030</span>                    deltaj3 = 3 * deltaj;<a name="line.1030"></a>
<span class="sourceLineNo">1031</span>                    w[j] = (float)Math.cos(deltaj);<a name="line.1031"></a>
<span class="sourceLineNo">1032</span>                    w[j + 1] = (float)Math.sin(deltaj);<a name="line.1032"></a>
<span class="sourceLineNo">1033</span>                    w[j + 2] = (float)Math.cos(deltaj3);<a name="line.1033"></a>
<span class="sourceLineNo">1034</span>                    w[j + 3] = (float)-Math.sin(deltaj3);<a name="line.1034"></a>
<span class="sourceLineNo">1035</span>                }<a name="line.1035"></a>
<span class="sourceLineNo">1036</span>            }<a name="line.1036"></a>
<span class="sourceLineNo">1037</span>            nw0 = 0;<a name="line.1037"></a>
<span class="sourceLineNo">1038</span>            while (nwh &gt; 2) {<a name="line.1038"></a>
<span class="sourceLineNo">1039</span>                nw1 = nw0 + nwh;<a name="line.1039"></a>
<span class="sourceLineNo">1040</span>                nwh &gt;&gt;= 1;<a name="line.1040"></a>
<span class="sourceLineNo">1041</span>                w[nw1] = 1;<a name="line.1041"></a>
<span class="sourceLineNo">1042</span>                w[nw1 + 1] = wn4r;<a name="line.1042"></a>
<span class="sourceLineNo">1043</span>                if (nwh == 4) {<a name="line.1043"></a>
<span class="sourceLineNo">1044</span>                    wk1r = w[nw0 + 4];<a name="line.1044"></a>
<span class="sourceLineNo">1045</span>                    wk1i = w[nw0 + 5];<a name="line.1045"></a>
<span class="sourceLineNo">1046</span>                    w[nw1 + 2] = wk1r;<a name="line.1046"></a>
<span class="sourceLineNo">1047</span>                    w[nw1 + 3] = wk1i;<a name="line.1047"></a>
<span class="sourceLineNo">1048</span>                } else if (nwh &gt; 4) {<a name="line.1048"></a>
<span class="sourceLineNo">1049</span>                    wk1r = w[nw0 + 4];<a name="line.1049"></a>
<span class="sourceLineNo">1050</span>                    wk3r = w[nw0 + 6];<a name="line.1050"></a>
<span class="sourceLineNo">1051</span>                    w[nw1 + 2] = (float)(0.5 / wk1r);<a name="line.1051"></a>
<span class="sourceLineNo">1052</span>                    w[nw1 + 3] = (float)(0.5 / wk3r);<a name="line.1052"></a>
<span class="sourceLineNo">1053</span>                    for (j = 4; j &lt; nwh; j += 4) {<a name="line.1053"></a>
<span class="sourceLineNo">1054</span>                        int idx1 = nw0 + 2 * j;<a name="line.1054"></a>
<span class="sourceLineNo">1055</span>                        int idx2 = nw1 + j;<a name="line.1055"></a>
<span class="sourceLineNo">1056</span>                        wk1r = w[idx1];<a name="line.1056"></a>
<span class="sourceLineNo">1057</span>                        wk1i = w[idx1 + 1];<a name="line.1057"></a>
<span class="sourceLineNo">1058</span>                        wk3r = w[idx1 + 2];<a name="line.1058"></a>
<span class="sourceLineNo">1059</span>                        wk3i = w[idx1 + 3];<a name="line.1059"></a>
<span class="sourceLineNo">1060</span>                        w[idx2] = wk1r;<a name="line.1060"></a>
<span class="sourceLineNo">1061</span>                        w[idx2 + 1] = wk1i;<a name="line.1061"></a>
<span class="sourceLineNo">1062</span>                        w[idx2 + 2] = wk3r;<a name="line.1062"></a>
<span class="sourceLineNo">1063</span>                        w[idx2 + 3] = wk3i;<a name="line.1063"></a>
<span class="sourceLineNo">1064</span>                    }<a name="line.1064"></a>
<span class="sourceLineNo">1065</span>                }<a name="line.1065"></a>
<span class="sourceLineNo">1066</span>                nw0 = nw1;<a name="line.1066"></a>
<span class="sourceLineNo">1067</span>            }<a name="line.1067"></a>
<span class="sourceLineNo">1068</span>        }<a name="line.1068"></a>
<span class="sourceLineNo">1069</span>    }<a name="line.1069"></a>
<span class="sourceLineNo">1070</span><a name="line.1070"></a>
<span class="sourceLineNo">1071</span>    private void makeipt(int nw) {<a name="line.1071"></a>
<span class="sourceLineNo">1072</span>        int j, l, m, m2, p, q;<a name="line.1072"></a>
<span class="sourceLineNo">1073</span><a name="line.1073"></a>
<span class="sourceLineNo">1074</span>        ip[2] = 0;<a name="line.1074"></a>
<span class="sourceLineNo">1075</span>        ip[3] = 16;<a name="line.1075"></a>
<span class="sourceLineNo">1076</span>        m = 2;<a name="line.1076"></a>
<span class="sourceLineNo">1077</span>        for (l = nw; l &gt; 32; l &gt;&gt;= 2) {<a name="line.1077"></a>
<span class="sourceLineNo">1078</span>            m2 = m &lt;&lt; 1;<a name="line.1078"></a>
<span class="sourceLineNo">1079</span>            q = m2 &lt;&lt; 3;<a name="line.1079"></a>
<span class="sourceLineNo">1080</span>            for (j = m; j &lt; m2; j++) {<a name="line.1080"></a>
<span class="sourceLineNo">1081</span>                p = ip[j] &lt;&lt; 2;<a name="line.1081"></a>
<span class="sourceLineNo">1082</span>                ip[m + j] = p;<a name="line.1082"></a>
<span class="sourceLineNo">1083</span>                ip[m2 + j] = p + q;<a name="line.1083"></a>
<span class="sourceLineNo">1084</span>            }<a name="line.1084"></a>
<span class="sourceLineNo">1085</span>            m = m2;<a name="line.1085"></a>
<span class="sourceLineNo">1086</span>        }<a name="line.1086"></a>
<span class="sourceLineNo">1087</span>    }<a name="line.1087"></a>
<span class="sourceLineNo">1088</span><a name="line.1088"></a>
<span class="sourceLineNo">1089</span>    private void makect(int nc, float[] c, int startc) {<a name="line.1089"></a>
<span class="sourceLineNo">1090</span>        int j, nch;<a name="line.1090"></a>
<span class="sourceLineNo">1091</span>        float delta, deltaj;<a name="line.1091"></a>
<span class="sourceLineNo">1092</span><a name="line.1092"></a>
<span class="sourceLineNo">1093</span>        ip[1] = nc;<a name="line.1093"></a>
<span class="sourceLineNo">1094</span>        if (nc &gt; 1) {<a name="line.1094"></a>
<span class="sourceLineNo">1095</span>            nch = nc &gt;&gt; 1;<a name="line.1095"></a>
<span class="sourceLineNo">1096</span>            delta = (float)(0.785398163397448278999490867136046290 / nch);<a name="line.1096"></a>
<span class="sourceLineNo">1097</span>            c[startc] = (float)Math.cos(delta * nch);<a name="line.1097"></a>
<span class="sourceLineNo">1098</span>            c[startc + nch] = (float)(0.5 * c[startc]);<a name="line.1098"></a>
<span class="sourceLineNo">1099</span>            for (j = 1; j &lt; nch; j++) {<a name="line.1099"></a>
<span class="sourceLineNo">1100</span>                deltaj = delta * j;<a name="line.1100"></a>
<span class="sourceLineNo">1101</span>                c[startc + j] =  (float)(0.5 * Math.cos(deltaj));<a name="line.1101"></a>
<span class="sourceLineNo">1102</span>                c[startc + nc - j] = (float)(0.5 * Math.sin(deltaj));<a name="line.1102"></a>
<span class="sourceLineNo">1103</span>            }<a name="line.1103"></a>
<span class="sourceLineNo">1104</span>        }<a name="line.1104"></a>
<span class="sourceLineNo">1105</span>    }<a name="line.1105"></a>
<span class="sourceLineNo">1106</span><a name="line.1106"></a>
<span class="sourceLineNo">1107</span>    private void bluestein_complex(final float[] a, final int offa, final int isign) {<a name="line.1107"></a>
<span class="sourceLineNo">1108</span>        final float[] ak = new float[2 * nBluestein];<a name="line.1108"></a>
<span class="sourceLineNo">1109</span>        int nthreads = 1;<a name="line.1109"></a>
<span class="sourceLineNo">1110</span>        int threads = ConcurrencyUtils.getNumberOfThreads();<a name="line.1110"></a>
<span class="sourceLineNo">1111</span>        if ((threads &gt; 1) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_2Threads())) {<a name="line.1111"></a>
<span class="sourceLineNo">1112</span>            nthreads = 2;<a name="line.1112"></a>
<span class="sourceLineNo">1113</span>            if ((threads &gt;= 4) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_4Threads())) {<a name="line.1113"></a>
<span class="sourceLineNo">1114</span>                nthreads = 4;<a name="line.1114"></a>
<span class="sourceLineNo">1115</span>            }<a name="line.1115"></a>
<span class="sourceLineNo">1116</span>            Future&lt;?&gt;[] futures = new Future[nthreads];<a name="line.1116"></a>
<span class="sourceLineNo">1117</span>            int k = n / nthreads;<a name="line.1117"></a>
<span class="sourceLineNo">1118</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1118"></a>
<span class="sourceLineNo">1119</span>                final int firstIdx = i * k;<a name="line.1119"></a>
<span class="sourceLineNo">1120</span>                final int lastIdx = (i == (nthreads - 1)) ? n : firstIdx + k;<a name="line.1120"></a>
<span class="sourceLineNo">1121</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1121"></a>
<span class="sourceLineNo">1122</span>                    @Override<a name="line.1122"></a>
<span class="sourceLineNo">1123</span>                                        public void run() {<a name="line.1123"></a>
<span class="sourceLineNo">1124</span>                        if (isign &gt; 0) {<a name="line.1124"></a>
<span class="sourceLineNo">1125</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1125"></a>
<span class="sourceLineNo">1126</span>                                int idx1 = 2 * i;<a name="line.1126"></a>
<span class="sourceLineNo">1127</span>                                int idx2 = idx1 + 1;<a name="line.1127"></a>
<span class="sourceLineNo">1128</span>                                int idx3 = offa + idx1;<a name="line.1128"></a>
<span class="sourceLineNo">1129</span>                                int idx4 = offa + idx2;<a name="line.1129"></a>
<span class="sourceLineNo">1130</span>                                ak[idx1] = a[idx3] * bk1[idx1] - a[idx4] * bk1[idx2];<a name="line.1130"></a>
<span class="sourceLineNo">1131</span>                                ak[idx2] = a[idx3] * bk1[idx2] + a[idx4] * bk1[idx1];<a name="line.1131"></a>
<span class="sourceLineNo">1132</span>                            }<a name="line.1132"></a>
<span class="sourceLineNo">1133</span>                        } else {<a name="line.1133"></a>
<span class="sourceLineNo">1134</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1134"></a>
<span class="sourceLineNo">1135</span>                                int idx1 = 2 * i;<a name="line.1135"></a>
<span class="sourceLineNo">1136</span>                                int idx2 = idx1 + 1;<a name="line.1136"></a>
<span class="sourceLineNo">1137</span>                                int idx3 = offa + idx1;<a name="line.1137"></a>
<span class="sourceLineNo">1138</span>                                int idx4 = offa + idx2;<a name="line.1138"></a>
<span class="sourceLineNo">1139</span>                                ak[idx1] = a[idx3] * bk1[idx1] + a[idx4] * bk1[idx2];<a name="line.1139"></a>
<span class="sourceLineNo">1140</span>                                ak[idx2] = -a[idx3] * bk1[idx2] + a[idx4] * bk1[idx1];<a name="line.1140"></a>
<span class="sourceLineNo">1141</span>                            }<a name="line.1141"></a>
<span class="sourceLineNo">1142</span>                        }<a name="line.1142"></a>
<span class="sourceLineNo">1143</span>                    }<a name="line.1143"></a>
<span class="sourceLineNo">1144</span>                });<a name="line.1144"></a>
<span class="sourceLineNo">1145</span>            }<a name="line.1145"></a>
<span class="sourceLineNo">1146</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1146"></a>
<span class="sourceLineNo">1147</span><a name="line.1147"></a>
<span class="sourceLineNo">1148</span>            cftbsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1148"></a>
<span class="sourceLineNo">1149</span><a name="line.1149"></a>
<span class="sourceLineNo">1150</span>            k = nBluestein / nthreads;<a name="line.1150"></a>
<span class="sourceLineNo">1151</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1151"></a>
<span class="sourceLineNo">1152</span>                final int firstIdx = i * k;<a name="line.1152"></a>
<span class="sourceLineNo">1153</span>                final int lastIdx = (i == (nthreads - 1)) ? nBluestein : firstIdx + k;<a name="line.1153"></a>
<span class="sourceLineNo">1154</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1154"></a>
<span class="sourceLineNo">1155</span>                    @Override<a name="line.1155"></a>
<span class="sourceLineNo">1156</span>                                        public void run() {<a name="line.1156"></a>
<span class="sourceLineNo">1157</span>                        if (isign &gt; 0) {<a name="line.1157"></a>
<span class="sourceLineNo">1158</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1158"></a>
<span class="sourceLineNo">1159</span>                                int idx1 = 2 * i;<a name="line.1159"></a>
<span class="sourceLineNo">1160</span>                                int idx2 = idx1 + 1;<a name="line.1160"></a>
<span class="sourceLineNo">1161</span>                                float im = -ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1161"></a>
<span class="sourceLineNo">1162</span>                                ak[idx1] = ak[idx1] * bk2[idx1] + ak[idx2] * bk2[idx2];<a name="line.1162"></a>
<span class="sourceLineNo">1163</span>                                ak[idx2] = im;<a name="line.1163"></a>
<span class="sourceLineNo">1164</span>                            }<a name="line.1164"></a>
<span class="sourceLineNo">1165</span>                        } else {<a name="line.1165"></a>
<span class="sourceLineNo">1166</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1166"></a>
<span class="sourceLineNo">1167</span>                                int idx1 = 2 * i;<a name="line.1167"></a>
<span class="sourceLineNo">1168</span>                                int idx2 = idx1 + 1;<a name="line.1168"></a>
<span class="sourceLineNo">1169</span>                                float im = ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1169"></a>
<span class="sourceLineNo">1170</span>                                ak[idx1] = ak[idx1] * bk2[idx1] - ak[idx2] * bk2[idx2];<a name="line.1170"></a>
<span class="sourceLineNo">1171</span>                                ak[idx2] = im;<a name="line.1171"></a>
<span class="sourceLineNo">1172</span>                            }<a name="line.1172"></a>
<span class="sourceLineNo">1173</span>                        }<a name="line.1173"></a>
<span class="sourceLineNo">1174</span>                    }<a name="line.1174"></a>
<span class="sourceLineNo">1175</span>                });<a name="line.1175"></a>
<span class="sourceLineNo">1176</span>            }<a name="line.1176"></a>
<span class="sourceLineNo">1177</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1177"></a>
<span class="sourceLineNo">1178</span><a name="line.1178"></a>
<span class="sourceLineNo">1179</span>            cftfsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1179"></a>
<span class="sourceLineNo">1180</span><a name="line.1180"></a>
<span class="sourceLineNo">1181</span>            k = n / nthreads;<a name="line.1181"></a>
<span class="sourceLineNo">1182</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1182"></a>
<span class="sourceLineNo">1183</span>                final int firstIdx = i * k;<a name="line.1183"></a>
<span class="sourceLineNo">1184</span>                final int lastIdx = (i == (nthreads - 1)) ? n : firstIdx + k;<a name="line.1184"></a>
<span class="sourceLineNo">1185</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1185"></a>
<span class="sourceLineNo">1186</span>                    @Override<a name="line.1186"></a>
<span class="sourceLineNo">1187</span>                                        public void run() {<a name="line.1187"></a>
<span class="sourceLineNo">1188</span>                        if (isign &gt; 0) {<a name="line.1188"></a>
<span class="sourceLineNo">1189</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1189"></a>
<span class="sourceLineNo">1190</span>                                int idx1 = 2 * i;<a name="line.1190"></a>
<span class="sourceLineNo">1191</span>                                int idx2 = idx1 + 1;<a name="line.1191"></a>
<span class="sourceLineNo">1192</span>                                int idx3 = offa + idx1;<a name="line.1192"></a>
<span class="sourceLineNo">1193</span>                                int idx4 = offa + idx2;<a name="line.1193"></a>
<span class="sourceLineNo">1194</span>                                a[idx3] = bk1[idx1] * ak[idx1] - bk1[idx2] * ak[idx2];<a name="line.1194"></a>
<span class="sourceLineNo">1195</span>                                a[idx4] = bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1195"></a>
<span class="sourceLineNo">1196</span>                            }<a name="line.1196"></a>
<span class="sourceLineNo">1197</span>                        } else {<a name="line.1197"></a>
<span class="sourceLineNo">1198</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1198"></a>
<span class="sourceLineNo">1199</span>                                int idx1 = 2 * i;<a name="line.1199"></a>
<span class="sourceLineNo">1200</span>                                int idx2 = idx1 + 1;<a name="line.1200"></a>
<span class="sourceLineNo">1201</span>                                int idx3 = offa + idx1;<a name="line.1201"></a>
<span class="sourceLineNo">1202</span>                                int idx4 = offa + idx2;<a name="line.1202"></a>
<span class="sourceLineNo">1203</span>                                a[idx3] = bk1[idx1] * ak[idx1] + bk1[idx2] * ak[idx2];<a name="line.1203"></a>
<span class="sourceLineNo">1204</span>                                a[idx4] = -bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1204"></a>
<span class="sourceLineNo">1205</span>                            }<a name="line.1205"></a>
<span class="sourceLineNo">1206</span>                        }<a name="line.1206"></a>
<span class="sourceLineNo">1207</span>                    }<a name="line.1207"></a>
<span class="sourceLineNo">1208</span>                });<a name="line.1208"></a>
<span class="sourceLineNo">1209</span>            }<a name="line.1209"></a>
<span class="sourceLineNo">1210</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1210"></a>
<span class="sourceLineNo">1211</span>        } else {<a name="line.1211"></a>
<span class="sourceLineNo">1212</span>            if (isign &gt; 0) {<a name="line.1212"></a>
<span class="sourceLineNo">1213</span>                for (int i = 0; i &lt; n; i++) {<a name="line.1213"></a>
<span class="sourceLineNo">1214</span>                    int idx1 = 2 * i;<a name="line.1214"></a>
<span class="sourceLineNo">1215</span>                    int idx2 = idx1 + 1;<a name="line.1215"></a>
<span class="sourceLineNo">1216</span>                    int idx3 = offa + idx1;<a name="line.1216"></a>
<span class="sourceLineNo">1217</span>                    int idx4 = offa + idx2;<a name="line.1217"></a>
<span class="sourceLineNo">1218</span>                    ak[idx1] = a[idx3] * bk1[idx1] - a[idx4] * bk1[idx2];<a name="line.1218"></a>
<span class="sourceLineNo">1219</span>                    ak[idx2] = a[idx3] * bk1[idx2] + a[idx4] * bk1[idx1];<a name="line.1219"></a>
<span class="sourceLineNo">1220</span>                }<a name="line.1220"></a>
<span class="sourceLineNo">1221</span>            } else {<a name="line.1221"></a>
<span class="sourceLineNo">1222</span>                for (int i = 0; i &lt; n; i++) {<a name="line.1222"></a>
<span class="sourceLineNo">1223</span>                    int idx1 = 2 * i;<a name="line.1223"></a>
<span class="sourceLineNo">1224</span>                    int idx2 = idx1 + 1;<a name="line.1224"></a>
<span class="sourceLineNo">1225</span>                    int idx3 = offa + idx1;<a name="line.1225"></a>
<span class="sourceLineNo">1226</span>                    int idx4 = offa + idx2;<a name="line.1226"></a>
<span class="sourceLineNo">1227</span>                    ak[idx1] = a[idx3] * bk1[idx1] + a[idx4] * bk1[idx2];<a name="line.1227"></a>
<span class="sourceLineNo">1228</span>                    ak[idx2] = -a[idx3] * bk1[idx2] + a[idx4] * bk1[idx1];<a name="line.1228"></a>
<span class="sourceLineNo">1229</span>                }<a name="line.1229"></a>
<span class="sourceLineNo">1230</span>            }<a name="line.1230"></a>
<span class="sourceLineNo">1231</span><a name="line.1231"></a>
<span class="sourceLineNo">1232</span>            cftbsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1232"></a>
<span class="sourceLineNo">1233</span><a name="line.1233"></a>
<span class="sourceLineNo">1234</span>            if (isign &gt; 0) {<a name="line.1234"></a>
<span class="sourceLineNo">1235</span>                for (int i = 0; i &lt; nBluestein; i++) {<a name="line.1235"></a>
<span class="sourceLineNo">1236</span>                    int idx1 = 2 * i;<a name="line.1236"></a>
<span class="sourceLineNo">1237</span>                    int idx2 = idx1 + 1;<a name="line.1237"></a>
<span class="sourceLineNo">1238</span>                    float im = -ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1238"></a>
<span class="sourceLineNo">1239</span>                    ak[idx1] = ak[idx1] * bk2[idx1] + ak[idx2] * bk2[idx2];<a name="line.1239"></a>
<span class="sourceLineNo">1240</span>                    ak[idx2] = im;<a name="line.1240"></a>
<span class="sourceLineNo">1241</span>                }<a name="line.1241"></a>
<span class="sourceLineNo">1242</span>            } else {<a name="line.1242"></a>
<span class="sourceLineNo">1243</span>                for (int i = 0; i &lt; nBluestein; i++) {<a name="line.1243"></a>
<span class="sourceLineNo">1244</span>                    int idx1 = 2 * i;<a name="line.1244"></a>
<span class="sourceLineNo">1245</span>                    int idx2 = idx1 + 1;<a name="line.1245"></a>
<span class="sourceLineNo">1246</span>                    float im = ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1246"></a>
<span class="sourceLineNo">1247</span>                    ak[idx1] = ak[idx1] * bk2[idx1] - ak[idx2] * bk2[idx2];<a name="line.1247"></a>
<span class="sourceLineNo">1248</span>                    ak[idx2] = im;<a name="line.1248"></a>
<span class="sourceLineNo">1249</span>                }<a name="line.1249"></a>
<span class="sourceLineNo">1250</span>            }<a name="line.1250"></a>
<span class="sourceLineNo">1251</span><a name="line.1251"></a>
<span class="sourceLineNo">1252</span>            cftfsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1252"></a>
<span class="sourceLineNo">1253</span>            if (isign &gt; 0) {<a name="line.1253"></a>
<span class="sourceLineNo">1254</span>                for (int i = 0; i &lt; n; i++) {<a name="line.1254"></a>
<span class="sourceLineNo">1255</span>                    int idx1 = 2 * i;<a name="line.1255"></a>
<span class="sourceLineNo">1256</span>                    int idx2 = idx1 + 1;<a name="line.1256"></a>
<span class="sourceLineNo">1257</span>                    int idx3 = offa + idx1;<a name="line.1257"></a>
<span class="sourceLineNo">1258</span>                    int idx4 = offa + idx2;<a name="line.1258"></a>
<span class="sourceLineNo">1259</span>                    a[idx3] = bk1[idx1] * ak[idx1] - bk1[idx2] * ak[idx2];<a name="line.1259"></a>
<span class="sourceLineNo">1260</span>                    a[idx4] = bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1260"></a>
<span class="sourceLineNo">1261</span>                }<a name="line.1261"></a>
<span class="sourceLineNo">1262</span>            } else {<a name="line.1262"></a>
<span class="sourceLineNo">1263</span>                for (int i = 0; i &lt; n; i++) {<a name="line.1263"></a>
<span class="sourceLineNo">1264</span>                    int idx1 = 2 * i;<a name="line.1264"></a>
<span class="sourceLineNo">1265</span>                    int idx2 = idx1 + 1;<a name="line.1265"></a>
<span class="sourceLineNo">1266</span>                    int idx3 = offa + idx1;<a name="line.1266"></a>
<span class="sourceLineNo">1267</span>                    int idx4 = offa + idx2;<a name="line.1267"></a>
<span class="sourceLineNo">1268</span>                    a[idx3] = bk1[idx1] * ak[idx1] + bk1[idx2] * ak[idx2];<a name="line.1268"></a>
<span class="sourceLineNo">1269</span>                    a[idx4] = -bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1269"></a>
<span class="sourceLineNo">1270</span>                }<a name="line.1270"></a>
<span class="sourceLineNo">1271</span>            }<a name="line.1271"></a>
<span class="sourceLineNo">1272</span>        }<a name="line.1272"></a>
<span class="sourceLineNo">1273</span>    }<a name="line.1273"></a>
<span class="sourceLineNo">1274</span><a name="line.1274"></a>
<span class="sourceLineNo">1275</span>    private void bluestein_real_full(final float[] a, final int offa, final int isign) {<a name="line.1275"></a>
<span class="sourceLineNo">1276</span>        final float[] ak = new float[2 * nBluestein];<a name="line.1276"></a>
<span class="sourceLineNo">1277</span>        int nthreads = 1;<a name="line.1277"></a>
<span class="sourceLineNo">1278</span>        int threads = ConcurrencyUtils.getNumberOfThreads();<a name="line.1278"></a>
<span class="sourceLineNo">1279</span>        if ((threads &gt; 1) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_2Threads())) {<a name="line.1279"></a>
<span class="sourceLineNo">1280</span>            nthreads = 2;<a name="line.1280"></a>
<span class="sourceLineNo">1281</span>            if ((threads &gt;= 4) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_4Threads())) {<a name="line.1281"></a>
<span class="sourceLineNo">1282</span>                nthreads = 4;<a name="line.1282"></a>
<span class="sourceLineNo">1283</span>            }<a name="line.1283"></a>
<span class="sourceLineNo">1284</span>            Future&lt;?&gt;[] futures = new Future[nthreads];<a name="line.1284"></a>
<span class="sourceLineNo">1285</span>            int k = n / nthreads;<a name="line.1285"></a>
<span class="sourceLineNo">1286</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1286"></a>
<span class="sourceLineNo">1287</span>                final int firstIdx = i * k;<a name="line.1287"></a>
<span class="sourceLineNo">1288</span>                final int lastIdx = (i == (nthreads - 1)) ? n : firstIdx + k;<a name="line.1288"></a>
<span class="sourceLineNo">1289</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1289"></a>
<span class="sourceLineNo">1290</span>                    @Override<a name="line.1290"></a>
<span class="sourceLineNo">1291</span>                                        public void run() {<a name="line.1291"></a>
<span class="sourceLineNo">1292</span>                        if (isign &gt; 0) {<a name="line.1292"></a>
<span class="sourceLineNo">1293</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1293"></a>
<span class="sourceLineNo">1294</span>                                int idx1 = 2 * i;<a name="line.1294"></a>
<span class="sourceLineNo">1295</span>                                int idx2 = idx1 + 1;<a name="line.1295"></a>
<span class="sourceLineNo">1296</span>                                int idx3 = offa + i;<a name="line.1296"></a>
<span class="sourceLineNo">1297</span>                                ak[idx1] = a[idx3] * bk1[idx1];<a name="line.1297"></a>
<span class="sourceLineNo">1298</span>                                ak[idx2] = a[idx3] * bk1[idx2];<a name="line.1298"></a>
<span class="sourceLineNo">1299</span>                            }<a name="line.1299"></a>
<span class="sourceLineNo">1300</span>                        } else {<a name="line.1300"></a>
<span class="sourceLineNo">1301</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1301"></a>
<span class="sourceLineNo">1302</span>                                int idx1 = 2 * i;<a name="line.1302"></a>
<span class="sourceLineNo">1303</span>                                int idx2 = idx1 + 1;<a name="line.1303"></a>
<span class="sourceLineNo">1304</span>                                int idx3 = offa + i;<a name="line.1304"></a>
<span class="sourceLineNo">1305</span>                                ak[idx1] = a[idx3] * bk1[idx1];<a name="line.1305"></a>
<span class="sourceLineNo">1306</span>                                ak[idx2] = -a[idx3] * bk1[idx2];<a name="line.1306"></a>
<span class="sourceLineNo">1307</span>                            }<a name="line.1307"></a>
<span class="sourceLineNo">1308</span>                        }<a name="line.1308"></a>
<span class="sourceLineNo">1309</span>                    }<a name="line.1309"></a>
<span class="sourceLineNo">1310</span>                });<a name="line.1310"></a>
<span class="sourceLineNo">1311</span>            }<a name="line.1311"></a>
<span class="sourceLineNo">1312</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1312"></a>
<span class="sourceLineNo">1313</span><a name="line.1313"></a>
<span class="sourceLineNo">1314</span>            cftbsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1314"></a>
<span class="sourceLineNo">1315</span><a name="line.1315"></a>
<span class="sourceLineNo">1316</span>            k = nBluestein / nthreads;<a name="line.1316"></a>
<span class="sourceLineNo">1317</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1317"></a>
<span class="sourceLineNo">1318</span>                final int firstIdx = i * k;<a name="line.1318"></a>
<span class="sourceLineNo">1319</span>                final int lastIdx = (i == (nthreads - 1)) ? nBluestein : firstIdx + k;<a name="line.1319"></a>
<span class="sourceLineNo">1320</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1320"></a>
<span class="sourceLineNo">1321</span>                    @Override<a name="line.1321"></a>
<span class="sourceLineNo">1322</span>                                        public void run() {<a name="line.1322"></a>
<span class="sourceLineNo">1323</span>                        if (isign &gt; 0) {<a name="line.1323"></a>
<span class="sourceLineNo">1324</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1324"></a>
<span class="sourceLineNo">1325</span>                                int idx1 = 2 * i;<a name="line.1325"></a>
<span class="sourceLineNo">1326</span>                                int idx2 = idx1 + 1;<a name="line.1326"></a>
<span class="sourceLineNo">1327</span>                                float im = -ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1327"></a>
<span class="sourceLineNo">1328</span>                                ak[idx1] = ak[idx1] * bk2[idx1] + ak[idx2] * bk2[idx2];<a name="line.1328"></a>
<span class="sourceLineNo">1329</span>                                ak[idx2] = im;<a name="line.1329"></a>
<span class="sourceLineNo">1330</span>                            }<a name="line.1330"></a>
<span class="sourceLineNo">1331</span>                        } else {<a name="line.1331"></a>
<span class="sourceLineNo">1332</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1332"></a>
<span class="sourceLineNo">1333</span>                                int idx1 = 2 * i;<a name="line.1333"></a>
<span class="sourceLineNo">1334</span>                                int idx2 = idx1 + 1;<a name="line.1334"></a>
<span class="sourceLineNo">1335</span>                                float im = ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1335"></a>
<span class="sourceLineNo">1336</span>                                ak[idx1] = ak[idx1] * bk2[idx1] - ak[idx2] * bk2[idx2];<a name="line.1336"></a>
<span class="sourceLineNo">1337</span>                                ak[idx2] = im;<a name="line.1337"></a>
<span class="sourceLineNo">1338</span>                            }<a name="line.1338"></a>
<span class="sourceLineNo">1339</span>                        }<a name="line.1339"></a>
<span class="sourceLineNo">1340</span>                    }<a name="line.1340"></a>
<span class="sourceLineNo">1341</span>                });<a name="line.1341"></a>
<span class="sourceLineNo">1342</span>            }<a name="line.1342"></a>
<span class="sourceLineNo">1343</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1343"></a>
<span class="sourceLineNo">1344</span><a name="line.1344"></a>
<span class="sourceLineNo">1345</span>            cftfsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1345"></a>
<span class="sourceLineNo">1346</span><a name="line.1346"></a>
<span class="sourceLineNo">1347</span>            k = n / nthreads;<a name="line.1347"></a>
<span class="sourceLineNo">1348</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1348"></a>
<span class="sourceLineNo">1349</span>                final int firstIdx = i * k;<a name="line.1349"></a>
<span class="sourceLineNo">1350</span>                final int lastIdx = (i == (nthreads - 1)) ? n : firstIdx + k;<a name="line.1350"></a>
<span class="sourceLineNo">1351</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1351"></a>
<span class="sourceLineNo">1352</span>                    @Override<a name="line.1352"></a>
<span class="sourceLineNo">1353</span>                                        public void run() {<a name="line.1353"></a>
<span class="sourceLineNo">1354</span>                        if (isign &gt; 0) {<a name="line.1354"></a>
<span class="sourceLineNo">1355</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1355"></a>
<span class="sourceLineNo">1356</span>                                int idx1 = 2 * i;<a name="line.1356"></a>
<span class="sourceLineNo">1357</span>                                int idx2 = idx1 + 1;<a name="line.1357"></a>
<span class="sourceLineNo">1358</span>                                a[offa + idx1] = bk1[idx1] * ak[idx1] - bk1[idx2] * ak[idx2];<a name="line.1358"></a>
<span class="sourceLineNo">1359</span>                                a[offa + idx2] = bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1359"></a>
<span class="sourceLineNo">1360</span>                            }<a name="line.1360"></a>
<span class="sourceLineNo">1361</span>                        } else {<a name="line.1361"></a>
<span class="sourceLineNo">1362</span>                            for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1362"></a>
<span class="sourceLineNo">1363</span>                                int idx1 = 2 * i;<a name="line.1363"></a>
<span class="sourceLineNo">1364</span>                                int idx2 = idx1 + 1;<a name="line.1364"></a>
<span class="sourceLineNo">1365</span>                                a[offa + idx1] = bk1[idx1] * ak[idx1] + bk1[idx2] * ak[idx2];<a name="line.1365"></a>
<span class="sourceLineNo">1366</span>                                a[offa + idx2] = -bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1366"></a>
<span class="sourceLineNo">1367</span>                            }<a name="line.1367"></a>
<span class="sourceLineNo">1368</span>                        }<a name="line.1368"></a>
<span class="sourceLineNo">1369</span>                    }<a name="line.1369"></a>
<span class="sourceLineNo">1370</span>                });<a name="line.1370"></a>
<span class="sourceLineNo">1371</span>            }<a name="line.1371"></a>
<span class="sourceLineNo">1372</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1372"></a>
<span class="sourceLineNo">1373</span>        } else {<a name="line.1373"></a>
<span class="sourceLineNo">1374</span>            if (isign &gt; 0) {<a name="line.1374"></a>
<span class="sourceLineNo">1375</span>                for (int i = 0; i &lt; n; i++) {<a name="line.1375"></a>
<span class="sourceLineNo">1376</span>                    int idx1 = 2 * i;<a name="line.1376"></a>
<span class="sourceLineNo">1377</span>                    int idx2 = idx1 + 1;<a name="line.1377"></a>
<span class="sourceLineNo">1378</span>                    int idx3 = offa + i;<a name="line.1378"></a>
<span class="sourceLineNo">1379</span>                    ak[idx1] = a[idx3] * bk1[idx1];<a name="line.1379"></a>
<span class="sourceLineNo">1380</span>                    ak[idx2] = a[idx3] * bk1[idx2];<a name="line.1380"></a>
<span class="sourceLineNo">1381</span>                }<a name="line.1381"></a>
<span class="sourceLineNo">1382</span>            } else {<a name="line.1382"></a>
<span class="sourceLineNo">1383</span>                for (int i = 0; i &lt; n; i++) {<a name="line.1383"></a>
<span class="sourceLineNo">1384</span>                    int idx1 = 2 * i;<a name="line.1384"></a>
<span class="sourceLineNo">1385</span>                    int idx2 = idx1 + 1;<a name="line.1385"></a>
<span class="sourceLineNo">1386</span>                    int idx3 = offa + i;<a name="line.1386"></a>
<span class="sourceLineNo">1387</span>                    ak[idx1] = a[idx3] * bk1[idx1];<a name="line.1387"></a>
<span class="sourceLineNo">1388</span>                    ak[idx2] = -a[idx3] * bk1[idx2];<a name="line.1388"></a>
<span class="sourceLineNo">1389</span>                }<a name="line.1389"></a>
<span class="sourceLineNo">1390</span>            }<a name="line.1390"></a>
<span class="sourceLineNo">1391</span><a name="line.1391"></a>
<span class="sourceLineNo">1392</span>            cftbsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1392"></a>
<span class="sourceLineNo">1393</span><a name="line.1393"></a>
<span class="sourceLineNo">1394</span>            if (isign &gt; 0) {<a name="line.1394"></a>
<span class="sourceLineNo">1395</span>                for (int i = 0; i &lt; nBluestein; i++) {<a name="line.1395"></a>
<span class="sourceLineNo">1396</span>                    int idx1 = 2 * i;<a name="line.1396"></a>
<span class="sourceLineNo">1397</span>                    int idx2 = idx1 + 1;<a name="line.1397"></a>
<span class="sourceLineNo">1398</span>                    float im = -ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1398"></a>
<span class="sourceLineNo">1399</span>                    ak[idx1] = ak[idx1] * bk2[idx1] + ak[idx2] * bk2[idx2];<a name="line.1399"></a>
<span class="sourceLineNo">1400</span>                    ak[idx2] = im;<a name="line.1400"></a>
<span class="sourceLineNo">1401</span>                }<a name="line.1401"></a>
<span class="sourceLineNo">1402</span>            } else {<a name="line.1402"></a>
<span class="sourceLineNo">1403</span>                for (int i = 0; i &lt; nBluestein; i++) {<a name="line.1403"></a>
<span class="sourceLineNo">1404</span>                    int idx1 = 2 * i;<a name="line.1404"></a>
<span class="sourceLineNo">1405</span>                    int idx2 = idx1 + 1;<a name="line.1405"></a>
<span class="sourceLineNo">1406</span>                    float im = ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1406"></a>
<span class="sourceLineNo">1407</span>                    ak[idx1] = ak[idx1] * bk2[idx1] - ak[idx2] * bk2[idx2];<a name="line.1407"></a>
<span class="sourceLineNo">1408</span>                    ak[idx2] = im;<a name="line.1408"></a>
<span class="sourceLineNo">1409</span>                }<a name="line.1409"></a>
<span class="sourceLineNo">1410</span>            }<a name="line.1410"></a>
<span class="sourceLineNo">1411</span><a name="line.1411"></a>
<span class="sourceLineNo">1412</span>            cftfsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1412"></a>
<span class="sourceLineNo">1413</span><a name="line.1413"></a>
<span class="sourceLineNo">1414</span>            if (isign &gt; 0) {<a name="line.1414"></a>
<span class="sourceLineNo">1415</span>                for (int i = 0; i &lt; n; i++) {<a name="line.1415"></a>
<span class="sourceLineNo">1416</span>                    int idx1 = 2 * i;<a name="line.1416"></a>
<span class="sourceLineNo">1417</span>                    int idx2 = idx1 + 1;<a name="line.1417"></a>
<span class="sourceLineNo">1418</span>                    a[offa + idx1] = bk1[idx1] * ak[idx1] - bk1[idx2] * ak[idx2];<a name="line.1418"></a>
<span class="sourceLineNo">1419</span>                    a[offa + idx2] = bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1419"></a>
<span class="sourceLineNo">1420</span>                }<a name="line.1420"></a>
<span class="sourceLineNo">1421</span>            } else {<a name="line.1421"></a>
<span class="sourceLineNo">1422</span>                for (int i = 0; i &lt; n; i++) {<a name="line.1422"></a>
<span class="sourceLineNo">1423</span>                    int idx1 = 2 * i;<a name="line.1423"></a>
<span class="sourceLineNo">1424</span>                    int idx2 = idx1 + 1;<a name="line.1424"></a>
<span class="sourceLineNo">1425</span>                    a[offa + idx1] = bk1[idx1] * ak[idx1] + bk1[idx2] * ak[idx2];<a name="line.1425"></a>
<span class="sourceLineNo">1426</span>                    a[offa + idx2] = -bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1426"></a>
<span class="sourceLineNo">1427</span>                }<a name="line.1427"></a>
<span class="sourceLineNo">1428</span>            }<a name="line.1428"></a>
<span class="sourceLineNo">1429</span>        }<a name="line.1429"></a>
<span class="sourceLineNo">1430</span>    }<a name="line.1430"></a>
<span class="sourceLineNo">1431</span><a name="line.1431"></a>
<span class="sourceLineNo">1432</span>    private void bluestein_real_forward(final float[] a, final int offa) {<a name="line.1432"></a>
<span class="sourceLineNo">1433</span>        final float[] ak = new float[2 * nBluestein];<a name="line.1433"></a>
<span class="sourceLineNo">1434</span>        int nthreads = 1;<a name="line.1434"></a>
<span class="sourceLineNo">1435</span>        int threads = ConcurrencyUtils.getNumberOfThreads();<a name="line.1435"></a>
<span class="sourceLineNo">1436</span>        if ((threads &gt; 1) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_2Threads())) {<a name="line.1436"></a>
<span class="sourceLineNo">1437</span>            nthreads = 2;<a name="line.1437"></a>
<span class="sourceLineNo">1438</span>            if ((threads &gt;= 4) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_4Threads())) {<a name="line.1438"></a>
<span class="sourceLineNo">1439</span>                nthreads = 4;<a name="line.1439"></a>
<span class="sourceLineNo">1440</span>            }<a name="line.1440"></a>
<span class="sourceLineNo">1441</span>            Future&lt;?&gt;[] futures = new Future[nthreads];<a name="line.1441"></a>
<span class="sourceLineNo">1442</span>            int k = n / nthreads;<a name="line.1442"></a>
<span class="sourceLineNo">1443</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1443"></a>
<span class="sourceLineNo">1444</span>                final int firstIdx = i * k;<a name="line.1444"></a>
<span class="sourceLineNo">1445</span>                final int lastIdx = (i == (nthreads - 1)) ? n : firstIdx + k;<a name="line.1445"></a>
<span class="sourceLineNo">1446</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1446"></a>
<span class="sourceLineNo">1447</span>                    @Override<a name="line.1447"></a>
<span class="sourceLineNo">1448</span>                                        public void run() {<a name="line.1448"></a>
<span class="sourceLineNo">1449</span>                        for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1449"></a>
<span class="sourceLineNo">1450</span>                            int idx1 = 2 * i;<a name="line.1450"></a>
<span class="sourceLineNo">1451</span>                            int idx2 = idx1 + 1;<a name="line.1451"></a>
<span class="sourceLineNo">1452</span>                            int idx3 = offa + i;<a name="line.1452"></a>
<span class="sourceLineNo">1453</span>                            ak[idx1] = a[idx3] * bk1[idx1];<a name="line.1453"></a>
<span class="sourceLineNo">1454</span>                            ak[idx2] = -a[idx3] * bk1[idx2];<a name="line.1454"></a>
<span class="sourceLineNo">1455</span>                        }<a name="line.1455"></a>
<span class="sourceLineNo">1456</span>                    }<a name="line.1456"></a>
<span class="sourceLineNo">1457</span>                });<a name="line.1457"></a>
<span class="sourceLineNo">1458</span>            }<a name="line.1458"></a>
<span class="sourceLineNo">1459</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1459"></a>
<span class="sourceLineNo">1460</span><a name="line.1460"></a>
<span class="sourceLineNo">1461</span>            cftbsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1461"></a>
<span class="sourceLineNo">1462</span><a name="line.1462"></a>
<span class="sourceLineNo">1463</span>            k = nBluestein / nthreads;<a name="line.1463"></a>
<span class="sourceLineNo">1464</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1464"></a>
<span class="sourceLineNo">1465</span>                final int firstIdx = i * k;<a name="line.1465"></a>
<span class="sourceLineNo">1466</span>                final int lastIdx = (i == (nthreads - 1)) ? nBluestein : firstIdx + k;<a name="line.1466"></a>
<span class="sourceLineNo">1467</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1467"></a>
<span class="sourceLineNo">1468</span>                    @Override<a name="line.1468"></a>
<span class="sourceLineNo">1469</span>                                        public void run() {<a name="line.1469"></a>
<span class="sourceLineNo">1470</span>                        for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1470"></a>
<span class="sourceLineNo">1471</span>                            int idx1 = 2 * i;<a name="line.1471"></a>
<span class="sourceLineNo">1472</span>                            int idx2 = idx1 + 1;<a name="line.1472"></a>
<span class="sourceLineNo">1473</span>                            float im = ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1473"></a>
<span class="sourceLineNo">1474</span>                            ak[idx1] = ak[idx1] * bk2[idx1] - ak[idx2] * bk2[idx2];<a name="line.1474"></a>
<span class="sourceLineNo">1475</span>                            ak[idx2] = im;<a name="line.1475"></a>
<span class="sourceLineNo">1476</span>                        }<a name="line.1476"></a>
<span class="sourceLineNo">1477</span>                    }<a name="line.1477"></a>
<span class="sourceLineNo">1478</span>                });<a name="line.1478"></a>
<span class="sourceLineNo">1479</span>            }<a name="line.1479"></a>
<span class="sourceLineNo">1480</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1480"></a>
<span class="sourceLineNo">1481</span><a name="line.1481"></a>
<span class="sourceLineNo">1482</span>        } else {<a name="line.1482"></a>
<span class="sourceLineNo">1483</span><a name="line.1483"></a>
<span class="sourceLineNo">1484</span>            for (int i = 0; i &lt; n; i++) {<a name="line.1484"></a>
<span class="sourceLineNo">1485</span>                int idx1 = 2 * i;<a name="line.1485"></a>
<span class="sourceLineNo">1486</span>                int idx2 = idx1 + 1;<a name="line.1486"></a>
<span class="sourceLineNo">1487</span>                int idx3 = offa + i;<a name="line.1487"></a>
<span class="sourceLineNo">1488</span>                ak[idx1] = a[idx3] * bk1[idx1];<a name="line.1488"></a>
<span class="sourceLineNo">1489</span>                ak[idx2] = -a[idx3] * bk1[idx2];<a name="line.1489"></a>
<span class="sourceLineNo">1490</span>            }<a name="line.1490"></a>
<span class="sourceLineNo">1491</span><a name="line.1491"></a>
<span class="sourceLineNo">1492</span>            cftbsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1492"></a>
<span class="sourceLineNo">1493</span><a name="line.1493"></a>
<span class="sourceLineNo">1494</span>            for (int i = 0; i &lt; nBluestein; i++) {<a name="line.1494"></a>
<span class="sourceLineNo">1495</span>                int idx1 = 2 * i;<a name="line.1495"></a>
<span class="sourceLineNo">1496</span>                int idx2 = idx1 + 1;<a name="line.1496"></a>
<span class="sourceLineNo">1497</span>                float im = ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1497"></a>
<span class="sourceLineNo">1498</span>                ak[idx1] = ak[idx1] * bk2[idx1] - ak[idx2] * bk2[idx2];<a name="line.1498"></a>
<span class="sourceLineNo">1499</span>                ak[idx2] = im;<a name="line.1499"></a>
<span class="sourceLineNo">1500</span>            }<a name="line.1500"></a>
<span class="sourceLineNo">1501</span>        }<a name="line.1501"></a>
<span class="sourceLineNo">1502</span><a name="line.1502"></a>
<span class="sourceLineNo">1503</span>        cftfsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1503"></a>
<span class="sourceLineNo">1504</span><a name="line.1504"></a>
<span class="sourceLineNo">1505</span>        if (n % 2 == 0) {<a name="line.1505"></a>
<span class="sourceLineNo">1506</span>            a[offa] = bk1[0] * ak[0] + bk1[1] * ak[1];<a name="line.1506"></a>
<span class="sourceLineNo">1507</span>            a[offa + 1] = bk1[n] * ak[n] + bk1[n + 1] * ak[n + 1];<a name="line.1507"></a>
<span class="sourceLineNo">1508</span>            for (int i = 1; i &lt; n / 2; i++) {<a name="line.1508"></a>
<span class="sourceLineNo">1509</span>                int idx1 = 2 * i;<a name="line.1509"></a>
<span class="sourceLineNo">1510</span>                int idx2 = idx1 + 1;<a name="line.1510"></a>
<span class="sourceLineNo">1511</span>                a[offa + idx1] = bk1[idx1] * ak[idx1] + bk1[idx2] * ak[idx2];<a name="line.1511"></a>
<span class="sourceLineNo">1512</span>                a[offa + idx2] = -bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1512"></a>
<span class="sourceLineNo">1513</span>            }<a name="line.1513"></a>
<span class="sourceLineNo">1514</span>        } else {<a name="line.1514"></a>
<span class="sourceLineNo">1515</span>            a[offa] = bk1[0] * ak[0] + bk1[1] * ak[1];<a name="line.1515"></a>
<span class="sourceLineNo">1516</span>            a[offa + 1] = -bk1[n] * ak[n - 1] + bk1[n - 1] * ak[n];<a name="line.1516"></a>
<span class="sourceLineNo">1517</span>            for (int i = 1; i &lt; (n - 1) / 2; i++) {<a name="line.1517"></a>
<span class="sourceLineNo">1518</span>                int idx1 = 2 * i;<a name="line.1518"></a>
<span class="sourceLineNo">1519</span>                int idx2 = idx1 + 1;<a name="line.1519"></a>
<span class="sourceLineNo">1520</span>                a[offa + idx1] = bk1[idx1] * ak[idx1] + bk1[idx2] * ak[idx2];<a name="line.1520"></a>
<span class="sourceLineNo">1521</span>                a[offa + idx2] = -bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1521"></a>
<span class="sourceLineNo">1522</span>            }<a name="line.1522"></a>
<span class="sourceLineNo">1523</span>            a[offa + n - 1] = bk1[n - 1] * ak[n - 1] + bk1[n] * ak[n];<a name="line.1523"></a>
<span class="sourceLineNo">1524</span>        }<a name="line.1524"></a>
<span class="sourceLineNo">1525</span><a name="line.1525"></a>
<span class="sourceLineNo">1526</span>    }<a name="line.1526"></a>
<span class="sourceLineNo">1527</span><a name="line.1527"></a>
<span class="sourceLineNo">1528</span>    private void bluestein_real_inverse(final float[] a, final int offa) {<a name="line.1528"></a>
<span class="sourceLineNo">1529</span>        final float[] ak = new float[2 * nBluestein];<a name="line.1529"></a>
<span class="sourceLineNo">1530</span>        if (n % 2 == 0) {<a name="line.1530"></a>
<span class="sourceLineNo">1531</span>            ak[0] = a[offa] * bk1[0];<a name="line.1531"></a>
<span class="sourceLineNo">1532</span>            ak[1] = a[offa] * bk1[1];<a name="line.1532"></a>
<span class="sourceLineNo">1533</span><a name="line.1533"></a>
<span class="sourceLineNo">1534</span>            for (int i = 1; i &lt; n / 2; i++) {<a name="line.1534"></a>
<span class="sourceLineNo">1535</span>                int idx1 = 2 * i;<a name="line.1535"></a>
<span class="sourceLineNo">1536</span>                int idx2 = idx1 + 1;<a name="line.1536"></a>
<span class="sourceLineNo">1537</span>                int idx3 = offa + idx1;<a name="line.1537"></a>
<span class="sourceLineNo">1538</span>                int idx4 = offa + idx2;<a name="line.1538"></a>
<span class="sourceLineNo">1539</span>                ak[idx1] = a[idx3] * bk1[idx1] - a[idx4] * bk1[idx2];<a name="line.1539"></a>
<span class="sourceLineNo">1540</span>                ak[idx2] = a[idx3] * bk1[idx2] + a[idx4] * bk1[idx1];<a name="line.1540"></a>
<span class="sourceLineNo">1541</span>            }<a name="line.1541"></a>
<span class="sourceLineNo">1542</span><a name="line.1542"></a>
<span class="sourceLineNo">1543</span>            ak[n] = a[offa + 1] * bk1[n];<a name="line.1543"></a>
<span class="sourceLineNo">1544</span>            ak[n + 1] = a[offa + 1] * bk1[n + 1];<a name="line.1544"></a>
<span class="sourceLineNo">1545</span><a name="line.1545"></a>
<span class="sourceLineNo">1546</span>            for (int i = n / 2 + 1; i &lt; n; i++) {<a name="line.1546"></a>
<span class="sourceLineNo">1547</span>                int idx1 = 2 * i;<a name="line.1547"></a>
<span class="sourceLineNo">1548</span>                int idx2 = idx1 + 1;<a name="line.1548"></a>
<span class="sourceLineNo">1549</span>                int idx3 = offa + 2 * n - idx1;<a name="line.1549"></a>
<span class="sourceLineNo">1550</span>                int idx4 = idx3 + 1;<a name="line.1550"></a>
<span class="sourceLineNo">1551</span>                ak[idx1] = a[idx3] * bk1[idx1] + a[idx4] * bk1[idx2];<a name="line.1551"></a>
<span class="sourceLineNo">1552</span>                ak[idx2] = a[idx3] * bk1[idx2] - a[idx4] * bk1[idx1];<a name="line.1552"></a>
<span class="sourceLineNo">1553</span>            }<a name="line.1553"></a>
<span class="sourceLineNo">1554</span><a name="line.1554"></a>
<span class="sourceLineNo">1555</span>        } else {<a name="line.1555"></a>
<span class="sourceLineNo">1556</span>            ak[0] = a[offa] * bk1[0];<a name="line.1556"></a>
<span class="sourceLineNo">1557</span>            ak[1] = a[offa] * bk1[1];<a name="line.1557"></a>
<span class="sourceLineNo">1558</span><a name="line.1558"></a>
<span class="sourceLineNo">1559</span>            for (int i = 1; i &lt; (n - 1) / 2; i++) {<a name="line.1559"></a>
<span class="sourceLineNo">1560</span>                int idx1 = 2 * i;<a name="line.1560"></a>
<span class="sourceLineNo">1561</span>                int idx2 = idx1 + 1;<a name="line.1561"></a>
<span class="sourceLineNo">1562</span>                int idx3 = offa + idx1;<a name="line.1562"></a>
<span class="sourceLineNo">1563</span>                int idx4 = offa + idx2;<a name="line.1563"></a>
<span class="sourceLineNo">1564</span>                ak[idx1] = a[idx3] * bk1[idx1] - a[idx4] * bk1[idx2];<a name="line.1564"></a>
<span class="sourceLineNo">1565</span>                ak[idx2] = a[idx3] * bk1[idx2] + a[idx4] * bk1[idx1];<a name="line.1565"></a>
<span class="sourceLineNo">1566</span>            }<a name="line.1566"></a>
<span class="sourceLineNo">1567</span><a name="line.1567"></a>
<span class="sourceLineNo">1568</span>            ak[n - 1] = a[offa + n - 1] * bk1[n - 1] - a[offa + 1] * bk1[n];<a name="line.1568"></a>
<span class="sourceLineNo">1569</span>            ak[n] = a[offa + n - 1] * bk1[n] + a[offa + 1] * bk1[n - 1];<a name="line.1569"></a>
<span class="sourceLineNo">1570</span><a name="line.1570"></a>
<span class="sourceLineNo">1571</span>            ak[n + 1] = a[offa + n - 1] * bk1[n + 1] + a[offa + 1] * bk1[n + 2];<a name="line.1571"></a>
<span class="sourceLineNo">1572</span>            ak[n + 2] = a[offa + n - 1] * bk1[n + 2] - a[offa + 1] * bk1[n + 1];<a name="line.1572"></a>
<span class="sourceLineNo">1573</span><a name="line.1573"></a>
<span class="sourceLineNo">1574</span>            for (int i = (n - 1) / 2 + 2; i &lt; n; i++) {<a name="line.1574"></a>
<span class="sourceLineNo">1575</span>                int idx1 = 2 * i;<a name="line.1575"></a>
<span class="sourceLineNo">1576</span>                int idx2 = idx1 + 1;<a name="line.1576"></a>
<span class="sourceLineNo">1577</span>                int idx3 = offa + 2 * n - idx1;<a name="line.1577"></a>
<span class="sourceLineNo">1578</span>                int idx4 = idx3 + 1;<a name="line.1578"></a>
<span class="sourceLineNo">1579</span>                ak[idx1] = a[idx3] * bk1[idx1] + a[idx4] * bk1[idx2];<a name="line.1579"></a>
<span class="sourceLineNo">1580</span>                ak[idx2] = a[idx3] * bk1[idx2] - a[idx4] * bk1[idx1];<a name="line.1580"></a>
<span class="sourceLineNo">1581</span>            }<a name="line.1581"></a>
<span class="sourceLineNo">1582</span>        }<a name="line.1582"></a>
<span class="sourceLineNo">1583</span><a name="line.1583"></a>
<span class="sourceLineNo">1584</span>        cftbsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1584"></a>
<span class="sourceLineNo">1585</span><a name="line.1585"></a>
<span class="sourceLineNo">1586</span>        int nthreads = 1;<a name="line.1586"></a>
<span class="sourceLineNo">1587</span>        int threads = ConcurrencyUtils.getNumberOfThreads();<a name="line.1587"></a>
<span class="sourceLineNo">1588</span>        if ((threads &gt; 1) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_2Threads())) {<a name="line.1588"></a>
<span class="sourceLineNo">1589</span>            nthreads = 2;<a name="line.1589"></a>
<span class="sourceLineNo">1590</span>            if ((threads &gt;= 4) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_4Threads())) {<a name="line.1590"></a>
<span class="sourceLineNo">1591</span>                nthreads = 4;<a name="line.1591"></a>
<span class="sourceLineNo">1592</span>            }<a name="line.1592"></a>
<span class="sourceLineNo">1593</span>            Future&lt;?&gt;[] futures = new Future[nthreads];<a name="line.1593"></a>
<span class="sourceLineNo">1594</span>            int k = nBluestein / nthreads;<a name="line.1594"></a>
<span class="sourceLineNo">1595</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1595"></a>
<span class="sourceLineNo">1596</span>                final int firstIdx = i * k;<a name="line.1596"></a>
<span class="sourceLineNo">1597</span>                final int lastIdx = (i == (nthreads - 1)) ? nBluestein : firstIdx + k;<a name="line.1597"></a>
<span class="sourceLineNo">1598</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1598"></a>
<span class="sourceLineNo">1599</span>                    @Override<a name="line.1599"></a>
<span class="sourceLineNo">1600</span>                                        public void run() {<a name="line.1600"></a>
<span class="sourceLineNo">1601</span>                        for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1601"></a>
<span class="sourceLineNo">1602</span>                            int idx1 = 2 * i;<a name="line.1602"></a>
<span class="sourceLineNo">1603</span>                            int idx2 = idx1 + 1;<a name="line.1603"></a>
<span class="sourceLineNo">1604</span>                            float im = -ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1604"></a>
<span class="sourceLineNo">1605</span>                            ak[idx1] = ak[idx1] * bk2[idx1] + ak[idx2] * bk2[idx2];<a name="line.1605"></a>
<span class="sourceLineNo">1606</span>                            ak[idx2] = im;<a name="line.1606"></a>
<span class="sourceLineNo">1607</span>                        }<a name="line.1607"></a>
<span class="sourceLineNo">1608</span>                    }<a name="line.1608"></a>
<span class="sourceLineNo">1609</span>                });<a name="line.1609"></a>
<span class="sourceLineNo">1610</span>            }<a name="line.1610"></a>
<span class="sourceLineNo">1611</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1611"></a>
<span class="sourceLineNo">1612</span><a name="line.1612"></a>
<span class="sourceLineNo">1613</span>            cftfsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1613"></a>
<span class="sourceLineNo">1614</span><a name="line.1614"></a>
<span class="sourceLineNo">1615</span>            k = n / nthreads;<a name="line.1615"></a>
<span class="sourceLineNo">1616</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1616"></a>
<span class="sourceLineNo">1617</span>                final int firstIdx = i * k;<a name="line.1617"></a>
<span class="sourceLineNo">1618</span>                final int lastIdx = (i == (nthreads - 1)) ? n : firstIdx + k;<a name="line.1618"></a>
<span class="sourceLineNo">1619</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1619"></a>
<span class="sourceLineNo">1620</span>                    @Override<a name="line.1620"></a>
<span class="sourceLineNo">1621</span>                                        public void run() {<a name="line.1621"></a>
<span class="sourceLineNo">1622</span>                        for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1622"></a>
<span class="sourceLineNo">1623</span>                            int idx1 = 2 * i;<a name="line.1623"></a>
<span class="sourceLineNo">1624</span>                            int idx2 = idx1 + 1;<a name="line.1624"></a>
<span class="sourceLineNo">1625</span>                            a[offa + i] = bk1[idx1] * ak[idx1] - bk1[idx2] * ak[idx2];<a name="line.1625"></a>
<span class="sourceLineNo">1626</span>                        }<a name="line.1626"></a>
<span class="sourceLineNo">1627</span>                    }<a name="line.1627"></a>
<span class="sourceLineNo">1628</span>                });<a name="line.1628"></a>
<span class="sourceLineNo">1629</span>            }<a name="line.1629"></a>
<span class="sourceLineNo">1630</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1630"></a>
<span class="sourceLineNo">1631</span><a name="line.1631"></a>
<span class="sourceLineNo">1632</span>        } else {<a name="line.1632"></a>
<span class="sourceLineNo">1633</span><a name="line.1633"></a>
<span class="sourceLineNo">1634</span>            for (int i = 0; i &lt; nBluestein; i++) {<a name="line.1634"></a>
<span class="sourceLineNo">1635</span>                int idx1 = 2 * i;<a name="line.1635"></a>
<span class="sourceLineNo">1636</span>                int idx2 = idx1 + 1;<a name="line.1636"></a>
<span class="sourceLineNo">1637</span>                float im = -ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1637"></a>
<span class="sourceLineNo">1638</span>                ak[idx1] = ak[idx1] * bk2[idx1] + ak[idx2] * bk2[idx2];<a name="line.1638"></a>
<span class="sourceLineNo">1639</span>                ak[idx2] = im;<a name="line.1639"></a>
<span class="sourceLineNo">1640</span>            }<a name="line.1640"></a>
<span class="sourceLineNo">1641</span><a name="line.1641"></a>
<span class="sourceLineNo">1642</span>            cftfsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1642"></a>
<span class="sourceLineNo">1643</span><a name="line.1643"></a>
<span class="sourceLineNo">1644</span>            for (int i = 0; i &lt; n; i++) {<a name="line.1644"></a>
<span class="sourceLineNo">1645</span>                int idx1 = 2 * i;<a name="line.1645"></a>
<span class="sourceLineNo">1646</span>                int idx2 = idx1 + 1;<a name="line.1646"></a>
<span class="sourceLineNo">1647</span>                a[offa + i] = bk1[idx1] * ak[idx1] - bk1[idx2] * ak[idx2];<a name="line.1647"></a>
<span class="sourceLineNo">1648</span>            }<a name="line.1648"></a>
<span class="sourceLineNo">1649</span>        }<a name="line.1649"></a>
<span class="sourceLineNo">1650</span>    }<a name="line.1650"></a>
<span class="sourceLineNo">1651</span><a name="line.1651"></a>
<span class="sourceLineNo">1652</span>    private void bluestein_real_inverse2(final float[] a, final int offa) {<a name="line.1652"></a>
<span class="sourceLineNo">1653</span>        final float[] ak = new float[2 * nBluestein];<a name="line.1653"></a>
<span class="sourceLineNo">1654</span>        int nthreads = 1;<a name="line.1654"></a>
<span class="sourceLineNo">1655</span>        int threads = ConcurrencyUtils.getNumberOfThreads();<a name="line.1655"></a>
<span class="sourceLineNo">1656</span>        if ((threads &gt; 1) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_2Threads())) {<a name="line.1656"></a>
<span class="sourceLineNo">1657</span>            nthreads = 2;<a name="line.1657"></a>
<span class="sourceLineNo">1658</span>            if ((threads &gt;= 4) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_4Threads())) {<a name="line.1658"></a>
<span class="sourceLineNo">1659</span>                nthreads = 4;<a name="line.1659"></a>
<span class="sourceLineNo">1660</span>            }<a name="line.1660"></a>
<span class="sourceLineNo">1661</span>            Future&lt;?&gt;[] futures = new Future[nthreads];<a name="line.1661"></a>
<span class="sourceLineNo">1662</span>            int k = n / nthreads;<a name="line.1662"></a>
<span class="sourceLineNo">1663</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1663"></a>
<span class="sourceLineNo">1664</span>                final int firstIdx = i * k;<a name="line.1664"></a>
<span class="sourceLineNo">1665</span>                final int lastIdx = (i == (nthreads - 1)) ? n : firstIdx + k;<a name="line.1665"></a>
<span class="sourceLineNo">1666</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1666"></a>
<span class="sourceLineNo">1667</span>                    @Override<a name="line.1667"></a>
<span class="sourceLineNo">1668</span>                                        public void run() {<a name="line.1668"></a>
<span class="sourceLineNo">1669</span>                        for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1669"></a>
<span class="sourceLineNo">1670</span>                            int idx1 = 2 * i;<a name="line.1670"></a>
<span class="sourceLineNo">1671</span>                            int idx2 = idx1 + 1;<a name="line.1671"></a>
<span class="sourceLineNo">1672</span>                            int idx3 = offa + i;<a name="line.1672"></a>
<span class="sourceLineNo">1673</span>                            ak[idx1] = a[idx3] * bk1[idx1];<a name="line.1673"></a>
<span class="sourceLineNo">1674</span>                            ak[idx2] = a[idx3] * bk1[idx2];<a name="line.1674"></a>
<span class="sourceLineNo">1675</span>                        }<a name="line.1675"></a>
<span class="sourceLineNo">1676</span>                    }<a name="line.1676"></a>
<span class="sourceLineNo">1677</span>                });<a name="line.1677"></a>
<span class="sourceLineNo">1678</span>            }<a name="line.1678"></a>
<span class="sourceLineNo">1679</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1679"></a>
<span class="sourceLineNo">1680</span><a name="line.1680"></a>
<span class="sourceLineNo">1681</span>            cftbsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1681"></a>
<span class="sourceLineNo">1682</span><a name="line.1682"></a>
<span class="sourceLineNo">1683</span>            k = nBluestein / nthreads;<a name="line.1683"></a>
<span class="sourceLineNo">1684</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.1684"></a>
<span class="sourceLineNo">1685</span>                final int firstIdx = i * k;<a name="line.1685"></a>
<span class="sourceLineNo">1686</span>                final int lastIdx = (i == (nthreads - 1)) ? nBluestein : firstIdx + k;<a name="line.1686"></a>
<span class="sourceLineNo">1687</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.1687"></a>
<span class="sourceLineNo">1688</span>                    @Override<a name="line.1688"></a>
<span class="sourceLineNo">1689</span>                                        public void run() {<a name="line.1689"></a>
<span class="sourceLineNo">1690</span>                        for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.1690"></a>
<span class="sourceLineNo">1691</span>                            int idx1 = 2 * i;<a name="line.1691"></a>
<span class="sourceLineNo">1692</span>                            int idx2 = idx1 + 1;<a name="line.1692"></a>
<span class="sourceLineNo">1693</span>                            float im = -ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1693"></a>
<span class="sourceLineNo">1694</span>                            ak[idx1] = ak[idx1] * bk2[idx1] + ak[idx2] * bk2[idx2];<a name="line.1694"></a>
<span class="sourceLineNo">1695</span>                            ak[idx2] = im;<a name="line.1695"></a>
<span class="sourceLineNo">1696</span>                        }<a name="line.1696"></a>
<span class="sourceLineNo">1697</span>                    }<a name="line.1697"></a>
<span class="sourceLineNo">1698</span>                });<a name="line.1698"></a>
<span class="sourceLineNo">1699</span>            }<a name="line.1699"></a>
<span class="sourceLineNo">1700</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.1700"></a>
<span class="sourceLineNo">1701</span><a name="line.1701"></a>
<span class="sourceLineNo">1702</span>        } else {<a name="line.1702"></a>
<span class="sourceLineNo">1703</span><a name="line.1703"></a>
<span class="sourceLineNo">1704</span>            for (int i = 0; i &lt; n; i++) {<a name="line.1704"></a>
<span class="sourceLineNo">1705</span>                int idx1 = 2 * i;<a name="line.1705"></a>
<span class="sourceLineNo">1706</span>                int idx2 = idx1 + 1;<a name="line.1706"></a>
<span class="sourceLineNo">1707</span>                int idx3 = offa + i;<a name="line.1707"></a>
<span class="sourceLineNo">1708</span>                ak[idx1] = a[idx3] * bk1[idx1];<a name="line.1708"></a>
<span class="sourceLineNo">1709</span>                ak[idx2] = a[idx3] * bk1[idx2];<a name="line.1709"></a>
<span class="sourceLineNo">1710</span>            }<a name="line.1710"></a>
<span class="sourceLineNo">1711</span><a name="line.1711"></a>
<span class="sourceLineNo">1712</span>            cftbsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1712"></a>
<span class="sourceLineNo">1713</span><a name="line.1713"></a>
<span class="sourceLineNo">1714</span>            for (int i = 0; i &lt; nBluestein; i++) {<a name="line.1714"></a>
<span class="sourceLineNo">1715</span>                int idx1 = 2 * i;<a name="line.1715"></a>
<span class="sourceLineNo">1716</span>                int idx2 = idx1 + 1;<a name="line.1716"></a>
<span class="sourceLineNo">1717</span>                float im = -ak[idx1] * bk2[idx2] + ak[idx2] * bk2[idx1];<a name="line.1717"></a>
<span class="sourceLineNo">1718</span>                ak[idx1] = ak[idx1] * bk2[idx1] + ak[idx2] * bk2[idx2];<a name="line.1718"></a>
<span class="sourceLineNo">1719</span>                ak[idx2] = im;<a name="line.1719"></a>
<span class="sourceLineNo">1720</span>            }<a name="line.1720"></a>
<span class="sourceLineNo">1721</span>        }<a name="line.1721"></a>
<span class="sourceLineNo">1722</span><a name="line.1722"></a>
<span class="sourceLineNo">1723</span>        cftfsub(2 * nBluestein, ak, 0, ip, nw, w);<a name="line.1723"></a>
<span class="sourceLineNo">1724</span><a name="line.1724"></a>
<span class="sourceLineNo">1725</span>        if (n % 2 == 0) {<a name="line.1725"></a>
<span class="sourceLineNo">1726</span>            a[offa] = bk1[0] * ak[0] - bk1[1] * ak[1];<a name="line.1726"></a>
<span class="sourceLineNo">1727</span>            a[offa + 1] = bk1[n] * ak[n] - bk1[n + 1] * ak[n + 1];<a name="line.1727"></a>
<span class="sourceLineNo">1728</span>            for (int i = 1; i &lt; n / 2; i++) {<a name="line.1728"></a>
<span class="sourceLineNo">1729</span>                int idx1 = 2 * i;<a name="line.1729"></a>
<span class="sourceLineNo">1730</span>                int idx2 = idx1 + 1;<a name="line.1730"></a>
<span class="sourceLineNo">1731</span>                a[offa + idx1] = bk1[idx1] * ak[idx1] - bk1[idx2] * ak[idx2];<a name="line.1731"></a>
<span class="sourceLineNo">1732</span>                a[offa + idx2] = bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1732"></a>
<span class="sourceLineNo">1733</span>            }<a name="line.1733"></a>
<span class="sourceLineNo">1734</span>        } else {<a name="line.1734"></a>
<span class="sourceLineNo">1735</span>            a[offa] = bk1[0] * ak[0] - bk1[1] * ak[1];<a name="line.1735"></a>
<span class="sourceLineNo">1736</span>            a[offa + 1] = bk1[n] * ak[n - 1] + bk1[n - 1] * ak[n];<a name="line.1736"></a>
<span class="sourceLineNo">1737</span>            for (int i = 1; i &lt; (n - 1) / 2; i++) {<a name="line.1737"></a>
<span class="sourceLineNo">1738</span>                int idx1 = 2 * i;<a name="line.1738"></a>
<span class="sourceLineNo">1739</span>                int idx2 = idx1 + 1;<a name="line.1739"></a>
<span class="sourceLineNo">1740</span>                a[offa + idx1] = bk1[idx1] * ak[idx1] - bk1[idx2] * ak[idx2];<a name="line.1740"></a>
<span class="sourceLineNo">1741</span>                a[offa + idx2] = bk1[idx2] * ak[idx1] + bk1[idx1] * ak[idx2];<a name="line.1741"></a>
<span class="sourceLineNo">1742</span>            }<a name="line.1742"></a>
<span class="sourceLineNo">1743</span>            a[offa + n - 1] = bk1[n - 1] * ak[n - 1] - bk1[n] * ak[n];<a name="line.1743"></a>
<span class="sourceLineNo">1744</span>        }<a name="line.1744"></a>
<span class="sourceLineNo">1745</span>    }<a name="line.1745"></a>
<span class="sourceLineNo">1746</span><a name="line.1746"></a>
<span class="sourceLineNo">1747</span>    /*---------------------------------------------------------<a name="line.1747"></a>
<span class="sourceLineNo">1748</span>       rfftf1: further processing of Real forward FFT<a name="line.1748"></a>
<span class="sourceLineNo">1749</span>      --------------------------------------------------------*/<a name="line.1749"></a>
<span class="sourceLineNo">1750</span>    void rfftf(final float a[], final int offa) {<a name="line.1750"></a>
<span class="sourceLineNo">1751</span>        if (n == 1)<a name="line.1751"></a>
<span class="sourceLineNo">1752</span>            return;<a name="line.1752"></a>
<span class="sourceLineNo">1753</span>        int l1, l2, na, kh, nf, ip, iw, ido, idl1;<a name="line.1753"></a>
<span class="sourceLineNo">1754</span><a name="line.1754"></a>
<span class="sourceLineNo">1755</span>        final float[] ch = new float[n];<a name="line.1755"></a>
<span class="sourceLineNo">1756</span>        final int twon = 2 * n;<a name="line.1756"></a>
<span class="sourceLineNo">1757</span>        nf = (int) wtable_r[1 + twon];<a name="line.1757"></a>
<span class="sourceLineNo">1758</span>        na = 1;<a name="line.1758"></a>
<span class="sourceLineNo">1759</span>        l2 = n;<a name="line.1759"></a>
<span class="sourceLineNo">1760</span>        iw = twon - 1;<a name="line.1760"></a>
<span class="sourceLineNo">1761</span>        for (int k1 = 1; k1 &lt;= nf; ++k1) {<a name="line.1761"></a>
<span class="sourceLineNo">1762</span>            kh = nf - k1;<a name="line.1762"></a>
<span class="sourceLineNo">1763</span>            ip = (int) wtable_r[kh + 2 + twon];<a name="line.1763"></a>
<span class="sourceLineNo">1764</span>            l1 = l2 / ip;<a name="line.1764"></a>
<span class="sourceLineNo">1765</span>            ido = n / l2;<a name="line.1765"></a>
<span class="sourceLineNo">1766</span>            idl1 = ido * l1;<a name="line.1766"></a>
<span class="sourceLineNo">1767</span>            iw -= (ip - 1) * ido;<a name="line.1767"></a>
<span class="sourceLineNo">1768</span>            na = 1 - na;<a name="line.1768"></a>
<span class="sourceLineNo">1769</span>            switch (ip) {<a name="line.1769"></a>
<span class="sourceLineNo">1770</span>            case 2:<a name="line.1770"></a>
<span class="sourceLineNo">1771</span>                if (na == 0) {<a name="line.1771"></a>
<span class="sourceLineNo">1772</span>                    radf2(ido, l1, a, offa, ch, 0, iw);<a name="line.1772"></a>
<span class="sourceLineNo">1773</span>                } else {<a name="line.1773"></a>
<span class="sourceLineNo">1774</span>                    radf2(ido, l1, ch, 0, a, offa, iw);<a name="line.1774"></a>
<span class="sourceLineNo">1775</span>                }<a name="line.1775"></a>
<span class="sourceLineNo">1776</span>                break;<a name="line.1776"></a>
<span class="sourceLineNo">1777</span>            case 3:<a name="line.1777"></a>
<span class="sourceLineNo">1778</span>                if (na == 0) {<a name="line.1778"></a>
<span class="sourceLineNo">1779</span>                    radf3(ido, l1, a, offa, ch, 0, iw);<a name="line.1779"></a>
<span class="sourceLineNo">1780</span>                } else {<a name="line.1780"></a>
<span class="sourceLineNo">1781</span>                    radf3(ido, l1, ch, 0, a, offa, iw);<a name="line.1781"></a>
<span class="sourceLineNo">1782</span>                }<a name="line.1782"></a>
<span class="sourceLineNo">1783</span>                break;<a name="line.1783"></a>
<span class="sourceLineNo">1784</span>            case 4:<a name="line.1784"></a>
<span class="sourceLineNo">1785</span>                if (na == 0) {<a name="line.1785"></a>
<span class="sourceLineNo">1786</span>                    radf4(ido, l1, a, offa, ch, 0, iw);<a name="line.1786"></a>
<span class="sourceLineNo">1787</span>                } else {<a name="line.1787"></a>
<span class="sourceLineNo">1788</span>                    radf4(ido, l1, ch, 0, a, offa, iw);<a name="line.1788"></a>
<span class="sourceLineNo">1789</span>                }<a name="line.1789"></a>
<span class="sourceLineNo">1790</span>                break;<a name="line.1790"></a>
<span class="sourceLineNo">1791</span>            case 5:<a name="line.1791"></a>
<span class="sourceLineNo">1792</span>                if (na == 0) {<a name="line.1792"></a>
<span class="sourceLineNo">1793</span>                    radf5(ido, l1, a, offa, ch, 0, iw);<a name="line.1793"></a>
<span class="sourceLineNo">1794</span>                } else {<a name="line.1794"></a>
<span class="sourceLineNo">1795</span>                    radf5(ido, l1, ch, 0, a, offa, iw);<a name="line.1795"></a>
<span class="sourceLineNo">1796</span>                }<a name="line.1796"></a>
<span class="sourceLineNo">1797</span>                break;<a name="line.1797"></a>
<span class="sourceLineNo">1798</span>            default:<a name="line.1798"></a>
<span class="sourceLineNo">1799</span>                if (ido == 1)<a name="line.1799"></a>
<span class="sourceLineNo">1800</span>                    na = 1 - na;<a name="line.1800"></a>
<span class="sourceLineNo">1801</span>                if (na == 0) {<a name="line.1801"></a>
<span class="sourceLineNo">1802</span>                    radfg(ido, ip, l1, idl1, a, offa, ch, 0, iw);<a name="line.1802"></a>
<span class="sourceLineNo">1803</span>                    na = 1;<a name="line.1803"></a>
<span class="sourceLineNo">1804</span>                } else {<a name="line.1804"></a>
<span class="sourceLineNo">1805</span>                    radfg(ido, ip, l1, idl1, ch, 0, a, offa, iw);<a name="line.1805"></a>
<span class="sourceLineNo">1806</span>                    na = 0;<a name="line.1806"></a>
<span class="sourceLineNo">1807</span>                }<a name="line.1807"></a>
<span class="sourceLineNo">1808</span>                break;<a name="line.1808"></a>
<span class="sourceLineNo">1809</span>            }<a name="line.1809"></a>
<span class="sourceLineNo">1810</span>            l2 = l1;<a name="line.1810"></a>
<span class="sourceLineNo">1811</span>        }<a name="line.1811"></a>
<span class="sourceLineNo">1812</span>        if (na == 1)<a name="line.1812"></a>
<span class="sourceLineNo">1813</span>            return;<a name="line.1813"></a>
<span class="sourceLineNo">1814</span>        System.arraycopy(ch, 0, a, offa, n);<a name="line.1814"></a>
<span class="sourceLineNo">1815</span>    }<a name="line.1815"></a>
<span class="sourceLineNo">1816</span><a name="line.1816"></a>
<span class="sourceLineNo">1817</span>    /*---------------------------------------------------------<a name="line.1817"></a>
<span class="sourceLineNo">1818</span>       rfftb1: further processing of Real backward FFT<a name="line.1818"></a>
<span class="sourceLineNo">1819</span>      --------------------------------------------------------*/<a name="line.1819"></a>
<span class="sourceLineNo">1820</span>    void rfftb(final float a[], final int offa) {<a name="line.1820"></a>
<span class="sourceLineNo">1821</span>        if (n == 1)<a name="line.1821"></a>
<span class="sourceLineNo">1822</span>            return;<a name="line.1822"></a>
<span class="sourceLineNo">1823</span>        int l1, l2, na, nf, ip, iw, ido, idl1;<a name="line.1823"></a>
<span class="sourceLineNo">1824</span><a name="line.1824"></a>
<span class="sourceLineNo">1825</span>        float[] ch = new float[n];<a name="line.1825"></a>
<span class="sourceLineNo">1826</span>        final int twon = 2 * n;<a name="line.1826"></a>
<span class="sourceLineNo">1827</span>        nf = (int) wtable_r[1 + twon];<a name="line.1827"></a>
<span class="sourceLineNo">1828</span>        na = 0;<a name="line.1828"></a>
<span class="sourceLineNo">1829</span>        l1 = 1;<a name="line.1829"></a>
<span class="sourceLineNo">1830</span>        iw = n;<a name="line.1830"></a>
<span class="sourceLineNo">1831</span>        for (int k1 = 1; k1 &lt;= nf; k1++) {<a name="line.1831"></a>
<span class="sourceLineNo">1832</span>            ip = (int) wtable_r[k1 + 1 + twon];<a name="line.1832"></a>
<span class="sourceLineNo">1833</span>            l2 = ip * l1;<a name="line.1833"></a>
<span class="sourceLineNo">1834</span>            ido = n / l2;<a name="line.1834"></a>
<span class="sourceLineNo">1835</span>            idl1 = ido * l1;<a name="line.1835"></a>
<span class="sourceLineNo">1836</span>            switch (ip) {<a name="line.1836"></a>
<span class="sourceLineNo">1837</span>            case 2:<a name="line.1837"></a>
<span class="sourceLineNo">1838</span>                if (na == 0) {<a name="line.1838"></a>
<span class="sourceLineNo">1839</span>                    radb2(ido, l1, a, offa, ch, 0, iw);<a name="line.1839"></a>
<span class="sourceLineNo">1840</span>                } else {<a name="line.1840"></a>
<span class="sourceLineNo">1841</span>                    radb2(ido, l1, ch, 0, a, offa, iw);<a name="line.1841"></a>
<span class="sourceLineNo">1842</span>                }<a name="line.1842"></a>
<span class="sourceLineNo">1843</span>                na = 1 - na;<a name="line.1843"></a>
<span class="sourceLineNo">1844</span>                break;<a name="line.1844"></a>
<span class="sourceLineNo">1845</span>            case 3:<a name="line.1845"></a>
<span class="sourceLineNo">1846</span>                if (na == 0) {<a name="line.1846"></a>
<span class="sourceLineNo">1847</span>                    radb3(ido, l1, a, offa, ch, 0, iw);<a name="line.1847"></a>
<span class="sourceLineNo">1848</span>                } else {<a name="line.1848"></a>
<span class="sourceLineNo">1849</span>                    radb3(ido, l1, ch, 0, a, offa, iw);<a name="line.1849"></a>
<span class="sourceLineNo">1850</span>                }<a name="line.1850"></a>
<span class="sourceLineNo">1851</span>                na = 1 - na;<a name="line.1851"></a>
<span class="sourceLineNo">1852</span>                break;<a name="line.1852"></a>
<span class="sourceLineNo">1853</span>            case 4:<a name="line.1853"></a>
<span class="sourceLineNo">1854</span>                if (na == 0) {<a name="line.1854"></a>
<span class="sourceLineNo">1855</span>                    radb4(ido, l1, a, offa, ch, 0, iw);<a name="line.1855"></a>
<span class="sourceLineNo">1856</span>                } else {<a name="line.1856"></a>
<span class="sourceLineNo">1857</span>                    radb4(ido, l1, ch, 0, a, offa, iw);<a name="line.1857"></a>
<span class="sourceLineNo">1858</span>                }<a name="line.1858"></a>
<span class="sourceLineNo">1859</span>                na = 1 - na;<a name="line.1859"></a>
<span class="sourceLineNo">1860</span>                break;<a name="line.1860"></a>
<span class="sourceLineNo">1861</span>            case 5:<a name="line.1861"></a>
<span class="sourceLineNo">1862</span>                if (na == 0) {<a name="line.1862"></a>
<span class="sourceLineNo">1863</span>                    radb5(ido, l1, a, offa, ch, 0, iw);<a name="line.1863"></a>
<span class="sourceLineNo">1864</span>                } else {<a name="line.1864"></a>
<span class="sourceLineNo">1865</span>                    radb5(ido, l1, ch, 0, a, offa, iw);<a name="line.1865"></a>
<span class="sourceLineNo">1866</span>                }<a name="line.1866"></a>
<span class="sourceLineNo">1867</span>                na = 1 - na;<a name="line.1867"></a>
<span class="sourceLineNo">1868</span>                break;<a name="line.1868"></a>
<span class="sourceLineNo">1869</span>            default:<a name="line.1869"></a>
<span class="sourceLineNo">1870</span>                if (na == 0) {<a name="line.1870"></a>
<span class="sourceLineNo">1871</span>                    radbg(ido, ip, l1, idl1, a, offa, ch, 0, iw);<a name="line.1871"></a>
<span class="sourceLineNo">1872</span>                } else {<a name="line.1872"></a>
<span class="sourceLineNo">1873</span>                    radbg(ido, ip, l1, idl1, ch, 0, a, offa, iw);<a name="line.1873"></a>
<span class="sourceLineNo">1874</span>                }<a name="line.1874"></a>
<span class="sourceLineNo">1875</span>                if (ido == 1)<a name="line.1875"></a>
<span class="sourceLineNo">1876</span>                    na = 1 - na;<a name="line.1876"></a>
<span class="sourceLineNo">1877</span>                break;<a name="line.1877"></a>
<span class="sourceLineNo">1878</span>            }<a name="line.1878"></a>
<span class="sourceLineNo">1879</span>            l1 = l2;<a name="line.1879"></a>
<span class="sourceLineNo">1880</span>            iw += (ip - 1) * ido;<a name="line.1880"></a>
<span class="sourceLineNo">1881</span>        }<a name="line.1881"></a>
<span class="sourceLineNo">1882</span>        if (na == 0)<a name="line.1882"></a>
<span class="sourceLineNo">1883</span>            return;<a name="line.1883"></a>
<span class="sourceLineNo">1884</span>        System.arraycopy(ch, 0, a, offa, n);<a name="line.1884"></a>
<span class="sourceLineNo">1885</span>    }<a name="line.1885"></a>
<span class="sourceLineNo">1886</span><a name="line.1886"></a>
<span class="sourceLineNo">1887</span>    /*-------------------------------------------------<a name="line.1887"></a>
<span class="sourceLineNo">1888</span>       radf2: Real FFT's forward processing of factor 2<a name="line.1888"></a>
<span class="sourceLineNo">1889</span>      -------------------------------------------------*/<a name="line.1889"></a>
<span class="sourceLineNo">1890</span>    void radf2(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset) {<a name="line.1890"></a>
<span class="sourceLineNo">1891</span>        int i, ic, idx0, idx1, idx2, idx3, idx4;<a name="line.1891"></a>
<span class="sourceLineNo">1892</span>        float t1i, t1r, w1r, w1i;<a name="line.1892"></a>
<span class="sourceLineNo">1893</span>        int iw1;<a name="line.1893"></a>
<span class="sourceLineNo">1894</span>        iw1 = offset;<a name="line.1894"></a>
<span class="sourceLineNo">1895</span>        idx0 = l1 * ido;<a name="line.1895"></a>
<span class="sourceLineNo">1896</span>        idx1 = 2 * ido;<a name="line.1896"></a>
<span class="sourceLineNo">1897</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.1897"></a>
<span class="sourceLineNo">1898</span>            int oidx1 = out_off + k * idx1;<a name="line.1898"></a>
<span class="sourceLineNo">1899</span>            int oidx2 = oidx1 + idx1 - 1;<a name="line.1899"></a>
<span class="sourceLineNo">1900</span>            int iidx1 = in_off + k * ido;<a name="line.1900"></a>
<span class="sourceLineNo">1901</span>            int iidx2 = iidx1 + idx0;<a name="line.1901"></a>
<span class="sourceLineNo">1902</span><a name="line.1902"></a>
<span class="sourceLineNo">1903</span>            float i1r = in[iidx1];<a name="line.1903"></a>
<span class="sourceLineNo">1904</span>            float i2r = in[iidx2];<a name="line.1904"></a>
<span class="sourceLineNo">1905</span><a name="line.1905"></a>
<span class="sourceLineNo">1906</span>            out[oidx1] = i1r + i2r;<a name="line.1906"></a>
<span class="sourceLineNo">1907</span>            out[oidx2] = i1r - i2r;<a name="line.1907"></a>
<span class="sourceLineNo">1908</span>        }<a name="line.1908"></a>
<span class="sourceLineNo">1909</span>        if (ido &lt; 2)<a name="line.1909"></a>
<span class="sourceLineNo">1910</span>            return;<a name="line.1910"></a>
<span class="sourceLineNo">1911</span>        if (ido != 2) {<a name="line.1911"></a>
<span class="sourceLineNo">1912</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.1912"></a>
<span class="sourceLineNo">1913</span>                idx1 = k * ido;<a name="line.1913"></a>
<span class="sourceLineNo">1914</span>                idx2 = 2 * idx1;<a name="line.1914"></a>
<span class="sourceLineNo">1915</span>                idx3 = idx2 + ido;<a name="line.1915"></a>
<span class="sourceLineNo">1916</span>                idx4 = idx1 + idx0;<a name="line.1916"></a>
<span class="sourceLineNo">1917</span>                for (i = 2; i &lt; ido; i += 2) {<a name="line.1917"></a>
<span class="sourceLineNo">1918</span>                    ic = ido - i;<a name="line.1918"></a>
<span class="sourceLineNo">1919</span>                    int widx1 = i - 1 + iw1;<a name="line.1919"></a>
<span class="sourceLineNo">1920</span>                    int oidx1 = out_off + i + idx2;<a name="line.1920"></a>
<span class="sourceLineNo">1921</span>                    int oidx2 = out_off + ic + idx3;<a name="line.1921"></a>
<span class="sourceLineNo">1922</span>                    int iidx1 = in_off + i + idx1;<a name="line.1922"></a>
<span class="sourceLineNo">1923</span>                    int iidx2 = in_off + i + idx4;<a name="line.1923"></a>
<span class="sourceLineNo">1924</span><a name="line.1924"></a>
<span class="sourceLineNo">1925</span>                    float a1i = in[iidx1 - 1];<a name="line.1925"></a>
<span class="sourceLineNo">1926</span>                    float a1r = in[iidx1];<a name="line.1926"></a>
<span class="sourceLineNo">1927</span>                    float a2i = in[iidx2 - 1];<a name="line.1927"></a>
<span class="sourceLineNo">1928</span>                    float a2r = in[iidx2];<a name="line.1928"></a>
<span class="sourceLineNo">1929</span><a name="line.1929"></a>
<span class="sourceLineNo">1930</span>                    w1r = wtable_r[widx1 - 1];<a name="line.1930"></a>
<span class="sourceLineNo">1931</span>                    w1i = wtable_r[widx1];<a name="line.1931"></a>
<span class="sourceLineNo">1932</span><a name="line.1932"></a>
<span class="sourceLineNo">1933</span>                    t1r = w1r * a2i + w1i * a2r;<a name="line.1933"></a>
<span class="sourceLineNo">1934</span>                    t1i = w1r * a2r - w1i * a2i;<a name="line.1934"></a>
<span class="sourceLineNo">1935</span><a name="line.1935"></a>
<span class="sourceLineNo">1936</span>                    out[oidx1] = a1r + t1i;<a name="line.1936"></a>
<span class="sourceLineNo">1937</span>                    out[oidx1 - 1] = a1i + t1r;<a name="line.1937"></a>
<span class="sourceLineNo">1938</span><a name="line.1938"></a>
<span class="sourceLineNo">1939</span>                    out[oidx2] = t1i - a1r;<a name="line.1939"></a>
<span class="sourceLineNo">1940</span>                    out[oidx2 - 1] = a1i - t1r;<a name="line.1940"></a>
<span class="sourceLineNo">1941</span>                }<a name="line.1941"></a>
<span class="sourceLineNo">1942</span>            }<a name="line.1942"></a>
<span class="sourceLineNo">1943</span>            if (ido % 2 == 1)<a name="line.1943"></a>
<span class="sourceLineNo">1944</span>                return;<a name="line.1944"></a>
<span class="sourceLineNo">1945</span>        }<a name="line.1945"></a>
<span class="sourceLineNo">1946</span>        idx2 = 2 * idx1;<a name="line.1946"></a>
<span class="sourceLineNo">1947</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.1947"></a>
<span class="sourceLineNo">1948</span>            idx1 = k * ido;<a name="line.1948"></a>
<span class="sourceLineNo">1949</span>            int oidx1 = out_off + idx2 + ido;<a name="line.1949"></a>
<span class="sourceLineNo">1950</span>            int iidx1 = in_off + ido - 1 + idx1;<a name="line.1950"></a>
<span class="sourceLineNo">1951</span><a name="line.1951"></a>
<span class="sourceLineNo">1952</span>            out[oidx1] = -in[iidx1 + idx0];<a name="line.1952"></a>
<span class="sourceLineNo">1953</span>            out[oidx1 - 1] = in[iidx1];<a name="line.1953"></a>
<span class="sourceLineNo">1954</span>        }<a name="line.1954"></a>
<span class="sourceLineNo">1955</span>    }<a name="line.1955"></a>
<span class="sourceLineNo">1956</span><a name="line.1956"></a>
<span class="sourceLineNo">1957</span>    /*-------------------------------------------------<a name="line.1957"></a>
<span class="sourceLineNo">1958</span>       radb2: Real FFT's backward processing of factor 2<a name="line.1958"></a>
<span class="sourceLineNo">1959</span>      -------------------------------------------------*/<a name="line.1959"></a>
<span class="sourceLineNo">1960</span>    void radb2(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset) {<a name="line.1960"></a>
<span class="sourceLineNo">1961</span>        int i, ic;<a name="line.1961"></a>
<span class="sourceLineNo">1962</span>        float t1i, t1r, w1r, w1i;<a name="line.1962"></a>
<span class="sourceLineNo">1963</span>        int iw1 = offset;<a name="line.1963"></a>
<span class="sourceLineNo">1964</span><a name="line.1964"></a>
<span class="sourceLineNo">1965</span>        int idx0 = l1 * ido;<a name="line.1965"></a>
<span class="sourceLineNo">1966</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.1966"></a>
<span class="sourceLineNo">1967</span>            int idx1 = k * ido;<a name="line.1967"></a>
<span class="sourceLineNo">1968</span>            int idx2 = 2 * idx1;<a name="line.1968"></a>
<span class="sourceLineNo">1969</span>            int idx3 = idx2 + ido;<a name="line.1969"></a>
<span class="sourceLineNo">1970</span>            int oidx1 = out_off + idx1;<a name="line.1970"></a>
<span class="sourceLineNo">1971</span>            int iidx1 = in_off + idx2;<a name="line.1971"></a>
<span class="sourceLineNo">1972</span>            int iidx2 = in_off + ido - 1 + idx3;<a name="line.1972"></a>
<span class="sourceLineNo">1973</span>            float i1r = in[iidx1];<a name="line.1973"></a>
<span class="sourceLineNo">1974</span>            float i2r = in[iidx2];<a name="line.1974"></a>
<span class="sourceLineNo">1975</span>            out[oidx1] = i1r + i2r;<a name="line.1975"></a>
<span class="sourceLineNo">1976</span>            out[oidx1 + idx0] = i1r - i2r;<a name="line.1976"></a>
<span class="sourceLineNo">1977</span>        }<a name="line.1977"></a>
<span class="sourceLineNo">1978</span>        if (ido &lt; 2)<a name="line.1978"></a>
<span class="sourceLineNo">1979</span>            return;<a name="line.1979"></a>
<span class="sourceLineNo">1980</span>        if (ido != 2) {<a name="line.1980"></a>
<span class="sourceLineNo">1981</span>            for (int k = 0; k &lt; l1; ++k) {<a name="line.1981"></a>
<span class="sourceLineNo">1982</span>                int idx1 = k * ido;<a name="line.1982"></a>
<span class="sourceLineNo">1983</span>                int idx2 = 2 * idx1;<a name="line.1983"></a>
<span class="sourceLineNo">1984</span>                int idx3 = idx2 + ido;<a name="line.1984"></a>
<span class="sourceLineNo">1985</span>                int idx4 = idx1 + idx0;<a name="line.1985"></a>
<span class="sourceLineNo">1986</span>                for (i = 2; i &lt; ido; i += 2) {<a name="line.1986"></a>
<span class="sourceLineNo">1987</span>                    ic = ido - i;<a name="line.1987"></a>
<span class="sourceLineNo">1988</span>                    int idx5 = i - 1 + iw1;<a name="line.1988"></a>
<span class="sourceLineNo">1989</span>                    int idx6 = out_off + i;<a name="line.1989"></a>
<span class="sourceLineNo">1990</span>                    int idx7 = in_off + i;<a name="line.1990"></a>
<span class="sourceLineNo">1991</span>                    int idx8 = in_off + ic;<a name="line.1991"></a>
<span class="sourceLineNo">1992</span>                    w1r = wtable_r[idx5 - 1];<a name="line.1992"></a>
<span class="sourceLineNo">1993</span>                    w1i = wtable_r[idx5];<a name="line.1993"></a>
<span class="sourceLineNo">1994</span>                    int iidx1 = idx7 + idx2;<a name="line.1994"></a>
<span class="sourceLineNo">1995</span>                    int iidx2 = idx8 + idx3;<a name="line.1995"></a>
<span class="sourceLineNo">1996</span>                    int oidx1 = idx6 + idx1;<a name="line.1996"></a>
<span class="sourceLineNo">1997</span>                    int oidx2 = idx6 + idx4;<a name="line.1997"></a>
<span class="sourceLineNo">1998</span>                    t1r = in[iidx1 - 1] - in[iidx2 - 1];<a name="line.1998"></a>
<span class="sourceLineNo">1999</span>                    t1i = in[iidx1] + in[iidx2];<a name="line.1999"></a>
<span class="sourceLineNo">2000</span>                    float i1i = in[iidx1];<a name="line.2000"></a>
<span class="sourceLineNo">2001</span>                    float i1r = in[iidx1 - 1];<a name="line.2001"></a>
<span class="sourceLineNo">2002</span>                    float i2i = in[iidx2];<a name="line.2002"></a>
<span class="sourceLineNo">2003</span>                    float i2r = in[iidx2 - 1];<a name="line.2003"></a>
<span class="sourceLineNo">2004</span><a name="line.2004"></a>
<span class="sourceLineNo">2005</span>                    out[oidx1 - 1] = i1r + i2r;<a name="line.2005"></a>
<span class="sourceLineNo">2006</span>                    out[oidx1] = i1i - i2i;<a name="line.2006"></a>
<span class="sourceLineNo">2007</span>                    out[oidx2 - 1] = w1r * t1r - w1i * t1i;<a name="line.2007"></a>
<span class="sourceLineNo">2008</span>                    out[oidx2] = w1r * t1i + w1i * t1r;<a name="line.2008"></a>
<span class="sourceLineNo">2009</span>                }<a name="line.2009"></a>
<span class="sourceLineNo">2010</span>            }<a name="line.2010"></a>
<span class="sourceLineNo">2011</span>            if (ido % 2 == 1)<a name="line.2011"></a>
<span class="sourceLineNo">2012</span>                return;<a name="line.2012"></a>
<span class="sourceLineNo">2013</span>        }<a name="line.2013"></a>
<span class="sourceLineNo">2014</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.2014"></a>
<span class="sourceLineNo">2015</span>            int idx1 = k * ido;<a name="line.2015"></a>
<span class="sourceLineNo">2016</span>            int idx2 = 2 * idx1;<a name="line.2016"></a>
<span class="sourceLineNo">2017</span>            int oidx1 = out_off + ido - 1 + idx1;<a name="line.2017"></a>
<span class="sourceLineNo">2018</span>            int iidx1 = in_off + idx2 + ido;<a name="line.2018"></a>
<span class="sourceLineNo">2019</span>            out[oidx1] = 2 * in[iidx1 - 1];<a name="line.2019"></a>
<span class="sourceLineNo">2020</span>            out[oidx1 + idx0] = -2 * in[iidx1];<a name="line.2020"></a>
<span class="sourceLineNo">2021</span>        }<a name="line.2021"></a>
<span class="sourceLineNo">2022</span>    }<a name="line.2022"></a>
<span class="sourceLineNo">2023</span><a name="line.2023"></a>
<span class="sourceLineNo">2024</span>    /*-------------------------------------------------<a name="line.2024"></a>
<span class="sourceLineNo">2025</span>       radf3: Real FFT's forward processing of factor 3 <a name="line.2025"></a>
<span class="sourceLineNo">2026</span>      -------------------------------------------------*/<a name="line.2026"></a>
<span class="sourceLineNo">2027</span>    void radf3(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset) {<a name="line.2027"></a>
<span class="sourceLineNo">2028</span>        final float taur = -0.5f;<a name="line.2028"></a>
<span class="sourceLineNo">2029</span>        final float taui = 0.866025403784438707610604524234076962f;<a name="line.2029"></a>
<span class="sourceLineNo">2030</span>        int i, ic;<a name="line.2030"></a>
<span class="sourceLineNo">2031</span>        float ci2, di2, di3, cr2, dr2, dr3, ti2, ti3, tr2, tr3, w1r, w2r, w1i, w2i;<a name="line.2031"></a>
<span class="sourceLineNo">2032</span>        int iw1, iw2;<a name="line.2032"></a>
<span class="sourceLineNo">2033</span>        iw1 = offset;<a name="line.2033"></a>
<span class="sourceLineNo">2034</span>        iw2 = iw1 + ido;<a name="line.2034"></a>
<span class="sourceLineNo">2035</span><a name="line.2035"></a>
<span class="sourceLineNo">2036</span>        int idx0 = l1 * ido;<a name="line.2036"></a>
<span class="sourceLineNo">2037</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.2037"></a>
<span class="sourceLineNo">2038</span>            int idx1 = k * ido;<a name="line.2038"></a>
<span class="sourceLineNo">2039</span>            int idx3 = 2 * idx0;<a name="line.2039"></a>
<span class="sourceLineNo">2040</span>            int idx4 = (3 * k + 1) * ido;<a name="line.2040"></a>
<span class="sourceLineNo">2041</span>            int iidx1 = in_off + idx1;<a name="line.2041"></a>
<span class="sourceLineNo">2042</span>            int iidx2 = iidx1 + idx0;<a name="line.2042"></a>
<span class="sourceLineNo">2043</span>            int iidx3 = iidx1 + idx3;<a name="line.2043"></a>
<span class="sourceLineNo">2044</span>            float i1r = in[iidx1];<a name="line.2044"></a>
<span class="sourceLineNo">2045</span>            float i2r = in[iidx2];<a name="line.2045"></a>
<span class="sourceLineNo">2046</span>            float i3r = in[iidx3];<a name="line.2046"></a>
<span class="sourceLineNo">2047</span>            cr2 = i2r + i3r;<a name="line.2047"></a>
<span class="sourceLineNo">2048</span>            out[out_off + 3 * idx1] = i1r + cr2;<a name="line.2048"></a>
<span class="sourceLineNo">2049</span>            out[out_off + idx4 + ido] = taui * (i3r - i2r);<a name="line.2049"></a>
<span class="sourceLineNo">2050</span>            out[out_off + ido - 1 + idx4] = i1r + taur * cr2;<a name="line.2050"></a>
<span class="sourceLineNo">2051</span>        }<a name="line.2051"></a>
<span class="sourceLineNo">2052</span>        if (ido == 1)<a name="line.2052"></a>
<span class="sourceLineNo">2053</span>            return;<a name="line.2053"></a>
<span class="sourceLineNo">2054</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.2054"></a>
<span class="sourceLineNo">2055</span>            int idx3 = k * ido;<a name="line.2055"></a>
<span class="sourceLineNo">2056</span>            int idx4 = 3 * idx3;<a name="line.2056"></a>
<span class="sourceLineNo">2057</span>            int idx5 = idx3 + idx0;<a name="line.2057"></a>
<span class="sourceLineNo">2058</span>            int idx6 = idx5 + idx0;<a name="line.2058"></a>
<span class="sourceLineNo">2059</span>            int idx7 = idx4 + ido;<a name="line.2059"></a>
<span class="sourceLineNo">2060</span>            int idx8 = idx7 + ido;<a name="line.2060"></a>
<span class="sourceLineNo">2061</span>            for (i = 2; i &lt; ido; i += 2) {<a name="line.2061"></a>
<span class="sourceLineNo">2062</span>                ic = ido - i;<a name="line.2062"></a>
<span class="sourceLineNo">2063</span>                int widx1 = i - 1 + iw1;<a name="line.2063"></a>
<span class="sourceLineNo">2064</span>                int widx2 = i - 1 + iw2;<a name="line.2064"></a>
<span class="sourceLineNo">2065</span><a name="line.2065"></a>
<span class="sourceLineNo">2066</span>                w1r = wtable_r[widx1 - 1];<a name="line.2066"></a>
<span class="sourceLineNo">2067</span>                w1i = wtable_r[widx1];<a name="line.2067"></a>
<span class="sourceLineNo">2068</span>                w2r = wtable_r[widx2 - 1];<a name="line.2068"></a>
<span class="sourceLineNo">2069</span>                w2i = wtable_r[widx2];<a name="line.2069"></a>
<span class="sourceLineNo">2070</span><a name="line.2070"></a>
<span class="sourceLineNo">2071</span>                int idx9 = in_off + i;<a name="line.2071"></a>
<span class="sourceLineNo">2072</span>                int idx10 = out_off + i;<a name="line.2072"></a>
<span class="sourceLineNo">2073</span>                int idx11 = out_off + ic;<a name="line.2073"></a>
<span class="sourceLineNo">2074</span>                int iidx1 = idx9 + idx3;<a name="line.2074"></a>
<span class="sourceLineNo">2075</span>                int iidx2 = idx9 + idx5;<a name="line.2075"></a>
<span class="sourceLineNo">2076</span>                int iidx3 = idx9 + idx6;<a name="line.2076"></a>
<span class="sourceLineNo">2077</span><a name="line.2077"></a>
<span class="sourceLineNo">2078</span>                float i1i = in[iidx1 - 1];<a name="line.2078"></a>
<span class="sourceLineNo">2079</span>                float i1r = in[iidx1];<a name="line.2079"></a>
<span class="sourceLineNo">2080</span>                float i2i = in[iidx2 - 1];<a name="line.2080"></a>
<span class="sourceLineNo">2081</span>                float i2r = in[iidx2];<a name="line.2081"></a>
<span class="sourceLineNo">2082</span>                float i3i = in[iidx3 - 1];<a name="line.2082"></a>
<span class="sourceLineNo">2083</span>                float i3r = in[iidx3];<a name="line.2083"></a>
<span class="sourceLineNo">2084</span><a name="line.2084"></a>
<span class="sourceLineNo">2085</span>                dr2 = w1r * i2i + w1i * i2r;<a name="line.2085"></a>
<span class="sourceLineNo">2086</span>                di2 = w1r * i2r - w1i * i2i;<a name="line.2086"></a>
<span class="sourceLineNo">2087</span>                dr3 = w2r * i3i + w2i * i3r;<a name="line.2087"></a>
<span class="sourceLineNo">2088</span>                di3 = w2r * i3r - w2i * i3i;<a name="line.2088"></a>
<span class="sourceLineNo">2089</span>                cr2 = dr2 + dr3;<a name="line.2089"></a>
<span class="sourceLineNo">2090</span>                ci2 = di2 + di3;<a name="line.2090"></a>
<span class="sourceLineNo">2091</span>                tr2 = i1i + taur * cr2;<a name="line.2091"></a>
<span class="sourceLineNo">2092</span>                ti2 = i1r + taur * ci2;<a name="line.2092"></a>
<span class="sourceLineNo">2093</span>                tr3 = taui * (di2 - di3);<a name="line.2093"></a>
<span class="sourceLineNo">2094</span>                ti3 = taui * (dr3 - dr2);<a name="line.2094"></a>
<span class="sourceLineNo">2095</span><a name="line.2095"></a>
<span class="sourceLineNo">2096</span>                int oidx1 = idx10 + idx4;<a name="line.2096"></a>
<span class="sourceLineNo">2097</span>                int oidx2 = idx11 + idx7;<a name="line.2097"></a>
<span class="sourceLineNo">2098</span>                int oidx3 = idx10 + idx8;<a name="line.2098"></a>
<span class="sourceLineNo">2099</span><a name="line.2099"></a>
<span class="sourceLineNo">2100</span>                out[oidx1 - 1] = i1i + cr2;<a name="line.2100"></a>
<span class="sourceLineNo">2101</span>                out[oidx1] = i1r + ci2;<a name="line.2101"></a>
<span class="sourceLineNo">2102</span>                out[oidx2 - 1] = tr2 - tr3;<a name="line.2102"></a>
<span class="sourceLineNo">2103</span>                out[oidx2] = ti3 - ti2;<a name="line.2103"></a>
<span class="sourceLineNo">2104</span>                out[oidx3 - 1] = tr2 + tr3;<a name="line.2104"></a>
<span class="sourceLineNo">2105</span>                out[oidx3] = ti2 + ti3;<a name="line.2105"></a>
<span class="sourceLineNo">2106</span>            }<a name="line.2106"></a>
<span class="sourceLineNo">2107</span>        }<a name="line.2107"></a>
<span class="sourceLineNo">2108</span>    }<a name="line.2108"></a>
<span class="sourceLineNo">2109</span><a name="line.2109"></a>
<span class="sourceLineNo">2110</span>    /*-------------------------------------------------<a name="line.2110"></a>
<span class="sourceLineNo">2111</span>       radb3: Real FFT's backward processing of factor 3<a name="line.2111"></a>
<span class="sourceLineNo">2112</span>      -------------------------------------------------*/<a name="line.2112"></a>
<span class="sourceLineNo">2113</span>    void radb3(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset) {<a name="line.2113"></a>
<span class="sourceLineNo">2114</span>        final float taur = -0.5f;<a name="line.2114"></a>
<span class="sourceLineNo">2115</span>        final float taui = 0.866025403784438707610604524234076962f;<a name="line.2115"></a>
<span class="sourceLineNo">2116</span>        int i, ic;<a name="line.2116"></a>
<span class="sourceLineNo">2117</span>        float ci2, ci3, di2, di3, cr2, cr3, dr2, dr3, ti2, tr2, w1r, w2r, w1i, w2i;<a name="line.2117"></a>
<span class="sourceLineNo">2118</span>        int iw1, iw2;<a name="line.2118"></a>
<span class="sourceLineNo">2119</span>        iw1 = offset;<a name="line.2119"></a>
<span class="sourceLineNo">2120</span>        iw2 = iw1 + ido;<a name="line.2120"></a>
<span class="sourceLineNo">2121</span><a name="line.2121"></a>
<span class="sourceLineNo">2122</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.2122"></a>
<span class="sourceLineNo">2123</span>            int idx1 = k * ido;<a name="line.2123"></a>
<span class="sourceLineNo">2124</span>            int iidx1 = in_off + 3 * idx1;<a name="line.2124"></a>
<span class="sourceLineNo">2125</span>            int iidx2 = iidx1 + 2 * ido;<a name="line.2125"></a>
<span class="sourceLineNo">2126</span>            float i1i = in[iidx1];<a name="line.2126"></a>
<span class="sourceLineNo">2127</span><a name="line.2127"></a>
<span class="sourceLineNo">2128</span>            tr2 = 2 * in[iidx2 - 1];<a name="line.2128"></a>
<span class="sourceLineNo">2129</span>            cr2 = i1i + taur * tr2;<a name="line.2129"></a>
<span class="sourceLineNo">2130</span>            ci3 = 2 * taui * in[iidx2];<a name="line.2130"></a>
<span class="sourceLineNo">2131</span><a name="line.2131"></a>
<span class="sourceLineNo">2132</span>            out[out_off + idx1] = i1i + tr2;<a name="line.2132"></a>
<span class="sourceLineNo">2133</span>            out[out_off + (k + l1) * ido] = cr2 - ci3;<a name="line.2133"></a>
<span class="sourceLineNo">2134</span>            out[out_off + (k + 2 * l1) * ido] = cr2 + ci3;<a name="line.2134"></a>
<span class="sourceLineNo">2135</span>        }<a name="line.2135"></a>
<span class="sourceLineNo">2136</span>        if (ido == 1)<a name="line.2136"></a>
<span class="sourceLineNo">2137</span>            return;<a name="line.2137"></a>
<span class="sourceLineNo">2138</span>        int idx0 = l1 * ido;<a name="line.2138"></a>
<span class="sourceLineNo">2139</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.2139"></a>
<span class="sourceLineNo">2140</span>            int idx1 = k * ido;<a name="line.2140"></a>
<span class="sourceLineNo">2141</span>            int idx2 = 3 * idx1;<a name="line.2141"></a>
<span class="sourceLineNo">2142</span>            int idx3 = idx2 + ido;<a name="line.2142"></a>
<span class="sourceLineNo">2143</span>            int idx4 = idx3 + ido;<a name="line.2143"></a>
<span class="sourceLineNo">2144</span>            int idx5 = idx1 + idx0;<a name="line.2144"></a>
<span class="sourceLineNo">2145</span>            int idx6 = idx5 + idx0;<a name="line.2145"></a>
<span class="sourceLineNo">2146</span>            for (i = 2; i &lt; ido; i += 2) {<a name="line.2146"></a>
<span class="sourceLineNo">2147</span>                ic = ido - i;<a name="line.2147"></a>
<span class="sourceLineNo">2148</span>                int idx7 = in_off + i;<a name="line.2148"></a>
<span class="sourceLineNo">2149</span>                int idx8 = in_off + ic;<a name="line.2149"></a>
<span class="sourceLineNo">2150</span>                int idx9 = out_off + i;<a name="line.2150"></a>
<span class="sourceLineNo">2151</span>                int iidx1 = idx7 + idx2;<a name="line.2151"></a>
<span class="sourceLineNo">2152</span>                int iidx2 = idx7 + idx4;<a name="line.2152"></a>
<span class="sourceLineNo">2153</span>                int iidx3 = idx8 + idx3;<a name="line.2153"></a>
<span class="sourceLineNo">2154</span><a name="line.2154"></a>
<span class="sourceLineNo">2155</span>                float i1i = in[iidx1 - 1];<a name="line.2155"></a>
<span class="sourceLineNo">2156</span>                float i1r = in[iidx1];<a name="line.2156"></a>
<span class="sourceLineNo">2157</span>                float i2i = in[iidx2 - 1];<a name="line.2157"></a>
<span class="sourceLineNo">2158</span>                float i2r = in[iidx2];<a name="line.2158"></a>
<span class="sourceLineNo">2159</span>                float i3i = in[iidx3 - 1];<a name="line.2159"></a>
<span class="sourceLineNo">2160</span>                float i3r = in[iidx3];<a name="line.2160"></a>
<span class="sourceLineNo">2161</span><a name="line.2161"></a>
<span class="sourceLineNo">2162</span>                tr2 = i2i + i3i;<a name="line.2162"></a>
<span class="sourceLineNo">2163</span>                cr2 = i1i + taur * tr2;<a name="line.2163"></a>
<span class="sourceLineNo">2164</span>                ti2 = i2r - i3r;<a name="line.2164"></a>
<span class="sourceLineNo">2165</span>                ci2 = i1r + taur * ti2;<a name="line.2165"></a>
<span class="sourceLineNo">2166</span>                cr3 = taui * (i2i - i3i);<a name="line.2166"></a>
<span class="sourceLineNo">2167</span>                ci3 = taui * (i2r + i3r);<a name="line.2167"></a>
<span class="sourceLineNo">2168</span>                dr2 = cr2 - ci3;<a name="line.2168"></a>
<span class="sourceLineNo">2169</span>                dr3 = cr2 + ci3;<a name="line.2169"></a>
<span class="sourceLineNo">2170</span>                di2 = ci2 + cr3;<a name="line.2170"></a>
<span class="sourceLineNo">2171</span>                di3 = ci2 - cr3;<a name="line.2171"></a>
<span class="sourceLineNo">2172</span><a name="line.2172"></a>
<span class="sourceLineNo">2173</span>                int widx1 = i - 1 + iw1;<a name="line.2173"></a>
<span class="sourceLineNo">2174</span>                int widx2 = i - 1 + iw2;<a name="line.2174"></a>
<span class="sourceLineNo">2175</span><a name="line.2175"></a>
<span class="sourceLineNo">2176</span>                w1r = wtable_r[widx1 - 1];<a name="line.2176"></a>
<span class="sourceLineNo">2177</span>                w1i = wtable_r[widx1];<a name="line.2177"></a>
<span class="sourceLineNo">2178</span>                w2r = wtable_r[widx2 - 1];<a name="line.2178"></a>
<span class="sourceLineNo">2179</span>                w2i = wtable_r[widx2];<a name="line.2179"></a>
<span class="sourceLineNo">2180</span><a name="line.2180"></a>
<span class="sourceLineNo">2181</span>                int oidx1 = idx9 + idx1;<a name="line.2181"></a>
<span class="sourceLineNo">2182</span>                int oidx2 = idx9 + idx5;<a name="line.2182"></a>
<span class="sourceLineNo">2183</span>                int oidx3 = idx9 + idx6;<a name="line.2183"></a>
<span class="sourceLineNo">2184</span><a name="line.2184"></a>
<span class="sourceLineNo">2185</span>                out[oidx1 - 1] = i1i + tr2;<a name="line.2185"></a>
<span class="sourceLineNo">2186</span>                out[oidx1] = i1r + ti2;<a name="line.2186"></a>
<span class="sourceLineNo">2187</span>                out[oidx2 - 1] = w1r * dr2 - w1i * di2;<a name="line.2187"></a>
<span class="sourceLineNo">2188</span>                out[oidx2] = w1r * di2 + w1i * dr2;<a name="line.2188"></a>
<span class="sourceLineNo">2189</span>                out[oidx3 - 1] = w2r * dr3 - w2i * di3;<a name="line.2189"></a>
<span class="sourceLineNo">2190</span>                out[oidx3] = w2r * di3 + w2i * dr3;<a name="line.2190"></a>
<span class="sourceLineNo">2191</span>            }<a name="line.2191"></a>
<span class="sourceLineNo">2192</span>        }<a name="line.2192"></a>
<span class="sourceLineNo">2193</span>    }<a name="line.2193"></a>
<span class="sourceLineNo">2194</span><a name="line.2194"></a>
<span class="sourceLineNo">2195</span>    /*-------------------------------------------------<a name="line.2195"></a>
<span class="sourceLineNo">2196</span>       radf4: Real FFT's forward processing of factor 4<a name="line.2196"></a>
<span class="sourceLineNo">2197</span>      -------------------------------------------------*/<a name="line.2197"></a>
<span class="sourceLineNo">2198</span>    void radf4(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset) {<a name="line.2198"></a>
<span class="sourceLineNo">2199</span>        final float hsqt2 = 0.707106781186547572737310929369414225f;<a name="line.2199"></a>
<span class="sourceLineNo">2200</span>        int i, ic;<a name="line.2200"></a>
<span class="sourceLineNo">2201</span>        float ci2, ci3, ci4, cr2, cr3, cr4, ti1, ti2, ti3, ti4, tr1, tr2, tr3, tr4, w1r, w1i, w2r, w2i, w3r, w3i;<a name="line.2201"></a>
<span class="sourceLineNo">2202</span>        int iw1, iw2, iw3;<a name="line.2202"></a>
<span class="sourceLineNo">2203</span>        iw1 = offset;<a name="line.2203"></a>
<span class="sourceLineNo">2204</span>        iw2 = offset + ido;<a name="line.2204"></a>
<span class="sourceLineNo">2205</span>        iw3 = iw2 + ido;<a name="line.2205"></a>
<span class="sourceLineNo">2206</span>        int idx0 = l1 * ido;<a name="line.2206"></a>
<span class="sourceLineNo">2207</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.2207"></a>
<span class="sourceLineNo">2208</span>            int idx1 = k * ido;<a name="line.2208"></a>
<span class="sourceLineNo">2209</span>            int idx2 = 4 * idx1;<a name="line.2209"></a>
<span class="sourceLineNo">2210</span>            int idx3 = idx1 + idx0;<a name="line.2210"></a>
<span class="sourceLineNo">2211</span>            int idx4 = idx3 + idx0;<a name="line.2211"></a>
<span class="sourceLineNo">2212</span>            int idx5 = idx4 + idx0;<a name="line.2212"></a>
<span class="sourceLineNo">2213</span>            int idx6 = idx2 + ido;<a name="line.2213"></a>
<span class="sourceLineNo">2214</span>            float i1r = in[in_off + idx1];<a name="line.2214"></a>
<span class="sourceLineNo">2215</span>            float i2r = in[in_off + idx3];<a name="line.2215"></a>
<span class="sourceLineNo">2216</span>            float i3r = in[in_off + idx4];<a name="line.2216"></a>
<span class="sourceLineNo">2217</span>            float i4r = in[in_off + idx5];<a name="line.2217"></a>
<span class="sourceLineNo">2218</span><a name="line.2218"></a>
<span class="sourceLineNo">2219</span>            tr1 = i2r + i4r;<a name="line.2219"></a>
<span class="sourceLineNo">2220</span>            tr2 = i1r + i3r;<a name="line.2220"></a>
<span class="sourceLineNo">2221</span><a name="line.2221"></a>
<span class="sourceLineNo">2222</span>            int oidx1 = out_off + idx2;<a name="line.2222"></a>
<span class="sourceLineNo">2223</span>            int oidx2 = out_off + idx6 + ido;<a name="line.2223"></a>
<span class="sourceLineNo">2224</span><a name="line.2224"></a>
<span class="sourceLineNo">2225</span>            out[oidx1] = tr1 + tr2;<a name="line.2225"></a>
<span class="sourceLineNo">2226</span>            out[oidx2 - 1 + ido + ido] = tr2 - tr1;<a name="line.2226"></a>
<span class="sourceLineNo">2227</span>            out[oidx2 - 1] = i1r - i3r;<a name="line.2227"></a>
<span class="sourceLineNo">2228</span>            out[oidx2] = i4r - i2r;<a name="line.2228"></a>
<span class="sourceLineNo">2229</span>        }<a name="line.2229"></a>
<span class="sourceLineNo">2230</span>        if (ido &lt; 2)<a name="line.2230"></a>
<span class="sourceLineNo">2231</span>            return;<a name="line.2231"></a>
<span class="sourceLineNo">2232</span>        if (ido != 2) {<a name="line.2232"></a>
<span class="sourceLineNo">2233</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.2233"></a>
<span class="sourceLineNo">2234</span>                int idx1 = k * ido;<a name="line.2234"></a>
<span class="sourceLineNo">2235</span>                int idx2 = idx1 + idx0;<a name="line.2235"></a>
<span class="sourceLineNo">2236</span>                int idx3 = idx2 + idx0;<a name="line.2236"></a>
<span class="sourceLineNo">2237</span>                int idx4 = idx3 + idx0;<a name="line.2237"></a>
<span class="sourceLineNo">2238</span>                int idx5 = 4 * idx1;<a name="line.2238"></a>
<span class="sourceLineNo">2239</span>                int idx6 = idx5 + ido;<a name="line.2239"></a>
<span class="sourceLineNo">2240</span>                int idx7 = idx6 + ido;<a name="line.2240"></a>
<span class="sourceLineNo">2241</span>                int idx8 = idx7 + ido;<a name="line.2241"></a>
<span class="sourceLineNo">2242</span>                for (i = 2; i &lt; ido; i += 2) {<a name="line.2242"></a>
<span class="sourceLineNo">2243</span>                    ic = ido - i;<a name="line.2243"></a>
<span class="sourceLineNo">2244</span>                    int widx1 = i - 1 + iw1;<a name="line.2244"></a>
<span class="sourceLineNo">2245</span>                    int widx2 = i - 1 + iw2;<a name="line.2245"></a>
<span class="sourceLineNo">2246</span>                    int widx3 = i - 1 + iw3;<a name="line.2246"></a>
<span class="sourceLineNo">2247</span>                    w1r = wtable_r[widx1 - 1];<a name="line.2247"></a>
<span class="sourceLineNo">2248</span>                    w1i = wtable_r[widx1];<a name="line.2248"></a>
<span class="sourceLineNo">2249</span>                    w2r = wtable_r[widx2 - 1];<a name="line.2249"></a>
<span class="sourceLineNo">2250</span>                    w2i = wtable_r[widx2];<a name="line.2250"></a>
<span class="sourceLineNo">2251</span>                    w3r = wtable_r[widx3 - 1];<a name="line.2251"></a>
<span class="sourceLineNo">2252</span>                    w3i = wtable_r[widx3];<a name="line.2252"></a>
<span class="sourceLineNo">2253</span><a name="line.2253"></a>
<span class="sourceLineNo">2254</span>                    int idx9 = in_off + i;<a name="line.2254"></a>
<span class="sourceLineNo">2255</span>                    int idx10 = out_off + i;<a name="line.2255"></a>
<span class="sourceLineNo">2256</span>                    int idx11 = out_off + ic;<a name="line.2256"></a>
<span class="sourceLineNo">2257</span>                    int iidx1 = idx9 + idx1;<a name="line.2257"></a>
<span class="sourceLineNo">2258</span>                    int iidx2 = idx9 + idx2;<a name="line.2258"></a>
<span class="sourceLineNo">2259</span>                    int iidx3 = idx9 + idx3;<a name="line.2259"></a>
<span class="sourceLineNo">2260</span>                    int iidx4 = idx9 + idx4;<a name="line.2260"></a>
<span class="sourceLineNo">2261</span><a name="line.2261"></a>
<span class="sourceLineNo">2262</span>                    float i1i = in[iidx1 - 1];<a name="line.2262"></a>
<span class="sourceLineNo">2263</span>                    float i1r = in[iidx1];<a name="line.2263"></a>
<span class="sourceLineNo">2264</span>                    float i2i = in[iidx2 - 1];<a name="line.2264"></a>
<span class="sourceLineNo">2265</span>                    float i2r = in[iidx2];<a name="line.2265"></a>
<span class="sourceLineNo">2266</span>                    float i3i = in[iidx3 - 1];<a name="line.2266"></a>
<span class="sourceLineNo">2267</span>                    float i3r = in[iidx3];<a name="line.2267"></a>
<span class="sourceLineNo">2268</span>                    float i4i = in[iidx4 - 1];<a name="line.2268"></a>
<span class="sourceLineNo">2269</span>                    float i4r = in[iidx4];<a name="line.2269"></a>
<span class="sourceLineNo">2270</span><a name="line.2270"></a>
<span class="sourceLineNo">2271</span>                    cr2 = w1r * i2i + w1i * i2r;<a name="line.2271"></a>
<span class="sourceLineNo">2272</span>                    ci2 = w1r * i2r - w1i * i2i;<a name="line.2272"></a>
<span class="sourceLineNo">2273</span>                    cr3 = w2r * i3i + w2i * i3r;<a name="line.2273"></a>
<span class="sourceLineNo">2274</span>                    ci3 = w2r * i3r - w2i * i3i;<a name="line.2274"></a>
<span class="sourceLineNo">2275</span>                    cr4 = w3r * i4i + w3i * i4r;<a name="line.2275"></a>
<span class="sourceLineNo">2276</span>                    ci4 = w3r * i4r - w3i * i4i;<a name="line.2276"></a>
<span class="sourceLineNo">2277</span>                    tr1 = cr2 + cr4;<a name="line.2277"></a>
<span class="sourceLineNo">2278</span>                    tr4 = cr4 - cr2;<a name="line.2278"></a>
<span class="sourceLineNo">2279</span>                    ti1 = ci2 + ci4;<a name="line.2279"></a>
<span class="sourceLineNo">2280</span>                    ti4 = ci2 - ci4;<a name="line.2280"></a>
<span class="sourceLineNo">2281</span>                    ti2 = i1r + ci3;<a name="line.2281"></a>
<span class="sourceLineNo">2282</span>                    ti3 = i1r - ci3;<a name="line.2282"></a>
<span class="sourceLineNo">2283</span>                    tr2 = i1i + cr3;<a name="line.2283"></a>
<span class="sourceLineNo">2284</span>                    tr3 = i1i - cr3;<a name="line.2284"></a>
<span class="sourceLineNo">2285</span><a name="line.2285"></a>
<span class="sourceLineNo">2286</span>                    int oidx1 = idx10 + idx5;<a name="line.2286"></a>
<span class="sourceLineNo">2287</span>                    int oidx2 = idx11 + idx6;<a name="line.2287"></a>
<span class="sourceLineNo">2288</span>                    int oidx3 = idx10 + idx7;<a name="line.2288"></a>
<span class="sourceLineNo">2289</span>                    int oidx4 = idx11 + idx8;<a name="line.2289"></a>
<span class="sourceLineNo">2290</span><a name="line.2290"></a>
<span class="sourceLineNo">2291</span>                    out[oidx1 - 1] = tr1 + tr2;<a name="line.2291"></a>
<span class="sourceLineNo">2292</span>                    out[oidx4 - 1] = tr2 - tr1;<a name="line.2292"></a>
<span class="sourceLineNo">2293</span>                    out[oidx1] = ti1 + ti2;<a name="line.2293"></a>
<span class="sourceLineNo">2294</span>                    out[oidx4] = ti1 - ti2;<a name="line.2294"></a>
<span class="sourceLineNo">2295</span>                    out[oidx3 - 1] = ti4 + tr3;<a name="line.2295"></a>
<span class="sourceLineNo">2296</span>                    out[oidx2 - 1] = tr3 - ti4;<a name="line.2296"></a>
<span class="sourceLineNo">2297</span>                    out[oidx3] = tr4 + ti3;<a name="line.2297"></a>
<span class="sourceLineNo">2298</span>                    out[oidx2] = tr4 - ti3;<a name="line.2298"></a>
<span class="sourceLineNo">2299</span>                }<a name="line.2299"></a>
<span class="sourceLineNo">2300</span>            }<a name="line.2300"></a>
<span class="sourceLineNo">2301</span>            if (ido % 2 == 1)<a name="line.2301"></a>
<span class="sourceLineNo">2302</span>                return;<a name="line.2302"></a>
<span class="sourceLineNo">2303</span>        }<a name="line.2303"></a>
<span class="sourceLineNo">2304</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.2304"></a>
<span class="sourceLineNo">2305</span>            int idx1 = k * ido;<a name="line.2305"></a>
<span class="sourceLineNo">2306</span>            int idx2 = 4 * idx1;<a name="line.2306"></a>
<span class="sourceLineNo">2307</span>            int idx3 = idx1 + idx0;<a name="line.2307"></a>
<span class="sourceLineNo">2308</span>            int idx4 = idx3 + idx0;<a name="line.2308"></a>
<span class="sourceLineNo">2309</span>            int idx5 = idx4 + idx0;<a name="line.2309"></a>
<span class="sourceLineNo">2310</span>            int idx6 = idx2 + ido;<a name="line.2310"></a>
<span class="sourceLineNo">2311</span>            int idx7 = idx6 + ido;<a name="line.2311"></a>
<span class="sourceLineNo">2312</span>            int idx8 = idx7 + ido;<a name="line.2312"></a>
<span class="sourceLineNo">2313</span>            int idx9 = in_off + ido;<a name="line.2313"></a>
<span class="sourceLineNo">2314</span>            int idx10 = out_off + ido;<a name="line.2314"></a>
<span class="sourceLineNo">2315</span><a name="line.2315"></a>
<span class="sourceLineNo">2316</span>            float i1i = in[idx9 - 1 + idx1];<a name="line.2316"></a>
<span class="sourceLineNo">2317</span>            float i2i = in[idx9 - 1 + idx3];<a name="line.2317"></a>
<span class="sourceLineNo">2318</span>            float i3i = in[idx9 - 1 + idx4];<a name="line.2318"></a>
<span class="sourceLineNo">2319</span>            float i4i = in[idx9 - 1 + idx5];<a name="line.2319"></a>
<span class="sourceLineNo">2320</span><a name="line.2320"></a>
<span class="sourceLineNo">2321</span>            ti1 = -hsqt2 * (i2i + i4i);<a name="line.2321"></a>
<span class="sourceLineNo">2322</span>            tr1 = hsqt2 * (i2i - i4i);<a name="line.2322"></a>
<span class="sourceLineNo">2323</span><a name="line.2323"></a>
<span class="sourceLineNo">2324</span>            out[idx10 - 1 + idx2] = tr1 + i1i;<a name="line.2324"></a>
<span class="sourceLineNo">2325</span>            out[idx10 - 1 + idx7] = i1i - tr1;<a name="line.2325"></a>
<span class="sourceLineNo">2326</span>            out[out_off + idx6] = ti1 - i3i;<a name="line.2326"></a>
<span class="sourceLineNo">2327</span>            out[out_off + idx8] = ti1 + i3i;<a name="line.2327"></a>
<span class="sourceLineNo">2328</span>        }<a name="line.2328"></a>
<span class="sourceLineNo">2329</span>    }<a name="line.2329"></a>
<span class="sourceLineNo">2330</span><a name="line.2330"></a>
<span class="sourceLineNo">2331</span>    /*-------------------------------------------------<a name="line.2331"></a>
<span class="sourceLineNo">2332</span>       radb4: Real FFT's backward processing of factor 4<a name="line.2332"></a>
<span class="sourceLineNo">2333</span>      -------------------------------------------------*/<a name="line.2333"></a>
<span class="sourceLineNo">2334</span>    void radb4(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset) {<a name="line.2334"></a>
<span class="sourceLineNo">2335</span>        final float sqrt2 = 1.41421356237309514547462185873882845f;<a name="line.2335"></a>
<span class="sourceLineNo">2336</span>        int i, ic;<a name="line.2336"></a>
<span class="sourceLineNo">2337</span>        float ci2, ci3, ci4, cr2, cr3, cr4;<a name="line.2337"></a>
<span class="sourceLineNo">2338</span>        float ti1, ti2, ti3, ti4, tr1, tr2, tr3, tr4, w1r, w1i, w2r, w2i, w3r, w3i;<a name="line.2338"></a>
<span class="sourceLineNo">2339</span>        int iw1, iw2, iw3;<a name="line.2339"></a>
<span class="sourceLineNo">2340</span>        iw1 = offset;<a name="line.2340"></a>
<span class="sourceLineNo">2341</span>        iw2 = iw1 + ido;<a name="line.2341"></a>
<span class="sourceLineNo">2342</span>        iw3 = iw2 + ido;<a name="line.2342"></a>
<span class="sourceLineNo">2343</span><a name="line.2343"></a>
<span class="sourceLineNo">2344</span>        int idx0 = l1 * ido;<a name="line.2344"></a>
<span class="sourceLineNo">2345</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.2345"></a>
<span class="sourceLineNo">2346</span>            int idx1 = k * ido;<a name="line.2346"></a>
<span class="sourceLineNo">2347</span>            int idx2 = 4 * idx1;<a name="line.2347"></a>
<span class="sourceLineNo">2348</span>            int idx3 = idx1 + idx0;<a name="line.2348"></a>
<span class="sourceLineNo">2349</span>            int idx4 = idx3 + idx0;<a name="line.2349"></a>
<span class="sourceLineNo">2350</span>            int idx5 = idx4 + idx0;<a name="line.2350"></a>
<span class="sourceLineNo">2351</span>            int idx6 = idx2 + ido;<a name="line.2351"></a>
<span class="sourceLineNo">2352</span>            int idx7 = idx6 + ido;<a name="line.2352"></a>
<span class="sourceLineNo">2353</span>            int idx8 = idx7 + ido;<a name="line.2353"></a>
<span class="sourceLineNo">2354</span><a name="line.2354"></a>
<span class="sourceLineNo">2355</span>            float i1r = in[in_off + idx2];<a name="line.2355"></a>
<span class="sourceLineNo">2356</span>            float i2r = in[in_off + idx7];<a name="line.2356"></a>
<span class="sourceLineNo">2357</span>            float i3r = in[in_off + ido - 1 + idx8];<a name="line.2357"></a>
<span class="sourceLineNo">2358</span>            float i4r = in[in_off + ido - 1 + idx6];<a name="line.2358"></a>
<span class="sourceLineNo">2359</span><a name="line.2359"></a>
<span class="sourceLineNo">2360</span>            tr1 = i1r - i3r;<a name="line.2360"></a>
<span class="sourceLineNo">2361</span>            tr2 = i1r + i3r;<a name="line.2361"></a>
<span class="sourceLineNo">2362</span>            tr3 = i4r + i4r;<a name="line.2362"></a>
<span class="sourceLineNo">2363</span>            tr4 = i2r + i2r;<a name="line.2363"></a>
<span class="sourceLineNo">2364</span><a name="line.2364"></a>
<span class="sourceLineNo">2365</span>            out[out_off + idx1] = tr2 + tr3;<a name="line.2365"></a>
<span class="sourceLineNo">2366</span>            out[out_off + idx3] = tr1 - tr4;<a name="line.2366"></a>
<span class="sourceLineNo">2367</span>            out[out_off + idx4] = tr2 - tr3;<a name="line.2367"></a>
<span class="sourceLineNo">2368</span>            out[out_off + idx5] = tr1 + tr4;<a name="line.2368"></a>
<span class="sourceLineNo">2369</span>        }<a name="line.2369"></a>
<span class="sourceLineNo">2370</span>        if (ido &lt; 2)<a name="line.2370"></a>
<span class="sourceLineNo">2371</span>            return;<a name="line.2371"></a>
<span class="sourceLineNo">2372</span>        if (ido != 2) {<a name="line.2372"></a>
<span class="sourceLineNo">2373</span>            for (int k = 0; k &lt; l1; ++k) {<a name="line.2373"></a>
<span class="sourceLineNo">2374</span>                int idx1 = k * ido;<a name="line.2374"></a>
<span class="sourceLineNo">2375</span>                int idx2 = idx1 + idx0;<a name="line.2375"></a>
<span class="sourceLineNo">2376</span>                int idx3 = idx2 + idx0;<a name="line.2376"></a>
<span class="sourceLineNo">2377</span>                int idx4 = idx3 + idx0;<a name="line.2377"></a>
<span class="sourceLineNo">2378</span>                int idx5 = 4 * idx1;<a name="line.2378"></a>
<span class="sourceLineNo">2379</span>                int idx6 = idx5 + ido;<a name="line.2379"></a>
<span class="sourceLineNo">2380</span>                int idx7 = idx6 + ido;<a name="line.2380"></a>
<span class="sourceLineNo">2381</span>                int idx8 = idx7 + ido;<a name="line.2381"></a>
<span class="sourceLineNo">2382</span>                for (i = 2; i &lt; ido; i += 2) {<a name="line.2382"></a>
<span class="sourceLineNo">2383</span>                    ic = ido - i;<a name="line.2383"></a>
<span class="sourceLineNo">2384</span>                    int widx1 = i - 1 + iw1;<a name="line.2384"></a>
<span class="sourceLineNo">2385</span>                    int widx2 = i - 1 + iw2;<a name="line.2385"></a>
<span class="sourceLineNo">2386</span>                    int widx3 = i - 1 + iw3;<a name="line.2386"></a>
<span class="sourceLineNo">2387</span>                    w1r = wtable_r[widx1 - 1];<a name="line.2387"></a>
<span class="sourceLineNo">2388</span>                    w1i = wtable_r[widx1];<a name="line.2388"></a>
<span class="sourceLineNo">2389</span>                    w2r = wtable_r[widx2 - 1];<a name="line.2389"></a>
<span class="sourceLineNo">2390</span>                    w2i = wtable_r[widx2];<a name="line.2390"></a>
<span class="sourceLineNo">2391</span>                    w3r = wtable_r[widx3 - 1];<a name="line.2391"></a>
<span class="sourceLineNo">2392</span>                    w3i = wtable_r[widx3];<a name="line.2392"></a>
<span class="sourceLineNo">2393</span><a name="line.2393"></a>
<span class="sourceLineNo">2394</span>                    int idx12 = in_off + i;<a name="line.2394"></a>
<span class="sourceLineNo">2395</span>                    int idx13 = in_off + ic;<a name="line.2395"></a>
<span class="sourceLineNo">2396</span>                    int idx14 = out_off + i;<a name="line.2396"></a>
<span class="sourceLineNo">2397</span><a name="line.2397"></a>
<span class="sourceLineNo">2398</span>                    int iidx1 = idx12 + idx5;<a name="line.2398"></a>
<span class="sourceLineNo">2399</span>                    int iidx2 = idx13 + idx6;<a name="line.2399"></a>
<span class="sourceLineNo">2400</span>                    int iidx3 = idx12 + idx7;<a name="line.2400"></a>
<span class="sourceLineNo">2401</span>                    int iidx4 = idx13 + idx8;<a name="line.2401"></a>
<span class="sourceLineNo">2402</span><a name="line.2402"></a>
<span class="sourceLineNo">2403</span>                    float i1i = in[iidx1 - 1];<a name="line.2403"></a>
<span class="sourceLineNo">2404</span>                    float i1r = in[iidx1];<a name="line.2404"></a>
<span class="sourceLineNo">2405</span>                    float i2i = in[iidx2 - 1];<a name="line.2405"></a>
<span class="sourceLineNo">2406</span>                    float i2r = in[iidx2];<a name="line.2406"></a>
<span class="sourceLineNo">2407</span>                    float i3i = in[iidx3 - 1];<a name="line.2407"></a>
<span class="sourceLineNo">2408</span>                    float i3r = in[iidx3];<a name="line.2408"></a>
<span class="sourceLineNo">2409</span>                    float i4i = in[iidx4 - 1];<a name="line.2409"></a>
<span class="sourceLineNo">2410</span>                    float i4r = in[iidx4];<a name="line.2410"></a>
<span class="sourceLineNo">2411</span><a name="line.2411"></a>
<span class="sourceLineNo">2412</span>                    ti1 = i1r + i4r;<a name="line.2412"></a>
<span class="sourceLineNo">2413</span>                    ti2 = i1r - i4r;<a name="line.2413"></a>
<span class="sourceLineNo">2414</span>                    ti3 = i3r - i2r;<a name="line.2414"></a>
<span class="sourceLineNo">2415</span>                    tr4 = i3r + i2r;<a name="line.2415"></a>
<span class="sourceLineNo">2416</span>                    tr1 = i1i - i4i;<a name="line.2416"></a>
<span class="sourceLineNo">2417</span>                    tr2 = i1i + i4i;<a name="line.2417"></a>
<span class="sourceLineNo">2418</span>                    ti4 = i3i - i2i;<a name="line.2418"></a>
<span class="sourceLineNo">2419</span>                    tr3 = i3i + i2i;<a name="line.2419"></a>
<span class="sourceLineNo">2420</span>                    cr3 = tr2 - tr3;<a name="line.2420"></a>
<span class="sourceLineNo">2421</span>                    ci3 = ti2 - ti3;<a name="line.2421"></a>
<span class="sourceLineNo">2422</span>                    cr2 = tr1 - tr4;<a name="line.2422"></a>
<span class="sourceLineNo">2423</span>                    cr4 = tr1 + tr4;<a name="line.2423"></a>
<span class="sourceLineNo">2424</span>                    ci2 = ti1 + ti4;<a name="line.2424"></a>
<span class="sourceLineNo">2425</span>                    ci4 = ti1 - ti4;<a name="line.2425"></a>
<span class="sourceLineNo">2426</span><a name="line.2426"></a>
<span class="sourceLineNo">2427</span>                    int oidx1 = idx14 + idx1;<a name="line.2427"></a>
<span class="sourceLineNo">2428</span>                    int oidx2 = idx14 + idx2;<a name="line.2428"></a>
<span class="sourceLineNo">2429</span>                    int oidx3 = idx14 + idx3;<a name="line.2429"></a>
<span class="sourceLineNo">2430</span>                    int oidx4 = idx14 + idx4;<a name="line.2430"></a>
<span class="sourceLineNo">2431</span><a name="line.2431"></a>
<span class="sourceLineNo">2432</span>                    out[oidx1 - 1] = tr2 + tr3;<a name="line.2432"></a>
<span class="sourceLineNo">2433</span>                    out[oidx1] = ti2 + ti3;<a name="line.2433"></a>
<span class="sourceLineNo">2434</span>                    out[oidx2 - 1] = w1r * cr2 - w1i * ci2;<a name="line.2434"></a>
<span class="sourceLineNo">2435</span>                    out[oidx2] = w1r * ci2 + w1i * cr2;<a name="line.2435"></a>
<span class="sourceLineNo">2436</span>                    out[oidx3 - 1] = w2r * cr3 - w2i * ci3;<a name="line.2436"></a>
<span class="sourceLineNo">2437</span>                    out[oidx3] = w2r * ci3 + w2i * cr3;<a name="line.2437"></a>
<span class="sourceLineNo">2438</span>                    out[oidx4 - 1] = w3r * cr4 - w3i * ci4;<a name="line.2438"></a>
<span class="sourceLineNo">2439</span>                    out[oidx4] = w3r * ci4 + w3i * cr4;<a name="line.2439"></a>
<span class="sourceLineNo">2440</span>                }<a name="line.2440"></a>
<span class="sourceLineNo">2441</span>            }<a name="line.2441"></a>
<span class="sourceLineNo">2442</span>            if (ido % 2 == 1)<a name="line.2442"></a>
<span class="sourceLineNo">2443</span>                return;<a name="line.2443"></a>
<span class="sourceLineNo">2444</span>        }<a name="line.2444"></a>
<span class="sourceLineNo">2445</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.2445"></a>
<span class="sourceLineNo">2446</span>            int idx1 = k * ido;<a name="line.2446"></a>
<span class="sourceLineNo">2447</span>            int idx2 = 4 * idx1;<a name="line.2447"></a>
<span class="sourceLineNo">2448</span>            int idx3 = idx1 + idx0;<a name="line.2448"></a>
<span class="sourceLineNo">2449</span>            int idx4 = idx3 + idx0;<a name="line.2449"></a>
<span class="sourceLineNo">2450</span>            int idx5 = idx4 + idx0;<a name="line.2450"></a>
<span class="sourceLineNo">2451</span>            int idx6 = idx2 + ido;<a name="line.2451"></a>
<span class="sourceLineNo">2452</span>            int idx7 = idx6 + ido;<a name="line.2452"></a>
<span class="sourceLineNo">2453</span>            int idx8 = idx7 + ido;<a name="line.2453"></a>
<span class="sourceLineNo">2454</span>            int idx9 = in_off + ido;<a name="line.2454"></a>
<span class="sourceLineNo">2455</span>            int idx10 = out_off + ido;<a name="line.2455"></a>
<span class="sourceLineNo">2456</span><a name="line.2456"></a>
<span class="sourceLineNo">2457</span>            float i1r = in[idx9 - 1 + idx2];<a name="line.2457"></a>
<span class="sourceLineNo">2458</span>            float i2r = in[idx9 - 1 + idx7];<a name="line.2458"></a>
<span class="sourceLineNo">2459</span>            float i3r = in[in_off + idx6];<a name="line.2459"></a>
<span class="sourceLineNo">2460</span>            float i4r = in[in_off + idx8];<a name="line.2460"></a>
<span class="sourceLineNo">2461</span><a name="line.2461"></a>
<span class="sourceLineNo">2462</span>            ti1 = i3r + i4r;<a name="line.2462"></a>
<span class="sourceLineNo">2463</span>            ti2 = i4r - i3r;<a name="line.2463"></a>
<span class="sourceLineNo">2464</span>            tr1 = i1r - i2r;<a name="line.2464"></a>
<span class="sourceLineNo">2465</span>            tr2 = i1r + i2r;<a name="line.2465"></a>
<span class="sourceLineNo">2466</span><a name="line.2466"></a>
<span class="sourceLineNo">2467</span>            out[idx10 - 1 + idx1] = tr2 + tr2;<a name="line.2467"></a>
<span class="sourceLineNo">2468</span>            out[idx10 - 1 + idx3] = sqrt2 * (tr1 - ti1);<a name="line.2468"></a>
<span class="sourceLineNo">2469</span>            out[idx10 - 1 + idx4] = ti2 + ti2;<a name="line.2469"></a>
<span class="sourceLineNo">2470</span>            out[idx10 - 1 + idx5] = -sqrt2 * (tr1 + ti1);<a name="line.2470"></a>
<span class="sourceLineNo">2471</span>        }<a name="line.2471"></a>
<span class="sourceLineNo">2472</span>    }<a name="line.2472"></a>
<span class="sourceLineNo">2473</span><a name="line.2473"></a>
<span class="sourceLineNo">2474</span>    /*-------------------------------------------------<a name="line.2474"></a>
<span class="sourceLineNo">2475</span>       radf5: Real FFT's forward processing of factor 5<a name="line.2475"></a>
<span class="sourceLineNo">2476</span>      -------------------------------------------------*/<a name="line.2476"></a>
<span class="sourceLineNo">2477</span>    void radf5(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset) {<a name="line.2477"></a>
<span class="sourceLineNo">2478</span>        final float tr11 = 0.309016994374947451262869435595348477f;<a name="line.2478"></a>
<span class="sourceLineNo">2479</span>        final float ti11 = 0.951056516295153531181938433292089030f;<a name="line.2479"></a>
<span class="sourceLineNo">2480</span>        final float tr12 = -0.809016994374947340240566973079694435f;<a name="line.2480"></a>
<span class="sourceLineNo">2481</span>        final float ti12 = 0.587785252292473248125759255344746634f;<a name="line.2481"></a>
<span class="sourceLineNo">2482</span>        int i, ic;<a name="line.2482"></a>
<span class="sourceLineNo">2483</span>        float ci2, di2, ci4, ci5, di3, di4, di5, ci3, cr2, cr3, dr2, dr3, dr4, dr5, cr5, cr4, ti2, ti3, ti5, ti4, tr2, tr3, tr4, tr5, w1r, w1i, w2r, w2i, w3r, w3i, w4r, w4i;<a name="line.2483"></a>
<span class="sourceLineNo">2484</span>        int iw1, iw2, iw3, iw4;<a name="line.2484"></a>
<span class="sourceLineNo">2485</span>        iw1 = offset;<a name="line.2485"></a>
<span class="sourceLineNo">2486</span>        iw2 = iw1 + ido;<a name="line.2486"></a>
<span class="sourceLineNo">2487</span>        iw3 = iw2 + ido;<a name="line.2487"></a>
<span class="sourceLineNo">2488</span>        iw4 = iw3 + ido;<a name="line.2488"></a>
<span class="sourceLineNo">2489</span><a name="line.2489"></a>
<span class="sourceLineNo">2490</span>        int idx0 = l1 * ido;<a name="line.2490"></a>
<span class="sourceLineNo">2491</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.2491"></a>
<span class="sourceLineNo">2492</span>            int idx1 = k * ido;<a name="line.2492"></a>
<span class="sourceLineNo">2493</span>            int idx2 = 5 * idx1;<a name="line.2493"></a>
<span class="sourceLineNo">2494</span>            int idx3 = idx2 + ido;<a name="line.2494"></a>
<span class="sourceLineNo">2495</span>            int idx4 = idx3 + ido;<a name="line.2495"></a>
<span class="sourceLineNo">2496</span>            int idx5 = idx4 + ido;<a name="line.2496"></a>
<span class="sourceLineNo">2497</span>            int idx6 = idx5 + ido;<a name="line.2497"></a>
<span class="sourceLineNo">2498</span>            int idx7 = idx1 + idx0;<a name="line.2498"></a>
<span class="sourceLineNo">2499</span>            int idx8 = idx7 + idx0;<a name="line.2499"></a>
<span class="sourceLineNo">2500</span>            int idx9 = idx8 + idx0;<a name="line.2500"></a>
<span class="sourceLineNo">2501</span>            int idx10 = idx9 + idx0;<a name="line.2501"></a>
<span class="sourceLineNo">2502</span>            int idx11 = out_off + ido - 1;<a name="line.2502"></a>
<span class="sourceLineNo">2503</span><a name="line.2503"></a>
<span class="sourceLineNo">2504</span>            float i1r = in[in_off + idx1];<a name="line.2504"></a>
<span class="sourceLineNo">2505</span>            float i2r = in[in_off + idx7];<a name="line.2505"></a>
<span class="sourceLineNo">2506</span>            float i3r = in[in_off + idx8];<a name="line.2506"></a>
<span class="sourceLineNo">2507</span>            float i4r = in[in_off + idx9];<a name="line.2507"></a>
<span class="sourceLineNo">2508</span>            float i5r = in[in_off + idx10];<a name="line.2508"></a>
<span class="sourceLineNo">2509</span><a name="line.2509"></a>
<span class="sourceLineNo">2510</span>            cr2 = i5r + i2r;<a name="line.2510"></a>
<span class="sourceLineNo">2511</span>            ci5 = i5r - i2r;<a name="line.2511"></a>
<span class="sourceLineNo">2512</span>            cr3 = i4r + i3r;<a name="line.2512"></a>
<span class="sourceLineNo">2513</span>            ci4 = i4r - i3r;<a name="line.2513"></a>
<span class="sourceLineNo">2514</span><a name="line.2514"></a>
<span class="sourceLineNo">2515</span>            out[out_off + idx2] = i1r + cr2 + cr3;<a name="line.2515"></a>
<span class="sourceLineNo">2516</span>            out[idx11 + idx3] = i1r + tr11 * cr2 + tr12 * cr3;<a name="line.2516"></a>
<span class="sourceLineNo">2517</span>            out[out_off + idx4] = ti11 * ci5 + ti12 * ci4;<a name="line.2517"></a>
<span class="sourceLineNo">2518</span>            out[idx11 + idx5] = i1r + tr12 * cr2 + tr11 * cr3;<a name="line.2518"></a>
<span class="sourceLineNo">2519</span>            out[out_off + idx6] = ti12 * ci5 - ti11 * ci4;<a name="line.2519"></a>
<span class="sourceLineNo">2520</span>        }<a name="line.2520"></a>
<span class="sourceLineNo">2521</span>        if (ido == 1)<a name="line.2521"></a>
<span class="sourceLineNo">2522</span>            return;<a name="line.2522"></a>
<span class="sourceLineNo">2523</span>        for (int k = 0; k &lt; l1; ++k) {<a name="line.2523"></a>
<span class="sourceLineNo">2524</span>            int idx1 = k * ido;<a name="line.2524"></a>
<span class="sourceLineNo">2525</span>            int idx2 = 5 * idx1;<a name="line.2525"></a>
<span class="sourceLineNo">2526</span>            int idx3 = idx2 + ido;<a name="line.2526"></a>
<span class="sourceLineNo">2527</span>            int idx4 = idx3 + ido;<a name="line.2527"></a>
<span class="sourceLineNo">2528</span>            int idx5 = idx4 + ido;<a name="line.2528"></a>
<span class="sourceLineNo">2529</span>            int idx6 = idx5 + ido;<a name="line.2529"></a>
<span class="sourceLineNo">2530</span>            int idx7 = idx1 + idx0;<a name="line.2530"></a>
<span class="sourceLineNo">2531</span>            int idx8 = idx7 + idx0;<a name="line.2531"></a>
<span class="sourceLineNo">2532</span>            int idx9 = idx8 + idx0;<a name="line.2532"></a>
<span class="sourceLineNo">2533</span>            int idx10 = idx9 + idx0;<a name="line.2533"></a>
<span class="sourceLineNo">2534</span>            for (i = 2; i &lt; ido; i += 2) {<a name="line.2534"></a>
<span class="sourceLineNo">2535</span>                int widx1 = i - 1 + iw1;<a name="line.2535"></a>
<span class="sourceLineNo">2536</span>                int widx2 = i - 1 + iw2;<a name="line.2536"></a>
<span class="sourceLineNo">2537</span>                int widx3 = i - 1 + iw3;<a name="line.2537"></a>
<span class="sourceLineNo">2538</span>                int widx4 = i - 1 + iw4;<a name="line.2538"></a>
<span class="sourceLineNo">2539</span>                w1r = wtable_r[widx1 - 1];<a name="line.2539"></a>
<span class="sourceLineNo">2540</span>                w1i = wtable_r[widx1];<a name="line.2540"></a>
<span class="sourceLineNo">2541</span>                w2r = wtable_r[widx2 - 1];<a name="line.2541"></a>
<span class="sourceLineNo">2542</span>                w2i = wtable_r[widx2];<a name="line.2542"></a>
<span class="sourceLineNo">2543</span>                w3r = wtable_r[widx3 - 1];<a name="line.2543"></a>
<span class="sourceLineNo">2544</span>                w3i = wtable_r[widx3];<a name="line.2544"></a>
<span class="sourceLineNo">2545</span>                w4r = wtable_r[widx4 - 1];<a name="line.2545"></a>
<span class="sourceLineNo">2546</span>                w4i = wtable_r[widx4];<a name="line.2546"></a>
<span class="sourceLineNo">2547</span><a name="line.2547"></a>
<span class="sourceLineNo">2548</span>                ic = ido - i;<a name="line.2548"></a>
<span class="sourceLineNo">2549</span>                int idx15 = in_off + i;<a name="line.2549"></a>
<span class="sourceLineNo">2550</span>                int idx16 = out_off + i;<a name="line.2550"></a>
<span class="sourceLineNo">2551</span>                int idx17 = out_off + ic;<a name="line.2551"></a>
<span class="sourceLineNo">2552</span><a name="line.2552"></a>
<span class="sourceLineNo">2553</span>                int iidx1 = idx15 + idx1;<a name="line.2553"></a>
<span class="sourceLineNo">2554</span>                int iidx2 = idx15 + idx7;<a name="line.2554"></a>
<span class="sourceLineNo">2555</span>                int iidx3 = idx15 + idx8;<a name="line.2555"></a>
<span class="sourceLineNo">2556</span>                int iidx4 = idx15 + idx9;<a name="line.2556"></a>
<span class="sourceLineNo">2557</span>                int iidx5 = idx15 + idx10;<a name="line.2557"></a>
<span class="sourceLineNo">2558</span><a name="line.2558"></a>
<span class="sourceLineNo">2559</span>                float i1i = in[iidx1 - 1];<a name="line.2559"></a>
<span class="sourceLineNo">2560</span>                float i1r = in[iidx1];<a name="line.2560"></a>
<span class="sourceLineNo">2561</span>                float i2i = in[iidx2 - 1];<a name="line.2561"></a>
<span class="sourceLineNo">2562</span>                float i2r = in[iidx2];<a name="line.2562"></a>
<span class="sourceLineNo">2563</span>                float i3i = in[iidx3 - 1];<a name="line.2563"></a>
<span class="sourceLineNo">2564</span>                float i3r = in[iidx3];<a name="line.2564"></a>
<span class="sourceLineNo">2565</span>                float i4i = in[iidx4 - 1];<a name="line.2565"></a>
<span class="sourceLineNo">2566</span>                float i4r = in[iidx4];<a name="line.2566"></a>
<span class="sourceLineNo">2567</span>                float i5i = in[iidx5 - 1];<a name="line.2567"></a>
<span class="sourceLineNo">2568</span>                float i5r = in[iidx5];<a name="line.2568"></a>
<span class="sourceLineNo">2569</span><a name="line.2569"></a>
<span class="sourceLineNo">2570</span>                dr2 = w1r * i2i + w1i * i2r;<a name="line.2570"></a>
<span class="sourceLineNo">2571</span>                di2 = w1r * i2r - w1i * i2i;<a name="line.2571"></a>
<span class="sourceLineNo">2572</span>                dr3 = w2r * i3i + w2i * i3r;<a name="line.2572"></a>
<span class="sourceLineNo">2573</span>                di3 = w2r * i3r - w2i * i3i;<a name="line.2573"></a>
<span class="sourceLineNo">2574</span>                dr4 = w3r * i4i + w3i * i4r;<a name="line.2574"></a>
<span class="sourceLineNo">2575</span>                di4 = w3r * i4r - w3i * i4i;<a name="line.2575"></a>
<span class="sourceLineNo">2576</span>                dr5 = w4r * i5i + w4i * i5r;<a name="line.2576"></a>
<span class="sourceLineNo">2577</span>                di5 = w4r * i5r - w4i * i5i;<a name="line.2577"></a>
<span class="sourceLineNo">2578</span><a name="line.2578"></a>
<span class="sourceLineNo">2579</span>                cr2 = dr2 + dr5;<a name="line.2579"></a>
<span class="sourceLineNo">2580</span>                ci5 = dr5 - dr2;<a name="line.2580"></a>
<span class="sourceLineNo">2581</span>                cr5 = di2 - di5;<a name="line.2581"></a>
<span class="sourceLineNo">2582</span>                ci2 = di2 + di5;<a name="line.2582"></a>
<span class="sourceLineNo">2583</span>                cr3 = dr3 + dr4;<a name="line.2583"></a>
<span class="sourceLineNo">2584</span>                ci4 = dr4 - dr3;<a name="line.2584"></a>
<span class="sourceLineNo">2585</span>                cr4 = di3 - di4;<a name="line.2585"></a>
<span class="sourceLineNo">2586</span>                ci3 = di3 + di4;<a name="line.2586"></a>
<span class="sourceLineNo">2587</span><a name="line.2587"></a>
<span class="sourceLineNo">2588</span>                tr2 = i1i + tr11 * cr2 + tr12 * cr3;<a name="line.2588"></a>
<span class="sourceLineNo">2589</span>                ti2 = i1r + tr11 * ci2 + tr12 * ci3;<a name="line.2589"></a>
<span class="sourceLineNo">2590</span>                tr3 = i1i + tr12 * cr2 + tr11 * cr3;<a name="line.2590"></a>
<span class="sourceLineNo">2591</span>                ti3 = i1r + tr12 * ci2 + tr11 * ci3;<a name="line.2591"></a>
<span class="sourceLineNo">2592</span>                tr5 = ti11 * cr5 + ti12 * cr4;<a name="line.2592"></a>
<span class="sourceLineNo">2593</span>                ti5 = ti11 * ci5 + ti12 * ci4;<a name="line.2593"></a>
<span class="sourceLineNo">2594</span>                tr4 = ti12 * cr5 - ti11 * cr4;<a name="line.2594"></a>
<span class="sourceLineNo">2595</span>                ti4 = ti12 * ci5 - ti11 * ci4;<a name="line.2595"></a>
<span class="sourceLineNo">2596</span><a name="line.2596"></a>
<span class="sourceLineNo">2597</span>                int oidx1 = idx16 + idx2;<a name="line.2597"></a>
<span class="sourceLineNo">2598</span>                int oidx2 = idx17 + idx3;<a name="line.2598"></a>
<span class="sourceLineNo">2599</span>                int oidx3 = idx16 + idx4;<a name="line.2599"></a>
<span class="sourceLineNo">2600</span>                int oidx4 = idx17 + idx5;<a name="line.2600"></a>
<span class="sourceLineNo">2601</span>                int oidx5 = idx16 + idx6;<a name="line.2601"></a>
<span class="sourceLineNo">2602</span><a name="line.2602"></a>
<span class="sourceLineNo">2603</span>                out[oidx1 - 1] = i1i + cr2 + cr3;<a name="line.2603"></a>
<span class="sourceLineNo">2604</span>                out[oidx1] = i1r + ci2 + ci3;<a name="line.2604"></a>
<span class="sourceLineNo">2605</span>                out[oidx3 - 1] = tr2 + tr5;<a name="line.2605"></a>
<span class="sourceLineNo">2606</span>                out[oidx2 - 1] = tr2 - tr5;<a name="line.2606"></a>
<span class="sourceLineNo">2607</span>                out[oidx3] = ti2 + ti5;<a name="line.2607"></a>
<span class="sourceLineNo">2608</span>                out[oidx2] = ti5 - ti2;<a name="line.2608"></a>
<span class="sourceLineNo">2609</span>                out[oidx5 - 1] = tr3 + tr4;<a name="line.2609"></a>
<span class="sourceLineNo">2610</span>                out[oidx4 - 1] = tr3 - tr4;<a name="line.2610"></a>
<span class="sourceLineNo">2611</span>                out[oidx5] = ti3 + ti4;<a name="line.2611"></a>
<span class="sourceLineNo">2612</span>                out[oidx4] = ti4 - ti3;<a name="line.2612"></a>
<span class="sourceLineNo">2613</span>            }<a name="line.2613"></a>
<span class="sourceLineNo">2614</span>        }<a name="line.2614"></a>
<span class="sourceLineNo">2615</span>    }<a name="line.2615"></a>
<span class="sourceLineNo">2616</span><a name="line.2616"></a>
<span class="sourceLineNo">2617</span>    /*-------------------------------------------------<a name="line.2617"></a>
<span class="sourceLineNo">2618</span>       radb5: Real FFT's backward processing of factor 5<a name="line.2618"></a>
<span class="sourceLineNo">2619</span>      -------------------------------------------------*/<a name="line.2619"></a>
<span class="sourceLineNo">2620</span>    void radb5(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset) {<a name="line.2620"></a>
<span class="sourceLineNo">2621</span>        final float tr11 = 0.309016994374947451262869435595348477f;<a name="line.2621"></a>
<span class="sourceLineNo">2622</span>        final float ti11 = 0.951056516295153531181938433292089030f;<a name="line.2622"></a>
<span class="sourceLineNo">2623</span>        final float tr12 = -0.809016994374947340240566973079694435f;<a name="line.2623"></a>
<span class="sourceLineNo">2624</span>        final float ti12 = 0.587785252292473248125759255344746634f;<a name="line.2624"></a>
<span class="sourceLineNo">2625</span>        int i, ic;<a name="line.2625"></a>
<span class="sourceLineNo">2626</span>        float ci2, ci3, ci4, ci5, di3, di4, di5, di2, cr2, cr3, cr5, cr4, ti2, ti3, ti4, ti5, dr3, dr4, dr5, dr2, tr2, tr3, tr4, tr5, w1r, w1i, w2r, w2i, w3r, w3i, w4r, w4i;<a name="line.2626"></a>
<span class="sourceLineNo">2627</span>        int iw1, iw2, iw3, iw4;<a name="line.2627"></a>
<span class="sourceLineNo">2628</span>        iw1 = offset;<a name="line.2628"></a>
<span class="sourceLineNo">2629</span>        iw2 = iw1 + ido;<a name="line.2629"></a>
<span class="sourceLineNo">2630</span>        iw3 = iw2 + ido;<a name="line.2630"></a>
<span class="sourceLineNo">2631</span>        iw4 = iw3 + ido;<a name="line.2631"></a>
<span class="sourceLineNo">2632</span><a name="line.2632"></a>
<span class="sourceLineNo">2633</span>        int idx0 = l1 * ido;<a name="line.2633"></a>
<span class="sourceLineNo">2634</span>        for (int k = 0; k &lt; l1; k++) {<a name="line.2634"></a>
<span class="sourceLineNo">2635</span>            int idx1 = k * ido;<a name="line.2635"></a>
<span class="sourceLineNo">2636</span>            int idx2 = 5 * idx1;<a name="line.2636"></a>
<span class="sourceLineNo">2637</span>            int idx3 = idx2 + ido;<a name="line.2637"></a>
<span class="sourceLineNo">2638</span>            int idx4 = idx3 + ido;<a name="line.2638"></a>
<span class="sourceLineNo">2639</span>            int idx5 = idx4 + ido;<a name="line.2639"></a>
<span class="sourceLineNo">2640</span>            int idx6 = idx5 + ido;<a name="line.2640"></a>
<span class="sourceLineNo">2641</span>            int idx7 = idx1 + idx0;<a name="line.2641"></a>
<span class="sourceLineNo">2642</span>            int idx8 = idx7 + idx0;<a name="line.2642"></a>
<span class="sourceLineNo">2643</span>            int idx9 = idx8 + idx0;<a name="line.2643"></a>
<span class="sourceLineNo">2644</span>            int idx10 = idx9 + idx0;<a name="line.2644"></a>
<span class="sourceLineNo">2645</span>            int idx11 = in_off + ido - 1;<a name="line.2645"></a>
<span class="sourceLineNo">2646</span><a name="line.2646"></a>
<span class="sourceLineNo">2647</span>            float i1r = in[in_off + idx2];<a name="line.2647"></a>
<span class="sourceLineNo">2648</span><a name="line.2648"></a>
<span class="sourceLineNo">2649</span>            ti5 = 2 * in[in_off + idx4];<a name="line.2649"></a>
<span class="sourceLineNo">2650</span>            ti4 = 2 * in[in_off + idx6];<a name="line.2650"></a>
<span class="sourceLineNo">2651</span>            tr2 = 2 * in[idx11 + idx3];<a name="line.2651"></a>
<span class="sourceLineNo">2652</span>            tr3 = 2 * in[idx11 + idx5];<a name="line.2652"></a>
<span class="sourceLineNo">2653</span>            cr2 = i1r + tr11 * tr2 + tr12 * tr3;<a name="line.2653"></a>
<span class="sourceLineNo">2654</span>            cr3 = i1r + tr12 * tr2 + tr11 * tr3;<a name="line.2654"></a>
<span class="sourceLineNo">2655</span>            ci5 = ti11 * ti5 + ti12 * ti4;<a name="line.2655"></a>
<span class="sourceLineNo">2656</span>            ci4 = ti12 * ti5 - ti11 * ti4;<a name="line.2656"></a>
<span class="sourceLineNo">2657</span><a name="line.2657"></a>
<span class="sourceLineNo">2658</span>            out[out_off + idx1] = i1r + tr2 + tr3;<a name="line.2658"></a>
<span class="sourceLineNo">2659</span>            out[out_off + idx7] = cr2 - ci5;<a name="line.2659"></a>
<span class="sourceLineNo">2660</span>            out[out_off + idx8] = cr3 - ci4;<a name="line.2660"></a>
<span class="sourceLineNo">2661</span>            out[out_off + idx9] = cr3 + ci4;<a name="line.2661"></a>
<span class="sourceLineNo">2662</span>            out[out_off + idx10] = cr2 + ci5;<a name="line.2662"></a>
<span class="sourceLineNo">2663</span>        }<a name="line.2663"></a>
<span class="sourceLineNo">2664</span>        if (ido == 1)<a name="line.2664"></a>
<span class="sourceLineNo">2665</span>            return;<a name="line.2665"></a>
<span class="sourceLineNo">2666</span>        for (int k = 0; k &lt; l1; ++k) {<a name="line.2666"></a>
<span class="sourceLineNo">2667</span>            int idx1 = k * ido;<a name="line.2667"></a>
<span class="sourceLineNo">2668</span>            int idx2 = 5 * idx1;<a name="line.2668"></a>
<span class="sourceLineNo">2669</span>            int idx3 = idx2 + ido;<a name="line.2669"></a>
<span class="sourceLineNo">2670</span>            int idx4 = idx3 + ido;<a name="line.2670"></a>
<span class="sourceLineNo">2671</span>            int idx5 = idx4 + ido;<a name="line.2671"></a>
<span class="sourceLineNo">2672</span>            int idx6 = idx5 + ido;<a name="line.2672"></a>
<span class="sourceLineNo">2673</span>            int idx7 = idx1 + idx0;<a name="line.2673"></a>
<span class="sourceLineNo">2674</span>            int idx8 = idx7 + idx0;<a name="line.2674"></a>
<span class="sourceLineNo">2675</span>            int idx9 = idx8 + idx0;<a name="line.2675"></a>
<span class="sourceLineNo">2676</span>            int idx10 = idx9 + idx0;<a name="line.2676"></a>
<span class="sourceLineNo">2677</span>            for (i = 2; i &lt; ido; i += 2) {<a name="line.2677"></a>
<span class="sourceLineNo">2678</span>                ic = ido - i;<a name="line.2678"></a>
<span class="sourceLineNo">2679</span>                int widx1 = i - 1 + iw1;<a name="line.2679"></a>
<span class="sourceLineNo">2680</span>                int widx2 = i - 1 + iw2;<a name="line.2680"></a>
<span class="sourceLineNo">2681</span>                int widx3 = i - 1 + iw3;<a name="line.2681"></a>
<span class="sourceLineNo">2682</span>                int widx4 = i - 1 + iw4;<a name="line.2682"></a>
<span class="sourceLineNo">2683</span>                w1r = wtable_r[widx1 - 1];<a name="line.2683"></a>
<span class="sourceLineNo">2684</span>                w1i = wtable_r[widx1];<a name="line.2684"></a>
<span class="sourceLineNo">2685</span>                w2r = wtable_r[widx2 - 1];<a name="line.2685"></a>
<span class="sourceLineNo">2686</span>                w2i = wtable_r[widx2];<a name="line.2686"></a>
<span class="sourceLineNo">2687</span>                w3r = wtable_r[widx3 - 1];<a name="line.2687"></a>
<span class="sourceLineNo">2688</span>                w3i = wtable_r[widx3];<a name="line.2688"></a>
<span class="sourceLineNo">2689</span>                w4r = wtable_r[widx4 - 1];<a name="line.2689"></a>
<span class="sourceLineNo">2690</span>                w4i = wtable_r[widx4];<a name="line.2690"></a>
<span class="sourceLineNo">2691</span><a name="line.2691"></a>
<span class="sourceLineNo">2692</span>                int idx15 = in_off + i;<a name="line.2692"></a>
<span class="sourceLineNo">2693</span>                int idx16 = in_off + ic;<a name="line.2693"></a>
<span class="sourceLineNo">2694</span>                int idx17 = out_off + i;<a name="line.2694"></a>
<span class="sourceLineNo">2695</span><a name="line.2695"></a>
<span class="sourceLineNo">2696</span>                int iidx1 = idx15 + idx2;<a name="line.2696"></a>
<span class="sourceLineNo">2697</span>                int iidx2 = idx16 + idx3;<a name="line.2697"></a>
<span class="sourceLineNo">2698</span>                int iidx3 = idx15 + idx4;<a name="line.2698"></a>
<span class="sourceLineNo">2699</span>                int iidx4 = idx16 + idx5;<a name="line.2699"></a>
<span class="sourceLineNo">2700</span>                int iidx5 = idx15 + idx6;<a name="line.2700"></a>
<span class="sourceLineNo">2701</span><a name="line.2701"></a>
<span class="sourceLineNo">2702</span>                float i1i = in[iidx1 - 1];<a name="line.2702"></a>
<span class="sourceLineNo">2703</span>                float i1r = in[iidx1];<a name="line.2703"></a>
<span class="sourceLineNo">2704</span>                float i2i = in[iidx2 - 1];<a name="line.2704"></a>
<span class="sourceLineNo">2705</span>                float i2r = in[iidx2];<a name="line.2705"></a>
<span class="sourceLineNo">2706</span>                float i3i = in[iidx3 - 1];<a name="line.2706"></a>
<span class="sourceLineNo">2707</span>                float i3r = in[iidx3];<a name="line.2707"></a>
<span class="sourceLineNo">2708</span>                float i4i = in[iidx4 - 1];<a name="line.2708"></a>
<span class="sourceLineNo">2709</span>                float i4r = in[iidx4];<a name="line.2709"></a>
<span class="sourceLineNo">2710</span>                float i5i = in[iidx5 - 1];<a name="line.2710"></a>
<span class="sourceLineNo">2711</span>                float i5r = in[iidx5];<a name="line.2711"></a>
<span class="sourceLineNo">2712</span><a name="line.2712"></a>
<span class="sourceLineNo">2713</span>                ti5 = i3r + i2r;<a name="line.2713"></a>
<span class="sourceLineNo">2714</span>                ti2 = i3r - i2r;<a name="line.2714"></a>
<span class="sourceLineNo">2715</span>                ti4 = i5r + i4r;<a name="line.2715"></a>
<span class="sourceLineNo">2716</span>                ti3 = i5r - i4r;<a name="line.2716"></a>
<span class="sourceLineNo">2717</span>                tr5 = i3i - i2i;<a name="line.2717"></a>
<span class="sourceLineNo">2718</span>                tr2 = i3i + i2i;<a name="line.2718"></a>
<span class="sourceLineNo">2719</span>                tr4 = i5i - i4i;<a name="line.2719"></a>
<span class="sourceLineNo">2720</span>                tr3 = i5i + i4i;<a name="line.2720"></a>
<span class="sourceLineNo">2721</span><a name="line.2721"></a>
<span class="sourceLineNo">2722</span>                cr2 = i1i + tr11 * tr2 + tr12 * tr3;<a name="line.2722"></a>
<span class="sourceLineNo">2723</span>                ci2 = i1r + tr11 * ti2 + tr12 * ti3;<a name="line.2723"></a>
<span class="sourceLineNo">2724</span>                cr3 = i1i + tr12 * tr2 + tr11 * tr3;<a name="line.2724"></a>
<span class="sourceLineNo">2725</span>                ci3 = i1r + tr12 * ti2 + tr11 * ti3;<a name="line.2725"></a>
<span class="sourceLineNo">2726</span>                cr5 = ti11 * tr5 + ti12 * tr4;<a name="line.2726"></a>
<span class="sourceLineNo">2727</span>                ci5 = ti11 * ti5 + ti12 * ti4;<a name="line.2727"></a>
<span class="sourceLineNo">2728</span>                cr4 = ti12 * tr5 - ti11 * tr4;<a name="line.2728"></a>
<span class="sourceLineNo">2729</span>                ci4 = ti12 * ti5 - ti11 * ti4;<a name="line.2729"></a>
<span class="sourceLineNo">2730</span>                dr3 = cr3 - ci4;<a name="line.2730"></a>
<span class="sourceLineNo">2731</span>                dr4 = cr3 + ci4;<a name="line.2731"></a>
<span class="sourceLineNo">2732</span>                di3 = ci3 + cr4;<a name="line.2732"></a>
<span class="sourceLineNo">2733</span>                di4 = ci3 - cr4;<a name="line.2733"></a>
<span class="sourceLineNo">2734</span>                dr5 = cr2 + ci5;<a name="line.2734"></a>
<span class="sourceLineNo">2735</span>                dr2 = cr2 - ci5;<a name="line.2735"></a>
<span class="sourceLineNo">2736</span>                di5 = ci2 - cr5;<a name="line.2736"></a>
<span class="sourceLineNo">2737</span>                di2 = ci2 + cr5;<a name="line.2737"></a>
<span class="sourceLineNo">2738</span><a name="line.2738"></a>
<span class="sourceLineNo">2739</span>                int oidx1 = idx17 + idx1;<a name="line.2739"></a>
<span class="sourceLineNo">2740</span>                int oidx2 = idx17 + idx7;<a name="line.2740"></a>
<span class="sourceLineNo">2741</span>                int oidx3 = idx17 + idx8;<a name="line.2741"></a>
<span class="sourceLineNo">2742</span>                int oidx4 = idx17 + idx9;<a name="line.2742"></a>
<span class="sourceLineNo">2743</span>                int oidx5 = idx17 + idx10;<a name="line.2743"></a>
<span class="sourceLineNo">2744</span><a name="line.2744"></a>
<span class="sourceLineNo">2745</span>                out[oidx1 - 1] = i1i + tr2 + tr3;<a name="line.2745"></a>
<span class="sourceLineNo">2746</span>                out[oidx1] = i1r + ti2 + ti3;<a name="line.2746"></a>
<span class="sourceLineNo">2747</span>                out[oidx2 - 1] = w1r * dr2 - w1i * di2;<a name="line.2747"></a>
<span class="sourceLineNo">2748</span>                out[oidx2] = w1r * di2 + w1i * dr2;<a name="line.2748"></a>
<span class="sourceLineNo">2749</span>                out[oidx3 - 1] = w2r * dr3 - w2i * di3;<a name="line.2749"></a>
<span class="sourceLineNo">2750</span>                out[oidx3] = w2r * di3 + w2i * dr3;<a name="line.2750"></a>
<span class="sourceLineNo">2751</span>                out[oidx4 - 1] = w3r * dr4 - w3i * di4;<a name="line.2751"></a>
<span class="sourceLineNo">2752</span>                out[oidx4] = w3r * di4 + w3i * dr4;<a name="line.2752"></a>
<span class="sourceLineNo">2753</span>                out[oidx5 - 1] = w4r * dr5 - w4i * di5;<a name="line.2753"></a>
<span class="sourceLineNo">2754</span>                out[oidx5] = w4r * di5 + w4i * dr5;<a name="line.2754"></a>
<span class="sourceLineNo">2755</span>            }<a name="line.2755"></a>
<span class="sourceLineNo">2756</span>        }<a name="line.2756"></a>
<span class="sourceLineNo">2757</span>    }<a name="line.2757"></a>
<span class="sourceLineNo">2758</span><a name="line.2758"></a>
<span class="sourceLineNo">2759</span>    /*---------------------------------------------------------<a name="line.2759"></a>
<span class="sourceLineNo">2760</span>       radfg: Real FFT's forward processing of general factor<a name="line.2760"></a>
<span class="sourceLineNo">2761</span>      --------------------------------------------------------*/<a name="line.2761"></a>
<span class="sourceLineNo">2762</span>    void radfg(final int ido, final int ip, final int l1, final int idl1, final float in[], final int in_off, final float out[], final int out_off, final int offset) {<a name="line.2762"></a>
<span class="sourceLineNo">2763</span>        int idij, ipph, j2, ic, jc, lc, is, nbd;<a name="line.2763"></a>
<span class="sourceLineNo">2764</span>        float dc2, ai1, ai2, ar1, ar2, ds2, dcp, arg, dsp, ar1h, ar2h, w1r, w1i;<a name="line.2764"></a>
<span class="sourceLineNo">2765</span>        int iw1 = offset;<a name="line.2765"></a>
<span class="sourceLineNo">2766</span><a name="line.2766"></a>
<span class="sourceLineNo">2767</span>        arg = TWO_PI / (float) ip;<a name="line.2767"></a>
<span class="sourceLineNo">2768</span>        dcp = (float)Math.cos(arg);<a name="line.2768"></a>
<span class="sourceLineNo">2769</span>        dsp = (float)Math.sin(arg);<a name="line.2769"></a>
<span class="sourceLineNo">2770</span>        ipph = (ip + 1) / 2;<a name="line.2770"></a>
<span class="sourceLineNo">2771</span>        nbd = (ido - 1) / 2;<a name="line.2771"></a>
<span class="sourceLineNo">2772</span>        if (ido != 1) {<a name="line.2772"></a>
<span class="sourceLineNo">2773</span>            for (int ik = 0; ik &lt; idl1; ik++)<a name="line.2773"></a>
<span class="sourceLineNo">2774</span>                out[out_off + ik] = in[in_off + ik];<a name="line.2774"></a>
<span class="sourceLineNo">2775</span>            for (int j = 1; j &lt; ip; j++) {<a name="line.2775"></a>
<span class="sourceLineNo">2776</span>                int idx1 = j * l1 * ido;<a name="line.2776"></a>
<span class="sourceLineNo">2777</span>                for (int k = 0; k &lt; l1; k++) {<a name="line.2777"></a>
<span class="sourceLineNo">2778</span>                    int idx2 = k * ido + idx1;<a name="line.2778"></a>
<span class="sourceLineNo">2779</span>                    out[out_off + idx2] = in[in_off + idx2];<a name="line.2779"></a>
<span class="sourceLineNo">2780</span>                }<a name="line.2780"></a>
<span class="sourceLineNo">2781</span>            }<a name="line.2781"></a>
<span class="sourceLineNo">2782</span>            if (nbd &lt;= l1) {<a name="line.2782"></a>
<span class="sourceLineNo">2783</span>                is = -ido;<a name="line.2783"></a>
<span class="sourceLineNo">2784</span>                for (int j = 1; j &lt; ip; j++) {<a name="line.2784"></a>
<span class="sourceLineNo">2785</span>                    is += ido;<a name="line.2785"></a>
<span class="sourceLineNo">2786</span>                    idij = is - 1;<a name="line.2786"></a>
<span class="sourceLineNo">2787</span>                    int idx1 = j * l1 * ido;<a name="line.2787"></a>
<span class="sourceLineNo">2788</span>                    for (int i = 2; i &lt; ido; i += 2) {<a name="line.2788"></a>
<span class="sourceLineNo">2789</span>                        idij += 2;<a name="line.2789"></a>
<span class="sourceLineNo">2790</span>                        int idx2 = idij + iw1;<a name="line.2790"></a>
<span class="sourceLineNo">2791</span>                        int idx4 = in_off + i;<a name="line.2791"></a>
<span class="sourceLineNo">2792</span>                        int idx5 = out_off + i;<a name="line.2792"></a>
<span class="sourceLineNo">2793</span>                        w1r = wtable_r[idx2 - 1];<a name="line.2793"></a>
<span class="sourceLineNo">2794</span>                        w1i = wtable_r[idx2];<a name="line.2794"></a>
<span class="sourceLineNo">2795</span>                        for (int k = 0; k &lt; l1; k++) {<a name="line.2795"></a>
<span class="sourceLineNo">2796</span>                            int idx3 = k * ido + idx1;<a name="line.2796"></a>
<span class="sourceLineNo">2797</span>                            int oidx1 = idx5 + idx3;<a name="line.2797"></a>
<span class="sourceLineNo">2798</span>                            int iidx1 = idx4 + idx3;<a name="line.2798"></a>
<span class="sourceLineNo">2799</span>                            float i1i = in[iidx1 - 1];<a name="line.2799"></a>
<span class="sourceLineNo">2800</span>                            float i1r = in[iidx1];<a name="line.2800"></a>
<span class="sourceLineNo">2801</span><a name="line.2801"></a>
<span class="sourceLineNo">2802</span>                            out[oidx1 - 1] = w1r * i1i + w1i * i1r;<a name="line.2802"></a>
<span class="sourceLineNo">2803</span>                            out[oidx1] = w1r * i1r - w1i * i1i;<a name="line.2803"></a>
<span class="sourceLineNo">2804</span>                        }<a name="line.2804"></a>
<span class="sourceLineNo">2805</span>                    }<a name="line.2805"></a>
<span class="sourceLineNo">2806</span>                }<a name="line.2806"></a>
<span class="sourceLineNo">2807</span>            } else {<a name="line.2807"></a>
<span class="sourceLineNo">2808</span>                is = -ido;<a name="line.2808"></a>
<span class="sourceLineNo">2809</span>                for (int j = 1; j &lt; ip; j++) {<a name="line.2809"></a>
<span class="sourceLineNo">2810</span>                    is += ido;<a name="line.2810"></a>
<span class="sourceLineNo">2811</span>                    int idx1 = j * l1 * ido;<a name="line.2811"></a>
<span class="sourceLineNo">2812</span>                    for (int k = 0; k &lt; l1; k++) {<a name="line.2812"></a>
<span class="sourceLineNo">2813</span>                        idij = is - 1;<a name="line.2813"></a>
<span class="sourceLineNo">2814</span>                        int idx3 = k * ido + idx1;<a name="line.2814"></a>
<span class="sourceLineNo">2815</span>                        for (int i = 2; i &lt; ido; i += 2) {<a name="line.2815"></a>
<span class="sourceLineNo">2816</span>                            idij += 2;<a name="line.2816"></a>
<span class="sourceLineNo">2817</span>                            int idx2 = idij + iw1;<a name="line.2817"></a>
<span class="sourceLineNo">2818</span>                            w1r = wtable_r[idx2 - 1];<a name="line.2818"></a>
<span class="sourceLineNo">2819</span>                            w1i = wtable_r[idx2];<a name="line.2819"></a>
<span class="sourceLineNo">2820</span>                            int oidx1 = out_off + i + idx3;<a name="line.2820"></a>
<span class="sourceLineNo">2821</span>                            int iidx1 = in_off + i + idx3;<a name="line.2821"></a>
<span class="sourceLineNo">2822</span>                            float i1i = in[iidx1 - 1];<a name="line.2822"></a>
<span class="sourceLineNo">2823</span>                            float i1r = in[iidx1];<a name="line.2823"></a>
<span class="sourceLineNo">2824</span><a name="line.2824"></a>
<span class="sourceLineNo">2825</span>                            out[oidx1 - 1] = w1r * i1i + w1i * i1r;<a name="line.2825"></a>
<span class="sourceLineNo">2826</span>                            out[oidx1] = w1r * i1r - w1i * i1i;<a name="line.2826"></a>
<span class="sourceLineNo">2827</span>                        }<a name="line.2827"></a>
<span class="sourceLineNo">2828</span>                    }<a name="line.2828"></a>
<span class="sourceLineNo">2829</span>                }<a name="line.2829"></a>
<span class="sourceLineNo">2830</span>            }<a name="line.2830"></a>
<span class="sourceLineNo">2831</span>            if (nbd &gt;= l1) {<a name="line.2831"></a>
<span class="sourceLineNo">2832</span>                for (int j = 1; j &lt; ipph; j++) {<a name="line.2832"></a>
<span class="sourceLineNo">2833</span>                    jc = ip - j;<a name="line.2833"></a>
<span class="sourceLineNo">2834</span>                    int idx1 = j * l1 * ido;<a name="line.2834"></a>
<span class="sourceLineNo">2835</span>                    int idx2 = jc * l1 * ido;<a name="line.2835"></a>
<span class="sourceLineNo">2836</span>                    for (int k = 0; k &lt; l1; k++) {<a name="line.2836"></a>
<span class="sourceLineNo">2837</span>                        int idx3 = k * ido + idx1;<a name="line.2837"></a>
<span class="sourceLineNo">2838</span>                        int idx4 = k * ido + idx2;<a name="line.2838"></a>
<span class="sourceLineNo">2839</span>                        for (int i = 2; i &lt; ido; i += 2) {<a name="line.2839"></a>
<span class="sourceLineNo">2840</span>                            int idx5 = in_off + i;<a name="line.2840"></a>
<span class="sourceLineNo">2841</span>                            int idx6 = out_off + i;<a name="line.2841"></a>
<span class="sourceLineNo">2842</span>                            int iidx1 = idx5 + idx3;<a name="line.2842"></a>
<span class="sourceLineNo">2843</span>                            int iidx2 = idx5 + idx4;<a name="line.2843"></a>
<span class="sourceLineNo">2844</span>                            int oidx1 = idx6 + idx3;<a name="line.2844"></a>
<span class="sourceLineNo">2845</span>                            int oidx2 = idx6 + idx4;<a name="line.2845"></a>
<span class="sourceLineNo">2846</span>                            float o1i = out[oidx1 - 1];<a name="line.2846"></a>
<span class="sourceLineNo">2847</span>                            float o1r = out[oidx1];<a name="line.2847"></a>
<span class="sourceLineNo">2848</span>                            float o2i = out[oidx2 - 1];<a name="line.2848"></a>
<span class="sourceLineNo">2849</span>                            float o2r = out[oidx2];<a name="line.2849"></a>
<span class="sourceLineNo">2850</span><a name="line.2850"></a>
<span class="sourceLineNo">2851</span>                            in[iidx1 - 1] = o1i + o2i;<a name="line.2851"></a>
<span class="sourceLineNo">2852</span>                            in[iidx1] = o1r + o2r;<a name="line.2852"></a>
<span class="sourceLineNo">2853</span><a name="line.2853"></a>
<span class="sourceLineNo">2854</span>                            in[iidx2 - 1] = o1r - o2r;<a name="line.2854"></a>
<span class="sourceLineNo">2855</span>                            in[iidx2] = o2i - o1i;<a name="line.2855"></a>
<span class="sourceLineNo">2856</span>                        }<a name="line.2856"></a>
<span class="sourceLineNo">2857</span>                    }<a name="line.2857"></a>
<span class="sourceLineNo">2858</span>                }<a name="line.2858"></a>
<span class="sourceLineNo">2859</span>            } else {<a name="line.2859"></a>
<span class="sourceLineNo">2860</span>                for (int j = 1; j &lt; ipph; j++) {<a name="line.2860"></a>
<span class="sourceLineNo">2861</span>                    jc = ip - j;<a name="line.2861"></a>
<span class="sourceLineNo">2862</span>                    int idx1 = j * l1 * ido;<a name="line.2862"></a>
<span class="sourceLineNo">2863</span>                    int idx2 = jc * l1 * ido;<a name="line.2863"></a>
<span class="sourceLineNo">2864</span>                    for (int i = 2; i &lt; ido; i += 2) {<a name="line.2864"></a>
<span class="sourceLineNo">2865</span>                        int idx5 = in_off + i;<a name="line.2865"></a>
<span class="sourceLineNo">2866</span>                        int idx6 = out_off + i;<a name="line.2866"></a>
<span class="sourceLineNo">2867</span>                        for (int k = 0; k &lt; l1; k++) {<a name="line.2867"></a>
<span class="sourceLineNo">2868</span>                            int idx3 = k * ido + idx1;<a name="line.2868"></a>
<span class="sourceLineNo">2869</span>                            int idx4 = k * ido + idx2;<a name="line.2869"></a>
<span class="sourceLineNo">2870</span>                            int iidx1 = idx5 + idx3;<a name="line.2870"></a>
<span class="sourceLineNo">2871</span>                            int iidx2 = idx5 + idx4;<a name="line.2871"></a>
<span class="sourceLineNo">2872</span>                            int oidx1 = idx6 + idx3;<a name="line.2872"></a>
<span class="sourceLineNo">2873</span>                            int oidx2 = idx6 + idx4;<a name="line.2873"></a>
<span class="sourceLineNo">2874</span>                            float o1i = out[oidx1 - 1];<a name="line.2874"></a>
<span class="sourceLineNo">2875</span>                            float o1r = out[oidx1];<a name="line.2875"></a>
<span class="sourceLineNo">2876</span>                            float o2i = out[oidx2 - 1];<a name="line.2876"></a>
<span class="sourceLineNo">2877</span>                            float o2r = out[oidx2];<a name="line.2877"></a>
<span class="sourceLineNo">2878</span><a name="line.2878"></a>
<span class="sourceLineNo">2879</span>                            in[iidx1 - 1] = o1i + o2i;<a name="line.2879"></a>
<span class="sourceLineNo">2880</span>                            in[iidx1] = o1r + o2r;<a name="line.2880"></a>
<span class="sourceLineNo">2881</span>                            in[iidx2 - 1] = o1r - o2r;<a name="line.2881"></a>
<span class="sourceLineNo">2882</span>                            in[iidx2] = o2i - o1i;<a name="line.2882"></a>
<span class="sourceLineNo">2883</span>                        }<a name="line.2883"></a>
<span class="sourceLineNo">2884</span>                    }<a name="line.2884"></a>
<span class="sourceLineNo">2885</span>                }<a name="line.2885"></a>
<span class="sourceLineNo">2886</span>            }<a name="line.2886"></a>
<span class="sourceLineNo">2887</span>        } else {<a name="line.2887"></a>
<span class="sourceLineNo">2888</span>            System.arraycopy(out, out_off, in, in_off, idl1);<a name="line.2888"></a>
<span class="sourceLineNo">2889</span>        }<a name="line.2889"></a>
<span class="sourceLineNo">2890</span>        for (int j = 1; j &lt; ipph; j++) {<a name="line.2890"></a>
<span class="sourceLineNo">2891</span>            jc = ip - j;<a name="line.2891"></a>
<span class="sourceLineNo">2892</span>            int idx1 = j * l1 * ido;<a name="line.2892"></a>
<span class="sourceLineNo">2893</span>            int idx2 = jc * l1 * ido;<a name="line.2893"></a>
<span class="sourceLineNo">2894</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.2894"></a>
<span class="sourceLineNo">2895</span>                int idx3 = k * ido + idx1;<a name="line.2895"></a>
<span class="sourceLineNo">2896</span>                int idx4 = k * ido + idx2;<a name="line.2896"></a>
<span class="sourceLineNo">2897</span>                int oidx1 = out_off + idx3;<a name="line.2897"></a>
<span class="sourceLineNo">2898</span>                int oidx2 = out_off + idx4;<a name="line.2898"></a>
<span class="sourceLineNo">2899</span>                float o1r = out[oidx1];<a name="line.2899"></a>
<span class="sourceLineNo">2900</span>                float o2r = out[oidx2];<a name="line.2900"></a>
<span class="sourceLineNo">2901</span><a name="line.2901"></a>
<span class="sourceLineNo">2902</span>                in[in_off + idx3] = o1r + o2r;<a name="line.2902"></a>
<span class="sourceLineNo">2903</span>                in[in_off + idx4] = o2r - o1r;<a name="line.2903"></a>
<span class="sourceLineNo">2904</span>            }<a name="line.2904"></a>
<span class="sourceLineNo">2905</span>        }<a name="line.2905"></a>
<span class="sourceLineNo">2906</span><a name="line.2906"></a>
<span class="sourceLineNo">2907</span>        ar1 = 1;<a name="line.2907"></a>
<span class="sourceLineNo">2908</span>        ai1 = 0;<a name="line.2908"></a>
<span class="sourceLineNo">2909</span>        int idx0 = (ip - 1) * idl1;<a name="line.2909"></a>
<span class="sourceLineNo">2910</span>        for (int l = 1; l &lt; ipph; l++) {<a name="line.2910"></a>
<span class="sourceLineNo">2911</span>            lc = ip - l;<a name="line.2911"></a>
<span class="sourceLineNo">2912</span>            ar1h = dcp * ar1 - dsp * ai1;<a name="line.2912"></a>
<span class="sourceLineNo">2913</span>            ai1 = dcp * ai1 + dsp * ar1;<a name="line.2913"></a>
<span class="sourceLineNo">2914</span>            ar1 = ar1h;<a name="line.2914"></a>
<span class="sourceLineNo">2915</span>            int idx1 = l * idl1;<a name="line.2915"></a>
<span class="sourceLineNo">2916</span>            int idx2 = lc * idl1;<a name="line.2916"></a>
<span class="sourceLineNo">2917</span>            for (int ik = 0; ik &lt; idl1; ik++) {<a name="line.2917"></a>
<span class="sourceLineNo">2918</span>                int idx3 = out_off + ik;<a name="line.2918"></a>
<span class="sourceLineNo">2919</span>                int idx4 = in_off + ik;<a name="line.2919"></a>
<span class="sourceLineNo">2920</span>                out[idx3 + idx1] = in[idx4] + ar1 * in[idx4 + idl1];<a name="line.2920"></a>
<span class="sourceLineNo">2921</span>                out[idx3 + idx2] = ai1 * in[idx4 + idx0];<a name="line.2921"></a>
<span class="sourceLineNo">2922</span>            }<a name="line.2922"></a>
<span class="sourceLineNo">2923</span>            dc2 = ar1;<a name="line.2923"></a>
<span class="sourceLineNo">2924</span>            ds2 = ai1;<a name="line.2924"></a>
<span class="sourceLineNo">2925</span>            ar2 = ar1;<a name="line.2925"></a>
<span class="sourceLineNo">2926</span>            ai2 = ai1;<a name="line.2926"></a>
<span class="sourceLineNo">2927</span>            for (int j = 2; j &lt; ipph; j++) {<a name="line.2927"></a>
<span class="sourceLineNo">2928</span>                jc = ip - j;<a name="line.2928"></a>
<span class="sourceLineNo">2929</span>                ar2h = dc2 * ar2 - ds2 * ai2;<a name="line.2929"></a>
<span class="sourceLineNo">2930</span>                ai2 = dc2 * ai2 + ds2 * ar2;<a name="line.2930"></a>
<span class="sourceLineNo">2931</span>                ar2 = ar2h;<a name="line.2931"></a>
<span class="sourceLineNo">2932</span>                int idx3 = j * idl1;<a name="line.2932"></a>
<span class="sourceLineNo">2933</span>                int idx4 = jc * idl1;<a name="line.2933"></a>
<span class="sourceLineNo">2934</span>                for (int ik = 0; ik &lt; idl1; ik++) {<a name="line.2934"></a>
<span class="sourceLineNo">2935</span>                    int idx5 = out_off + ik;<a name="line.2935"></a>
<span class="sourceLineNo">2936</span>                    int idx6 = in_off + ik;<a name="line.2936"></a>
<span class="sourceLineNo">2937</span>                    out[idx5 + idx1] += ar2 * in[idx6 + idx3];<a name="line.2937"></a>
<span class="sourceLineNo">2938</span>                    out[idx5 + idx2] += ai2 * in[idx6 + idx4];<a name="line.2938"></a>
<span class="sourceLineNo">2939</span>                }<a name="line.2939"></a>
<span class="sourceLineNo">2940</span>            }<a name="line.2940"></a>
<span class="sourceLineNo">2941</span>        }<a name="line.2941"></a>
<span class="sourceLineNo">2942</span>        for (int j = 1; j &lt; ipph; j++) {<a name="line.2942"></a>
<span class="sourceLineNo">2943</span>            int idx1 = j * idl1;<a name="line.2943"></a>
<span class="sourceLineNo">2944</span>            for (int ik = 0; ik &lt; idl1; ik++) {<a name="line.2944"></a>
<span class="sourceLineNo">2945</span>                out[out_off + ik] += in[in_off + ik + idx1];<a name="line.2945"></a>
<span class="sourceLineNo">2946</span>            }<a name="line.2946"></a>
<span class="sourceLineNo">2947</span>        }<a name="line.2947"></a>
<span class="sourceLineNo">2948</span><a name="line.2948"></a>
<span class="sourceLineNo">2949</span>        if (ido &gt;= l1) {<a name="line.2949"></a>
<span class="sourceLineNo">2950</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.2950"></a>
<span class="sourceLineNo">2951</span>                int idx1 = k * ido;<a name="line.2951"></a>
<span class="sourceLineNo">2952</span>                int idx2 = idx1 * ip;<a name="line.2952"></a>
<span class="sourceLineNo">2953</span>                for (int i = 0; i &lt; ido; i++) {<a name="line.2953"></a>
<span class="sourceLineNo">2954</span>                    in[in_off + i + idx2] = out[out_off + i + idx1];<a name="line.2954"></a>
<span class="sourceLineNo">2955</span>                }<a name="line.2955"></a>
<span class="sourceLineNo">2956</span>            }<a name="line.2956"></a>
<span class="sourceLineNo">2957</span>        } else {<a name="line.2957"></a>
<span class="sourceLineNo">2958</span>            for (int i = 0; i &lt; ido; i++) {<a name="line.2958"></a>
<span class="sourceLineNo">2959</span>                for (int k = 0; k &lt; l1; k++) {<a name="line.2959"></a>
<span class="sourceLineNo">2960</span>                    int idx1 = k * ido;<a name="line.2960"></a>
<span class="sourceLineNo">2961</span>                    in[in_off + i + idx1 * ip] = out[out_off + i + idx1];<a name="line.2961"></a>
<span class="sourceLineNo">2962</span>                }<a name="line.2962"></a>
<span class="sourceLineNo">2963</span>            }<a name="line.2963"></a>
<span class="sourceLineNo">2964</span>        }<a name="line.2964"></a>
<span class="sourceLineNo">2965</span>        int idx01 = ip * ido;<a name="line.2965"></a>
<span class="sourceLineNo">2966</span>        for (int j = 1; j &lt; ipph; j++) {<a name="line.2966"></a>
<span class="sourceLineNo">2967</span>            jc = ip - j;<a name="line.2967"></a>
<span class="sourceLineNo">2968</span>            j2 = 2 * j;<a name="line.2968"></a>
<span class="sourceLineNo">2969</span>            int idx1 = j * l1 * ido;<a name="line.2969"></a>
<span class="sourceLineNo">2970</span>            int idx2 = jc * l1 * ido;<a name="line.2970"></a>
<span class="sourceLineNo">2971</span>            int idx3 = j2 * ido;<a name="line.2971"></a>
<span class="sourceLineNo">2972</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.2972"></a>
<span class="sourceLineNo">2973</span>                int idx4 = k * ido;<a name="line.2973"></a>
<span class="sourceLineNo">2974</span>                int idx5 = idx4 + idx1;<a name="line.2974"></a>
<span class="sourceLineNo">2975</span>                int idx6 = idx4 + idx2;<a name="line.2975"></a>
<span class="sourceLineNo">2976</span>                int idx7 = k * idx01;<a name="line.2976"></a>
<span class="sourceLineNo">2977</span>                in[in_off + ido - 1 + idx3 - ido + idx7] = out[out_off + idx5];<a name="line.2977"></a>
<span class="sourceLineNo">2978</span>                in[in_off + idx3 + idx7] = out[out_off + idx6];<a name="line.2978"></a>
<span class="sourceLineNo">2979</span>            }<a name="line.2979"></a>
<span class="sourceLineNo">2980</span>        }<a name="line.2980"></a>
<span class="sourceLineNo">2981</span>        if (ido == 1)<a name="line.2981"></a>
<span class="sourceLineNo">2982</span>            return;<a name="line.2982"></a>
<span class="sourceLineNo">2983</span>        if (nbd &gt;= l1) {<a name="line.2983"></a>
<span class="sourceLineNo">2984</span>            for (int j = 1; j &lt; ipph; j++) {<a name="line.2984"></a>
<span class="sourceLineNo">2985</span>                jc = ip - j;<a name="line.2985"></a>
<span class="sourceLineNo">2986</span>                j2 = 2 * j;<a name="line.2986"></a>
<span class="sourceLineNo">2987</span>                int idx1 = j * l1 * ido;<a name="line.2987"></a>
<span class="sourceLineNo">2988</span>                int idx2 = jc * l1 * ido;<a name="line.2988"></a>
<span class="sourceLineNo">2989</span>                int idx3 = j2 * ido;<a name="line.2989"></a>
<span class="sourceLineNo">2990</span>                for (int k = 0; k &lt; l1; k++) {<a name="line.2990"></a>
<span class="sourceLineNo">2991</span>                    int idx4 = k * idx01;<a name="line.2991"></a>
<span class="sourceLineNo">2992</span>                    int idx5 = k * ido;<a name="line.2992"></a>
<span class="sourceLineNo">2993</span>                    for (int i = 2; i &lt; ido; i += 2) {<a name="line.2993"></a>
<span class="sourceLineNo">2994</span>                        ic = ido - i;<a name="line.2994"></a>
<span class="sourceLineNo">2995</span>                        int idx6 = in_off + i;<a name="line.2995"></a>
<span class="sourceLineNo">2996</span>                        int idx7 = in_off + ic;<a name="line.2996"></a>
<span class="sourceLineNo">2997</span>                        int idx8 = out_off + i;<a name="line.2997"></a>
<span class="sourceLineNo">2998</span>                        int iidx1 = idx6 + idx3 + idx4;<a name="line.2998"></a>
<span class="sourceLineNo">2999</span>                        int iidx2 = idx7 + idx3 - ido + idx4;<a name="line.2999"></a>
<span class="sourceLineNo">3000</span>                        int oidx1 = idx8 + idx5 + idx1;<a name="line.3000"></a>
<span class="sourceLineNo">3001</span>                        int oidx2 = idx8 + idx5 + idx2;<a name="line.3001"></a>
<span class="sourceLineNo">3002</span>                        float o1i = out[oidx1 - 1];<a name="line.3002"></a>
<span class="sourceLineNo">3003</span>                        float o1r = out[oidx1];<a name="line.3003"></a>
<span class="sourceLineNo">3004</span>                        float o2i = out[oidx2 - 1];<a name="line.3004"></a>
<span class="sourceLineNo">3005</span>                        float o2r = out[oidx2];<a name="line.3005"></a>
<span class="sourceLineNo">3006</span><a name="line.3006"></a>
<span class="sourceLineNo">3007</span>                        in[iidx1 - 1] = o1i + o2i;<a name="line.3007"></a>
<span class="sourceLineNo">3008</span>                        in[iidx2 - 1] = o1i - o2i;<a name="line.3008"></a>
<span class="sourceLineNo">3009</span>                        in[iidx1] = o1r + o2r;<a name="line.3009"></a>
<span class="sourceLineNo">3010</span>                        in[iidx2] = o2r - o1r;<a name="line.3010"></a>
<span class="sourceLineNo">3011</span>                    }<a name="line.3011"></a>
<span class="sourceLineNo">3012</span>                }<a name="line.3012"></a>
<span class="sourceLineNo">3013</span>            }<a name="line.3013"></a>
<span class="sourceLineNo">3014</span>        } else {<a name="line.3014"></a>
<span class="sourceLineNo">3015</span>            for (int j = 1; j &lt; ipph; j++) {<a name="line.3015"></a>
<span class="sourceLineNo">3016</span>                jc = ip - j;<a name="line.3016"></a>
<span class="sourceLineNo">3017</span>                j2 = 2 * j;<a name="line.3017"></a>
<span class="sourceLineNo">3018</span>                int idx1 = j * l1 * ido;<a name="line.3018"></a>
<span class="sourceLineNo">3019</span>                int idx2 = jc * l1 * ido;<a name="line.3019"></a>
<span class="sourceLineNo">3020</span>                int idx3 = j2 * ido;<a name="line.3020"></a>
<span class="sourceLineNo">3021</span>                for (int i = 2; i &lt; ido; i += 2) {<a name="line.3021"></a>
<span class="sourceLineNo">3022</span>                    ic = ido - i;<a name="line.3022"></a>
<span class="sourceLineNo">3023</span>                    int idx6 = in_off + i;<a name="line.3023"></a>
<span class="sourceLineNo">3024</span>                    int idx7 = in_off + ic;<a name="line.3024"></a>
<span class="sourceLineNo">3025</span>                    int idx8 = out_off + i;<a name="line.3025"></a>
<span class="sourceLineNo">3026</span>                    for (int k = 0; k &lt; l1; k++) {<a name="line.3026"></a>
<span class="sourceLineNo">3027</span>                        int idx4 = k * idx01;<a name="line.3027"></a>
<span class="sourceLineNo">3028</span>                        int idx5 = k * ido;<a name="line.3028"></a>
<span class="sourceLineNo">3029</span>                        int iidx1 = idx6 + idx3 + idx4;<a name="line.3029"></a>
<span class="sourceLineNo">3030</span>                        int iidx2 = idx7 + idx3 - ido + idx4;<a name="line.3030"></a>
<span class="sourceLineNo">3031</span>                        int oidx1 = idx8 + idx5 + idx1;<a name="line.3031"></a>
<span class="sourceLineNo">3032</span>                        int oidx2 = idx8 + idx5 + idx2;<a name="line.3032"></a>
<span class="sourceLineNo">3033</span>                        float o1i = out[oidx1 - 1];<a name="line.3033"></a>
<span class="sourceLineNo">3034</span>                        float o1r = out[oidx1];<a name="line.3034"></a>
<span class="sourceLineNo">3035</span>                        float o2i = out[oidx2 - 1];<a name="line.3035"></a>
<span class="sourceLineNo">3036</span>                        float o2r = out[oidx2];<a name="line.3036"></a>
<span class="sourceLineNo">3037</span><a name="line.3037"></a>
<span class="sourceLineNo">3038</span>                        in[iidx1 - 1] = o1i + o2i;<a name="line.3038"></a>
<span class="sourceLineNo">3039</span>                        in[iidx2 - 1] = o1i - o2i;<a name="line.3039"></a>
<span class="sourceLineNo">3040</span>                        in[iidx1] = o1r + o2r;<a name="line.3040"></a>
<span class="sourceLineNo">3041</span>                        in[iidx2] = o2r - o1r;<a name="line.3041"></a>
<span class="sourceLineNo">3042</span>                    }<a name="line.3042"></a>
<span class="sourceLineNo">3043</span>                }<a name="line.3043"></a>
<span class="sourceLineNo">3044</span>            }<a name="line.3044"></a>
<span class="sourceLineNo">3045</span>        }<a name="line.3045"></a>
<span class="sourceLineNo">3046</span>    }<a name="line.3046"></a>
<span class="sourceLineNo">3047</span><a name="line.3047"></a>
<span class="sourceLineNo">3048</span>    /*---------------------------------------------------------<a name="line.3048"></a>
<span class="sourceLineNo">3049</span>       radbg: Real FFT's backward processing of general factor<a name="line.3049"></a>
<span class="sourceLineNo">3050</span>      --------------------------------------------------------*/<a name="line.3050"></a>
<span class="sourceLineNo">3051</span>    void radbg(final int ido, final int ip, final int l1, final int idl1, final float in[], final int in_off, final float out[], final int out_off, final int offset) {<a name="line.3051"></a>
<span class="sourceLineNo">3052</span>        int idij, ipph, j2, ic, jc, lc, is;<a name="line.3052"></a>
<span class="sourceLineNo">3053</span>        float dc2, ai1, ai2, ar1, ar2, ds2, w1r, w1i;<a name="line.3053"></a>
<span class="sourceLineNo">3054</span>        int nbd;<a name="line.3054"></a>
<span class="sourceLineNo">3055</span>        float dcp, arg, dsp, ar1h, ar2h;<a name="line.3055"></a>
<span class="sourceLineNo">3056</span>        int iw1 = offset;<a name="line.3056"></a>
<span class="sourceLineNo">3057</span><a name="line.3057"></a>
<span class="sourceLineNo">3058</span>        arg = TWO_PI / (float) ip;<a name="line.3058"></a>
<span class="sourceLineNo">3059</span>        dcp = (float)Math.cos(arg);<a name="line.3059"></a>
<span class="sourceLineNo">3060</span>        dsp = (float)Math.sin(arg);<a name="line.3060"></a>
<span class="sourceLineNo">3061</span>        nbd = (ido - 1) / 2;<a name="line.3061"></a>
<span class="sourceLineNo">3062</span>        ipph = (ip + 1) / 2;<a name="line.3062"></a>
<span class="sourceLineNo">3063</span>        int idx0 = ip * ido;<a name="line.3063"></a>
<span class="sourceLineNo">3064</span>        if (ido &gt;= l1) {<a name="line.3064"></a>
<span class="sourceLineNo">3065</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.3065"></a>
<span class="sourceLineNo">3066</span>                int idx1 = k * ido;<a name="line.3066"></a>
<span class="sourceLineNo">3067</span>                int idx2 = k * idx0;<a name="line.3067"></a>
<span class="sourceLineNo">3068</span>                for (int i = 0; i &lt; ido; i++) {<a name="line.3068"></a>
<span class="sourceLineNo">3069</span>                    out[out_off + i + idx1] = in[in_off + i + idx2];<a name="line.3069"></a>
<span class="sourceLineNo">3070</span>                }<a name="line.3070"></a>
<span class="sourceLineNo">3071</span>            }<a name="line.3071"></a>
<span class="sourceLineNo">3072</span>        } else {<a name="line.3072"></a>
<span class="sourceLineNo">3073</span>            for (int i = 0; i &lt; ido; i++) {<a name="line.3073"></a>
<span class="sourceLineNo">3074</span>                int idx1 = out_off + i;<a name="line.3074"></a>
<span class="sourceLineNo">3075</span>                int idx2 = in_off + i;<a name="line.3075"></a>
<span class="sourceLineNo">3076</span>                for (int k = 0; k &lt; l1; k++) {<a name="line.3076"></a>
<span class="sourceLineNo">3077</span>                    out[idx1 + k * ido] = in[idx2 + k * idx0];<a name="line.3077"></a>
<span class="sourceLineNo">3078</span>                }<a name="line.3078"></a>
<span class="sourceLineNo">3079</span>            }<a name="line.3079"></a>
<span class="sourceLineNo">3080</span>        }<a name="line.3080"></a>
<span class="sourceLineNo">3081</span>        int iidx0 = in_off + ido - 1;<a name="line.3081"></a>
<span class="sourceLineNo">3082</span>        for (int j = 1; j &lt; ipph; j++) {<a name="line.3082"></a>
<span class="sourceLineNo">3083</span>            jc = ip - j;<a name="line.3083"></a>
<span class="sourceLineNo">3084</span>            j2 = 2 * j;<a name="line.3084"></a>
<span class="sourceLineNo">3085</span>            int idx1 = j * l1 * ido;<a name="line.3085"></a>
<span class="sourceLineNo">3086</span>            int idx2 = jc * l1 * ido;<a name="line.3086"></a>
<span class="sourceLineNo">3087</span>            int idx3 = j2 * ido;<a name="line.3087"></a>
<span class="sourceLineNo">3088</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.3088"></a>
<span class="sourceLineNo">3089</span>                int idx4 = k * ido;<a name="line.3089"></a>
<span class="sourceLineNo">3090</span>                int idx5 = idx4 * ip;<a name="line.3090"></a>
<span class="sourceLineNo">3091</span>                int iidx1 = iidx0 + idx3 + idx5 - ido;<a name="line.3091"></a>
<span class="sourceLineNo">3092</span>                int iidx2 = in_off + idx3 + idx5;<a name="line.3092"></a>
<span class="sourceLineNo">3093</span>                float i1r = in[iidx1];<a name="line.3093"></a>
<span class="sourceLineNo">3094</span>                float i2r = in[iidx2];<a name="line.3094"></a>
<span class="sourceLineNo">3095</span><a name="line.3095"></a>
<span class="sourceLineNo">3096</span>                out[out_off + idx4 + idx1] = i1r + i1r;<a name="line.3096"></a>
<span class="sourceLineNo">3097</span>                out[out_off + idx4 + idx2] = i2r + i2r;<a name="line.3097"></a>
<span class="sourceLineNo">3098</span>            }<a name="line.3098"></a>
<span class="sourceLineNo">3099</span>        }<a name="line.3099"></a>
<span class="sourceLineNo">3100</span><a name="line.3100"></a>
<span class="sourceLineNo">3101</span>        if (ido != 1) {<a name="line.3101"></a>
<span class="sourceLineNo">3102</span>            if (nbd &gt;= l1) {<a name="line.3102"></a>
<span class="sourceLineNo">3103</span>                for (int j = 1; j &lt; ipph; j++) {<a name="line.3103"></a>
<span class="sourceLineNo">3104</span>                    jc = ip - j;<a name="line.3104"></a>
<span class="sourceLineNo">3105</span>                    int idx1 = j * l1 * ido;<a name="line.3105"></a>
<span class="sourceLineNo">3106</span>                    int idx2 = jc * l1 * ido;<a name="line.3106"></a>
<span class="sourceLineNo">3107</span>                    int idx3 = 2 * j * ido;<a name="line.3107"></a>
<span class="sourceLineNo">3108</span>                    for (int k = 0; k &lt; l1; k++) {<a name="line.3108"></a>
<span class="sourceLineNo">3109</span>                        int idx4 = k * ido + idx1;<a name="line.3109"></a>
<span class="sourceLineNo">3110</span>                        int idx5 = k * ido + idx2;<a name="line.3110"></a>
<span class="sourceLineNo">3111</span>                        int idx6 = k * ip * ido + idx3;<a name="line.3111"></a>
<span class="sourceLineNo">3112</span>                        for (int i = 2; i &lt; ido; i += 2) {<a name="line.3112"></a>
<span class="sourceLineNo">3113</span>                            ic = ido - i;<a name="line.3113"></a>
<span class="sourceLineNo">3114</span>                            int idx7 = out_off + i;<a name="line.3114"></a>
<span class="sourceLineNo">3115</span>                            int idx8 = in_off + ic;<a name="line.3115"></a>
<span class="sourceLineNo">3116</span>                            int idx9 = in_off + i;<a name="line.3116"></a>
<span class="sourceLineNo">3117</span>                            int oidx1 = idx7 + idx4;<a name="line.3117"></a>
<span class="sourceLineNo">3118</span>                            int oidx2 = idx7 + idx5;<a name="line.3118"></a>
<span class="sourceLineNo">3119</span>                            int iidx1 = idx9 + idx6;<a name="line.3119"></a>
<span class="sourceLineNo">3120</span>                            int iidx2 = idx8 + idx6 - ido;<a name="line.3120"></a>
<span class="sourceLineNo">3121</span>                            float a1i = in[iidx1 - 1];<a name="line.3121"></a>
<span class="sourceLineNo">3122</span>                            float a1r = in[iidx1];<a name="line.3122"></a>
<span class="sourceLineNo">3123</span>                            float a2i = in[iidx2 - 1];<a name="line.3123"></a>
<span class="sourceLineNo">3124</span>                            float a2r = in[iidx2];<a name="line.3124"></a>
<span class="sourceLineNo">3125</span><a name="line.3125"></a>
<span class="sourceLineNo">3126</span>                            out[oidx1 - 1] = a1i + a2i;<a name="line.3126"></a>
<span class="sourceLineNo">3127</span>                            out[oidx2 - 1] = a1i - a2i;<a name="line.3127"></a>
<span class="sourceLineNo">3128</span>                            out[oidx1] = a1r - a2r;<a name="line.3128"></a>
<span class="sourceLineNo">3129</span>                            out[oidx2] = a1r + a2r;<a name="line.3129"></a>
<span class="sourceLineNo">3130</span>                        }<a name="line.3130"></a>
<span class="sourceLineNo">3131</span>                    }<a name="line.3131"></a>
<span class="sourceLineNo">3132</span>                }<a name="line.3132"></a>
<span class="sourceLineNo">3133</span>            } else {<a name="line.3133"></a>
<span class="sourceLineNo">3134</span>                for (int j = 1; j &lt; ipph; j++) {<a name="line.3134"></a>
<span class="sourceLineNo">3135</span>                    jc = ip - j;<a name="line.3135"></a>
<span class="sourceLineNo">3136</span>                    int idx1 = j * l1 * ido;<a name="line.3136"></a>
<span class="sourceLineNo">3137</span>                    int idx2 = jc * l1 * ido;<a name="line.3137"></a>
<span class="sourceLineNo">3138</span>                    int idx3 = 2 * j * ido;<a name="line.3138"></a>
<span class="sourceLineNo">3139</span>                    for (int i = 2; i &lt; ido; i += 2) {<a name="line.3139"></a>
<span class="sourceLineNo">3140</span>                        ic = ido - i;<a name="line.3140"></a>
<span class="sourceLineNo">3141</span>                        int idx7 = out_off + i;<a name="line.3141"></a>
<span class="sourceLineNo">3142</span>                        int idx8 = in_off + ic;<a name="line.3142"></a>
<span class="sourceLineNo">3143</span>                        int idx9 = in_off + i;<a name="line.3143"></a>
<span class="sourceLineNo">3144</span>                        for (int k = 0; k &lt; l1; k++) {<a name="line.3144"></a>
<span class="sourceLineNo">3145</span>                            int idx4 = k * ido + idx1;<a name="line.3145"></a>
<span class="sourceLineNo">3146</span>                            int idx5 = k * ido + idx2;<a name="line.3146"></a>
<span class="sourceLineNo">3147</span>                            int idx6 = k * ip * ido + idx3;<a name="line.3147"></a>
<span class="sourceLineNo">3148</span>                            int oidx1 = idx7 + idx4;<a name="line.3148"></a>
<span class="sourceLineNo">3149</span>                            int oidx2 = idx7 + idx5;<a name="line.3149"></a>
<span class="sourceLineNo">3150</span>                            int iidx1 = idx9 + idx6;<a name="line.3150"></a>
<span class="sourceLineNo">3151</span>                            int iidx2 = idx8 + idx6 - ido;<a name="line.3151"></a>
<span class="sourceLineNo">3152</span>                            float a1i = in[iidx1 - 1];<a name="line.3152"></a>
<span class="sourceLineNo">3153</span>                            float a1r = in[iidx1];<a name="line.3153"></a>
<span class="sourceLineNo">3154</span>                            float a2i = in[iidx2 - 1];<a name="line.3154"></a>
<span class="sourceLineNo">3155</span>                            float a2r = in[iidx2];<a name="line.3155"></a>
<span class="sourceLineNo">3156</span><a name="line.3156"></a>
<span class="sourceLineNo">3157</span>                            out[oidx1 - 1] = a1i + a2i;<a name="line.3157"></a>
<span class="sourceLineNo">3158</span>                            out[oidx2 - 1] = a1i - a2i;<a name="line.3158"></a>
<span class="sourceLineNo">3159</span>                            out[oidx1] = a1r - a2r;<a name="line.3159"></a>
<span class="sourceLineNo">3160</span>                            out[oidx2] = a1r + a2r;<a name="line.3160"></a>
<span class="sourceLineNo">3161</span>                        }<a name="line.3161"></a>
<span class="sourceLineNo">3162</span>                    }<a name="line.3162"></a>
<span class="sourceLineNo">3163</span>                }<a name="line.3163"></a>
<span class="sourceLineNo">3164</span>            }<a name="line.3164"></a>
<span class="sourceLineNo">3165</span>        }<a name="line.3165"></a>
<span class="sourceLineNo">3166</span><a name="line.3166"></a>
<span class="sourceLineNo">3167</span>        ar1 = 1;<a name="line.3167"></a>
<span class="sourceLineNo">3168</span>        ai1 = 0;<a name="line.3168"></a>
<span class="sourceLineNo">3169</span>        int idx01 = (ip - 1) * idl1;<a name="line.3169"></a>
<span class="sourceLineNo">3170</span>        for (int l = 1; l &lt; ipph; l++) {<a name="line.3170"></a>
<span class="sourceLineNo">3171</span>            lc = ip - l;<a name="line.3171"></a>
<span class="sourceLineNo">3172</span>            ar1h = dcp * ar1 - dsp * ai1;<a name="line.3172"></a>
<span class="sourceLineNo">3173</span>            ai1 = dcp * ai1 + dsp * ar1;<a name="line.3173"></a>
<span class="sourceLineNo">3174</span>            ar1 = ar1h;<a name="line.3174"></a>
<span class="sourceLineNo">3175</span>            int idx1 = l * idl1;<a name="line.3175"></a>
<span class="sourceLineNo">3176</span>            int idx2 = lc * idl1;<a name="line.3176"></a>
<span class="sourceLineNo">3177</span>            for (int ik = 0; ik &lt; idl1; ik++) {<a name="line.3177"></a>
<span class="sourceLineNo">3178</span>                int idx3 = in_off + ik;<a name="line.3178"></a>
<span class="sourceLineNo">3179</span>                int idx4 = out_off + ik;<a name="line.3179"></a>
<span class="sourceLineNo">3180</span>                in[idx3 + idx1] = out[idx4] + ar1 * out[idx4 + idl1];<a name="line.3180"></a>
<span class="sourceLineNo">3181</span>                in[idx3 + idx2] = ai1 * out[idx4 + idx01];<a name="line.3181"></a>
<span class="sourceLineNo">3182</span>            }<a name="line.3182"></a>
<span class="sourceLineNo">3183</span>            dc2 = ar1;<a name="line.3183"></a>
<span class="sourceLineNo">3184</span>            ds2 = ai1;<a name="line.3184"></a>
<span class="sourceLineNo">3185</span>            ar2 = ar1;<a name="line.3185"></a>
<span class="sourceLineNo">3186</span>            ai2 = ai1;<a name="line.3186"></a>
<span class="sourceLineNo">3187</span>            for (int j = 2; j &lt; ipph; j++) {<a name="line.3187"></a>
<span class="sourceLineNo">3188</span>                jc = ip - j;<a name="line.3188"></a>
<span class="sourceLineNo">3189</span>                ar2h = dc2 * ar2 - ds2 * ai2;<a name="line.3189"></a>
<span class="sourceLineNo">3190</span>                ai2 = dc2 * ai2 + ds2 * ar2;<a name="line.3190"></a>
<span class="sourceLineNo">3191</span>                ar2 = ar2h;<a name="line.3191"></a>
<span class="sourceLineNo">3192</span>                int idx5 = j * idl1;<a name="line.3192"></a>
<span class="sourceLineNo">3193</span>                int idx6 = jc * idl1;<a name="line.3193"></a>
<span class="sourceLineNo">3194</span>                for (int ik = 0; ik &lt; idl1; ik++) {<a name="line.3194"></a>
<span class="sourceLineNo">3195</span>                    int idx7 = in_off + ik;<a name="line.3195"></a>
<span class="sourceLineNo">3196</span>                    int idx8 = out_off + ik;<a name="line.3196"></a>
<span class="sourceLineNo">3197</span>                    in[idx7 + idx1] += ar2 * out[idx8 + idx5];<a name="line.3197"></a>
<span class="sourceLineNo">3198</span>                    in[idx7 + idx2] += ai2 * out[idx8 + idx6];<a name="line.3198"></a>
<span class="sourceLineNo">3199</span>                }<a name="line.3199"></a>
<span class="sourceLineNo">3200</span>            }<a name="line.3200"></a>
<span class="sourceLineNo">3201</span>        }<a name="line.3201"></a>
<span class="sourceLineNo">3202</span>        for (int j = 1; j &lt; ipph; j++) {<a name="line.3202"></a>
<span class="sourceLineNo">3203</span>            int idx1 = j * idl1;<a name="line.3203"></a>
<span class="sourceLineNo">3204</span>            for (int ik = 0; ik &lt; idl1; ik++) {<a name="line.3204"></a>
<span class="sourceLineNo">3205</span>                int idx2 = out_off + ik;<a name="line.3205"></a>
<span class="sourceLineNo">3206</span>                out[idx2] += out[idx2 + idx1];<a name="line.3206"></a>
<span class="sourceLineNo">3207</span>            }<a name="line.3207"></a>
<span class="sourceLineNo">3208</span>        }<a name="line.3208"></a>
<span class="sourceLineNo">3209</span>        for (int j = 1; j &lt; ipph; j++) {<a name="line.3209"></a>
<span class="sourceLineNo">3210</span>            jc = ip - j;<a name="line.3210"></a>
<span class="sourceLineNo">3211</span>            int idx1 = j * l1 * ido;<a name="line.3211"></a>
<span class="sourceLineNo">3212</span>            int idx2 = jc * l1 * ido;<a name="line.3212"></a>
<span class="sourceLineNo">3213</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.3213"></a>
<span class="sourceLineNo">3214</span>                int idx3 = k * ido;<a name="line.3214"></a>
<span class="sourceLineNo">3215</span>                int oidx1 = out_off + idx3;<a name="line.3215"></a>
<span class="sourceLineNo">3216</span>                int iidx1 = in_off + idx3 + idx1;<a name="line.3216"></a>
<span class="sourceLineNo">3217</span>                int iidx2 = in_off + idx3 + idx2;<a name="line.3217"></a>
<span class="sourceLineNo">3218</span>                float i1r = in[iidx1];<a name="line.3218"></a>
<span class="sourceLineNo">3219</span>                float i2r = in[iidx2];<a name="line.3219"></a>
<span class="sourceLineNo">3220</span><a name="line.3220"></a>
<span class="sourceLineNo">3221</span>                out[oidx1 + idx1] = i1r - i2r;<a name="line.3221"></a>
<span class="sourceLineNo">3222</span>                out[oidx1 + idx2] = i1r + i2r;<a name="line.3222"></a>
<span class="sourceLineNo">3223</span>            }<a name="line.3223"></a>
<span class="sourceLineNo">3224</span>        }<a name="line.3224"></a>
<span class="sourceLineNo">3225</span><a name="line.3225"></a>
<span class="sourceLineNo">3226</span>        if (ido == 1)<a name="line.3226"></a>
<span class="sourceLineNo">3227</span>            return;<a name="line.3227"></a>
<span class="sourceLineNo">3228</span>        if (nbd &gt;= l1) {<a name="line.3228"></a>
<span class="sourceLineNo">3229</span>            for (int j = 1; j &lt; ipph; j++) {<a name="line.3229"></a>
<span class="sourceLineNo">3230</span>                jc = ip - j;<a name="line.3230"></a>
<span class="sourceLineNo">3231</span>                int idx1 = j * l1 * ido;<a name="line.3231"></a>
<span class="sourceLineNo">3232</span>                int idx2 = jc * l1 * ido;<a name="line.3232"></a>
<span class="sourceLineNo">3233</span>                for (int k = 0; k &lt; l1; k++) {<a name="line.3233"></a>
<span class="sourceLineNo">3234</span>                    int idx3 = k * ido;<a name="line.3234"></a>
<span class="sourceLineNo">3235</span>                    for (int i = 2; i &lt; ido; i += 2) {<a name="line.3235"></a>
<span class="sourceLineNo">3236</span>                        int idx4 = out_off + i;<a name="line.3236"></a>
<span class="sourceLineNo">3237</span>                        int idx5 = in_off + i;<a name="line.3237"></a>
<span class="sourceLineNo">3238</span>                        int oidx1 = idx4 + idx3 + idx1;<a name="line.3238"></a>
<span class="sourceLineNo">3239</span>                        int oidx2 = idx4 + idx3 + idx2;<a name="line.3239"></a>
<span class="sourceLineNo">3240</span>                        int iidx1 = idx5 + idx3 + idx1;<a name="line.3240"></a>
<span class="sourceLineNo">3241</span>                        int iidx2 = idx5 + idx3 + idx2;<a name="line.3241"></a>
<span class="sourceLineNo">3242</span>                        float i1i = in[iidx1 - 1];<a name="line.3242"></a>
<span class="sourceLineNo">3243</span>                        float i1r = in[iidx1];<a name="line.3243"></a>
<span class="sourceLineNo">3244</span>                        float i2i = in[iidx2 - 1];<a name="line.3244"></a>
<span class="sourceLineNo">3245</span>                        float i2r = in[iidx2];<a name="line.3245"></a>
<span class="sourceLineNo">3246</span><a name="line.3246"></a>
<span class="sourceLineNo">3247</span>                        out[oidx1 - 1] = i1i - i2r;<a name="line.3247"></a>
<span class="sourceLineNo">3248</span>                        out[oidx2 - 1] = i1i + i2r;<a name="line.3248"></a>
<span class="sourceLineNo">3249</span>                        out[oidx1] = i1r + i2i;<a name="line.3249"></a>
<span class="sourceLineNo">3250</span>                        out[oidx2] = i1r - i2i;<a name="line.3250"></a>
<span class="sourceLineNo">3251</span>                    }<a name="line.3251"></a>
<span class="sourceLineNo">3252</span>                }<a name="line.3252"></a>
<span class="sourceLineNo">3253</span>            }<a name="line.3253"></a>
<span class="sourceLineNo">3254</span>        } else {<a name="line.3254"></a>
<span class="sourceLineNo">3255</span>            for (int j = 1; j &lt; ipph; j++) {<a name="line.3255"></a>
<span class="sourceLineNo">3256</span>                jc = ip - j;<a name="line.3256"></a>
<span class="sourceLineNo">3257</span>                int idx1 = j * l1 * ido;<a name="line.3257"></a>
<span class="sourceLineNo">3258</span>                int idx2 = jc * l1 * ido;<a name="line.3258"></a>
<span class="sourceLineNo">3259</span>                for (int i = 2; i &lt; ido; i += 2) {<a name="line.3259"></a>
<span class="sourceLineNo">3260</span>                    int idx4 = out_off + i;<a name="line.3260"></a>
<span class="sourceLineNo">3261</span>                    int idx5 = in_off + i;<a name="line.3261"></a>
<span class="sourceLineNo">3262</span>                    for (int k = 0; k &lt; l1; k++) {<a name="line.3262"></a>
<span class="sourceLineNo">3263</span>                        int idx3 = k * ido;<a name="line.3263"></a>
<span class="sourceLineNo">3264</span>                        int oidx1 = idx4 + idx3 + idx1;<a name="line.3264"></a>
<span class="sourceLineNo">3265</span>                        int oidx2 = idx4 + idx3 + idx2;<a name="line.3265"></a>
<span class="sourceLineNo">3266</span>                        int iidx1 = idx5 + idx3 + idx1;<a name="line.3266"></a>
<span class="sourceLineNo">3267</span>                        int iidx2 = idx5 + idx3 + idx2;<a name="line.3267"></a>
<span class="sourceLineNo">3268</span>                        float i1i = in[iidx1 - 1];<a name="line.3268"></a>
<span class="sourceLineNo">3269</span>                        float i1r = in[iidx1];<a name="line.3269"></a>
<span class="sourceLineNo">3270</span>                        float i2i = in[iidx2 - 1];<a name="line.3270"></a>
<span class="sourceLineNo">3271</span>                        float i2r = in[iidx2];<a name="line.3271"></a>
<span class="sourceLineNo">3272</span><a name="line.3272"></a>
<span class="sourceLineNo">3273</span>                        out[oidx1 - 1] = i1i - i2r;<a name="line.3273"></a>
<span class="sourceLineNo">3274</span>                        out[oidx2 - 1] = i1i + i2r;<a name="line.3274"></a>
<span class="sourceLineNo">3275</span>                        out[oidx1] = i1r + i2i;<a name="line.3275"></a>
<span class="sourceLineNo">3276</span>                        out[oidx2] = i1r - i2i;<a name="line.3276"></a>
<span class="sourceLineNo">3277</span>                    }<a name="line.3277"></a>
<span class="sourceLineNo">3278</span>                }<a name="line.3278"></a>
<span class="sourceLineNo">3279</span>            }<a name="line.3279"></a>
<span class="sourceLineNo">3280</span>        }<a name="line.3280"></a>
<span class="sourceLineNo">3281</span>        System.arraycopy(out, out_off, in, in_off, idl1);<a name="line.3281"></a>
<span class="sourceLineNo">3282</span>        for (int j = 1; j &lt; ip; j++) {<a name="line.3282"></a>
<span class="sourceLineNo">3283</span>            int idx1 = j * l1 * ido;<a name="line.3283"></a>
<span class="sourceLineNo">3284</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.3284"></a>
<span class="sourceLineNo">3285</span>                int idx2 = k * ido + idx1;<a name="line.3285"></a>
<span class="sourceLineNo">3286</span>                in[in_off + idx2] = out[out_off + idx2];<a name="line.3286"></a>
<span class="sourceLineNo">3287</span>            }<a name="line.3287"></a>
<span class="sourceLineNo">3288</span>        }<a name="line.3288"></a>
<span class="sourceLineNo">3289</span>        if (nbd &lt;= l1) {<a name="line.3289"></a>
<span class="sourceLineNo">3290</span>            is = -ido;<a name="line.3290"></a>
<span class="sourceLineNo">3291</span>            for (int j = 1; j &lt; ip; j++) {<a name="line.3291"></a>
<span class="sourceLineNo">3292</span>                is += ido;<a name="line.3292"></a>
<span class="sourceLineNo">3293</span>                idij = is - 1;<a name="line.3293"></a>
<span class="sourceLineNo">3294</span>                int idx1 = j * l1 * ido;<a name="line.3294"></a>
<span class="sourceLineNo">3295</span>                for (int i = 2; i &lt; ido; i += 2) {<a name="line.3295"></a>
<span class="sourceLineNo">3296</span>                    idij += 2;<a name="line.3296"></a>
<span class="sourceLineNo">3297</span>                    int idx2 = idij + iw1;<a name="line.3297"></a>
<span class="sourceLineNo">3298</span>                    w1r = wtable_r[idx2 - 1];<a name="line.3298"></a>
<span class="sourceLineNo">3299</span>                    w1i = wtable_r[idx2];<a name="line.3299"></a>
<span class="sourceLineNo">3300</span>                    int idx4 = in_off + i;<a name="line.3300"></a>
<span class="sourceLineNo">3301</span>                    int idx5 = out_off + i;<a name="line.3301"></a>
<span class="sourceLineNo">3302</span>                    for (int k = 0; k &lt; l1; k++) {<a name="line.3302"></a>
<span class="sourceLineNo">3303</span>                        int idx3 = k * ido + idx1;<a name="line.3303"></a>
<span class="sourceLineNo">3304</span>                        int iidx1 = idx4 + idx3;<a name="line.3304"></a>
<span class="sourceLineNo">3305</span>                        int oidx1 = idx5 + idx3;<a name="line.3305"></a>
<span class="sourceLineNo">3306</span>                        float o1i = out[oidx1 - 1];<a name="line.3306"></a>
<span class="sourceLineNo">3307</span>                        float o1r = out[oidx1];<a name="line.3307"></a>
<span class="sourceLineNo">3308</span><a name="line.3308"></a>
<span class="sourceLineNo">3309</span>                        in[iidx1 - 1] = w1r * o1i - w1i * o1r;<a name="line.3309"></a>
<span class="sourceLineNo">3310</span>                        in[iidx1] = w1r * o1r + w1i * o1i;<a name="line.3310"></a>
<span class="sourceLineNo">3311</span>                    }<a name="line.3311"></a>
<span class="sourceLineNo">3312</span>                }<a name="line.3312"></a>
<span class="sourceLineNo">3313</span>            }<a name="line.3313"></a>
<span class="sourceLineNo">3314</span>        } else {<a name="line.3314"></a>
<span class="sourceLineNo">3315</span>            is = -ido;<a name="line.3315"></a>
<span class="sourceLineNo">3316</span>            for (int j = 1; j &lt; ip; j++) {<a name="line.3316"></a>
<span class="sourceLineNo">3317</span>                is += ido;<a name="line.3317"></a>
<span class="sourceLineNo">3318</span>                int idx1 = j * l1 * ido;<a name="line.3318"></a>
<span class="sourceLineNo">3319</span>                for (int k = 0; k &lt; l1; k++) {<a name="line.3319"></a>
<span class="sourceLineNo">3320</span>                    idij = is - 1;<a name="line.3320"></a>
<span class="sourceLineNo">3321</span>                    int idx3 = k * ido + idx1;<a name="line.3321"></a>
<span class="sourceLineNo">3322</span>                    for (int i = 2; i &lt; ido; i += 2) {<a name="line.3322"></a>
<span class="sourceLineNo">3323</span>                        idij += 2;<a name="line.3323"></a>
<span class="sourceLineNo">3324</span>                        int idx2 = idij + iw1;<a name="line.3324"></a>
<span class="sourceLineNo">3325</span>                        w1r = wtable_r[idx2 - 1];<a name="line.3325"></a>
<span class="sourceLineNo">3326</span>                        w1i = wtable_r[idx2];<a name="line.3326"></a>
<span class="sourceLineNo">3327</span>                        int idx4 = in_off + i;<a name="line.3327"></a>
<span class="sourceLineNo">3328</span>                        int idx5 = out_off + i;<a name="line.3328"></a>
<span class="sourceLineNo">3329</span>                        int iidx1 = idx4 + idx3;<a name="line.3329"></a>
<span class="sourceLineNo">3330</span>                        int oidx1 = idx5 + idx3;<a name="line.3330"></a>
<span class="sourceLineNo">3331</span>                        float o1i = out[oidx1 - 1];<a name="line.3331"></a>
<span class="sourceLineNo">3332</span>                        float o1r = out[oidx1];<a name="line.3332"></a>
<span class="sourceLineNo">3333</span><a name="line.3333"></a>
<span class="sourceLineNo">3334</span>                        in[iidx1 - 1] = w1r * o1i - w1i * o1r;<a name="line.3334"></a>
<span class="sourceLineNo">3335</span>                        in[iidx1] = w1r * o1r + w1i * o1i;<a name="line.3335"></a>
<span class="sourceLineNo">3336</span><a name="line.3336"></a>
<span class="sourceLineNo">3337</span>                    }<a name="line.3337"></a>
<span class="sourceLineNo">3338</span>                }<a name="line.3338"></a>
<span class="sourceLineNo">3339</span>            }<a name="line.3339"></a>
<span class="sourceLineNo">3340</span>        }<a name="line.3340"></a>
<span class="sourceLineNo">3341</span>    }<a name="line.3341"></a>
<span class="sourceLineNo">3342</span><a name="line.3342"></a>
<span class="sourceLineNo">3343</span>    /*---------------------------------------------------------<a name="line.3343"></a>
<span class="sourceLineNo">3344</span>       cfftf1: further processing of Complex forward FFT<a name="line.3344"></a>
<span class="sourceLineNo">3345</span>      --------------------------------------------------------*/<a name="line.3345"></a>
<span class="sourceLineNo">3346</span>    void cfftf(float a[], int offa, int isign) {<a name="line.3346"></a>
<span class="sourceLineNo">3347</span>        int idot;<a name="line.3347"></a>
<span class="sourceLineNo">3348</span>        int l1, l2;<a name="line.3348"></a>
<span class="sourceLineNo">3349</span>        int na, nf, ip, iw, ido, idl1;<a name="line.3349"></a>
<span class="sourceLineNo">3350</span>        int[] nac = new int[1];<a name="line.3350"></a>
<span class="sourceLineNo">3351</span>        final int twon = 2 * n;<a name="line.3351"></a>
<span class="sourceLineNo">3352</span><a name="line.3352"></a>
<span class="sourceLineNo">3353</span>        int iw1, iw2;<a name="line.3353"></a>
<span class="sourceLineNo">3354</span>        float[] ch = new float[twon];<a name="line.3354"></a>
<span class="sourceLineNo">3355</span><a name="line.3355"></a>
<span class="sourceLineNo">3356</span>        iw1 = twon;<a name="line.3356"></a>
<span class="sourceLineNo">3357</span>        iw2 = 4 * n;<a name="line.3357"></a>
<span class="sourceLineNo">3358</span>        nac[0] = 0;<a name="line.3358"></a>
<span class="sourceLineNo">3359</span>        nf = (int) wtable[1 + iw2];<a name="line.3359"></a>
<span class="sourceLineNo">3360</span>        na = 0;<a name="line.3360"></a>
<span class="sourceLineNo">3361</span>        l1 = 1;<a name="line.3361"></a>
<span class="sourceLineNo">3362</span>        iw = iw1;<a name="line.3362"></a>
<span class="sourceLineNo">3363</span>        for (int k1 = 2; k1 &lt;= nf + 1; k1++) {<a name="line.3363"></a>
<span class="sourceLineNo">3364</span>            ip = (int) wtable[k1 + iw2];<a name="line.3364"></a>
<span class="sourceLineNo">3365</span>            l2 = ip * l1;<a name="line.3365"></a>
<span class="sourceLineNo">3366</span>            ido = n / l2;<a name="line.3366"></a>
<span class="sourceLineNo">3367</span>            idot = ido + ido;<a name="line.3367"></a>
<span class="sourceLineNo">3368</span>            idl1 = idot * l1;<a name="line.3368"></a>
<span class="sourceLineNo">3369</span>            switch (ip) {<a name="line.3369"></a>
<span class="sourceLineNo">3370</span>            case 4:<a name="line.3370"></a>
<span class="sourceLineNo">3371</span>                if (na == 0) {<a name="line.3371"></a>
<span class="sourceLineNo">3372</span>                    passf4(idot, l1, a, offa, ch, 0, iw, isign);<a name="line.3372"></a>
<span class="sourceLineNo">3373</span>                } else {<a name="line.3373"></a>
<span class="sourceLineNo">3374</span>                    passf4(idot, l1, ch, 0, a, offa, iw, isign);<a name="line.3374"></a>
<span class="sourceLineNo">3375</span>                }<a name="line.3375"></a>
<span class="sourceLineNo">3376</span>                na = 1 - na;<a name="line.3376"></a>
<span class="sourceLineNo">3377</span>                break;<a name="line.3377"></a>
<span class="sourceLineNo">3378</span>            case 2:<a name="line.3378"></a>
<span class="sourceLineNo">3379</span>                if (na == 0) {<a name="line.3379"></a>
<span class="sourceLineNo">3380</span>                    passf2(idot, l1, a, offa, ch, 0, iw, isign);<a name="line.3380"></a>
<span class="sourceLineNo">3381</span>                } else {<a name="line.3381"></a>
<span class="sourceLineNo">3382</span>                    passf2(idot, l1, ch, 0, a, offa, iw, isign);<a name="line.3382"></a>
<span class="sourceLineNo">3383</span>                }<a name="line.3383"></a>
<span class="sourceLineNo">3384</span>                na = 1 - na;<a name="line.3384"></a>
<span class="sourceLineNo">3385</span>                break;<a name="line.3385"></a>
<span class="sourceLineNo">3386</span>            case 3:<a name="line.3386"></a>
<span class="sourceLineNo">3387</span>                if (na == 0) {<a name="line.3387"></a>
<span class="sourceLineNo">3388</span>                    passf3(idot, l1, a, offa, ch, 0, iw, isign);<a name="line.3388"></a>
<span class="sourceLineNo">3389</span>                } else {<a name="line.3389"></a>
<span class="sourceLineNo">3390</span>                    passf3(idot, l1, ch, 0, a, offa, iw, isign);<a name="line.3390"></a>
<span class="sourceLineNo">3391</span>                }<a name="line.3391"></a>
<span class="sourceLineNo">3392</span>                na = 1 - na;<a name="line.3392"></a>
<span class="sourceLineNo">3393</span>                break;<a name="line.3393"></a>
<span class="sourceLineNo">3394</span>            case 5:<a name="line.3394"></a>
<span class="sourceLineNo">3395</span>                if (na == 0) {<a name="line.3395"></a>
<span class="sourceLineNo">3396</span>                    passf5(idot, l1, a, offa, ch, 0, iw, isign);<a name="line.3396"></a>
<span class="sourceLineNo">3397</span>                } else {<a name="line.3397"></a>
<span class="sourceLineNo">3398</span>                    passf5(idot, l1, ch, 0, a, offa, iw, isign);<a name="line.3398"></a>
<span class="sourceLineNo">3399</span>                }<a name="line.3399"></a>
<span class="sourceLineNo">3400</span>                na = 1 - na;<a name="line.3400"></a>
<span class="sourceLineNo">3401</span>                break;<a name="line.3401"></a>
<span class="sourceLineNo">3402</span>            default:<a name="line.3402"></a>
<span class="sourceLineNo">3403</span>                if (na == 0) {<a name="line.3403"></a>
<span class="sourceLineNo">3404</span>                    passfg(nac, idot, ip, l1, idl1, a, offa, ch, 0, iw, isign);<a name="line.3404"></a>
<span class="sourceLineNo">3405</span>                } else {<a name="line.3405"></a>
<span class="sourceLineNo">3406</span>                    passfg(nac, idot, ip, l1, idl1, ch, 0, a, offa, iw, isign);<a name="line.3406"></a>
<span class="sourceLineNo">3407</span>                }<a name="line.3407"></a>
<span class="sourceLineNo">3408</span>                if (nac[0] != 0)<a name="line.3408"></a>
<span class="sourceLineNo">3409</span>                    na = 1 - na;<a name="line.3409"></a>
<span class="sourceLineNo">3410</span>                break;<a name="line.3410"></a>
<span class="sourceLineNo">3411</span>            }<a name="line.3411"></a>
<span class="sourceLineNo">3412</span>            l1 = l2;<a name="line.3412"></a>
<span class="sourceLineNo">3413</span>            iw += (ip - 1) * idot;<a name="line.3413"></a>
<span class="sourceLineNo">3414</span>        }<a name="line.3414"></a>
<span class="sourceLineNo">3415</span>        if (na == 0)<a name="line.3415"></a>
<span class="sourceLineNo">3416</span>            return;<a name="line.3416"></a>
<span class="sourceLineNo">3417</span>        System.arraycopy(ch, 0, a, offa, twon);<a name="line.3417"></a>
<span class="sourceLineNo">3418</span><a name="line.3418"></a>
<span class="sourceLineNo">3419</span>    }<a name="line.3419"></a>
<span class="sourceLineNo">3420</span><a name="line.3420"></a>
<span class="sourceLineNo">3421</span>    /*----------------------------------------------------------------------<a name="line.3421"></a>
<span class="sourceLineNo">3422</span>       passf2: Complex FFT's forward/backward processing of factor 2;<a name="line.3422"></a>
<span class="sourceLineNo">3423</span>       isign is +1 for backward and -1 for forward transforms<a name="line.3423"></a>
<span class="sourceLineNo">3424</span>      ----------------------------------------------------------------------*/<a name="line.3424"></a>
<span class="sourceLineNo">3425</span><a name="line.3425"></a>
<span class="sourceLineNo">3426</span>    void passf2(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset, final int isign) {<a name="line.3426"></a>
<span class="sourceLineNo">3427</span>        float t1i, t1r;<a name="line.3427"></a>
<span class="sourceLineNo">3428</span>        int iw1;<a name="line.3428"></a>
<span class="sourceLineNo">3429</span>        iw1 = offset;<a name="line.3429"></a>
<span class="sourceLineNo">3430</span>        int idx = ido * l1;<a name="line.3430"></a>
<span class="sourceLineNo">3431</span>        if (ido &lt;= 2) {<a name="line.3431"></a>
<span class="sourceLineNo">3432</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.3432"></a>
<span class="sourceLineNo">3433</span>                int idx0 = k * ido;<a name="line.3433"></a>
<span class="sourceLineNo">3434</span>                int iidx1 = in_off + 2 * idx0;<a name="line.3434"></a>
<span class="sourceLineNo">3435</span>                int iidx2 = iidx1 + ido;<a name="line.3435"></a>
<span class="sourceLineNo">3436</span>                float a1r = in[iidx1];<a name="line.3436"></a>
<span class="sourceLineNo">3437</span>                float a1i = in[iidx1 + 1];<a name="line.3437"></a>
<span class="sourceLineNo">3438</span>                float a2r = in[iidx2];<a name="line.3438"></a>
<span class="sourceLineNo">3439</span>                float a2i = in[iidx2 + 1];<a name="line.3439"></a>
<span class="sourceLineNo">3440</span><a name="line.3440"></a>
<span class="sourceLineNo">3441</span>                int oidx1 = out_off + idx0;<a name="line.3441"></a>
<span class="sourceLineNo">3442</span>                int oidx2 = oidx1 + idx;<a name="line.3442"></a>
<span class="sourceLineNo">3443</span>                out[oidx1] = a1r + a2r;<a name="line.3443"></a>
<span class="sourceLineNo">3444</span>                out[oidx1 + 1] = a1i + a2i;<a name="line.3444"></a>
<span class="sourceLineNo">3445</span>                out[oidx2] = a1r - a2r;<a name="line.3445"></a>
<span class="sourceLineNo">3446</span>                out[oidx2 + 1] = a1i - a2i;<a name="line.3446"></a>
<span class="sourceLineNo">3447</span>            }<a name="line.3447"></a>
<span class="sourceLineNo">3448</span>        } else {<a name="line.3448"></a>
<span class="sourceLineNo">3449</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.3449"></a>
<span class="sourceLineNo">3450</span>                for (int i = 0; i &lt; ido - 1; i += 2) {<a name="line.3450"></a>
<span class="sourceLineNo">3451</span>                    int idx0 = k * ido;<a name="line.3451"></a>
<span class="sourceLineNo">3452</span>                    int iidx1 = in_off + i + 2 * idx0;<a name="line.3452"></a>
<span class="sourceLineNo">3453</span>                    int iidx2 = iidx1 + ido;<a name="line.3453"></a>
<span class="sourceLineNo">3454</span>                    float i1r = in[iidx1];<a name="line.3454"></a>
<span class="sourceLineNo">3455</span>                    float i1i = in[iidx1 + 1];<a name="line.3455"></a>
<span class="sourceLineNo">3456</span>                    float i2r = in[iidx2];<a name="line.3456"></a>
<span class="sourceLineNo">3457</span>                    float i2i = in[iidx2 + 1];<a name="line.3457"></a>
<span class="sourceLineNo">3458</span><a name="line.3458"></a>
<span class="sourceLineNo">3459</span>                    int widx1 = i + iw1;<a name="line.3459"></a>
<span class="sourceLineNo">3460</span>                    float w1r = wtable[widx1];<a name="line.3460"></a>
<span class="sourceLineNo">3461</span>                    float w1i = isign * wtable[widx1 + 1];<a name="line.3461"></a>
<span class="sourceLineNo">3462</span><a name="line.3462"></a>
<span class="sourceLineNo">3463</span>                    t1r = i1r - i2r;<a name="line.3463"></a>
<span class="sourceLineNo">3464</span>                    t1i = i1i - i2i;<a name="line.3464"></a>
<span class="sourceLineNo">3465</span><a name="line.3465"></a>
<span class="sourceLineNo">3466</span>                    int oidx1 = out_off + i + idx0;<a name="line.3466"></a>
<span class="sourceLineNo">3467</span>                    int oidx2 = oidx1 + idx;<a name="line.3467"></a>
<span class="sourceLineNo">3468</span>                    out[oidx1] = i1r + i2r;<a name="line.3468"></a>
<span class="sourceLineNo">3469</span>                    out[oidx1 + 1] = i1i + i2i;<a name="line.3469"></a>
<span class="sourceLineNo">3470</span>                    out[oidx2] = w1r * t1r - w1i * t1i;<a name="line.3470"></a>
<span class="sourceLineNo">3471</span>                    out[oidx2 + 1] = w1r * t1i + w1i * t1r;<a name="line.3471"></a>
<span class="sourceLineNo">3472</span>                }<a name="line.3472"></a>
<span class="sourceLineNo">3473</span>            }<a name="line.3473"></a>
<span class="sourceLineNo">3474</span>        }<a name="line.3474"></a>
<span class="sourceLineNo">3475</span>    }<a name="line.3475"></a>
<span class="sourceLineNo">3476</span><a name="line.3476"></a>
<span class="sourceLineNo">3477</span>    /*----------------------------------------------------------------------<a name="line.3477"></a>
<span class="sourceLineNo">3478</span>       passf3: Complex FFT's forward/backward processing of factor 3;<a name="line.3478"></a>
<span class="sourceLineNo">3479</span>       isign is +1 for backward and -1 for forward transforms<a name="line.3479"></a>
<span class="sourceLineNo">3480</span>      ----------------------------------------------------------------------*/<a name="line.3480"></a>
<span class="sourceLineNo">3481</span>    void passf3(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset, final int isign) {<a name="line.3481"></a>
<span class="sourceLineNo">3482</span>        final float taur = -0.5f;<a name="line.3482"></a>
<span class="sourceLineNo">3483</span>        final float taui = 0.866025403784438707610604524234076962f;<a name="line.3483"></a>
<span class="sourceLineNo">3484</span>        float ci2, ci3, di2, di3, cr2, cr3, dr2, dr3, ti2, tr2;<a name="line.3484"></a>
<span class="sourceLineNo">3485</span>        int iw1, iw2;<a name="line.3485"></a>
<span class="sourceLineNo">3486</span><a name="line.3486"></a>
<span class="sourceLineNo">3487</span>        iw1 = offset;<a name="line.3487"></a>
<span class="sourceLineNo">3488</span>        iw2 = iw1 + ido;<a name="line.3488"></a>
<span class="sourceLineNo">3489</span><a name="line.3489"></a>
<span class="sourceLineNo">3490</span>        final int idxt = l1 * ido;<a name="line.3490"></a>
<span class="sourceLineNo">3491</span><a name="line.3491"></a>
<span class="sourceLineNo">3492</span>        if (ido == 2) {<a name="line.3492"></a>
<span class="sourceLineNo">3493</span>            for (int k = 1; k &lt;= l1; k++) {<a name="line.3493"></a>
<span class="sourceLineNo">3494</span>                int iidx1 = in_off + (3 * k - 2) * ido;<a name="line.3494"></a>
<span class="sourceLineNo">3495</span>                int iidx2 = iidx1 + ido;<a name="line.3495"></a>
<span class="sourceLineNo">3496</span>                int iidx3 = iidx1 - ido;<a name="line.3496"></a>
<span class="sourceLineNo">3497</span>                float i1r = in[iidx1];<a name="line.3497"></a>
<span class="sourceLineNo">3498</span>                float i1i = in[iidx1 + 1];<a name="line.3498"></a>
<span class="sourceLineNo">3499</span>                float i2r = in[iidx2];<a name="line.3499"></a>
<span class="sourceLineNo">3500</span>                float i2i = in[iidx2 + 1];<a name="line.3500"></a>
<span class="sourceLineNo">3501</span>                float i3r = in[iidx3];<a name="line.3501"></a>
<span class="sourceLineNo">3502</span>                float i3i = in[iidx3 + 1];<a name="line.3502"></a>
<span class="sourceLineNo">3503</span><a name="line.3503"></a>
<span class="sourceLineNo">3504</span>                tr2 = i1r + i2r;<a name="line.3504"></a>
<span class="sourceLineNo">3505</span>                cr2 = i3r + taur * tr2;<a name="line.3505"></a>
<span class="sourceLineNo">3506</span>                ti2 = i1i + i2i;<a name="line.3506"></a>
<span class="sourceLineNo">3507</span>                ci2 = i3i + taur * ti2;<a name="line.3507"></a>
<span class="sourceLineNo">3508</span>                cr3 = isign * taui * (i1r - i2r);<a name="line.3508"></a>
<span class="sourceLineNo">3509</span>                ci3 = isign * taui * (i1i - i2i);<a name="line.3509"></a>
<span class="sourceLineNo">3510</span><a name="line.3510"></a>
<span class="sourceLineNo">3511</span>                int oidx1 = out_off + (k - 1) * ido;<a name="line.3511"></a>
<span class="sourceLineNo">3512</span>                int oidx2 = oidx1 + idxt;<a name="line.3512"></a>
<span class="sourceLineNo">3513</span>                int oidx3 = oidx2 + idxt;<a name="line.3513"></a>
<span class="sourceLineNo">3514</span>                out[oidx1] = in[iidx3] + tr2;<a name="line.3514"></a>
<span class="sourceLineNo">3515</span>                out[oidx1 + 1] = i3i + ti2;<a name="line.3515"></a>
<span class="sourceLineNo">3516</span>                out[oidx2] = cr2 - ci3;<a name="line.3516"></a>
<span class="sourceLineNo">3517</span>                out[oidx2 + 1] = ci2 + cr3;<a name="line.3517"></a>
<span class="sourceLineNo">3518</span>                out[oidx3] = cr2 + ci3;<a name="line.3518"></a>
<span class="sourceLineNo">3519</span>                out[oidx3 + 1] = ci2 - cr3;<a name="line.3519"></a>
<span class="sourceLineNo">3520</span>            }<a name="line.3520"></a>
<span class="sourceLineNo">3521</span>        } else {<a name="line.3521"></a>
<span class="sourceLineNo">3522</span>            for (int k = 1; k &lt;= l1; k++) {<a name="line.3522"></a>
<span class="sourceLineNo">3523</span>                int idx1 = in_off + (3 * k - 2) * ido;<a name="line.3523"></a>
<span class="sourceLineNo">3524</span>                int idx2 = out_off + (k - 1) * ido;<a name="line.3524"></a>
<span class="sourceLineNo">3525</span>                for (int i = 0; i &lt; ido - 1; i += 2) {<a name="line.3525"></a>
<span class="sourceLineNo">3526</span>                    int iidx1 = i + idx1;<a name="line.3526"></a>
<span class="sourceLineNo">3527</span>                    int iidx2 = iidx1 + ido;<a name="line.3527"></a>
<span class="sourceLineNo">3528</span>                    int iidx3 = iidx1 - ido;<a name="line.3528"></a>
<span class="sourceLineNo">3529</span>                    float a1r = in[iidx1];<a name="line.3529"></a>
<span class="sourceLineNo">3530</span>                    float a1i = in[iidx1 + 1];<a name="line.3530"></a>
<span class="sourceLineNo">3531</span>                    float a2r = in[iidx2];<a name="line.3531"></a>
<span class="sourceLineNo">3532</span>                    float a2i = in[iidx2 + 1];<a name="line.3532"></a>
<span class="sourceLineNo">3533</span>                    float a3r = in[iidx3];<a name="line.3533"></a>
<span class="sourceLineNo">3534</span>                    float a3i = in[iidx3 + 1];<a name="line.3534"></a>
<span class="sourceLineNo">3535</span><a name="line.3535"></a>
<span class="sourceLineNo">3536</span>                    tr2 = a1r + a2r;<a name="line.3536"></a>
<span class="sourceLineNo">3537</span>                    cr2 = a3r + taur * tr2;<a name="line.3537"></a>
<span class="sourceLineNo">3538</span>                    ti2 = a1i + a2i;<a name="line.3538"></a>
<span class="sourceLineNo">3539</span>                    ci2 = a3i + taur * ti2;<a name="line.3539"></a>
<span class="sourceLineNo">3540</span>                    cr3 = isign * taui * (a1r - a2r);<a name="line.3540"></a>
<span class="sourceLineNo">3541</span>                    ci3 = isign * taui * (a1i - a2i);<a name="line.3541"></a>
<span class="sourceLineNo">3542</span>                    dr2 = cr2 - ci3;<a name="line.3542"></a>
<span class="sourceLineNo">3543</span>                    dr3 = cr2 + ci3;<a name="line.3543"></a>
<span class="sourceLineNo">3544</span>                    di2 = ci2 + cr3;<a name="line.3544"></a>
<span class="sourceLineNo">3545</span>                    di3 = ci2 - cr3;<a name="line.3545"></a>
<span class="sourceLineNo">3546</span><a name="line.3546"></a>
<span class="sourceLineNo">3547</span>                    int widx1 = i + iw1;<a name="line.3547"></a>
<span class="sourceLineNo">3548</span>                    int widx2 = i + iw2;<a name="line.3548"></a>
<span class="sourceLineNo">3549</span>                    float w1r = wtable[widx1];<a name="line.3549"></a>
<span class="sourceLineNo">3550</span>                    float w1i = isign * wtable[widx1 + 1];<a name="line.3550"></a>
<span class="sourceLineNo">3551</span>                    float w2r = wtable[widx2];<a name="line.3551"></a>
<span class="sourceLineNo">3552</span>                    float w2i = isign * wtable[widx2 + 1];<a name="line.3552"></a>
<span class="sourceLineNo">3553</span><a name="line.3553"></a>
<span class="sourceLineNo">3554</span>                    int oidx1 = i + idx2;<a name="line.3554"></a>
<span class="sourceLineNo">3555</span>                    int oidx2 = oidx1 + idxt;<a name="line.3555"></a>
<span class="sourceLineNo">3556</span>                    int oidx3 = oidx2 + idxt;<a name="line.3556"></a>
<span class="sourceLineNo">3557</span>                    out[oidx1] = a3r + tr2;<a name="line.3557"></a>
<span class="sourceLineNo">3558</span>                    out[oidx1 + 1] = a3i + ti2;<a name="line.3558"></a>
<span class="sourceLineNo">3559</span>                    out[oidx2] = w1r * dr2 - w1i * di2;<a name="line.3559"></a>
<span class="sourceLineNo">3560</span>                    out[oidx2 + 1] = w1r * di2 + w1i * dr2;<a name="line.3560"></a>
<span class="sourceLineNo">3561</span>                    out[oidx3] = w2r * dr3 - w2i * di3;<a name="line.3561"></a>
<span class="sourceLineNo">3562</span>                    out[oidx3 + 1] = w2r * di3 + w2i * dr3;<a name="line.3562"></a>
<span class="sourceLineNo">3563</span>                }<a name="line.3563"></a>
<span class="sourceLineNo">3564</span>            }<a name="line.3564"></a>
<span class="sourceLineNo">3565</span>        }<a name="line.3565"></a>
<span class="sourceLineNo">3566</span>    }<a name="line.3566"></a>
<span class="sourceLineNo">3567</span><a name="line.3567"></a>
<span class="sourceLineNo">3568</span>    /*----------------------------------------------------------------------<a name="line.3568"></a>
<span class="sourceLineNo">3569</span>       passf4: Complex FFT's forward/backward processing of factor 4;<a name="line.3569"></a>
<span class="sourceLineNo">3570</span>       isign is +1 for backward and -1 for forward transforms<a name="line.3570"></a>
<span class="sourceLineNo">3571</span>      ----------------------------------------------------------------------*/<a name="line.3571"></a>
<span class="sourceLineNo">3572</span>    void passf4(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset, final int isign) {<a name="line.3572"></a>
<span class="sourceLineNo">3573</span>        float ci2, ci3, ci4, cr2, cr3, cr4, ti1, ti2, ti3, ti4, tr1, tr2, tr3, tr4;<a name="line.3573"></a>
<span class="sourceLineNo">3574</span>        int iw1, iw2, iw3;<a name="line.3574"></a>
<span class="sourceLineNo">3575</span>        iw1 = offset;<a name="line.3575"></a>
<span class="sourceLineNo">3576</span>        iw2 = iw1 + ido;<a name="line.3576"></a>
<span class="sourceLineNo">3577</span>        iw3 = iw2 + ido;<a name="line.3577"></a>
<span class="sourceLineNo">3578</span><a name="line.3578"></a>
<span class="sourceLineNo">3579</span>        int idx0 = l1 * ido;<a name="line.3579"></a>
<span class="sourceLineNo">3580</span>        if (ido == 2) {<a name="line.3580"></a>
<span class="sourceLineNo">3581</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.3581"></a>
<span class="sourceLineNo">3582</span>                int idxt1 = k * ido;<a name="line.3582"></a>
<span class="sourceLineNo">3583</span>                int iidx1 = in_off + 4 * idxt1 + 1;<a name="line.3583"></a>
<span class="sourceLineNo">3584</span>                int iidx2 = iidx1 + ido;<a name="line.3584"></a>
<span class="sourceLineNo">3585</span>                int iidx3 = iidx2 + ido;<a name="line.3585"></a>
<span class="sourceLineNo">3586</span>                int iidx4 = iidx3 + ido;<a name="line.3586"></a>
<span class="sourceLineNo">3587</span><a name="line.3587"></a>
<span class="sourceLineNo">3588</span>                float i1i = in[iidx1 - 1];<a name="line.3588"></a>
<span class="sourceLineNo">3589</span>                float i1r = in[iidx1];<a name="line.3589"></a>
<span class="sourceLineNo">3590</span>                float i2i = in[iidx2 - 1];<a name="line.3590"></a>
<span class="sourceLineNo">3591</span>                float i2r = in[iidx2];<a name="line.3591"></a>
<span class="sourceLineNo">3592</span>                float i3i = in[iidx3 - 1];<a name="line.3592"></a>
<span class="sourceLineNo">3593</span>                float i3r = in[iidx3];<a name="line.3593"></a>
<span class="sourceLineNo">3594</span>                float i4i = in[iidx4 - 1];<a name="line.3594"></a>
<span class="sourceLineNo">3595</span>                float i4r = in[iidx4];<a name="line.3595"></a>
<span class="sourceLineNo">3596</span><a name="line.3596"></a>
<span class="sourceLineNo">3597</span>                ti1 = i1r - i3r;<a name="line.3597"></a>
<span class="sourceLineNo">3598</span>                ti2 = i1r + i3r;<a name="line.3598"></a>
<span class="sourceLineNo">3599</span>                tr4 = i4r - i2r;<a name="line.3599"></a>
<span class="sourceLineNo">3600</span>                ti3 = i2r + i4r;<a name="line.3600"></a>
<span class="sourceLineNo">3601</span>                tr1 = i1i - i3i;<a name="line.3601"></a>
<span class="sourceLineNo">3602</span>                tr2 = i1i + i3i;<a name="line.3602"></a>
<span class="sourceLineNo">3603</span>                ti4 = i2i - i4i;<a name="line.3603"></a>
<span class="sourceLineNo">3604</span>                tr3 = i2i + i4i;<a name="line.3604"></a>
<span class="sourceLineNo">3605</span><a name="line.3605"></a>
<span class="sourceLineNo">3606</span>                int oidx1 = out_off + idxt1;<a name="line.3606"></a>
<span class="sourceLineNo">3607</span>                int oidx2 = oidx1 + idx0;<a name="line.3607"></a>
<span class="sourceLineNo">3608</span>                int oidx3 = oidx2 + idx0;<a name="line.3608"></a>
<span class="sourceLineNo">3609</span>                int oidx4 = oidx3 + idx0;<a name="line.3609"></a>
<span class="sourceLineNo">3610</span>                out[oidx1] = tr2 + tr3;<a name="line.3610"></a>
<span class="sourceLineNo">3611</span>                out[oidx1 + 1] = ti2 + ti3;<a name="line.3611"></a>
<span class="sourceLineNo">3612</span>                out[oidx2] = tr1 + isign * tr4;<a name="line.3612"></a>
<span class="sourceLineNo">3613</span>                out[oidx2 + 1] = ti1 + isign * ti4;<a name="line.3613"></a>
<span class="sourceLineNo">3614</span>                out[oidx3] = tr2 - tr3;<a name="line.3614"></a>
<span class="sourceLineNo">3615</span>                out[oidx3 + 1] = ti2 - ti3;<a name="line.3615"></a>
<span class="sourceLineNo">3616</span>                out[oidx4] = tr1 - isign * tr4;<a name="line.3616"></a>
<span class="sourceLineNo">3617</span>                out[oidx4 + 1] = ti1 - isign * ti4;<a name="line.3617"></a>
<span class="sourceLineNo">3618</span>            }<a name="line.3618"></a>
<span class="sourceLineNo">3619</span>        } else {<a name="line.3619"></a>
<span class="sourceLineNo">3620</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.3620"></a>
<span class="sourceLineNo">3621</span>                int idx1 = k * ido;<a name="line.3621"></a>
<span class="sourceLineNo">3622</span>                int idx2 = in_off + 1 + 4 * idx1;<a name="line.3622"></a>
<span class="sourceLineNo">3623</span>                for (int i = 0; i &lt; ido - 1; i += 2) {<a name="line.3623"></a>
<span class="sourceLineNo">3624</span>                    int iidx1 = i + idx2;<a name="line.3624"></a>
<span class="sourceLineNo">3625</span>                    int iidx2 = iidx1 + ido;<a name="line.3625"></a>
<span class="sourceLineNo">3626</span>                    int iidx3 = iidx2 + ido;<a name="line.3626"></a>
<span class="sourceLineNo">3627</span>                    int iidx4 = iidx3 + ido;<a name="line.3627"></a>
<span class="sourceLineNo">3628</span>                    float i1i = in[iidx1 - 1];<a name="line.3628"></a>
<span class="sourceLineNo">3629</span>                    float i1r = in[iidx1];<a name="line.3629"></a>
<span class="sourceLineNo">3630</span>                    float i2i = in[iidx2 - 1];<a name="line.3630"></a>
<span class="sourceLineNo">3631</span>                    float i2r = in[iidx2];<a name="line.3631"></a>
<span class="sourceLineNo">3632</span>                    float i3i = in[iidx3 - 1];<a name="line.3632"></a>
<span class="sourceLineNo">3633</span>                    float i3r = in[iidx3];<a name="line.3633"></a>
<span class="sourceLineNo">3634</span>                    float i4i = in[iidx4 - 1];<a name="line.3634"></a>
<span class="sourceLineNo">3635</span>                    float i4r = in[iidx4];<a name="line.3635"></a>
<span class="sourceLineNo">3636</span><a name="line.3636"></a>
<span class="sourceLineNo">3637</span>                    ti1 = i1r - i3r;<a name="line.3637"></a>
<span class="sourceLineNo">3638</span>                    ti2 = i1r + i3r;<a name="line.3638"></a>
<span class="sourceLineNo">3639</span>                    ti3 = i2r + i4r;<a name="line.3639"></a>
<span class="sourceLineNo">3640</span>                    tr4 = i4r - i2r;<a name="line.3640"></a>
<span class="sourceLineNo">3641</span>                    tr1 = i1i - i3i;<a name="line.3641"></a>
<span class="sourceLineNo">3642</span>                    tr2 = i1i + i3i;<a name="line.3642"></a>
<span class="sourceLineNo">3643</span>                    ti4 = i2i - i4i;<a name="line.3643"></a>
<span class="sourceLineNo">3644</span>                    tr3 = i2i + i4i;<a name="line.3644"></a>
<span class="sourceLineNo">3645</span>                    cr3 = tr2 - tr3;<a name="line.3645"></a>
<span class="sourceLineNo">3646</span>                    ci3 = ti2 - ti3;<a name="line.3646"></a>
<span class="sourceLineNo">3647</span>                    cr2 = tr1 + isign * tr4;<a name="line.3647"></a>
<span class="sourceLineNo">3648</span>                    cr4 = tr1 - isign * tr4;<a name="line.3648"></a>
<span class="sourceLineNo">3649</span>                    ci2 = ti1 + isign * ti4;<a name="line.3649"></a>
<span class="sourceLineNo">3650</span>                    ci4 = ti1 - isign * ti4;<a name="line.3650"></a>
<span class="sourceLineNo">3651</span><a name="line.3651"></a>
<span class="sourceLineNo">3652</span>                    int widx1 = i + iw1;<a name="line.3652"></a>
<span class="sourceLineNo">3653</span>                    int widx2 = i + iw2;<a name="line.3653"></a>
<span class="sourceLineNo">3654</span>                    int widx3 = i + iw3;<a name="line.3654"></a>
<span class="sourceLineNo">3655</span>                    float w1r = wtable[widx1];<a name="line.3655"></a>
<span class="sourceLineNo">3656</span>                    float w1i = isign * wtable[widx1 + 1];<a name="line.3656"></a>
<span class="sourceLineNo">3657</span>                    float w2r = wtable[widx2];<a name="line.3657"></a>
<span class="sourceLineNo">3658</span>                    float w2i = isign * wtable[widx2 + 1];<a name="line.3658"></a>
<span class="sourceLineNo">3659</span>                    float w3r = wtable[widx3];<a name="line.3659"></a>
<span class="sourceLineNo">3660</span>                    float w3i = isign * wtable[widx3 + 1];<a name="line.3660"></a>
<span class="sourceLineNo">3661</span><a name="line.3661"></a>
<span class="sourceLineNo">3662</span>                    int oidx1 = out_off + i + idx1;<a name="line.3662"></a>
<span class="sourceLineNo">3663</span>                    int oidx2 = oidx1 + idx0;<a name="line.3663"></a>
<span class="sourceLineNo">3664</span>                    int oidx3 = oidx2 + idx0;<a name="line.3664"></a>
<span class="sourceLineNo">3665</span>                    int oidx4 = oidx3 + idx0;<a name="line.3665"></a>
<span class="sourceLineNo">3666</span>                    out[oidx1] = tr2 + tr3;<a name="line.3666"></a>
<span class="sourceLineNo">3667</span>                    out[oidx1 + 1] = ti2 + ti3;<a name="line.3667"></a>
<span class="sourceLineNo">3668</span>                    out[oidx2] = w1r * cr2 - w1i * ci2;<a name="line.3668"></a>
<span class="sourceLineNo">3669</span>                    out[oidx2 + 1] = w1r * ci2 + w1i * cr2;<a name="line.3669"></a>
<span class="sourceLineNo">3670</span>                    out[oidx3] = w2r * cr3 - w2i * ci3;<a name="line.3670"></a>
<span class="sourceLineNo">3671</span>                    out[oidx3 + 1] = w2r * ci3 + w2i * cr3;<a name="line.3671"></a>
<span class="sourceLineNo">3672</span>                    out[oidx4] = w3r * cr4 - w3i * ci4;<a name="line.3672"></a>
<span class="sourceLineNo">3673</span>                    out[oidx4 + 1] = w3r * ci4 + w3i * cr4;<a name="line.3673"></a>
<span class="sourceLineNo">3674</span>                }<a name="line.3674"></a>
<span class="sourceLineNo">3675</span>            }<a name="line.3675"></a>
<span class="sourceLineNo">3676</span>        }<a name="line.3676"></a>
<span class="sourceLineNo">3677</span>    }<a name="line.3677"></a>
<span class="sourceLineNo">3678</span><a name="line.3678"></a>
<span class="sourceLineNo">3679</span>    /*----------------------------------------------------------------------<a name="line.3679"></a>
<span class="sourceLineNo">3680</span>       passf5: Complex FFT's forward/backward processing of factor 5;<a name="line.3680"></a>
<span class="sourceLineNo">3681</span>       isign is +1 for backward and -1 for forward transforms<a name="line.3681"></a>
<span class="sourceLineNo">3682</span>      ----------------------------------------------------------------------*/<a name="line.3682"></a>
<span class="sourceLineNo">3683</span>    void passf5(final int ido, final int l1, final float in[], final int in_off, final float out[], final int out_off, final int offset, final int isign)<a name="line.3683"></a>
<span class="sourceLineNo">3684</span>    /* isign==-1 for forward transform and+1 for backward transform */<a name="line.3684"></a>
<span class="sourceLineNo">3685</span>    {<a name="line.3685"></a>
<span class="sourceLineNo">3686</span>        final float tr11 = 0.309016994374947451262869435595348477f;<a name="line.3686"></a>
<span class="sourceLineNo">3687</span>        final float ti11 = 0.951056516295153531181938433292089030f;<a name="line.3687"></a>
<span class="sourceLineNo">3688</span>        final float tr12 = -0.809016994374947340240566973079694435f;<a name="line.3688"></a>
<span class="sourceLineNo">3689</span>        final float ti12 = 0.587785252292473248125759255344746634f;<a name="line.3689"></a>
<span class="sourceLineNo">3690</span>        float ci2, ci3, ci4, ci5, di3, di4, di5, di2, cr2, cr3, cr5, cr4, ti2, ti3, ti4, ti5, dr3, dr4, dr5, dr2, tr2, tr3, tr4, tr5;<a name="line.3690"></a>
<span class="sourceLineNo">3691</span>        int iw1, iw2, iw3, iw4;<a name="line.3691"></a>
<span class="sourceLineNo">3692</span><a name="line.3692"></a>
<span class="sourceLineNo">3693</span>        iw1 = offset;<a name="line.3693"></a>
<span class="sourceLineNo">3694</span>        iw2 = iw1 + ido;<a name="line.3694"></a>
<span class="sourceLineNo">3695</span>        iw3 = iw2 + ido;<a name="line.3695"></a>
<span class="sourceLineNo">3696</span>        iw4 = iw3 + ido;<a name="line.3696"></a>
<span class="sourceLineNo">3697</span><a name="line.3697"></a>
<span class="sourceLineNo">3698</span>        int idx0 = l1 * ido;<a name="line.3698"></a>
<span class="sourceLineNo">3699</span><a name="line.3699"></a>
<span class="sourceLineNo">3700</span>        if (ido == 2) {<a name="line.3700"></a>
<span class="sourceLineNo">3701</span>            for (int k = 1; k &lt;= l1; ++k) {<a name="line.3701"></a>
<span class="sourceLineNo">3702</span>                int iidx1 = in_off + (5 * k - 4) * ido + 1;<a name="line.3702"></a>
<span class="sourceLineNo">3703</span>                int iidx2 = iidx1 + ido;<a name="line.3703"></a>
<span class="sourceLineNo">3704</span>                int iidx3 = iidx1 - ido;<a name="line.3704"></a>
<span class="sourceLineNo">3705</span>                int iidx4 = iidx2 + ido;<a name="line.3705"></a>
<span class="sourceLineNo">3706</span>                int iidx5 = iidx4 + ido;<a name="line.3706"></a>
<span class="sourceLineNo">3707</span><a name="line.3707"></a>
<span class="sourceLineNo">3708</span>                float i1i = in[iidx1 - 1];<a name="line.3708"></a>
<span class="sourceLineNo">3709</span>                float i1r = in[iidx1];<a name="line.3709"></a>
<span class="sourceLineNo">3710</span>                float i2i = in[iidx2 - 1];<a name="line.3710"></a>
<span class="sourceLineNo">3711</span>                float i2r = in[iidx2];<a name="line.3711"></a>
<span class="sourceLineNo">3712</span>                float i3i = in[iidx3 - 1];<a name="line.3712"></a>
<span class="sourceLineNo">3713</span>                float i3r = in[iidx3];<a name="line.3713"></a>
<span class="sourceLineNo">3714</span>                float i4i = in[iidx4 - 1];<a name="line.3714"></a>
<span class="sourceLineNo">3715</span>                float i4r = in[iidx4];<a name="line.3715"></a>
<span class="sourceLineNo">3716</span>                float i5i = in[iidx5 - 1];<a name="line.3716"></a>
<span class="sourceLineNo">3717</span>                float i5r = in[iidx5];<a name="line.3717"></a>
<span class="sourceLineNo">3718</span><a name="line.3718"></a>
<span class="sourceLineNo">3719</span>                ti5 = i1r - i5r;<a name="line.3719"></a>
<span class="sourceLineNo">3720</span>                ti2 = i1r + i5r;<a name="line.3720"></a>
<span class="sourceLineNo">3721</span>                ti4 = i2r - i4r;<a name="line.3721"></a>
<span class="sourceLineNo">3722</span>                ti3 = i2r + i4r;<a name="line.3722"></a>
<span class="sourceLineNo">3723</span>                tr5 = i1i - i5i;<a name="line.3723"></a>
<span class="sourceLineNo">3724</span>                tr2 = i1i + i5i;<a name="line.3724"></a>
<span class="sourceLineNo">3725</span>                tr4 = i2i - i4i;<a name="line.3725"></a>
<span class="sourceLineNo">3726</span>                tr3 = i2i + i4i;<a name="line.3726"></a>
<span class="sourceLineNo">3727</span>                cr2 = i3i + tr11 * tr2 + tr12 * tr3;<a name="line.3727"></a>
<span class="sourceLineNo">3728</span>                ci2 = i3r + tr11 * ti2 + tr12 * ti3;<a name="line.3728"></a>
<span class="sourceLineNo">3729</span>                cr3 = i3i + tr12 * tr2 + tr11 * tr3;<a name="line.3729"></a>
<span class="sourceLineNo">3730</span>                ci3 = i3r + tr12 * ti2 + tr11 * ti3;<a name="line.3730"></a>
<span class="sourceLineNo">3731</span>                cr5 = isign * (ti11 * tr5 + ti12 * tr4);<a name="line.3731"></a>
<span class="sourceLineNo">3732</span>                ci5 = isign * (ti11 * ti5 + ti12 * ti4);<a name="line.3732"></a>
<span class="sourceLineNo">3733</span>                cr4 = isign * (ti12 * tr5 - ti11 * tr4);<a name="line.3733"></a>
<span class="sourceLineNo">3734</span>                ci4 = isign * (ti12 * ti5 - ti11 * ti4);<a name="line.3734"></a>
<span class="sourceLineNo">3735</span><a name="line.3735"></a>
<span class="sourceLineNo">3736</span>                int oidx1 = out_off + (k - 1) * ido;<a name="line.3736"></a>
<span class="sourceLineNo">3737</span>                int oidx2 = oidx1 + idx0;<a name="line.3737"></a>
<span class="sourceLineNo">3738</span>                int oidx3 = oidx2 + idx0;<a name="line.3738"></a>
<span class="sourceLineNo">3739</span>                int oidx4 = oidx3 + idx0;<a name="line.3739"></a>
<span class="sourceLineNo">3740</span>                int oidx5 = oidx4 + idx0;<a name="line.3740"></a>
<span class="sourceLineNo">3741</span>                out[oidx1] = i3i + tr2 + tr3;<a name="line.3741"></a>
<span class="sourceLineNo">3742</span>                out[oidx1 + 1] = i3r + ti2 + ti3;<a name="line.3742"></a>
<span class="sourceLineNo">3743</span>                out[oidx2] = cr2 - ci5;<a name="line.3743"></a>
<span class="sourceLineNo">3744</span>                out[oidx2 + 1] = ci2 + cr5;<a name="line.3744"></a>
<span class="sourceLineNo">3745</span>                out[oidx3] = cr3 - ci4;<a name="line.3745"></a>
<span class="sourceLineNo">3746</span>                out[oidx3 + 1] = ci3 + cr4;<a name="line.3746"></a>
<span class="sourceLineNo">3747</span>                out[oidx4] = cr3 + ci4;<a name="line.3747"></a>
<span class="sourceLineNo">3748</span>                out[oidx4 + 1] = ci3 - cr4;<a name="line.3748"></a>
<span class="sourceLineNo">3749</span>                out[oidx5] = cr2 + ci5;<a name="line.3749"></a>
<span class="sourceLineNo">3750</span>                out[oidx5 + 1] = ci2 - cr5;<a name="line.3750"></a>
<span class="sourceLineNo">3751</span>            }<a name="line.3751"></a>
<span class="sourceLineNo">3752</span>        } else {<a name="line.3752"></a>
<span class="sourceLineNo">3753</span>            for (int k = 1; k &lt;= l1; k++) {<a name="line.3753"></a>
<span class="sourceLineNo">3754</span>                int idx1 = in_off + 1 + (k * 5 - 4) * ido;<a name="line.3754"></a>
<span class="sourceLineNo">3755</span>                int idx2 = out_off + (k - 1) * ido;<a name="line.3755"></a>
<span class="sourceLineNo">3756</span>                for (int i = 0; i &lt; ido - 1; i += 2) {<a name="line.3756"></a>
<span class="sourceLineNo">3757</span>                    int iidx1 = i + idx1;<a name="line.3757"></a>
<span class="sourceLineNo">3758</span>                    int iidx2 = iidx1 + ido;<a name="line.3758"></a>
<span class="sourceLineNo">3759</span>                    int iidx3 = iidx1 - ido;<a name="line.3759"></a>
<span class="sourceLineNo">3760</span>                    int iidx4 = iidx2 + ido;<a name="line.3760"></a>
<span class="sourceLineNo">3761</span>                    int iidx5 = iidx4 + ido;<a name="line.3761"></a>
<span class="sourceLineNo">3762</span>                    float i1i = in[iidx1 - 1];<a name="line.3762"></a>
<span class="sourceLineNo">3763</span>                    float i1r = in[iidx1];<a name="line.3763"></a>
<span class="sourceLineNo">3764</span>                    float i2i = in[iidx2 - 1];<a name="line.3764"></a>
<span class="sourceLineNo">3765</span>                    float i2r = in[iidx2];<a name="line.3765"></a>
<span class="sourceLineNo">3766</span>                    float i3i = in[iidx3 - 1];<a name="line.3766"></a>
<span class="sourceLineNo">3767</span>                    float i3r = in[iidx3];<a name="line.3767"></a>
<span class="sourceLineNo">3768</span>                    float i4i = in[iidx4 - 1];<a name="line.3768"></a>
<span class="sourceLineNo">3769</span>                    float i4r = in[iidx4];<a name="line.3769"></a>
<span class="sourceLineNo">3770</span>                    float i5i = in[iidx5 - 1];<a name="line.3770"></a>
<span class="sourceLineNo">3771</span>                    float i5r = in[iidx5];<a name="line.3771"></a>
<span class="sourceLineNo">3772</span><a name="line.3772"></a>
<span class="sourceLineNo">3773</span>                    ti5 = i1r - i5r;<a name="line.3773"></a>
<span class="sourceLineNo">3774</span>                    ti2 = i1r + i5r;<a name="line.3774"></a>
<span class="sourceLineNo">3775</span>                    ti4 = i2r - i4r;<a name="line.3775"></a>
<span class="sourceLineNo">3776</span>                    ti3 = i2r + i4r;<a name="line.3776"></a>
<span class="sourceLineNo">3777</span>                    tr5 = i1i - i5i;<a name="line.3777"></a>
<span class="sourceLineNo">3778</span>                    tr2 = i1i + i5i;<a name="line.3778"></a>
<span class="sourceLineNo">3779</span>                    tr4 = i2i - i4i;<a name="line.3779"></a>
<span class="sourceLineNo">3780</span>                    tr3 = i2i + i4i;<a name="line.3780"></a>
<span class="sourceLineNo">3781</span>                    cr2 = i3i + tr11 * tr2 + tr12 * tr3;<a name="line.3781"></a>
<span class="sourceLineNo">3782</span>                    ci2 = i3r + tr11 * ti2 + tr12 * ti3;<a name="line.3782"></a>
<span class="sourceLineNo">3783</span>                    cr3 = i3i + tr12 * tr2 + tr11 * tr3;<a name="line.3783"></a>
<span class="sourceLineNo">3784</span>                    ci3 = i3r + tr12 * ti2 + tr11 * ti3;<a name="line.3784"></a>
<span class="sourceLineNo">3785</span>                    cr5 = isign * (ti11 * tr5 + ti12 * tr4);<a name="line.3785"></a>
<span class="sourceLineNo">3786</span>                    ci5 = isign * (ti11 * ti5 + ti12 * ti4);<a name="line.3786"></a>
<span class="sourceLineNo">3787</span>                    cr4 = isign * (ti12 * tr5 - ti11 * tr4);<a name="line.3787"></a>
<span class="sourceLineNo">3788</span>                    ci4 = isign * (ti12 * ti5 - ti11 * ti4);<a name="line.3788"></a>
<span class="sourceLineNo">3789</span>                    dr3 = cr3 - ci4;<a name="line.3789"></a>
<span class="sourceLineNo">3790</span>                    dr4 = cr3 + ci4;<a name="line.3790"></a>
<span class="sourceLineNo">3791</span>                    di3 = ci3 + cr4;<a name="line.3791"></a>
<span class="sourceLineNo">3792</span>                    di4 = ci3 - cr4;<a name="line.3792"></a>
<span class="sourceLineNo">3793</span>                    dr5 = cr2 + ci5;<a name="line.3793"></a>
<span class="sourceLineNo">3794</span>                    dr2 = cr2 - ci5;<a name="line.3794"></a>
<span class="sourceLineNo">3795</span>                    di5 = ci2 - cr5;<a name="line.3795"></a>
<span class="sourceLineNo">3796</span>                    di2 = ci2 + cr5;<a name="line.3796"></a>
<span class="sourceLineNo">3797</span><a name="line.3797"></a>
<span class="sourceLineNo">3798</span>                    int widx1 = i + iw1;<a name="line.3798"></a>
<span class="sourceLineNo">3799</span>                    int widx2 = i + iw2;<a name="line.3799"></a>
<span class="sourceLineNo">3800</span>                    int widx3 = i + iw3;<a name="line.3800"></a>
<span class="sourceLineNo">3801</span>                    int widx4 = i + iw4;<a name="line.3801"></a>
<span class="sourceLineNo">3802</span>                    float w1r = wtable[widx1];<a name="line.3802"></a>
<span class="sourceLineNo">3803</span>                    float w1i = isign * wtable[widx1 + 1];<a name="line.3803"></a>
<span class="sourceLineNo">3804</span>                    float w2r = wtable[widx2];<a name="line.3804"></a>
<span class="sourceLineNo">3805</span>                    float w2i = isign * wtable[widx2 + 1];<a name="line.3805"></a>
<span class="sourceLineNo">3806</span>                    float w3r = wtable[widx3];<a name="line.3806"></a>
<span class="sourceLineNo">3807</span>                    float w3i = isign * wtable[widx3 + 1];<a name="line.3807"></a>
<span class="sourceLineNo">3808</span>                    float w4r = wtable[widx4];<a name="line.3808"></a>
<span class="sourceLineNo">3809</span>                    float w4i = isign * wtable[widx4 + 1];<a name="line.3809"></a>
<span class="sourceLineNo">3810</span><a name="line.3810"></a>
<span class="sourceLineNo">3811</span>                    int oidx1 = i + idx2;<a name="line.3811"></a>
<span class="sourceLineNo">3812</span>                    int oidx2 = oidx1 + idx0;<a name="line.3812"></a>
<span class="sourceLineNo">3813</span>                    int oidx3 = oidx2 + idx0;<a name="line.3813"></a>
<span class="sourceLineNo">3814</span>                    int oidx4 = oidx3 + idx0;<a name="line.3814"></a>
<span class="sourceLineNo">3815</span>                    int oidx5 = oidx4 + idx0;<a name="line.3815"></a>
<span class="sourceLineNo">3816</span>                    out[oidx1] = i3i + tr2 + tr3;<a name="line.3816"></a>
<span class="sourceLineNo">3817</span>                    out[oidx1 + 1] = i3r + ti2 + ti3;<a name="line.3817"></a>
<span class="sourceLineNo">3818</span>                    out[oidx2] = w1r * dr2 - w1i * di2;<a name="line.3818"></a>
<span class="sourceLineNo">3819</span>                    out[oidx2 + 1] = w1r * di2 + w1i * dr2;<a name="line.3819"></a>
<span class="sourceLineNo">3820</span>                    out[oidx3] = w2r * dr3 - w2i * di3;<a name="line.3820"></a>
<span class="sourceLineNo">3821</span>                    out[oidx3 + 1] = w2r * di3 + w2i * dr3;<a name="line.3821"></a>
<span class="sourceLineNo">3822</span>                    out[oidx4] = w3r * dr4 - w3i * di4;<a name="line.3822"></a>
<span class="sourceLineNo">3823</span>                    out[oidx4 + 1] = w3r * di4 + w3i * dr4;<a name="line.3823"></a>
<span class="sourceLineNo">3824</span>                    out[oidx5] = w4r * dr5 - w4i * di5;<a name="line.3824"></a>
<span class="sourceLineNo">3825</span>                    out[oidx5 + 1] = w4r * di5 + w4i * dr5;<a name="line.3825"></a>
<span class="sourceLineNo">3826</span>                }<a name="line.3826"></a>
<span class="sourceLineNo">3827</span>            }<a name="line.3827"></a>
<span class="sourceLineNo">3828</span>        }<a name="line.3828"></a>
<span class="sourceLineNo">3829</span>    }<a name="line.3829"></a>
<span class="sourceLineNo">3830</span><a name="line.3830"></a>
<span class="sourceLineNo">3831</span>    /*----------------------------------------------------------------------<a name="line.3831"></a>
<span class="sourceLineNo">3832</span>       passfg: Complex FFT's forward/backward processing of general factor;<a name="line.3832"></a>
<span class="sourceLineNo">3833</span>       isign is +1 for backward and -1 for forward transforms<a name="line.3833"></a>
<span class="sourceLineNo">3834</span>      ----------------------------------------------------------------------*/<a name="line.3834"></a>
<span class="sourceLineNo">3835</span>    void passfg(final int nac[], final int ido, final int ip, final int l1, final int idl1, final float in[], final int in_off, final float out[], final int out_off, final int offset, final int isign) {<a name="line.3835"></a>
<span class="sourceLineNo">3836</span>        int idij, idlj, idot, ipph, l, jc, lc, idj, idl, inc, idp;<a name="line.3836"></a>
<span class="sourceLineNo">3837</span>        float w1r, w1i, w2i, w2r;<a name="line.3837"></a>
<span class="sourceLineNo">3838</span>        int iw1;<a name="line.3838"></a>
<span class="sourceLineNo">3839</span><a name="line.3839"></a>
<span class="sourceLineNo">3840</span>        iw1 = offset;<a name="line.3840"></a>
<span class="sourceLineNo">3841</span>        idot = ido / 2;<a name="line.3841"></a>
<span class="sourceLineNo">3842</span>        ipph = (ip + 1) / 2;<a name="line.3842"></a>
<span class="sourceLineNo">3843</span>        idp = ip * ido;<a name="line.3843"></a>
<span class="sourceLineNo">3844</span>        if (ido &gt;= l1) {<a name="line.3844"></a>
<span class="sourceLineNo">3845</span>            for (int j = 1; j &lt; ipph; j++) {<a name="line.3845"></a>
<span class="sourceLineNo">3846</span>                jc = ip - j;<a name="line.3846"></a>
<span class="sourceLineNo">3847</span>                int idx1 = j * ido;<a name="line.3847"></a>
<span class="sourceLineNo">3848</span>                int idx2 = jc * ido;<a name="line.3848"></a>
<span class="sourceLineNo">3849</span>                for (int k = 0; k &lt; l1; k++) {<a name="line.3849"></a>
<span class="sourceLineNo">3850</span>                    int idx3 = k * ido;<a name="line.3850"></a>
<span class="sourceLineNo">3851</span>                    int idx4 = idx3 + idx1 * l1;<a name="line.3851"></a>
<span class="sourceLineNo">3852</span>                    int idx5 = idx3 + idx2 * l1;<a name="line.3852"></a>
<span class="sourceLineNo">3853</span>                    int idx6 = idx3 * ip;<a name="line.3853"></a>
<span class="sourceLineNo">3854</span>                    for (int i = 0; i &lt; ido; i++) {<a name="line.3854"></a>
<span class="sourceLineNo">3855</span>                        int oidx1 = out_off + i;<a name="line.3855"></a>
<span class="sourceLineNo">3856</span>                        float i1r = in[in_off + i + idx1 + idx6];<a name="line.3856"></a>
<span class="sourceLineNo">3857</span>                        float i2r = in[in_off + i + idx2 + idx6];<a name="line.3857"></a>
<span class="sourceLineNo">3858</span>                        out[oidx1 + idx4] = i1r + i2r;<a name="line.3858"></a>
<span class="sourceLineNo">3859</span>                        out[oidx1 + idx5] = i1r - i2r;<a name="line.3859"></a>
<span class="sourceLineNo">3860</span>                    }<a name="line.3860"></a>
<span class="sourceLineNo">3861</span>                }<a name="line.3861"></a>
<span class="sourceLineNo">3862</span>            }<a name="line.3862"></a>
<span class="sourceLineNo">3863</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.3863"></a>
<span class="sourceLineNo">3864</span>                int idxt1 = k * ido;<a name="line.3864"></a>
<span class="sourceLineNo">3865</span>                int idxt2 = idxt1 * ip;<a name="line.3865"></a>
<span class="sourceLineNo">3866</span>                for (int i = 0; i &lt; ido; i++) {<a name="line.3866"></a>
<span class="sourceLineNo">3867</span>                    out[out_off + i + idxt1] = in[in_off + i + idxt2];<a name="line.3867"></a>
<span class="sourceLineNo">3868</span>                }<a name="line.3868"></a>
<span class="sourceLineNo">3869</span>            }<a name="line.3869"></a>
<span class="sourceLineNo">3870</span>        } else {<a name="line.3870"></a>
<span class="sourceLineNo">3871</span>            for (int j = 1; j &lt; ipph; j++) {<a name="line.3871"></a>
<span class="sourceLineNo">3872</span>                jc = ip - j;<a name="line.3872"></a>
<span class="sourceLineNo">3873</span>                int idxt1 = j * l1 * ido;<a name="line.3873"></a>
<span class="sourceLineNo">3874</span>                int idxt2 = jc * l1 * ido;<a name="line.3874"></a>
<span class="sourceLineNo">3875</span>                int idxt3 = j * ido;<a name="line.3875"></a>
<span class="sourceLineNo">3876</span>                int idxt4 = jc * ido;<a name="line.3876"></a>
<span class="sourceLineNo">3877</span>                for (int i = 0; i &lt; ido; i++) {<a name="line.3877"></a>
<span class="sourceLineNo">3878</span>                    for (int k = 0; k &lt; l1; k++) {<a name="line.3878"></a>
<span class="sourceLineNo">3879</span>                        int idx1 = k * ido;<a name="line.3879"></a>
<span class="sourceLineNo">3880</span>                        int idx2 = idx1 * ip;<a name="line.3880"></a>
<span class="sourceLineNo">3881</span>                        int idx3 = out_off + i;<a name="line.3881"></a>
<span class="sourceLineNo">3882</span>                        int idx4 = in_off + i;<a name="line.3882"></a>
<span class="sourceLineNo">3883</span>                        float i1r = in[idx4 + idxt3 + idx2];<a name="line.3883"></a>
<span class="sourceLineNo">3884</span>                        float i2r = in[idx4 + idxt4 + idx2];<a name="line.3884"></a>
<span class="sourceLineNo">3885</span>                        out[idx3 + idx1 + idxt1] = i1r + i2r;<a name="line.3885"></a>
<span class="sourceLineNo">3886</span>                        out[idx3 + idx1 + idxt2] = i1r - i2r;<a name="line.3886"></a>
<span class="sourceLineNo">3887</span>                    }<a name="line.3887"></a>
<span class="sourceLineNo">3888</span>                }<a name="line.3888"></a>
<span class="sourceLineNo">3889</span>            }<a name="line.3889"></a>
<span class="sourceLineNo">3890</span>            for (int i = 0; i &lt; ido; i++) {<a name="line.3890"></a>
<span class="sourceLineNo">3891</span>                for (int k = 0; k &lt; l1; k++) {<a name="line.3891"></a>
<span class="sourceLineNo">3892</span>                    int idx1 = k * ido;<a name="line.3892"></a>
<span class="sourceLineNo">3893</span>                    out[out_off + i + idx1] = in[in_off + i + idx1 * ip];<a name="line.3893"></a>
<span class="sourceLineNo">3894</span>                }<a name="line.3894"></a>
<span class="sourceLineNo">3895</span>            }<a name="line.3895"></a>
<span class="sourceLineNo">3896</span>        }<a name="line.3896"></a>
<span class="sourceLineNo">3897</span><a name="line.3897"></a>
<span class="sourceLineNo">3898</span>        idl = 2 - ido;<a name="line.3898"></a>
<span class="sourceLineNo">3899</span>        inc = 0;<a name="line.3899"></a>
<span class="sourceLineNo">3900</span>        int idxt0 = (ip - 1) * idl1;<a name="line.3900"></a>
<span class="sourceLineNo">3901</span>        for (l = 1; l &lt; ipph; l++) {<a name="line.3901"></a>
<span class="sourceLineNo">3902</span>            lc = ip - l;<a name="line.3902"></a>
<span class="sourceLineNo">3903</span>            idl += ido;<a name="line.3903"></a>
<span class="sourceLineNo">3904</span>            int idxt1 = l * idl1;<a name="line.3904"></a>
<span class="sourceLineNo">3905</span>            int idxt2 = lc * idl1;<a name="line.3905"></a>
<span class="sourceLineNo">3906</span>            int idxt3 = idl + iw1;<a name="line.3906"></a>
<span class="sourceLineNo">3907</span>            w1r = wtable[idxt3 - 2];<a name="line.3907"></a>
<span class="sourceLineNo">3908</span>            w1i = isign * wtable[idxt3 - 1];<a name="line.3908"></a>
<span class="sourceLineNo">3909</span>            for (int ik = 0; ik &lt; idl1; ik++) {<a name="line.3909"></a>
<span class="sourceLineNo">3910</span>                int idx1 = in_off + ik;<a name="line.3910"></a>
<span class="sourceLineNo">3911</span>                int idx2 = out_off + ik;<a name="line.3911"></a>
<span class="sourceLineNo">3912</span>                in[idx1 + idxt1] = out[idx2] + w1r * out[idx2 + idl1];<a name="line.3912"></a>
<span class="sourceLineNo">3913</span>                in[idx1 + idxt2] = w1i * out[idx2 + idxt0];<a name="line.3913"></a>
<span class="sourceLineNo">3914</span>            }<a name="line.3914"></a>
<span class="sourceLineNo">3915</span>            idlj = idl;<a name="line.3915"></a>
<span class="sourceLineNo">3916</span>            inc += ido;<a name="line.3916"></a>
<span class="sourceLineNo">3917</span>            for (int j = 2; j &lt; ipph; j++) {<a name="line.3917"></a>
<span class="sourceLineNo">3918</span>                jc = ip - j;<a name="line.3918"></a>
<span class="sourceLineNo">3919</span>                idlj += inc;<a name="line.3919"></a>
<span class="sourceLineNo">3920</span>                if (idlj &gt; idp)<a name="line.3920"></a>
<span class="sourceLineNo">3921</span>                    idlj -= idp;<a name="line.3921"></a>
<span class="sourceLineNo">3922</span>                int idxt4 = idlj + iw1;<a name="line.3922"></a>
<span class="sourceLineNo">3923</span>                w2r = wtable[idxt4 - 2];<a name="line.3923"></a>
<span class="sourceLineNo">3924</span>                w2i = isign * wtable[idxt4 - 1];<a name="line.3924"></a>
<span class="sourceLineNo">3925</span>                int idxt5 = j * idl1;<a name="line.3925"></a>
<span class="sourceLineNo">3926</span>                int idxt6 = jc * idl1;<a name="line.3926"></a>
<span class="sourceLineNo">3927</span>                for (int ik = 0; ik &lt; idl1; ik++) {<a name="line.3927"></a>
<span class="sourceLineNo">3928</span>                    int idx1 = in_off + ik;<a name="line.3928"></a>
<span class="sourceLineNo">3929</span>                    int idx2 = out_off + ik;<a name="line.3929"></a>
<span class="sourceLineNo">3930</span>                    in[idx1 + idxt1] += w2r * out[idx2 + idxt5];<a name="line.3930"></a>
<span class="sourceLineNo">3931</span>                    in[idx1 + idxt2] += w2i * out[idx2 + idxt6];<a name="line.3931"></a>
<span class="sourceLineNo">3932</span>                }<a name="line.3932"></a>
<span class="sourceLineNo">3933</span>            }<a name="line.3933"></a>
<span class="sourceLineNo">3934</span>        }<a name="line.3934"></a>
<span class="sourceLineNo">3935</span>        for (int j = 1; j &lt; ipph; j++) {<a name="line.3935"></a>
<span class="sourceLineNo">3936</span>            int idxt1 = j * idl1;<a name="line.3936"></a>
<span class="sourceLineNo">3937</span>            for (int ik = 0; ik &lt; idl1; ik++) {<a name="line.3937"></a>
<span class="sourceLineNo">3938</span>                int idx1 = out_off + ik;<a name="line.3938"></a>
<span class="sourceLineNo">3939</span>                out[idx1] += out[idx1 + idxt1];<a name="line.3939"></a>
<span class="sourceLineNo">3940</span>            }<a name="line.3940"></a>
<span class="sourceLineNo">3941</span>        }<a name="line.3941"></a>
<span class="sourceLineNo">3942</span>        for (int j = 1; j &lt; ipph; j++) {<a name="line.3942"></a>
<span class="sourceLineNo">3943</span>            jc = ip - j;<a name="line.3943"></a>
<span class="sourceLineNo">3944</span>            int idx1 = j * idl1;<a name="line.3944"></a>
<span class="sourceLineNo">3945</span>            int idx2 = jc * idl1;<a name="line.3945"></a>
<span class="sourceLineNo">3946</span>            for (int ik = 1; ik &lt; idl1; ik += 2) {<a name="line.3946"></a>
<span class="sourceLineNo">3947</span>                int idx3 = out_off + ik;<a name="line.3947"></a>
<span class="sourceLineNo">3948</span>                int idx4 = in_off + ik;<a name="line.3948"></a>
<span class="sourceLineNo">3949</span>                int iidx1 = idx4 + idx1;<a name="line.3949"></a>
<span class="sourceLineNo">3950</span>                int iidx2 = idx4 + idx2;<a name="line.3950"></a>
<span class="sourceLineNo">3951</span>                float i1i = in[iidx1 - 1];<a name="line.3951"></a>
<span class="sourceLineNo">3952</span>                float i1r = in[iidx1];<a name="line.3952"></a>
<span class="sourceLineNo">3953</span>                float i2i = in[iidx2 - 1];<a name="line.3953"></a>
<span class="sourceLineNo">3954</span>                float i2r = in[iidx2];<a name="line.3954"></a>
<span class="sourceLineNo">3955</span><a name="line.3955"></a>
<span class="sourceLineNo">3956</span>                int oidx1 = idx3 + idx1;<a name="line.3956"></a>
<span class="sourceLineNo">3957</span>                int oidx2 = idx3 + idx2;<a name="line.3957"></a>
<span class="sourceLineNo">3958</span>                out[oidx1 - 1] = i1i - i2r;<a name="line.3958"></a>
<span class="sourceLineNo">3959</span>                out[oidx2 - 1] = i1i + i2r;<a name="line.3959"></a>
<span class="sourceLineNo">3960</span>                out[oidx1] = i1r + i2i;<a name="line.3960"></a>
<span class="sourceLineNo">3961</span>                out[oidx2] = i1r - i2i;<a name="line.3961"></a>
<span class="sourceLineNo">3962</span>            }<a name="line.3962"></a>
<span class="sourceLineNo">3963</span>        }<a name="line.3963"></a>
<span class="sourceLineNo">3964</span>        nac[0] = 1;<a name="line.3964"></a>
<span class="sourceLineNo">3965</span>        if (ido == 2)<a name="line.3965"></a>
<span class="sourceLineNo">3966</span>            return;<a name="line.3966"></a>
<span class="sourceLineNo">3967</span>        nac[0] = 0;<a name="line.3967"></a>
<span class="sourceLineNo">3968</span>        System.arraycopy(out, out_off, in, in_off, idl1);<a name="line.3968"></a>
<span class="sourceLineNo">3969</span>        int idx0 = l1 * ido;<a name="line.3969"></a>
<span class="sourceLineNo">3970</span>        for (int j = 1; j &lt; ip; j++) {<a name="line.3970"></a>
<span class="sourceLineNo">3971</span>            int idx1 = j * idx0;<a name="line.3971"></a>
<span class="sourceLineNo">3972</span>            for (int k = 0; k &lt; l1; k++) {<a name="line.3972"></a>
<span class="sourceLineNo">3973</span>                int idx2 = k * ido;<a name="line.3973"></a>
<span class="sourceLineNo">3974</span>                int oidx1 = out_off + idx2 + idx1;<a name="line.3974"></a>
<span class="sourceLineNo">3975</span>                int iidx1 = in_off + idx2 + idx1;<a name="line.3975"></a>
<span class="sourceLineNo">3976</span>                in[iidx1] = out[oidx1];<a name="line.3976"></a>
<span class="sourceLineNo">3977</span>                in[iidx1 + 1] = out[oidx1 + 1];<a name="line.3977"></a>
<span class="sourceLineNo">3978</span>            }<a name="line.3978"></a>
<span class="sourceLineNo">3979</span>        }<a name="line.3979"></a>
<span class="sourceLineNo">3980</span>        if (idot &lt;= l1) {<a name="line.3980"></a>
<span class="sourceLineNo">3981</span>            idij = 0;<a name="line.3981"></a>
<span class="sourceLineNo">3982</span>            for (int j = 1; j &lt; ip; j++) {<a name="line.3982"></a>
<span class="sourceLineNo">3983</span>                idij += 2;<a name="line.3983"></a>
<span class="sourceLineNo">3984</span>                int idx1 = j * l1 * ido;<a name="line.3984"></a>
<span class="sourceLineNo">3985</span>                for (int i = 3; i &lt; ido; i += 2) {<a name="line.3985"></a>
<span class="sourceLineNo">3986</span>                    idij += 2;<a name="line.3986"></a>
<span class="sourceLineNo">3987</span>                    int idx2 = idij + iw1 - 1;<a name="line.3987"></a>
<span class="sourceLineNo">3988</span>                    w1r = wtable[idx2 - 1];<a name="line.3988"></a>
<span class="sourceLineNo">3989</span>                    w1i = isign * wtable[idx2];<a name="line.3989"></a>
<span class="sourceLineNo">3990</span>                    int idx3 = in_off + i;<a name="line.3990"></a>
<span class="sourceLineNo">3991</span>                    int idx4 = out_off + i;<a name="line.3991"></a>
<span class="sourceLineNo">3992</span>                    for (int k = 0; k &lt; l1; k++) {<a name="line.3992"></a>
<span class="sourceLineNo">3993</span>                        int idx5 = k * ido + idx1;<a name="line.3993"></a>
<span class="sourceLineNo">3994</span>                        int iidx1 = idx3 + idx5;<a name="line.3994"></a>
<span class="sourceLineNo">3995</span>                        int oidx1 = idx4 + idx5;<a name="line.3995"></a>
<span class="sourceLineNo">3996</span>                        float o1i = out[oidx1 - 1];<a name="line.3996"></a>
<span class="sourceLineNo">3997</span>                        float o1r = out[oidx1];<a name="line.3997"></a>
<span class="sourceLineNo">3998</span>                        in[iidx1 - 1] = w1r * o1i - w1i * o1r;<a name="line.3998"></a>
<span class="sourceLineNo">3999</span>                        in[iidx1] = w1r * o1r + w1i * o1i;<a name="line.3999"></a>
<span class="sourceLineNo">4000</span>                    }<a name="line.4000"></a>
<span class="sourceLineNo">4001</span>                }<a name="line.4001"></a>
<span class="sourceLineNo">4002</span>            }<a name="line.4002"></a>
<span class="sourceLineNo">4003</span>        } else {<a name="line.4003"></a>
<span class="sourceLineNo">4004</span>            idj = 2 - ido;<a name="line.4004"></a>
<span class="sourceLineNo">4005</span>            for (int j = 1; j &lt; ip; j++) {<a name="line.4005"></a>
<span class="sourceLineNo">4006</span>                idj += ido;<a name="line.4006"></a>
<span class="sourceLineNo">4007</span>                int idx1 = j * l1 * ido;<a name="line.4007"></a>
<span class="sourceLineNo">4008</span>                for (int k = 0; k &lt; l1; k++) {<a name="line.4008"></a>
<span class="sourceLineNo">4009</span>                    idij = idj;<a name="line.4009"></a>
<span class="sourceLineNo">4010</span>                    int idx3 = k * ido + idx1;<a name="line.4010"></a>
<span class="sourceLineNo">4011</span>                    for (int i = 3; i &lt; ido; i += 2) {<a name="line.4011"></a>
<span class="sourceLineNo">4012</span>                        idij += 2;<a name="line.4012"></a>
<span class="sourceLineNo">4013</span>                        int idx2 = idij - 1 + iw1;<a name="line.4013"></a>
<span class="sourceLineNo">4014</span>                        w1r = wtable[idx2 - 1];<a name="line.4014"></a>
<span class="sourceLineNo">4015</span>                        w1i = isign * wtable[idx2];<a name="line.4015"></a>
<span class="sourceLineNo">4016</span>                        int iidx1 = in_off + i + idx3;<a name="line.4016"></a>
<span class="sourceLineNo">4017</span>                        int oidx1 = out_off + i + idx3;<a name="line.4017"></a>
<span class="sourceLineNo">4018</span>                        float o1i = out[oidx1 - 1];<a name="line.4018"></a>
<span class="sourceLineNo">4019</span>                        float o1r = out[oidx1];<a name="line.4019"></a>
<span class="sourceLineNo">4020</span>                        in[iidx1 - 1] = w1r * o1i - w1i * o1r;<a name="line.4020"></a>
<span class="sourceLineNo">4021</span>                        in[iidx1] = w1r * o1r + w1i * o1i;<a name="line.4021"></a>
<span class="sourceLineNo">4022</span>                    }<a name="line.4022"></a>
<span class="sourceLineNo">4023</span>                }<a name="line.4023"></a>
<span class="sourceLineNo">4024</span>            }<a name="line.4024"></a>
<span class="sourceLineNo">4025</span>        }<a name="line.4025"></a>
<span class="sourceLineNo">4026</span>    }<a name="line.4026"></a>
<span class="sourceLineNo">4027</span><a name="line.4027"></a>
<span class="sourceLineNo">4028</span>    private void cftfsub(int n, float[] a, int offa, int[] ip, int nw, float[] w) {<a name="line.4028"></a>
<span class="sourceLineNo">4029</span>        if (n &gt; 8) {<a name="line.4029"></a>
<span class="sourceLineNo">4030</span>            if (n &gt; 32) {<a name="line.4030"></a>
<span class="sourceLineNo">4031</span>                cftf1st(n, a, offa, w, nw - (n &gt;&gt; 2));<a name="line.4031"></a>
<span class="sourceLineNo">4032</span>                if ((ConcurrencyUtils.getNumberOfThreads() &gt; 1) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_2Threads())) {<a name="line.4032"></a>
<span class="sourceLineNo">4033</span>                    cftrec4_th(n, a, offa, nw, w);<a name="line.4033"></a>
<span class="sourceLineNo">4034</span>                } else if (n &gt; 512) {<a name="line.4034"></a>
<span class="sourceLineNo">4035</span>                    cftrec4(n, a, offa, nw, w);<a name="line.4035"></a>
<span class="sourceLineNo">4036</span>                } else if (n &gt; 128) {<a name="line.4036"></a>
<span class="sourceLineNo">4037</span>                    cftleaf(n, 1, a, offa, nw, w);<a name="line.4037"></a>
<span class="sourceLineNo">4038</span>                } else {<a name="line.4038"></a>
<span class="sourceLineNo">4039</span>                    cftfx41(n, a, offa, nw, w);<a name="line.4039"></a>
<span class="sourceLineNo">4040</span>                }<a name="line.4040"></a>
<span class="sourceLineNo">4041</span>                bitrv2(n, ip, a, offa);<a name="line.4041"></a>
<span class="sourceLineNo">4042</span>            } else if (n == 32) {<a name="line.4042"></a>
<span class="sourceLineNo">4043</span>                cftf161(a, offa, w, nw - 8);<a name="line.4043"></a>
<span class="sourceLineNo">4044</span>                bitrv216(a, offa);<a name="line.4044"></a>
<span class="sourceLineNo">4045</span>            } else {<a name="line.4045"></a>
<span class="sourceLineNo">4046</span>                cftf081(a, offa, w, 0);<a name="line.4046"></a>
<span class="sourceLineNo">4047</span>                bitrv208(a, offa);<a name="line.4047"></a>
<span class="sourceLineNo">4048</span>            }<a name="line.4048"></a>
<span class="sourceLineNo">4049</span>        } else if (n == 8) {<a name="line.4049"></a>
<span class="sourceLineNo">4050</span>            cftf040(a, offa);<a name="line.4050"></a>
<span class="sourceLineNo">4051</span>        } else if (n == 4) {<a name="line.4051"></a>
<span class="sourceLineNo">4052</span>            cftxb020(a, offa);<a name="line.4052"></a>
<span class="sourceLineNo">4053</span>        }<a name="line.4053"></a>
<span class="sourceLineNo">4054</span>    }<a name="line.4054"></a>
<span class="sourceLineNo">4055</span><a name="line.4055"></a>
<span class="sourceLineNo">4056</span>    private void cftbsub(int n, float[] a, int offa, int[] ip, int nw, float[] w) {<a name="line.4056"></a>
<span class="sourceLineNo">4057</span>        if (n &gt; 8) {<a name="line.4057"></a>
<span class="sourceLineNo">4058</span>            if (n &gt; 32) {<a name="line.4058"></a>
<span class="sourceLineNo">4059</span>                cftb1st(n, a, offa, w, nw - (n &gt;&gt; 2));<a name="line.4059"></a>
<span class="sourceLineNo">4060</span>                if ((ConcurrencyUtils.getNumberOfThreads() &gt; 1) &amp;&amp; (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_2Threads())) {<a name="line.4060"></a>
<span class="sourceLineNo">4061</span>                    cftrec4_th(n, a, offa, nw, w);<a name="line.4061"></a>
<span class="sourceLineNo">4062</span>                } else if (n &gt; 512) {<a name="line.4062"></a>
<span class="sourceLineNo">4063</span>                    cftrec4(n, a, offa, nw, w);<a name="line.4063"></a>
<span class="sourceLineNo">4064</span>                } else if (n &gt; 128) {<a name="line.4064"></a>
<span class="sourceLineNo">4065</span>                    cftleaf(n, 1, a, offa, nw, w);<a name="line.4065"></a>
<span class="sourceLineNo">4066</span>                } else {<a name="line.4066"></a>
<span class="sourceLineNo">4067</span>                    cftfx41(n, a, offa, nw, w);<a name="line.4067"></a>
<span class="sourceLineNo">4068</span>                }<a name="line.4068"></a>
<span class="sourceLineNo">4069</span>                bitrv2conj(n, ip, a, offa);<a name="line.4069"></a>
<span class="sourceLineNo">4070</span>            } else if (n == 32) {<a name="line.4070"></a>
<span class="sourceLineNo">4071</span>                cftf161(a, offa, w, nw - 8);<a name="line.4071"></a>
<span class="sourceLineNo">4072</span>                bitrv216neg(a, offa);<a name="line.4072"></a>
<span class="sourceLineNo">4073</span>            } else {<a name="line.4073"></a>
<span class="sourceLineNo">4074</span>                cftf081(a, offa, w, 0);<a name="line.4074"></a>
<span class="sourceLineNo">4075</span>                bitrv208neg(a, offa);<a name="line.4075"></a>
<span class="sourceLineNo">4076</span>            }<a name="line.4076"></a>
<span class="sourceLineNo">4077</span>        } else if (n == 8) {<a name="line.4077"></a>
<span class="sourceLineNo">4078</span>            cftb040(a, offa);<a name="line.4078"></a>
<span class="sourceLineNo">4079</span>        } else if (n == 4) {<a name="line.4079"></a>
<span class="sourceLineNo">4080</span>            cftxb020(a, offa);<a name="line.4080"></a>
<span class="sourceLineNo">4081</span>        }<a name="line.4081"></a>
<span class="sourceLineNo">4082</span>    }<a name="line.4082"></a>
<span class="sourceLineNo">4083</span><a name="line.4083"></a>
<span class="sourceLineNo">4084</span>    private void bitrv2(int n, int[] ip, float[] a, int offa) {<a name="line.4084"></a>
<span class="sourceLineNo">4085</span>        int j1, k1, l, m, nh, nm;<a name="line.4085"></a>
<span class="sourceLineNo">4086</span>        float xr, xi, yr, yi;<a name="line.4086"></a>
<span class="sourceLineNo">4087</span>        int idx0, idx1, idx2;<a name="line.4087"></a>
<span class="sourceLineNo">4088</span><a name="line.4088"></a>
<span class="sourceLineNo">4089</span>        m = 1;<a name="line.4089"></a>
<span class="sourceLineNo">4090</span>        for (l = n &gt;&gt; 2; l &gt; 8; l &gt;&gt;= 2) {<a name="line.4090"></a>
<span class="sourceLineNo">4091</span>            m &lt;&lt;= 1;<a name="line.4091"></a>
<span class="sourceLineNo">4092</span>        }<a name="line.4092"></a>
<span class="sourceLineNo">4093</span>        nh = n &gt;&gt; 1;<a name="line.4093"></a>
<span class="sourceLineNo">4094</span>        nm = 4 * m;<a name="line.4094"></a>
<span class="sourceLineNo">4095</span>        if (l == 8) {<a name="line.4095"></a>
<span class="sourceLineNo">4096</span>            for (int k = 0; k &lt; m; k++) {<a name="line.4096"></a>
<span class="sourceLineNo">4097</span>                idx0 = 4 * k;<a name="line.4097"></a>
<span class="sourceLineNo">4098</span>                for (int j = 0; j &lt; k; j++) {<a name="line.4098"></a>
<span class="sourceLineNo">4099</span>                    j1 = 4 * j + 2 * ip[m + k];<a name="line.4099"></a>
<span class="sourceLineNo">4100</span>                    k1 = idx0 + 2 * ip[m + j];<a name="line.4100"></a>
<span class="sourceLineNo">4101</span>                    idx1 = offa + j1;<a name="line.4101"></a>
<span class="sourceLineNo">4102</span>                    idx2 = offa + k1;<a name="line.4102"></a>
<span class="sourceLineNo">4103</span>                    xr = a[idx1];<a name="line.4103"></a>
<span class="sourceLineNo">4104</span>                    xi = a[idx1 + 1];<a name="line.4104"></a>
<span class="sourceLineNo">4105</span>                    yr = a[idx2];<a name="line.4105"></a>
<span class="sourceLineNo">4106</span>                    yi = a[idx2 + 1];<a name="line.4106"></a>
<span class="sourceLineNo">4107</span>                    a[idx1] = yr;<a name="line.4107"></a>
<span class="sourceLineNo">4108</span>                    a[idx1 + 1] = yi;<a name="line.4108"></a>
<span class="sourceLineNo">4109</span>                    a[idx2] = xr;<a name="line.4109"></a>
<span class="sourceLineNo">4110</span>                    a[idx2 + 1] = xi;<a name="line.4110"></a>
<span class="sourceLineNo">4111</span>                    j1 += nm;<a name="line.4111"></a>
<span class="sourceLineNo">4112</span>                    k1 += 2 * nm;<a name="line.4112"></a>
<span class="sourceLineNo">4113</span>                    idx1 = offa + j1;<a name="line.4113"></a>
<span class="sourceLineNo">4114</span>                    idx2 = offa + k1;<a name="line.4114"></a>
<span class="sourceLineNo">4115</span>                    xr = a[idx1];<a name="line.4115"></a>
<span class="sourceLineNo">4116</span>                    xi = a[idx1 + 1];<a name="line.4116"></a>
<span class="sourceLineNo">4117</span>                    yr = a[idx2];<a name="line.4117"></a>
<span class="sourceLineNo">4118</span>                    yi = a[idx2 + 1];<a name="line.4118"></a>
<span class="sourceLineNo">4119</span>                    a[idx1] = yr;<a name="line.4119"></a>
<span class="sourceLineNo">4120</span>                    a[idx1 + 1] = yi;<a name="line.4120"></a>
<span class="sourceLineNo">4121</span>                    a[idx2] = xr;<a name="line.4121"></a>
<span class="sourceLineNo">4122</span>                    a[idx2 + 1] = xi;<a name="line.4122"></a>
<span class="sourceLineNo">4123</span>                    j1 += nm;<a name="line.4123"></a>
<span class="sourceLineNo">4124</span>                    k1 -= nm;<a name="line.4124"></a>
<span class="sourceLineNo">4125</span>                    idx1 = offa + j1;<a name="line.4125"></a>
<span class="sourceLineNo">4126</span>                    idx2 = offa + k1;<a name="line.4126"></a>
<span class="sourceLineNo">4127</span>                    xr = a[idx1];<a name="line.4127"></a>
<span class="sourceLineNo">4128</span>                    xi = a[idx1 + 1];<a name="line.4128"></a>
<span class="sourceLineNo">4129</span>                    yr = a[idx2];<a name="line.4129"></a>
<span class="sourceLineNo">4130</span>                    yi = a[idx2 + 1];<a name="line.4130"></a>
<span class="sourceLineNo">4131</span>                    a[idx1] = yr;<a name="line.4131"></a>
<span class="sourceLineNo">4132</span>                    a[idx1 + 1] = yi;<a name="line.4132"></a>
<span class="sourceLineNo">4133</span>                    a[idx2] = xr;<a name="line.4133"></a>
<span class="sourceLineNo">4134</span>                    a[idx2 + 1] = xi;<a name="line.4134"></a>
<span class="sourceLineNo">4135</span>                    j1 += nm;<a name="line.4135"></a>
<span class="sourceLineNo">4136</span>                    k1 += 2 * nm;<a name="line.4136"></a>
<span class="sourceLineNo">4137</span>                    idx1 = offa + j1;<a name="line.4137"></a>
<span class="sourceLineNo">4138</span>                    idx2 = offa + k1;<a name="line.4138"></a>
<span class="sourceLineNo">4139</span>                    xr = a[idx1];<a name="line.4139"></a>
<span class="sourceLineNo">4140</span>                    xi = a[idx1 + 1];<a name="line.4140"></a>
<span class="sourceLineNo">4141</span>                    yr = a[idx2];<a name="line.4141"></a>
<span class="sourceLineNo">4142</span>                    yi = a[idx2 + 1];<a name="line.4142"></a>
<span class="sourceLineNo">4143</span>                    a[idx1] = yr;<a name="line.4143"></a>
<span class="sourceLineNo">4144</span>                    a[idx1 + 1] = yi;<a name="line.4144"></a>
<span class="sourceLineNo">4145</span>                    a[idx2] = xr;<a name="line.4145"></a>
<span class="sourceLineNo">4146</span>                    a[idx2 + 1] = xi;<a name="line.4146"></a>
<span class="sourceLineNo">4147</span>                    j1 += nh;<a name="line.4147"></a>
<span class="sourceLineNo">4148</span>                    k1 += 2;<a name="line.4148"></a>
<span class="sourceLineNo">4149</span>                    idx1 = offa + j1;<a name="line.4149"></a>
<span class="sourceLineNo">4150</span>                    idx2 = offa + k1;<a name="line.4150"></a>
<span class="sourceLineNo">4151</span>                    xr = a[idx1];<a name="line.4151"></a>
<span class="sourceLineNo">4152</span>                    xi = a[idx1 + 1];<a name="line.4152"></a>
<span class="sourceLineNo">4153</span>                    yr = a[idx2];<a name="line.4153"></a>
<span class="sourceLineNo">4154</span>                    yi = a[idx2 + 1];<a name="line.4154"></a>
<span class="sourceLineNo">4155</span>                    a[idx1] = yr;<a name="line.4155"></a>
<span class="sourceLineNo">4156</span>                    a[idx1 + 1] = yi;<a name="line.4156"></a>
<span class="sourceLineNo">4157</span>                    a[idx2] = xr;<a name="line.4157"></a>
<span class="sourceLineNo">4158</span>                    a[idx2 + 1] = xi;<a name="line.4158"></a>
<span class="sourceLineNo">4159</span>                    j1 -= nm;<a name="line.4159"></a>
<span class="sourceLineNo">4160</span>                    k1 -= 2 * nm;<a name="line.4160"></a>
<span class="sourceLineNo">4161</span>                    idx1 = offa + j1;<a name="line.4161"></a>
<span class="sourceLineNo">4162</span>                    idx2 = offa + k1;<a name="line.4162"></a>
<span class="sourceLineNo">4163</span>                    xr = a[idx1];<a name="line.4163"></a>
<span class="sourceLineNo">4164</span>                    xi = a[idx1 + 1];<a name="line.4164"></a>
<span class="sourceLineNo">4165</span>                    yr = a[idx2];<a name="line.4165"></a>
<span class="sourceLineNo">4166</span>                    yi = a[idx2 + 1];<a name="line.4166"></a>
<span class="sourceLineNo">4167</span>                    a[idx1] = yr;<a name="line.4167"></a>
<span class="sourceLineNo">4168</span>                    a[idx1 + 1] = yi;<a name="line.4168"></a>
<span class="sourceLineNo">4169</span>                    a[idx2] = xr;<a name="line.4169"></a>
<span class="sourceLineNo">4170</span>                    a[idx2 + 1] = xi;<a name="line.4170"></a>
<span class="sourceLineNo">4171</span>                    j1 -= nm;<a name="line.4171"></a>
<span class="sourceLineNo">4172</span>                    k1 += nm;<a name="line.4172"></a>
<span class="sourceLineNo">4173</span>                    idx1 = offa + j1;<a name="line.4173"></a>
<span class="sourceLineNo">4174</span>                    idx2 = offa + k1;<a name="line.4174"></a>
<span class="sourceLineNo">4175</span>                    xr = a[idx1];<a name="line.4175"></a>
<span class="sourceLineNo">4176</span>                    xi = a[idx1 + 1];<a name="line.4176"></a>
<span class="sourceLineNo">4177</span>                    yr = a[idx2];<a name="line.4177"></a>
<span class="sourceLineNo">4178</span>                    yi = a[idx2 + 1];<a name="line.4178"></a>
<span class="sourceLineNo">4179</span>                    a[idx1] = yr;<a name="line.4179"></a>
<span class="sourceLineNo">4180</span>                    a[idx1 + 1] = yi;<a name="line.4180"></a>
<span class="sourceLineNo">4181</span>                    a[idx2] = xr;<a name="line.4181"></a>
<span class="sourceLineNo">4182</span>                    a[idx2 + 1] = xi;<a name="line.4182"></a>
<span class="sourceLineNo">4183</span>                    j1 -= nm;<a name="line.4183"></a>
<span class="sourceLineNo">4184</span>                    k1 -= 2 * nm;<a name="line.4184"></a>
<span class="sourceLineNo">4185</span>                    idx1 = offa + j1;<a name="line.4185"></a>
<span class="sourceLineNo">4186</span>                    idx2 = offa + k1;<a name="line.4186"></a>
<span class="sourceLineNo">4187</span>                    xr = a[idx1];<a name="line.4187"></a>
<span class="sourceLineNo">4188</span>                    xi = a[idx1 + 1];<a name="line.4188"></a>
<span class="sourceLineNo">4189</span>                    yr = a[idx2];<a name="line.4189"></a>
<span class="sourceLineNo">4190</span>                    yi = a[idx2 + 1];<a name="line.4190"></a>
<span class="sourceLineNo">4191</span>                    a[idx1] = yr;<a name="line.4191"></a>
<span class="sourceLineNo">4192</span>                    a[idx1 + 1] = yi;<a name="line.4192"></a>
<span class="sourceLineNo">4193</span>                    a[idx2] = xr;<a name="line.4193"></a>
<span class="sourceLineNo">4194</span>                    a[idx2 + 1] = xi;<a name="line.4194"></a>
<span class="sourceLineNo">4195</span>                    j1 += 2;<a name="line.4195"></a>
<span class="sourceLineNo">4196</span>                    k1 += nh;<a name="line.4196"></a>
<span class="sourceLineNo">4197</span>                    idx1 = offa + j1;<a name="line.4197"></a>
<span class="sourceLineNo">4198</span>                    idx2 = offa + k1;<a name="line.4198"></a>
<span class="sourceLineNo">4199</span>                    xr = a[idx1];<a name="line.4199"></a>
<span class="sourceLineNo">4200</span>                    xi = a[idx1 + 1];<a name="line.4200"></a>
<span class="sourceLineNo">4201</span>                    yr = a[idx2];<a name="line.4201"></a>
<span class="sourceLineNo">4202</span>                    yi = a[idx2 + 1];<a name="line.4202"></a>
<span class="sourceLineNo">4203</span>                    a[idx1] = yr;<a name="line.4203"></a>
<span class="sourceLineNo">4204</span>                    a[idx1 + 1] = yi;<a name="line.4204"></a>
<span class="sourceLineNo">4205</span>                    a[idx2] = xr;<a name="line.4205"></a>
<span class="sourceLineNo">4206</span>                    a[idx2 + 1] = xi;<a name="line.4206"></a>
<span class="sourceLineNo">4207</span>                    j1 += nm;<a name="line.4207"></a>
<span class="sourceLineNo">4208</span>                    k1 += 2 * nm;<a name="line.4208"></a>
<span class="sourceLineNo">4209</span>                    idx1 = offa + j1;<a name="line.4209"></a>
<span class="sourceLineNo">4210</span>                    idx2 = offa + k1;<a name="line.4210"></a>
<span class="sourceLineNo">4211</span>                    xr = a[idx1];<a name="line.4211"></a>
<span class="sourceLineNo">4212</span>                    xi = a[idx1 + 1];<a name="line.4212"></a>
<span class="sourceLineNo">4213</span>                    yr = a[idx2];<a name="line.4213"></a>
<span class="sourceLineNo">4214</span>                    yi = a[idx2 + 1];<a name="line.4214"></a>
<span class="sourceLineNo">4215</span>                    a[idx1] = yr;<a name="line.4215"></a>
<span class="sourceLineNo">4216</span>                    a[idx1 + 1] = yi;<a name="line.4216"></a>
<span class="sourceLineNo">4217</span>                    a[idx2] = xr;<a name="line.4217"></a>
<span class="sourceLineNo">4218</span>                    a[idx2 + 1] = xi;<a name="line.4218"></a>
<span class="sourceLineNo">4219</span>                    j1 += nm;<a name="line.4219"></a>
<span class="sourceLineNo">4220</span>                    k1 -= nm;<a name="line.4220"></a>
<span class="sourceLineNo">4221</span>                    idx1 = offa + j1;<a name="line.4221"></a>
<span class="sourceLineNo">4222</span>                    idx2 = offa + k1;<a name="line.4222"></a>
<span class="sourceLineNo">4223</span>                    xr = a[idx1];<a name="line.4223"></a>
<span class="sourceLineNo">4224</span>                    xi = a[idx1 + 1];<a name="line.4224"></a>
<span class="sourceLineNo">4225</span>                    yr = a[idx2];<a name="line.4225"></a>
<span class="sourceLineNo">4226</span>                    yi = a[idx2 + 1];<a name="line.4226"></a>
<span class="sourceLineNo">4227</span>                    a[idx1] = yr;<a name="line.4227"></a>
<span class="sourceLineNo">4228</span>                    a[idx1 + 1] = yi;<a name="line.4228"></a>
<span class="sourceLineNo">4229</span>                    a[idx2] = xr;<a name="line.4229"></a>
<span class="sourceLineNo">4230</span>                    a[idx2 + 1] = xi;<a name="line.4230"></a>
<span class="sourceLineNo">4231</span>                    j1 += nm;<a name="line.4231"></a>
<span class="sourceLineNo">4232</span>                    k1 += 2 * nm;<a name="line.4232"></a>
<span class="sourceLineNo">4233</span>                    idx1 = offa + j1;<a name="line.4233"></a>
<span class="sourceLineNo">4234</span>                    idx2 = offa + k1;<a name="line.4234"></a>
<span class="sourceLineNo">4235</span>                    xr = a[idx1];<a name="line.4235"></a>
<span class="sourceLineNo">4236</span>                    xi = a[idx1 + 1];<a name="line.4236"></a>
<span class="sourceLineNo">4237</span>                    yr = a[idx2];<a name="line.4237"></a>
<span class="sourceLineNo">4238</span>                    yi = a[idx2 + 1];<a name="line.4238"></a>
<span class="sourceLineNo">4239</span>                    a[idx1] = yr;<a name="line.4239"></a>
<span class="sourceLineNo">4240</span>                    a[idx1 + 1] = yi;<a name="line.4240"></a>
<span class="sourceLineNo">4241</span>                    a[idx2] = xr;<a name="line.4241"></a>
<span class="sourceLineNo">4242</span>                    a[idx2 + 1] = xi;<a name="line.4242"></a>
<span class="sourceLineNo">4243</span>                    j1 -= nh;<a name="line.4243"></a>
<span class="sourceLineNo">4244</span>                    k1 -= 2;<a name="line.4244"></a>
<span class="sourceLineNo">4245</span>                    idx1 = offa + j1;<a name="line.4245"></a>
<span class="sourceLineNo">4246</span>                    idx2 = offa + k1;<a name="line.4246"></a>
<span class="sourceLineNo">4247</span>                    xr = a[idx1];<a name="line.4247"></a>
<span class="sourceLineNo">4248</span>                    xi = a[idx1 + 1];<a name="line.4248"></a>
<span class="sourceLineNo">4249</span>                    yr = a[idx2];<a name="line.4249"></a>
<span class="sourceLineNo">4250</span>                    yi = a[idx2 + 1];<a name="line.4250"></a>
<span class="sourceLineNo">4251</span>                    a[idx1] = yr;<a name="line.4251"></a>
<span class="sourceLineNo">4252</span>                    a[idx1 + 1] = yi;<a name="line.4252"></a>
<span class="sourceLineNo">4253</span>                    a[idx2] = xr;<a name="line.4253"></a>
<span class="sourceLineNo">4254</span>                    a[idx2 + 1] = xi;<a name="line.4254"></a>
<span class="sourceLineNo">4255</span>                    j1 -= nm;<a name="line.4255"></a>
<span class="sourceLineNo">4256</span>                    k1 -= 2 * nm;<a name="line.4256"></a>
<span class="sourceLineNo">4257</span>                    idx1 = offa + j1;<a name="line.4257"></a>
<span class="sourceLineNo">4258</span>                    idx2 = offa + k1;<a name="line.4258"></a>
<span class="sourceLineNo">4259</span>                    xr = a[idx1];<a name="line.4259"></a>
<span class="sourceLineNo">4260</span>                    xi = a[idx1 + 1];<a name="line.4260"></a>
<span class="sourceLineNo">4261</span>                    yr = a[idx2];<a name="line.4261"></a>
<span class="sourceLineNo">4262</span>                    yi = a[idx2 + 1];<a name="line.4262"></a>
<span class="sourceLineNo">4263</span>                    a[idx1] = yr;<a name="line.4263"></a>
<span class="sourceLineNo">4264</span>                    a[idx1 + 1] = yi;<a name="line.4264"></a>
<span class="sourceLineNo">4265</span>                    a[idx2] = xr;<a name="line.4265"></a>
<span class="sourceLineNo">4266</span>                    a[idx2 + 1] = xi;<a name="line.4266"></a>
<span class="sourceLineNo">4267</span>                    j1 -= nm;<a name="line.4267"></a>
<span class="sourceLineNo">4268</span>                    k1 += nm;<a name="line.4268"></a>
<span class="sourceLineNo">4269</span>                    idx1 = offa + j1;<a name="line.4269"></a>
<span class="sourceLineNo">4270</span>                    idx2 = offa + k1;<a name="line.4270"></a>
<span class="sourceLineNo">4271</span>                    xr = a[idx1];<a name="line.4271"></a>
<span class="sourceLineNo">4272</span>                    xi = a[idx1 + 1];<a name="line.4272"></a>
<span class="sourceLineNo">4273</span>                    yr = a[idx2];<a name="line.4273"></a>
<span class="sourceLineNo">4274</span>                    yi = a[idx2 + 1];<a name="line.4274"></a>
<span class="sourceLineNo">4275</span>                    a[idx1] = yr;<a name="line.4275"></a>
<span class="sourceLineNo">4276</span>                    a[idx1 + 1] = yi;<a name="line.4276"></a>
<span class="sourceLineNo">4277</span>                    a[idx2] = xr;<a name="line.4277"></a>
<span class="sourceLineNo">4278</span>                    a[idx2 + 1] = xi;<a name="line.4278"></a>
<span class="sourceLineNo">4279</span>                    j1 -= nm;<a name="line.4279"></a>
<span class="sourceLineNo">4280</span>                    k1 -= 2 * nm;<a name="line.4280"></a>
<span class="sourceLineNo">4281</span>                    idx1 = offa + j1;<a name="line.4281"></a>
<span class="sourceLineNo">4282</span>                    idx2 = offa + k1;<a name="line.4282"></a>
<span class="sourceLineNo">4283</span>                    xr = a[idx1];<a name="line.4283"></a>
<span class="sourceLineNo">4284</span>                    xi = a[idx1 + 1];<a name="line.4284"></a>
<span class="sourceLineNo">4285</span>                    yr = a[idx2];<a name="line.4285"></a>
<span class="sourceLineNo">4286</span>                    yi = a[idx2 + 1];<a name="line.4286"></a>
<span class="sourceLineNo">4287</span>                    a[idx1] = yr;<a name="line.4287"></a>
<span class="sourceLineNo">4288</span>                    a[idx1 + 1] = yi;<a name="line.4288"></a>
<span class="sourceLineNo">4289</span>                    a[idx2] = xr;<a name="line.4289"></a>
<span class="sourceLineNo">4290</span>                    a[idx2 + 1] = xi;<a name="line.4290"></a>
<span class="sourceLineNo">4291</span>                }<a name="line.4291"></a>
<span class="sourceLineNo">4292</span>                k1 = idx0 + 2 * ip[m + k];<a name="line.4292"></a>
<span class="sourceLineNo">4293</span>                j1 = k1 + 2;<a name="line.4293"></a>
<span class="sourceLineNo">4294</span>                k1 += nh;<a name="line.4294"></a>
<span class="sourceLineNo">4295</span>                idx1 = offa + j1;<a name="line.4295"></a>
<span class="sourceLineNo">4296</span>                idx2 = offa + k1;<a name="line.4296"></a>
<span class="sourceLineNo">4297</span>                xr = a[idx1];<a name="line.4297"></a>
<span class="sourceLineNo">4298</span>                xi = a[idx1 + 1];<a name="line.4298"></a>
<span class="sourceLineNo">4299</span>                yr = a[idx2];<a name="line.4299"></a>
<span class="sourceLineNo">4300</span>                yi = a[idx2 + 1];<a name="line.4300"></a>
<span class="sourceLineNo">4301</span>                a[idx1] = yr;<a name="line.4301"></a>
<span class="sourceLineNo">4302</span>                a[idx1 + 1] = yi;<a name="line.4302"></a>
<span class="sourceLineNo">4303</span>                a[idx2] = xr;<a name="line.4303"></a>
<span class="sourceLineNo">4304</span>                a[idx2 + 1] = xi;<a name="line.4304"></a>
<span class="sourceLineNo">4305</span>                j1 += nm;<a name="line.4305"></a>
<span class="sourceLineNo">4306</span>                k1 += 2 * nm;<a name="line.4306"></a>
<span class="sourceLineNo">4307</span>                idx1 = offa + j1;<a name="line.4307"></a>
<span class="sourceLineNo">4308</span>                idx2 = offa + k1;<a name="line.4308"></a>
<span class="sourceLineNo">4309</span>                xr = a[idx1];<a name="line.4309"></a>
<span class="sourceLineNo">4310</span>                xi = a[idx1 + 1];<a name="line.4310"></a>
<span class="sourceLineNo">4311</span>                yr = a[idx2];<a name="line.4311"></a>
<span class="sourceLineNo">4312</span>                yi = a[idx2 + 1];<a name="line.4312"></a>
<span class="sourceLineNo">4313</span>                a[idx1] = yr;<a name="line.4313"></a>
<span class="sourceLineNo">4314</span>                a[idx1 + 1] = yi;<a name="line.4314"></a>
<span class="sourceLineNo">4315</span>                a[idx2] = xr;<a name="line.4315"></a>
<span class="sourceLineNo">4316</span>                a[idx2 + 1] = xi;<a name="line.4316"></a>
<span class="sourceLineNo">4317</span>                j1 += nm;<a name="line.4317"></a>
<span class="sourceLineNo">4318</span>                k1 -= nm;<a name="line.4318"></a>
<span class="sourceLineNo">4319</span>                idx1 = offa + j1;<a name="line.4319"></a>
<span class="sourceLineNo">4320</span>                idx2 = offa + k1;<a name="line.4320"></a>
<span class="sourceLineNo">4321</span>                xr = a[idx1];<a name="line.4321"></a>
<span class="sourceLineNo">4322</span>                xi = a[idx1 + 1];<a name="line.4322"></a>
<span class="sourceLineNo">4323</span>                yr = a[idx2];<a name="line.4323"></a>
<span class="sourceLineNo">4324</span>                yi = a[idx2 + 1];<a name="line.4324"></a>
<span class="sourceLineNo">4325</span>                a[idx1] = yr;<a name="line.4325"></a>
<span class="sourceLineNo">4326</span>                a[idx1 + 1] = yi;<a name="line.4326"></a>
<span class="sourceLineNo">4327</span>                a[idx2] = xr;<a name="line.4327"></a>
<span class="sourceLineNo">4328</span>                a[idx2 + 1] = xi;<a name="line.4328"></a>
<span class="sourceLineNo">4329</span>                j1 -= 2;<a name="line.4329"></a>
<span class="sourceLineNo">4330</span>                k1 -= nh;<a name="line.4330"></a>
<span class="sourceLineNo">4331</span>                idx1 = offa + j1;<a name="line.4331"></a>
<span class="sourceLineNo">4332</span>                idx2 = offa + k1;<a name="line.4332"></a>
<span class="sourceLineNo">4333</span>                xr = a[idx1];<a name="line.4333"></a>
<span class="sourceLineNo">4334</span>                xi = a[idx1 + 1];<a name="line.4334"></a>
<span class="sourceLineNo">4335</span>                yr = a[idx2];<a name="line.4335"></a>
<span class="sourceLineNo">4336</span>                yi = a[idx2 + 1];<a name="line.4336"></a>
<span class="sourceLineNo">4337</span>                a[idx1] = yr;<a name="line.4337"></a>
<span class="sourceLineNo">4338</span>                a[idx1 + 1] = yi;<a name="line.4338"></a>
<span class="sourceLineNo">4339</span>                a[idx2] = xr;<a name="line.4339"></a>
<span class="sourceLineNo">4340</span>                a[idx2 + 1] = xi;<a name="line.4340"></a>
<span class="sourceLineNo">4341</span>                j1 += nh + 2;<a name="line.4341"></a>
<span class="sourceLineNo">4342</span>                k1 += nh + 2;<a name="line.4342"></a>
<span class="sourceLineNo">4343</span>                idx1 = offa + j1;<a name="line.4343"></a>
<span class="sourceLineNo">4344</span>                idx2 = offa + k1;<a name="line.4344"></a>
<span class="sourceLineNo">4345</span>                xr = a[idx1];<a name="line.4345"></a>
<span class="sourceLineNo">4346</span>                xi = a[idx1 + 1];<a name="line.4346"></a>
<span class="sourceLineNo">4347</span>                yr = a[idx2];<a name="line.4347"></a>
<span class="sourceLineNo">4348</span>                yi = a[idx2 + 1];<a name="line.4348"></a>
<span class="sourceLineNo">4349</span>                a[idx1] = yr;<a name="line.4349"></a>
<span class="sourceLineNo">4350</span>                a[idx1 + 1] = yi;<a name="line.4350"></a>
<span class="sourceLineNo">4351</span>                a[idx2] = xr;<a name="line.4351"></a>
<span class="sourceLineNo">4352</span>                a[idx2 + 1] = xi;<a name="line.4352"></a>
<span class="sourceLineNo">4353</span>                j1 -= nh - nm;<a name="line.4353"></a>
<span class="sourceLineNo">4354</span>                k1 += 2 * nm - 2;<a name="line.4354"></a>
<span class="sourceLineNo">4355</span>                idx1 = offa + j1;<a name="line.4355"></a>
<span class="sourceLineNo">4356</span>                idx2 = offa + k1;<a name="line.4356"></a>
<span class="sourceLineNo">4357</span>                xr = a[idx1];<a name="line.4357"></a>
<span class="sourceLineNo">4358</span>                xi = a[idx1 + 1];<a name="line.4358"></a>
<span class="sourceLineNo">4359</span>                yr = a[idx2];<a name="line.4359"></a>
<span class="sourceLineNo">4360</span>                yi = a[idx2 + 1];<a name="line.4360"></a>
<span class="sourceLineNo">4361</span>                a[idx1] = yr;<a name="line.4361"></a>
<span class="sourceLineNo">4362</span>                a[idx1 + 1] = yi;<a name="line.4362"></a>
<span class="sourceLineNo">4363</span>                a[idx2] = xr;<a name="line.4363"></a>
<span class="sourceLineNo">4364</span>                a[idx2 + 1] = xi;<a name="line.4364"></a>
<span class="sourceLineNo">4365</span>            }<a name="line.4365"></a>
<span class="sourceLineNo">4366</span>        } else {<a name="line.4366"></a>
<span class="sourceLineNo">4367</span>            for (int k = 0; k &lt; m; k++) {<a name="line.4367"></a>
<span class="sourceLineNo">4368</span>                idx0 = 4 * k;<a name="line.4368"></a>
<span class="sourceLineNo">4369</span>                for (int j = 0; j &lt; k; j++) {<a name="line.4369"></a>
<span class="sourceLineNo">4370</span>                    j1 = 4 * j + ip[m + k];<a name="line.4370"></a>
<span class="sourceLineNo">4371</span>                    k1 = idx0 + ip[m + j];<a name="line.4371"></a>
<span class="sourceLineNo">4372</span>                    idx1 = offa + j1;<a name="line.4372"></a>
<span class="sourceLineNo">4373</span>                    idx2 = offa + k1;<a name="line.4373"></a>
<span class="sourceLineNo">4374</span>                    xr = a[idx1];<a name="line.4374"></a>
<span class="sourceLineNo">4375</span>                    xi = a[idx1 + 1];<a name="line.4375"></a>
<span class="sourceLineNo">4376</span>                    yr = a[idx2];<a name="line.4376"></a>
<span class="sourceLineNo">4377</span>                    yi = a[idx2 + 1];<a name="line.4377"></a>
<span class="sourceLineNo">4378</span>                    a[idx1] = yr;<a name="line.4378"></a>
<span class="sourceLineNo">4379</span>                    a[idx1 + 1] = yi;<a name="line.4379"></a>
<span class="sourceLineNo">4380</span>                    a[idx2] = xr;<a name="line.4380"></a>
<span class="sourceLineNo">4381</span>                    a[idx2 + 1] = xi;<a name="line.4381"></a>
<span class="sourceLineNo">4382</span>                    j1 += nm;<a name="line.4382"></a>
<span class="sourceLineNo">4383</span>                    k1 += nm;<a name="line.4383"></a>
<span class="sourceLineNo">4384</span>                    idx1 = offa + j1;<a name="line.4384"></a>
<span class="sourceLineNo">4385</span>                    idx2 = offa + k1;<a name="line.4385"></a>
<span class="sourceLineNo">4386</span>                    xr = a[idx1];<a name="line.4386"></a>
<span class="sourceLineNo">4387</span>                    xi = a[idx1 + 1];<a name="line.4387"></a>
<span class="sourceLineNo">4388</span>                    yr = a[idx2];<a name="line.4388"></a>
<span class="sourceLineNo">4389</span>                    yi = a[idx2 + 1];<a name="line.4389"></a>
<span class="sourceLineNo">4390</span>                    a[idx1] = yr;<a name="line.4390"></a>
<span class="sourceLineNo">4391</span>                    a[idx1 + 1] = yi;<a name="line.4391"></a>
<span class="sourceLineNo">4392</span>                    a[idx2] = xr;<a name="line.4392"></a>
<span class="sourceLineNo">4393</span>                    a[idx2 + 1] = xi;<a name="line.4393"></a>
<span class="sourceLineNo">4394</span>                    j1 += nh;<a name="line.4394"></a>
<span class="sourceLineNo">4395</span>                    k1 += 2;<a name="line.4395"></a>
<span class="sourceLineNo">4396</span>                    idx1 = offa + j1;<a name="line.4396"></a>
<span class="sourceLineNo">4397</span>                    idx2 = offa + k1;<a name="line.4397"></a>
<span class="sourceLineNo">4398</span>                    xr = a[idx1];<a name="line.4398"></a>
<span class="sourceLineNo">4399</span>                    xi = a[idx1 + 1];<a name="line.4399"></a>
<span class="sourceLineNo">4400</span>                    yr = a[idx2];<a name="line.4400"></a>
<span class="sourceLineNo">4401</span>                    yi = a[idx2 + 1];<a name="line.4401"></a>
<span class="sourceLineNo">4402</span>                    a[idx1] = yr;<a name="line.4402"></a>
<span class="sourceLineNo">4403</span>                    a[idx1 + 1] = yi;<a name="line.4403"></a>
<span class="sourceLineNo">4404</span>                    a[idx2] = xr;<a name="line.4404"></a>
<span class="sourceLineNo">4405</span>                    a[idx2 + 1] = xi;<a name="line.4405"></a>
<span class="sourceLineNo">4406</span>                    j1 -= nm;<a name="line.4406"></a>
<span class="sourceLineNo">4407</span>                    k1 -= nm;<a name="line.4407"></a>
<span class="sourceLineNo">4408</span>                    idx1 = offa + j1;<a name="line.4408"></a>
<span class="sourceLineNo">4409</span>                    idx2 = offa + k1;<a name="line.4409"></a>
<span class="sourceLineNo">4410</span>                    xr = a[idx1];<a name="line.4410"></a>
<span class="sourceLineNo">4411</span>                    xi = a[idx1 + 1];<a name="line.4411"></a>
<span class="sourceLineNo">4412</span>                    yr = a[idx2];<a name="line.4412"></a>
<span class="sourceLineNo">4413</span>                    yi = a[idx2 + 1];<a name="line.4413"></a>
<span class="sourceLineNo">4414</span>                    a[idx1] = yr;<a name="line.4414"></a>
<span class="sourceLineNo">4415</span>                    a[idx1 + 1] = yi;<a name="line.4415"></a>
<span class="sourceLineNo">4416</span>                    a[idx2] = xr;<a name="line.4416"></a>
<span class="sourceLineNo">4417</span>                    a[idx2 + 1] = xi;<a name="line.4417"></a>
<span class="sourceLineNo">4418</span>                    j1 += 2;<a name="line.4418"></a>
<span class="sourceLineNo">4419</span>                    k1 += nh;<a name="line.4419"></a>
<span class="sourceLineNo">4420</span>                    idx1 = offa + j1;<a name="line.4420"></a>
<span class="sourceLineNo">4421</span>                    idx2 = offa + k1;<a name="line.4421"></a>
<span class="sourceLineNo">4422</span>                    xr = a[idx1];<a name="line.4422"></a>
<span class="sourceLineNo">4423</span>                    xi = a[idx1 + 1];<a name="line.4423"></a>
<span class="sourceLineNo">4424</span>                    yr = a[idx2];<a name="line.4424"></a>
<span class="sourceLineNo">4425</span>                    yi = a[idx2 + 1];<a name="line.4425"></a>
<span class="sourceLineNo">4426</span>                    a[idx1] = yr;<a name="line.4426"></a>
<span class="sourceLineNo">4427</span>                    a[idx1 + 1] = yi;<a name="line.4427"></a>
<span class="sourceLineNo">4428</span>                    a[idx2] = xr;<a name="line.4428"></a>
<span class="sourceLineNo">4429</span>                    a[idx2 + 1] = xi;<a name="line.4429"></a>
<span class="sourceLineNo">4430</span>                    j1 += nm;<a name="line.4430"></a>
<span class="sourceLineNo">4431</span>                    k1 += nm;<a name="line.4431"></a>
<span class="sourceLineNo">4432</span>                    idx1 = offa + j1;<a name="line.4432"></a>
<span class="sourceLineNo">4433</span>                    idx2 = offa + k1;<a name="line.4433"></a>
<span class="sourceLineNo">4434</span>                    xr = a[idx1];<a name="line.4434"></a>
<span class="sourceLineNo">4435</span>                    xi = a[idx1 + 1];<a name="line.4435"></a>
<span class="sourceLineNo">4436</span>                    yr = a[idx2];<a name="line.4436"></a>
<span class="sourceLineNo">4437</span>                    yi = a[idx2 + 1];<a name="line.4437"></a>
<span class="sourceLineNo">4438</span>                    a[idx1] = yr;<a name="line.4438"></a>
<span class="sourceLineNo">4439</span>                    a[idx1 + 1] = yi;<a name="line.4439"></a>
<span class="sourceLineNo">4440</span>                    a[idx2] = xr;<a name="line.4440"></a>
<span class="sourceLineNo">4441</span>                    a[idx2 + 1] = xi;<a name="line.4441"></a>
<span class="sourceLineNo">4442</span>                    j1 -= nh;<a name="line.4442"></a>
<span class="sourceLineNo">4443</span>                    k1 -= 2;<a name="line.4443"></a>
<span class="sourceLineNo">4444</span>                    idx1 = offa + j1;<a name="line.4444"></a>
<span class="sourceLineNo">4445</span>                    idx2 = offa + k1;<a name="line.4445"></a>
<span class="sourceLineNo">4446</span>                    xr = a[idx1];<a name="line.4446"></a>
<span class="sourceLineNo">4447</span>                    xi = a[idx1 + 1];<a name="line.4447"></a>
<span class="sourceLineNo">4448</span>                    yr = a[idx2];<a name="line.4448"></a>
<span class="sourceLineNo">4449</span>                    yi = a[idx2 + 1];<a name="line.4449"></a>
<span class="sourceLineNo">4450</span>                    a[idx1] = yr;<a name="line.4450"></a>
<span class="sourceLineNo">4451</span>                    a[idx1 + 1] = yi;<a name="line.4451"></a>
<span class="sourceLineNo">4452</span>                    a[idx2] = xr;<a name="line.4452"></a>
<span class="sourceLineNo">4453</span>                    a[idx2 + 1] = xi;<a name="line.4453"></a>
<span class="sourceLineNo">4454</span>                    j1 -= nm;<a name="line.4454"></a>
<span class="sourceLineNo">4455</span>                    k1 -= nm;<a name="line.4455"></a>
<span class="sourceLineNo">4456</span>                    idx1 = offa + j1;<a name="line.4456"></a>
<span class="sourceLineNo">4457</span>                    idx2 = offa + k1;<a name="line.4457"></a>
<span class="sourceLineNo">4458</span>                    xr = a[idx1];<a name="line.4458"></a>
<span class="sourceLineNo">4459</span>                    xi = a[idx1 + 1];<a name="line.4459"></a>
<span class="sourceLineNo">4460</span>                    yr = a[idx2];<a name="line.4460"></a>
<span class="sourceLineNo">4461</span>                    yi = a[idx2 + 1];<a name="line.4461"></a>
<span class="sourceLineNo">4462</span>                    a[idx1] = yr;<a name="line.4462"></a>
<span class="sourceLineNo">4463</span>                    a[idx1 + 1] = yi;<a name="line.4463"></a>
<span class="sourceLineNo">4464</span>                    a[idx2] = xr;<a name="line.4464"></a>
<span class="sourceLineNo">4465</span>                    a[idx2 + 1] = xi;<a name="line.4465"></a>
<span class="sourceLineNo">4466</span>                }<a name="line.4466"></a>
<span class="sourceLineNo">4467</span>                k1 = idx0 + ip[m + k];<a name="line.4467"></a>
<span class="sourceLineNo">4468</span>                j1 = k1 + 2;<a name="line.4468"></a>
<span class="sourceLineNo">4469</span>                k1 += nh;<a name="line.4469"></a>
<span class="sourceLineNo">4470</span>                idx1 = offa + j1;<a name="line.4470"></a>
<span class="sourceLineNo">4471</span>                idx2 = offa + k1;<a name="line.4471"></a>
<span class="sourceLineNo">4472</span>                xr = a[idx1];<a name="line.4472"></a>
<span class="sourceLineNo">4473</span>                xi = a[idx1 + 1];<a name="line.4473"></a>
<span class="sourceLineNo">4474</span>                yr = a[idx2];<a name="line.4474"></a>
<span class="sourceLineNo">4475</span>                yi = a[idx2 + 1];<a name="line.4475"></a>
<span class="sourceLineNo">4476</span>                a[idx1] = yr;<a name="line.4476"></a>
<span class="sourceLineNo">4477</span>                a[idx1 + 1] = yi;<a name="line.4477"></a>
<span class="sourceLineNo">4478</span>                a[idx2] = xr;<a name="line.4478"></a>
<span class="sourceLineNo">4479</span>                a[idx2 + 1] = xi;<a name="line.4479"></a>
<span class="sourceLineNo">4480</span>                j1 += nm;<a name="line.4480"></a>
<span class="sourceLineNo">4481</span>                k1 += nm;<a name="line.4481"></a>
<span class="sourceLineNo">4482</span>                idx1 = offa + j1;<a name="line.4482"></a>
<span class="sourceLineNo">4483</span>                idx2 = offa + k1;<a name="line.4483"></a>
<span class="sourceLineNo">4484</span>                xr = a[idx1];<a name="line.4484"></a>
<span class="sourceLineNo">4485</span>                xi = a[idx1 + 1];<a name="line.4485"></a>
<span class="sourceLineNo">4486</span>                yr = a[idx2];<a name="line.4486"></a>
<span class="sourceLineNo">4487</span>                yi = a[idx2 + 1];<a name="line.4487"></a>
<span class="sourceLineNo">4488</span>                a[idx1] = yr;<a name="line.4488"></a>
<span class="sourceLineNo">4489</span>                a[idx1 + 1] = yi;<a name="line.4489"></a>
<span class="sourceLineNo">4490</span>                a[idx2] = xr;<a name="line.4490"></a>
<span class="sourceLineNo">4491</span>                a[idx2 + 1] = xi;<a name="line.4491"></a>
<span class="sourceLineNo">4492</span>            }<a name="line.4492"></a>
<span class="sourceLineNo">4493</span>        }<a name="line.4493"></a>
<span class="sourceLineNo">4494</span>    }<a name="line.4494"></a>
<span class="sourceLineNo">4495</span><a name="line.4495"></a>
<span class="sourceLineNo">4496</span>    private void bitrv2conj(int n, int[] ip, float[] a, int offa) {<a name="line.4496"></a>
<span class="sourceLineNo">4497</span>        int j1, k1, l, m, nh, nm;<a name="line.4497"></a>
<span class="sourceLineNo">4498</span>        float xr, xi, yr, yi;<a name="line.4498"></a>
<span class="sourceLineNo">4499</span>        int idx0, idx1, idx2;<a name="line.4499"></a>
<span class="sourceLineNo">4500</span><a name="line.4500"></a>
<span class="sourceLineNo">4501</span>        m = 1;<a name="line.4501"></a>
<span class="sourceLineNo">4502</span>        for (l = n &gt;&gt; 2; l &gt; 8; l &gt;&gt;= 2) {<a name="line.4502"></a>
<span class="sourceLineNo">4503</span>            m &lt;&lt;= 1;<a name="line.4503"></a>
<span class="sourceLineNo">4504</span>        }<a name="line.4504"></a>
<span class="sourceLineNo">4505</span>        nh = n &gt;&gt; 1;<a name="line.4505"></a>
<span class="sourceLineNo">4506</span>        nm = 4 * m;<a name="line.4506"></a>
<span class="sourceLineNo">4507</span>        if (l == 8) {<a name="line.4507"></a>
<span class="sourceLineNo">4508</span>            for (int k = 0; k &lt; m; k++) {<a name="line.4508"></a>
<span class="sourceLineNo">4509</span>                idx0 = 4 * k;<a name="line.4509"></a>
<span class="sourceLineNo">4510</span>                for (int j = 0; j &lt; k; j++) {<a name="line.4510"></a>
<span class="sourceLineNo">4511</span>                    j1 = 4 * j + 2 * ip[m + k];<a name="line.4511"></a>
<span class="sourceLineNo">4512</span>                    k1 = idx0 + 2 * ip[m + j];<a name="line.4512"></a>
<span class="sourceLineNo">4513</span>                    idx1 = offa + j1;<a name="line.4513"></a>
<span class="sourceLineNo">4514</span>                    idx2 = offa + k1;<a name="line.4514"></a>
<span class="sourceLineNo">4515</span>                    xr = a[idx1];<a name="line.4515"></a>
<span class="sourceLineNo">4516</span>                    xi = -a[idx1 + 1];<a name="line.4516"></a>
<span class="sourceLineNo">4517</span>                    yr = a[idx2];<a name="line.4517"></a>
<span class="sourceLineNo">4518</span>                    yi = -a[idx2 + 1];<a name="line.4518"></a>
<span class="sourceLineNo">4519</span>                    a[idx1] = yr;<a name="line.4519"></a>
<span class="sourceLineNo">4520</span>                    a[idx1 + 1] = yi;<a name="line.4520"></a>
<span class="sourceLineNo">4521</span>                    a[idx2] = xr;<a name="line.4521"></a>
<span class="sourceLineNo">4522</span>                    a[idx2 + 1] = xi;<a name="line.4522"></a>
<span class="sourceLineNo">4523</span>                    j1 += nm;<a name="line.4523"></a>
<span class="sourceLineNo">4524</span>                    k1 += 2 * nm;<a name="line.4524"></a>
<span class="sourceLineNo">4525</span>                    idx1 = offa + j1;<a name="line.4525"></a>
<span class="sourceLineNo">4526</span>                    idx2 = offa + k1;<a name="line.4526"></a>
<span class="sourceLineNo">4527</span>                    xr = a[idx1];<a name="line.4527"></a>
<span class="sourceLineNo">4528</span>                    xi = -a[idx1 + 1];<a name="line.4528"></a>
<span class="sourceLineNo">4529</span>                    yr = a[idx2];<a name="line.4529"></a>
<span class="sourceLineNo">4530</span>                    yi = -a[idx2 + 1];<a name="line.4530"></a>
<span class="sourceLineNo">4531</span>                    a[idx1] = yr;<a name="line.4531"></a>
<span class="sourceLineNo">4532</span>                    a[idx1 + 1] = yi;<a name="line.4532"></a>
<span class="sourceLineNo">4533</span>                    a[idx2] = xr;<a name="line.4533"></a>
<span class="sourceLineNo">4534</span>                    a[idx2 + 1] = xi;<a name="line.4534"></a>
<span class="sourceLineNo">4535</span>                    j1 += nm;<a name="line.4535"></a>
<span class="sourceLineNo">4536</span>                    k1 -= nm;<a name="line.4536"></a>
<span class="sourceLineNo">4537</span>                    idx1 = offa + j1;<a name="line.4537"></a>
<span class="sourceLineNo">4538</span>                    idx2 = offa + k1;<a name="line.4538"></a>
<span class="sourceLineNo">4539</span>                    xr = a[idx1];<a name="line.4539"></a>
<span class="sourceLineNo">4540</span>                    xi = -a[idx1 + 1];<a name="line.4540"></a>
<span class="sourceLineNo">4541</span>                    yr = a[idx2];<a name="line.4541"></a>
<span class="sourceLineNo">4542</span>                    yi = -a[idx2 + 1];<a name="line.4542"></a>
<span class="sourceLineNo">4543</span>                    a[idx1] = yr;<a name="line.4543"></a>
<span class="sourceLineNo">4544</span>                    a[idx1 + 1] = yi;<a name="line.4544"></a>
<span class="sourceLineNo">4545</span>                    a[idx2] = xr;<a name="line.4545"></a>
<span class="sourceLineNo">4546</span>                    a[idx2 + 1] = xi;<a name="line.4546"></a>
<span class="sourceLineNo">4547</span>                    j1 += nm;<a name="line.4547"></a>
<span class="sourceLineNo">4548</span>                    k1 += 2 * nm;<a name="line.4548"></a>
<span class="sourceLineNo">4549</span>                    idx1 = offa + j1;<a name="line.4549"></a>
<span class="sourceLineNo">4550</span>                    idx2 = offa + k1;<a name="line.4550"></a>
<span class="sourceLineNo">4551</span>                    xr = a[idx1];<a name="line.4551"></a>
<span class="sourceLineNo">4552</span>                    xi = -a[idx1 + 1];<a name="line.4552"></a>
<span class="sourceLineNo">4553</span>                    yr = a[idx2];<a name="line.4553"></a>
<span class="sourceLineNo">4554</span>                    yi = -a[idx2 + 1];<a name="line.4554"></a>
<span class="sourceLineNo">4555</span>                    a[idx1] = yr;<a name="line.4555"></a>
<span class="sourceLineNo">4556</span>                    a[idx1 + 1] = yi;<a name="line.4556"></a>
<span class="sourceLineNo">4557</span>                    a[idx2] = xr;<a name="line.4557"></a>
<span class="sourceLineNo">4558</span>                    a[idx2 + 1] = xi;<a name="line.4558"></a>
<span class="sourceLineNo">4559</span>                    j1 += nh;<a name="line.4559"></a>
<span class="sourceLineNo">4560</span>                    k1 += 2;<a name="line.4560"></a>
<span class="sourceLineNo">4561</span>                    idx1 = offa + j1;<a name="line.4561"></a>
<span class="sourceLineNo">4562</span>                    idx2 = offa + k1;<a name="line.4562"></a>
<span class="sourceLineNo">4563</span>                    xr = a[idx1];<a name="line.4563"></a>
<span class="sourceLineNo">4564</span>                    xi = -a[idx1 + 1];<a name="line.4564"></a>
<span class="sourceLineNo">4565</span>                    yr = a[idx2];<a name="line.4565"></a>
<span class="sourceLineNo">4566</span>                    yi = -a[idx2 + 1];<a name="line.4566"></a>
<span class="sourceLineNo">4567</span>                    a[idx1] = yr;<a name="line.4567"></a>
<span class="sourceLineNo">4568</span>                    a[idx1 + 1] = yi;<a name="line.4568"></a>
<span class="sourceLineNo">4569</span>                    a[idx2] = xr;<a name="line.4569"></a>
<span class="sourceLineNo">4570</span>                    a[idx2 + 1] = xi;<a name="line.4570"></a>
<span class="sourceLineNo">4571</span>                    j1 -= nm;<a name="line.4571"></a>
<span class="sourceLineNo">4572</span>                    k1 -= 2 * nm;<a name="line.4572"></a>
<span class="sourceLineNo">4573</span>                    idx1 = offa + j1;<a name="line.4573"></a>
<span class="sourceLineNo">4574</span>                    idx2 = offa + k1;<a name="line.4574"></a>
<span class="sourceLineNo">4575</span>                    xr = a[idx1];<a name="line.4575"></a>
<span class="sourceLineNo">4576</span>                    xi = -a[idx1 + 1];<a name="line.4576"></a>
<span class="sourceLineNo">4577</span>                    yr = a[idx2];<a name="line.4577"></a>
<span class="sourceLineNo">4578</span>                    yi = -a[idx2 + 1];<a name="line.4578"></a>
<span class="sourceLineNo">4579</span>                    a[idx1] = yr;<a name="line.4579"></a>
<span class="sourceLineNo">4580</span>                    a[idx1 + 1] = yi;<a name="line.4580"></a>
<span class="sourceLineNo">4581</span>                    a[idx2] = xr;<a name="line.4581"></a>
<span class="sourceLineNo">4582</span>                    a[idx2 + 1] = xi;<a name="line.4582"></a>
<span class="sourceLineNo">4583</span>                    j1 -= nm;<a name="line.4583"></a>
<span class="sourceLineNo">4584</span>                    k1 += nm;<a name="line.4584"></a>
<span class="sourceLineNo">4585</span>                    idx1 = offa + j1;<a name="line.4585"></a>
<span class="sourceLineNo">4586</span>                    idx2 = offa + k1;<a name="line.4586"></a>
<span class="sourceLineNo">4587</span>                    xr = a[idx1];<a name="line.4587"></a>
<span class="sourceLineNo">4588</span>                    xi = -a[idx1 + 1];<a name="line.4588"></a>
<span class="sourceLineNo">4589</span>                    yr = a[idx2];<a name="line.4589"></a>
<span class="sourceLineNo">4590</span>                    yi = -a[idx2 + 1];<a name="line.4590"></a>
<span class="sourceLineNo">4591</span>                    a[idx1] = yr;<a name="line.4591"></a>
<span class="sourceLineNo">4592</span>                    a[idx1 + 1] = yi;<a name="line.4592"></a>
<span class="sourceLineNo">4593</span>                    a[idx2] = xr;<a name="line.4593"></a>
<span class="sourceLineNo">4594</span>                    a[idx2 + 1] = xi;<a name="line.4594"></a>
<span class="sourceLineNo">4595</span>                    j1 -= nm;<a name="line.4595"></a>
<span class="sourceLineNo">4596</span>                    k1 -= 2 * nm;<a name="line.4596"></a>
<span class="sourceLineNo">4597</span>                    idx1 = offa + j1;<a name="line.4597"></a>
<span class="sourceLineNo">4598</span>                    idx2 = offa + k1;<a name="line.4598"></a>
<span class="sourceLineNo">4599</span>                    xr = a[idx1];<a name="line.4599"></a>
<span class="sourceLineNo">4600</span>                    xi = -a[idx1 + 1];<a name="line.4600"></a>
<span class="sourceLineNo">4601</span>                    yr = a[idx2];<a name="line.4601"></a>
<span class="sourceLineNo">4602</span>                    yi = -a[idx2 + 1];<a name="line.4602"></a>
<span class="sourceLineNo">4603</span>                    a[idx1] = yr;<a name="line.4603"></a>
<span class="sourceLineNo">4604</span>                    a[idx1 + 1] = yi;<a name="line.4604"></a>
<span class="sourceLineNo">4605</span>                    a[idx2] = xr;<a name="line.4605"></a>
<span class="sourceLineNo">4606</span>                    a[idx2 + 1] = xi;<a name="line.4606"></a>
<span class="sourceLineNo">4607</span>                    j1 += 2;<a name="line.4607"></a>
<span class="sourceLineNo">4608</span>                    k1 += nh;<a name="line.4608"></a>
<span class="sourceLineNo">4609</span>                    idx1 = offa + j1;<a name="line.4609"></a>
<span class="sourceLineNo">4610</span>                    idx2 = offa + k1;<a name="line.4610"></a>
<span class="sourceLineNo">4611</span>                    xr = a[idx1];<a name="line.4611"></a>
<span class="sourceLineNo">4612</span>                    xi = -a[idx1 + 1];<a name="line.4612"></a>
<span class="sourceLineNo">4613</span>                    yr = a[idx2];<a name="line.4613"></a>
<span class="sourceLineNo">4614</span>                    yi = -a[idx2 + 1];<a name="line.4614"></a>
<span class="sourceLineNo">4615</span>                    a[idx1] = yr;<a name="line.4615"></a>
<span class="sourceLineNo">4616</span>                    a[idx1 + 1] = yi;<a name="line.4616"></a>
<span class="sourceLineNo">4617</span>                    a[idx2] = xr;<a name="line.4617"></a>
<span class="sourceLineNo">4618</span>                    a[idx2 + 1] = xi;<a name="line.4618"></a>
<span class="sourceLineNo">4619</span>                    j1 += nm;<a name="line.4619"></a>
<span class="sourceLineNo">4620</span>                    k1 += 2 * nm;<a name="line.4620"></a>
<span class="sourceLineNo">4621</span>                    idx1 = offa + j1;<a name="line.4621"></a>
<span class="sourceLineNo">4622</span>                    idx2 = offa + k1;<a name="line.4622"></a>
<span class="sourceLineNo">4623</span>                    xr = a[idx1];<a name="line.4623"></a>
<span class="sourceLineNo">4624</span>                    xi = -a[idx1 + 1];<a name="line.4624"></a>
<span class="sourceLineNo">4625</span>                    yr = a[idx2];<a name="line.4625"></a>
<span class="sourceLineNo">4626</span>                    yi = -a[idx2 + 1];<a name="line.4626"></a>
<span class="sourceLineNo">4627</span>                    a[idx1] = yr;<a name="line.4627"></a>
<span class="sourceLineNo">4628</span>                    a[idx1 + 1] = yi;<a name="line.4628"></a>
<span class="sourceLineNo">4629</span>                    a[idx2] = xr;<a name="line.4629"></a>
<span class="sourceLineNo">4630</span>                    a[idx2 + 1] = xi;<a name="line.4630"></a>
<span class="sourceLineNo">4631</span>                    j1 += nm;<a name="line.4631"></a>
<span class="sourceLineNo">4632</span>                    k1 -= nm;<a name="line.4632"></a>
<span class="sourceLineNo">4633</span>                    idx1 = offa + j1;<a name="line.4633"></a>
<span class="sourceLineNo">4634</span>                    idx2 = offa + k1;<a name="line.4634"></a>
<span class="sourceLineNo">4635</span>                    xr = a[idx1];<a name="line.4635"></a>
<span class="sourceLineNo">4636</span>                    xi = -a[idx1 + 1];<a name="line.4636"></a>
<span class="sourceLineNo">4637</span>                    yr = a[idx2];<a name="line.4637"></a>
<span class="sourceLineNo">4638</span>                    yi = -a[idx2 + 1];<a name="line.4638"></a>
<span class="sourceLineNo">4639</span>                    a[idx1] = yr;<a name="line.4639"></a>
<span class="sourceLineNo">4640</span>                    a[idx1 + 1] = yi;<a name="line.4640"></a>
<span class="sourceLineNo">4641</span>                    a[idx2] = xr;<a name="line.4641"></a>
<span class="sourceLineNo">4642</span>                    a[idx2 + 1] = xi;<a name="line.4642"></a>
<span class="sourceLineNo">4643</span>                    j1 += nm;<a name="line.4643"></a>
<span class="sourceLineNo">4644</span>                    k1 += 2 * nm;<a name="line.4644"></a>
<span class="sourceLineNo">4645</span>                    idx1 = offa + j1;<a name="line.4645"></a>
<span class="sourceLineNo">4646</span>                    idx2 = offa + k1;<a name="line.4646"></a>
<span class="sourceLineNo">4647</span>                    xr = a[idx1];<a name="line.4647"></a>
<span class="sourceLineNo">4648</span>                    xi = -a[idx1 + 1];<a name="line.4648"></a>
<span class="sourceLineNo">4649</span>                    yr = a[idx2];<a name="line.4649"></a>
<span class="sourceLineNo">4650</span>                    yi = -a[idx2 + 1];<a name="line.4650"></a>
<span class="sourceLineNo">4651</span>                    a[idx1] = yr;<a name="line.4651"></a>
<span class="sourceLineNo">4652</span>                    a[idx1 + 1] = yi;<a name="line.4652"></a>
<span class="sourceLineNo">4653</span>                    a[idx2] = xr;<a name="line.4653"></a>
<span class="sourceLineNo">4654</span>                    a[idx2 + 1] = xi;<a name="line.4654"></a>
<span class="sourceLineNo">4655</span>                    j1 -= nh;<a name="line.4655"></a>
<span class="sourceLineNo">4656</span>                    k1 -= 2;<a name="line.4656"></a>
<span class="sourceLineNo">4657</span>                    idx1 = offa + j1;<a name="line.4657"></a>
<span class="sourceLineNo">4658</span>                    idx2 = offa + k1;<a name="line.4658"></a>
<span class="sourceLineNo">4659</span>                    xr = a[idx1];<a name="line.4659"></a>
<span class="sourceLineNo">4660</span>                    xi = -a[idx1 + 1];<a name="line.4660"></a>
<span class="sourceLineNo">4661</span>                    yr = a[idx2];<a name="line.4661"></a>
<span class="sourceLineNo">4662</span>                    yi = -a[idx2 + 1];<a name="line.4662"></a>
<span class="sourceLineNo">4663</span>                    a[idx1] = yr;<a name="line.4663"></a>
<span class="sourceLineNo">4664</span>                    a[idx1 + 1] = yi;<a name="line.4664"></a>
<span class="sourceLineNo">4665</span>                    a[idx2] = xr;<a name="line.4665"></a>
<span class="sourceLineNo">4666</span>                    a[idx2 + 1] = xi;<a name="line.4666"></a>
<span class="sourceLineNo">4667</span>                    j1 -= nm;<a name="line.4667"></a>
<span class="sourceLineNo">4668</span>                    k1 -= 2 * nm;<a name="line.4668"></a>
<span class="sourceLineNo">4669</span>                    idx1 = offa + j1;<a name="line.4669"></a>
<span class="sourceLineNo">4670</span>                    idx2 = offa + k1;<a name="line.4670"></a>
<span class="sourceLineNo">4671</span>                    xr = a[idx1];<a name="line.4671"></a>
<span class="sourceLineNo">4672</span>                    xi = -a[idx1 + 1];<a name="line.4672"></a>
<span class="sourceLineNo">4673</span>                    yr = a[idx2];<a name="line.4673"></a>
<span class="sourceLineNo">4674</span>                    yi = -a[idx2 + 1];<a name="line.4674"></a>
<span class="sourceLineNo">4675</span>                    a[idx1] = yr;<a name="line.4675"></a>
<span class="sourceLineNo">4676</span>                    a[idx1 + 1] = yi;<a name="line.4676"></a>
<span class="sourceLineNo">4677</span>                    a[idx2] = xr;<a name="line.4677"></a>
<span class="sourceLineNo">4678</span>                    a[idx2 + 1] = xi;<a name="line.4678"></a>
<span class="sourceLineNo">4679</span>                    j1 -= nm;<a name="line.4679"></a>
<span class="sourceLineNo">4680</span>                    k1 += nm;<a name="line.4680"></a>
<span class="sourceLineNo">4681</span>                    idx1 = offa + j1;<a name="line.4681"></a>
<span class="sourceLineNo">4682</span>                    idx2 = offa + k1;<a name="line.4682"></a>
<span class="sourceLineNo">4683</span>                    xr = a[idx1];<a name="line.4683"></a>
<span class="sourceLineNo">4684</span>                    xi = -a[idx1 + 1];<a name="line.4684"></a>
<span class="sourceLineNo">4685</span>                    yr = a[idx2];<a name="line.4685"></a>
<span class="sourceLineNo">4686</span>                    yi = -a[idx2 + 1];<a name="line.4686"></a>
<span class="sourceLineNo">4687</span>                    a[idx1] = yr;<a name="line.4687"></a>
<span class="sourceLineNo">4688</span>                    a[idx1 + 1] = yi;<a name="line.4688"></a>
<span class="sourceLineNo">4689</span>                    a[idx2] = xr;<a name="line.4689"></a>
<span class="sourceLineNo">4690</span>                    a[idx2 + 1] = xi;<a name="line.4690"></a>
<span class="sourceLineNo">4691</span>                    j1 -= nm;<a name="line.4691"></a>
<span class="sourceLineNo">4692</span>                    k1 -= 2 * nm;<a name="line.4692"></a>
<span class="sourceLineNo">4693</span>                    idx1 = offa + j1;<a name="line.4693"></a>
<span class="sourceLineNo">4694</span>                    idx2 = offa + k1;<a name="line.4694"></a>
<span class="sourceLineNo">4695</span>                    xr = a[idx1];<a name="line.4695"></a>
<span class="sourceLineNo">4696</span>                    xi = -a[idx1 + 1];<a name="line.4696"></a>
<span class="sourceLineNo">4697</span>                    yr = a[idx2];<a name="line.4697"></a>
<span class="sourceLineNo">4698</span>                    yi = -a[idx2 + 1];<a name="line.4698"></a>
<span class="sourceLineNo">4699</span>                    a[idx1] = yr;<a name="line.4699"></a>
<span class="sourceLineNo">4700</span>                    a[idx1 + 1] = yi;<a name="line.4700"></a>
<span class="sourceLineNo">4701</span>                    a[idx2] = xr;<a name="line.4701"></a>
<span class="sourceLineNo">4702</span>                    a[idx2 + 1] = xi;<a name="line.4702"></a>
<span class="sourceLineNo">4703</span>                }<a name="line.4703"></a>
<span class="sourceLineNo">4704</span>                k1 = idx0 + 2 * ip[m + k];<a name="line.4704"></a>
<span class="sourceLineNo">4705</span>                j1 = k1 + 2;<a name="line.4705"></a>
<span class="sourceLineNo">4706</span>                k1 += nh;<a name="line.4706"></a>
<span class="sourceLineNo">4707</span>                idx1 = offa + j1;<a name="line.4707"></a>
<span class="sourceLineNo">4708</span>                idx2 = offa + k1;<a name="line.4708"></a>
<span class="sourceLineNo">4709</span>                a[idx1 - 1] = -a[idx1 - 1];<a name="line.4709"></a>
<span class="sourceLineNo">4710</span>                xr = a[idx1];<a name="line.4710"></a>
<span class="sourceLineNo">4711</span>                xi = -a[idx1 + 1];<a name="line.4711"></a>
<span class="sourceLineNo">4712</span>                yr = a[idx2];<a name="line.4712"></a>
<span class="sourceLineNo">4713</span>                yi = -a[idx2 + 1];<a name="line.4713"></a>
<span class="sourceLineNo">4714</span>                a[idx1] = yr;<a name="line.4714"></a>
<span class="sourceLineNo">4715</span>                a[idx1 + 1] = yi;<a name="line.4715"></a>
<span class="sourceLineNo">4716</span>                a[idx2] = xr;<a name="line.4716"></a>
<span class="sourceLineNo">4717</span>                a[idx2 + 1] = xi;<a name="line.4717"></a>
<span class="sourceLineNo">4718</span>                a[idx2 + 3] = -a[idx2 + 3];<a name="line.4718"></a>
<span class="sourceLineNo">4719</span>                j1 += nm;<a name="line.4719"></a>
<span class="sourceLineNo">4720</span>                k1 += 2 * nm;<a name="line.4720"></a>
<span class="sourceLineNo">4721</span>                idx1 = offa + j1;<a name="line.4721"></a>
<span class="sourceLineNo">4722</span>                idx2 = offa + k1;<a name="line.4722"></a>
<span class="sourceLineNo">4723</span>                xr = a[idx1];<a name="line.4723"></a>
<span class="sourceLineNo">4724</span>                xi = -a[idx1 + 1];<a name="line.4724"></a>
<span class="sourceLineNo">4725</span>                yr = a[idx2];<a name="line.4725"></a>
<span class="sourceLineNo">4726</span>                yi = -a[idx2 + 1];<a name="line.4726"></a>
<span class="sourceLineNo">4727</span>                a[idx1] = yr;<a name="line.4727"></a>
<span class="sourceLineNo">4728</span>                a[idx1 + 1] = yi;<a name="line.4728"></a>
<span class="sourceLineNo">4729</span>                a[idx2] = xr;<a name="line.4729"></a>
<span class="sourceLineNo">4730</span>                a[idx2 + 1] = xi;<a name="line.4730"></a>
<span class="sourceLineNo">4731</span>                j1 += nm;<a name="line.4731"></a>
<span class="sourceLineNo">4732</span>                k1 -= nm;<a name="line.4732"></a>
<span class="sourceLineNo">4733</span>                idx1 = offa + j1;<a name="line.4733"></a>
<span class="sourceLineNo">4734</span>                idx2 = offa + k1;<a name="line.4734"></a>
<span class="sourceLineNo">4735</span>                xr = a[idx1];<a name="line.4735"></a>
<span class="sourceLineNo">4736</span>                xi = -a[idx1 + 1];<a name="line.4736"></a>
<span class="sourceLineNo">4737</span>                yr = a[idx2];<a name="line.4737"></a>
<span class="sourceLineNo">4738</span>                yi = -a[idx2 + 1];<a name="line.4738"></a>
<span class="sourceLineNo">4739</span>                a[idx1] = yr;<a name="line.4739"></a>
<span class="sourceLineNo">4740</span>                a[idx1 + 1] = yi;<a name="line.4740"></a>
<span class="sourceLineNo">4741</span>                a[idx2] = xr;<a name="line.4741"></a>
<span class="sourceLineNo">4742</span>                a[idx2 + 1] = xi;<a name="line.4742"></a>
<span class="sourceLineNo">4743</span>                j1 -= 2;<a name="line.4743"></a>
<span class="sourceLineNo">4744</span>                k1 -= nh;<a name="line.4744"></a>
<span class="sourceLineNo">4745</span>                idx1 = offa + j1;<a name="line.4745"></a>
<span class="sourceLineNo">4746</span>                idx2 = offa + k1;<a name="line.4746"></a>
<span class="sourceLineNo">4747</span>                xr = a[idx1];<a name="line.4747"></a>
<span class="sourceLineNo">4748</span>                xi = -a[idx1 + 1];<a name="line.4748"></a>
<span class="sourceLineNo">4749</span>                yr = a[idx2];<a name="line.4749"></a>
<span class="sourceLineNo">4750</span>                yi = -a[idx2 + 1];<a name="line.4750"></a>
<span class="sourceLineNo">4751</span>                a[idx1] = yr;<a name="line.4751"></a>
<span class="sourceLineNo">4752</span>                a[idx1 + 1] = yi;<a name="line.4752"></a>
<span class="sourceLineNo">4753</span>                a[idx2] = xr;<a name="line.4753"></a>
<span class="sourceLineNo">4754</span>                a[idx2 + 1] = xi;<a name="line.4754"></a>
<span class="sourceLineNo">4755</span>                j1 += nh + 2;<a name="line.4755"></a>
<span class="sourceLineNo">4756</span>                k1 += nh + 2;<a name="line.4756"></a>
<span class="sourceLineNo">4757</span>                idx1 = offa + j1;<a name="line.4757"></a>
<span class="sourceLineNo">4758</span>                idx2 = offa + k1;<a name="line.4758"></a>
<span class="sourceLineNo">4759</span>                xr = a[idx1];<a name="line.4759"></a>
<span class="sourceLineNo">4760</span>                xi = -a[idx1 + 1];<a name="line.4760"></a>
<span class="sourceLineNo">4761</span>                yr = a[idx2];<a name="line.4761"></a>
<span class="sourceLineNo">4762</span>                yi = -a[idx2 + 1];<a name="line.4762"></a>
<span class="sourceLineNo">4763</span>                a[idx1] = yr;<a name="line.4763"></a>
<span class="sourceLineNo">4764</span>                a[idx1 + 1] = yi;<a name="line.4764"></a>
<span class="sourceLineNo">4765</span>                a[idx2] = xr;<a name="line.4765"></a>
<span class="sourceLineNo">4766</span>                a[idx2 + 1] = xi;<a name="line.4766"></a>
<span class="sourceLineNo">4767</span>                j1 -= nh - nm;<a name="line.4767"></a>
<span class="sourceLineNo">4768</span>                k1 += 2 * nm - 2;<a name="line.4768"></a>
<span class="sourceLineNo">4769</span>                idx1 = offa + j1;<a name="line.4769"></a>
<span class="sourceLineNo">4770</span>                idx2 = offa + k1;<a name="line.4770"></a>
<span class="sourceLineNo">4771</span>                a[idx1 - 1] = -a[idx1 - 1];<a name="line.4771"></a>
<span class="sourceLineNo">4772</span>                xr = a[idx1];<a name="line.4772"></a>
<span class="sourceLineNo">4773</span>                xi = -a[idx1 + 1];<a name="line.4773"></a>
<span class="sourceLineNo">4774</span>                yr = a[idx2];<a name="line.4774"></a>
<span class="sourceLineNo">4775</span>                yi = -a[idx2 + 1];<a name="line.4775"></a>
<span class="sourceLineNo">4776</span>                a[idx1] = yr;<a name="line.4776"></a>
<span class="sourceLineNo">4777</span>                a[idx1 + 1] = yi;<a name="line.4777"></a>
<span class="sourceLineNo">4778</span>                a[idx2] = xr;<a name="line.4778"></a>
<span class="sourceLineNo">4779</span>                a[idx2 + 1] = xi;<a name="line.4779"></a>
<span class="sourceLineNo">4780</span>                a[idx2 + 3] = -a[idx2 + 3];<a name="line.4780"></a>
<span class="sourceLineNo">4781</span>            }<a name="line.4781"></a>
<span class="sourceLineNo">4782</span>        } else {<a name="line.4782"></a>
<span class="sourceLineNo">4783</span>            for (int k = 0; k &lt; m; k++) {<a name="line.4783"></a>
<span class="sourceLineNo">4784</span>                idx0 = 4 * k;<a name="line.4784"></a>
<span class="sourceLineNo">4785</span>                for (int j = 0; j &lt; k; j++) {<a name="line.4785"></a>
<span class="sourceLineNo">4786</span>                    j1 = 4 * j + ip[m + k];<a name="line.4786"></a>
<span class="sourceLineNo">4787</span>                    k1 = idx0 + ip[m + j];<a name="line.4787"></a>
<span class="sourceLineNo">4788</span>                    idx1 = offa + j1;<a name="line.4788"></a>
<span class="sourceLineNo">4789</span>                    idx2 = offa + k1;<a name="line.4789"></a>
<span class="sourceLineNo">4790</span>                    xr = a[idx1];<a name="line.4790"></a>
<span class="sourceLineNo">4791</span>                    xi = -a[idx1 + 1];<a name="line.4791"></a>
<span class="sourceLineNo">4792</span>                    yr = a[idx2];<a name="line.4792"></a>
<span class="sourceLineNo">4793</span>                    yi = -a[idx2 + 1];<a name="line.4793"></a>
<span class="sourceLineNo">4794</span>                    a[idx1] = yr;<a name="line.4794"></a>
<span class="sourceLineNo">4795</span>                    a[idx1 + 1] = yi;<a name="line.4795"></a>
<span class="sourceLineNo">4796</span>                    a[idx2] = xr;<a name="line.4796"></a>
<span class="sourceLineNo">4797</span>                    a[idx2 + 1] = xi;<a name="line.4797"></a>
<span class="sourceLineNo">4798</span>                    j1 += nm;<a name="line.4798"></a>
<span class="sourceLineNo">4799</span>                    k1 += nm;<a name="line.4799"></a>
<span class="sourceLineNo">4800</span>                    idx1 = offa + j1;<a name="line.4800"></a>
<span class="sourceLineNo">4801</span>                    idx2 = offa + k1;<a name="line.4801"></a>
<span class="sourceLineNo">4802</span>                    xr = a[idx1];<a name="line.4802"></a>
<span class="sourceLineNo">4803</span>                    xi = -a[idx1 + 1];<a name="line.4803"></a>
<span class="sourceLineNo">4804</span>                    yr = a[idx2];<a name="line.4804"></a>
<span class="sourceLineNo">4805</span>                    yi = -a[idx2 + 1];<a name="line.4805"></a>
<span class="sourceLineNo">4806</span>                    a[idx1] = yr;<a name="line.4806"></a>
<span class="sourceLineNo">4807</span>                    a[idx1 + 1] = yi;<a name="line.4807"></a>
<span class="sourceLineNo">4808</span>                    a[idx2] = xr;<a name="line.4808"></a>
<span class="sourceLineNo">4809</span>                    a[idx2 + 1] = xi;<a name="line.4809"></a>
<span class="sourceLineNo">4810</span>                    j1 += nh;<a name="line.4810"></a>
<span class="sourceLineNo">4811</span>                    k1 += 2;<a name="line.4811"></a>
<span class="sourceLineNo">4812</span>                    idx1 = offa + j1;<a name="line.4812"></a>
<span class="sourceLineNo">4813</span>                    idx2 = offa + k1;<a name="line.4813"></a>
<span class="sourceLineNo">4814</span>                    xr = a[idx1];<a name="line.4814"></a>
<span class="sourceLineNo">4815</span>                    xi = -a[idx1 + 1];<a name="line.4815"></a>
<span class="sourceLineNo">4816</span>                    yr = a[idx2];<a name="line.4816"></a>
<span class="sourceLineNo">4817</span>                    yi = -a[idx2 + 1];<a name="line.4817"></a>
<span class="sourceLineNo">4818</span>                    a[idx1] = yr;<a name="line.4818"></a>
<span class="sourceLineNo">4819</span>                    a[idx1 + 1] = yi;<a name="line.4819"></a>
<span class="sourceLineNo">4820</span>                    a[idx2] = xr;<a name="line.4820"></a>
<span class="sourceLineNo">4821</span>                    a[idx2 + 1] = xi;<a name="line.4821"></a>
<span class="sourceLineNo">4822</span>                    j1 -= nm;<a name="line.4822"></a>
<span class="sourceLineNo">4823</span>                    k1 -= nm;<a name="line.4823"></a>
<span class="sourceLineNo">4824</span>                    idx1 = offa + j1;<a name="line.4824"></a>
<span class="sourceLineNo">4825</span>                    idx2 = offa + k1;<a name="line.4825"></a>
<span class="sourceLineNo">4826</span>                    xr = a[idx1];<a name="line.4826"></a>
<span class="sourceLineNo">4827</span>                    xi = -a[idx1 + 1];<a name="line.4827"></a>
<span class="sourceLineNo">4828</span>                    yr = a[idx2];<a name="line.4828"></a>
<span class="sourceLineNo">4829</span>                    yi = -a[idx2 + 1];<a name="line.4829"></a>
<span class="sourceLineNo">4830</span>                    a[idx1] = yr;<a name="line.4830"></a>
<span class="sourceLineNo">4831</span>                    a[idx1 + 1] = yi;<a name="line.4831"></a>
<span class="sourceLineNo">4832</span>                    a[idx2] = xr;<a name="line.4832"></a>
<span class="sourceLineNo">4833</span>                    a[idx2 + 1] = xi;<a name="line.4833"></a>
<span class="sourceLineNo">4834</span>                    j1 += 2;<a name="line.4834"></a>
<span class="sourceLineNo">4835</span>                    k1 += nh;<a name="line.4835"></a>
<span class="sourceLineNo">4836</span>                    idx1 = offa + j1;<a name="line.4836"></a>
<span class="sourceLineNo">4837</span>                    idx2 = offa + k1;<a name="line.4837"></a>
<span class="sourceLineNo">4838</span>                    xr = a[idx1];<a name="line.4838"></a>
<span class="sourceLineNo">4839</span>                    xi = -a[idx1 + 1];<a name="line.4839"></a>
<span class="sourceLineNo">4840</span>                    yr = a[idx2];<a name="line.4840"></a>
<span class="sourceLineNo">4841</span>                    yi = -a[idx2 + 1];<a name="line.4841"></a>
<span class="sourceLineNo">4842</span>                    a[idx1] = yr;<a name="line.4842"></a>
<span class="sourceLineNo">4843</span>                    a[idx1 + 1] = yi;<a name="line.4843"></a>
<span class="sourceLineNo">4844</span>                    a[idx2] = xr;<a name="line.4844"></a>
<span class="sourceLineNo">4845</span>                    a[idx2 + 1] = xi;<a name="line.4845"></a>
<span class="sourceLineNo">4846</span>                    j1 += nm;<a name="line.4846"></a>
<span class="sourceLineNo">4847</span>                    k1 += nm;<a name="line.4847"></a>
<span class="sourceLineNo">4848</span>                    idx1 = offa + j1;<a name="line.4848"></a>
<span class="sourceLineNo">4849</span>                    idx2 = offa + k1;<a name="line.4849"></a>
<span class="sourceLineNo">4850</span>                    xr = a[idx1];<a name="line.4850"></a>
<span class="sourceLineNo">4851</span>                    xi = -a[idx1 + 1];<a name="line.4851"></a>
<span class="sourceLineNo">4852</span>                    yr = a[idx2];<a name="line.4852"></a>
<span class="sourceLineNo">4853</span>                    yi = -a[idx2 + 1];<a name="line.4853"></a>
<span class="sourceLineNo">4854</span>                    a[idx1] = yr;<a name="line.4854"></a>
<span class="sourceLineNo">4855</span>                    a[idx1 + 1] = yi;<a name="line.4855"></a>
<span class="sourceLineNo">4856</span>                    a[idx2] = xr;<a name="line.4856"></a>
<span class="sourceLineNo">4857</span>                    a[idx2 + 1] = xi;<a name="line.4857"></a>
<span class="sourceLineNo">4858</span>                    j1 -= nh;<a name="line.4858"></a>
<span class="sourceLineNo">4859</span>                    k1 -= 2;<a name="line.4859"></a>
<span class="sourceLineNo">4860</span>                    idx1 = offa + j1;<a name="line.4860"></a>
<span class="sourceLineNo">4861</span>                    idx2 = offa + k1;<a name="line.4861"></a>
<span class="sourceLineNo">4862</span>                    xr = a[idx1];<a name="line.4862"></a>
<span class="sourceLineNo">4863</span>                    xi = -a[idx1 + 1];<a name="line.4863"></a>
<span class="sourceLineNo">4864</span>                    yr = a[idx2];<a name="line.4864"></a>
<span class="sourceLineNo">4865</span>                    yi = -a[idx2 + 1];<a name="line.4865"></a>
<span class="sourceLineNo">4866</span>                    a[idx1] = yr;<a name="line.4866"></a>
<span class="sourceLineNo">4867</span>                    a[idx1 + 1] = yi;<a name="line.4867"></a>
<span class="sourceLineNo">4868</span>                    a[idx2] = xr;<a name="line.4868"></a>
<span class="sourceLineNo">4869</span>                    a[idx2 + 1] = xi;<a name="line.4869"></a>
<span class="sourceLineNo">4870</span>                    j1 -= nm;<a name="line.4870"></a>
<span class="sourceLineNo">4871</span>                    k1 -= nm;<a name="line.4871"></a>
<span class="sourceLineNo">4872</span>                    idx1 = offa + j1;<a name="line.4872"></a>
<span class="sourceLineNo">4873</span>                    idx2 = offa + k1;<a name="line.4873"></a>
<span class="sourceLineNo">4874</span>                    xr = a[idx1];<a name="line.4874"></a>
<span class="sourceLineNo">4875</span>                    xi = -a[idx1 + 1];<a name="line.4875"></a>
<span class="sourceLineNo">4876</span>                    yr = a[idx2];<a name="line.4876"></a>
<span class="sourceLineNo">4877</span>                    yi = -a[idx2 + 1];<a name="line.4877"></a>
<span class="sourceLineNo">4878</span>                    a[idx1] = yr;<a name="line.4878"></a>
<span class="sourceLineNo">4879</span>                    a[idx1 + 1] = yi;<a name="line.4879"></a>
<span class="sourceLineNo">4880</span>                    a[idx2] = xr;<a name="line.4880"></a>
<span class="sourceLineNo">4881</span>                    a[idx2 + 1] = xi;<a name="line.4881"></a>
<span class="sourceLineNo">4882</span>                }<a name="line.4882"></a>
<span class="sourceLineNo">4883</span>                k1 = idx0 + ip[m + k];<a name="line.4883"></a>
<span class="sourceLineNo">4884</span>                j1 = k1 + 2;<a name="line.4884"></a>
<span class="sourceLineNo">4885</span>                k1 += nh;<a name="line.4885"></a>
<span class="sourceLineNo">4886</span>                idx1 = offa + j1;<a name="line.4886"></a>
<span class="sourceLineNo">4887</span>                idx2 = offa + k1;<a name="line.4887"></a>
<span class="sourceLineNo">4888</span>                a[idx1 - 1] = -a[idx1 - 1];<a name="line.4888"></a>
<span class="sourceLineNo">4889</span>                xr = a[idx1];<a name="line.4889"></a>
<span class="sourceLineNo">4890</span>                xi = -a[idx1 + 1];<a name="line.4890"></a>
<span class="sourceLineNo">4891</span>                yr = a[idx2];<a name="line.4891"></a>
<span class="sourceLineNo">4892</span>                yi = -a[idx2 + 1];<a name="line.4892"></a>
<span class="sourceLineNo">4893</span>                a[idx1] = yr;<a name="line.4893"></a>
<span class="sourceLineNo">4894</span>                a[idx1 + 1] = yi;<a name="line.4894"></a>
<span class="sourceLineNo">4895</span>                a[idx2] = xr;<a name="line.4895"></a>
<span class="sourceLineNo">4896</span>                a[idx2 + 1] = xi;<a name="line.4896"></a>
<span class="sourceLineNo">4897</span>                a[idx2 + 3] = -a[idx2 + 3];<a name="line.4897"></a>
<span class="sourceLineNo">4898</span>                j1 += nm;<a name="line.4898"></a>
<span class="sourceLineNo">4899</span>                k1 += nm;<a name="line.4899"></a>
<span class="sourceLineNo">4900</span>                idx1 = offa + j1;<a name="line.4900"></a>
<span class="sourceLineNo">4901</span>                idx2 = offa + k1;<a name="line.4901"></a>
<span class="sourceLineNo">4902</span>                a[idx1 - 1] = -a[idx1 - 1];<a name="line.4902"></a>
<span class="sourceLineNo">4903</span>                xr = a[idx1];<a name="line.4903"></a>
<span class="sourceLineNo">4904</span>                xi = -a[idx1 + 1];<a name="line.4904"></a>
<span class="sourceLineNo">4905</span>                yr = a[idx2];<a name="line.4905"></a>
<span class="sourceLineNo">4906</span>                yi = -a[idx2 + 1];<a name="line.4906"></a>
<span class="sourceLineNo">4907</span>                a[idx1] = yr;<a name="line.4907"></a>
<span class="sourceLineNo">4908</span>                a[idx1 + 1] = yi;<a name="line.4908"></a>
<span class="sourceLineNo">4909</span>                a[idx2] = xr;<a name="line.4909"></a>
<span class="sourceLineNo">4910</span>                a[idx2 + 1] = xi;<a name="line.4910"></a>
<span class="sourceLineNo">4911</span>                a[idx2 + 3] = -a[idx2 + 3];<a name="line.4911"></a>
<span class="sourceLineNo">4912</span>            }<a name="line.4912"></a>
<span class="sourceLineNo">4913</span>        }<a name="line.4913"></a>
<span class="sourceLineNo">4914</span>    }<a name="line.4914"></a>
<span class="sourceLineNo">4915</span><a name="line.4915"></a>
<span class="sourceLineNo">4916</span>    private void bitrv216(float[] a, int offa) {<a name="line.4916"></a>
<span class="sourceLineNo">4917</span>        float x1r, x1i, x2r, x2i, x3r, x3i, x4r, x4i, x5r, x5i, x7r, x7i, x8r, x8i, x10r, x10i, x11r, x11i, x12r, x12i, x13r, x13i, x14r, x14i;<a name="line.4917"></a>
<span class="sourceLineNo">4918</span><a name="line.4918"></a>
<span class="sourceLineNo">4919</span>        x1r = a[offa + 2];<a name="line.4919"></a>
<span class="sourceLineNo">4920</span>        x1i = a[offa + 3];<a name="line.4920"></a>
<span class="sourceLineNo">4921</span>        x2r = a[offa + 4];<a name="line.4921"></a>
<span class="sourceLineNo">4922</span>        x2i = a[offa + 5];<a name="line.4922"></a>
<span class="sourceLineNo">4923</span>        x3r = a[offa + 6];<a name="line.4923"></a>
<span class="sourceLineNo">4924</span>        x3i = a[offa + 7];<a name="line.4924"></a>
<span class="sourceLineNo">4925</span>        x4r = a[offa + 8];<a name="line.4925"></a>
<span class="sourceLineNo">4926</span>        x4i = a[offa + 9];<a name="line.4926"></a>
<span class="sourceLineNo">4927</span>        x5r = a[offa + 10];<a name="line.4927"></a>
<span class="sourceLineNo">4928</span>        x5i = a[offa + 11];<a name="line.4928"></a>
<span class="sourceLineNo">4929</span>        x7r = a[offa + 14];<a name="line.4929"></a>
<span class="sourceLineNo">4930</span>        x7i = a[offa + 15];<a name="line.4930"></a>
<span class="sourceLineNo">4931</span>        x8r = a[offa + 16];<a name="line.4931"></a>
<span class="sourceLineNo">4932</span>        x8i = a[offa + 17];<a name="line.4932"></a>
<span class="sourceLineNo">4933</span>        x10r = a[offa + 20];<a name="line.4933"></a>
<span class="sourceLineNo">4934</span>        x10i = a[offa + 21];<a name="line.4934"></a>
<span class="sourceLineNo">4935</span>        x11r = a[offa + 22];<a name="line.4935"></a>
<span class="sourceLineNo">4936</span>        x11i = a[offa + 23];<a name="line.4936"></a>
<span class="sourceLineNo">4937</span>        x12r = a[offa + 24];<a name="line.4937"></a>
<span class="sourceLineNo">4938</span>        x12i = a[offa + 25];<a name="line.4938"></a>
<span class="sourceLineNo">4939</span>        x13r = a[offa + 26];<a name="line.4939"></a>
<span class="sourceLineNo">4940</span>        x13i = a[offa + 27];<a name="line.4940"></a>
<span class="sourceLineNo">4941</span>        x14r = a[offa + 28];<a name="line.4941"></a>
<span class="sourceLineNo">4942</span>        x14i = a[offa + 29];<a name="line.4942"></a>
<span class="sourceLineNo">4943</span>        a[offa + 2] = x8r;<a name="line.4943"></a>
<span class="sourceLineNo">4944</span>        a[offa + 3] = x8i;<a name="line.4944"></a>
<span class="sourceLineNo">4945</span>        a[offa + 4] = x4r;<a name="line.4945"></a>
<span class="sourceLineNo">4946</span>        a[offa + 5] = x4i;<a name="line.4946"></a>
<span class="sourceLineNo">4947</span>        a[offa + 6] = x12r;<a name="line.4947"></a>
<span class="sourceLineNo">4948</span>        a[offa + 7] = x12i;<a name="line.4948"></a>
<span class="sourceLineNo">4949</span>        a[offa + 8] = x2r;<a name="line.4949"></a>
<span class="sourceLineNo">4950</span>        a[offa + 9] = x2i;<a name="line.4950"></a>
<span class="sourceLineNo">4951</span>        a[offa + 10] = x10r;<a name="line.4951"></a>
<span class="sourceLineNo">4952</span>        a[offa + 11] = x10i;<a name="line.4952"></a>
<span class="sourceLineNo">4953</span>        a[offa + 14] = x14r;<a name="line.4953"></a>
<span class="sourceLineNo">4954</span>        a[offa + 15] = x14i;<a name="line.4954"></a>
<span class="sourceLineNo">4955</span>        a[offa + 16] = x1r;<a name="line.4955"></a>
<span class="sourceLineNo">4956</span>        a[offa + 17] = x1i;<a name="line.4956"></a>
<span class="sourceLineNo">4957</span>        a[offa + 20] = x5r;<a name="line.4957"></a>
<span class="sourceLineNo">4958</span>        a[offa + 21] = x5i;<a name="line.4958"></a>
<span class="sourceLineNo">4959</span>        a[offa + 22] = x13r;<a name="line.4959"></a>
<span class="sourceLineNo">4960</span>        a[offa + 23] = x13i;<a name="line.4960"></a>
<span class="sourceLineNo">4961</span>        a[offa + 24] = x3r;<a name="line.4961"></a>
<span class="sourceLineNo">4962</span>        a[offa + 25] = x3i;<a name="line.4962"></a>
<span class="sourceLineNo">4963</span>        a[offa + 26] = x11r;<a name="line.4963"></a>
<span class="sourceLineNo">4964</span>        a[offa + 27] = x11i;<a name="line.4964"></a>
<span class="sourceLineNo">4965</span>        a[offa + 28] = x7r;<a name="line.4965"></a>
<span class="sourceLineNo">4966</span>        a[offa + 29] = x7i;<a name="line.4966"></a>
<span class="sourceLineNo">4967</span>    }<a name="line.4967"></a>
<span class="sourceLineNo">4968</span><a name="line.4968"></a>
<span class="sourceLineNo">4969</span>    private void bitrv216neg(float[] a, int offa) {<a name="line.4969"></a>
<span class="sourceLineNo">4970</span>        float x1r, x1i, x2r, x2i, x3r, x3i, x4r, x4i, x5r, x5i, x6r, x6i, x7r, x7i, x8r, x8i, x9r, x9i, x10r, x10i, x11r, x11i, x12r, x12i, x13r, x13i, x14r, x14i, x15r, x15i;<a name="line.4970"></a>
<span class="sourceLineNo">4971</span><a name="line.4971"></a>
<span class="sourceLineNo">4972</span>        x1r = a[offa + 2];<a name="line.4972"></a>
<span class="sourceLineNo">4973</span>        x1i = a[offa + 3];<a name="line.4973"></a>
<span class="sourceLineNo">4974</span>        x2r = a[offa + 4];<a name="line.4974"></a>
<span class="sourceLineNo">4975</span>        x2i = a[offa + 5];<a name="line.4975"></a>
<span class="sourceLineNo">4976</span>        x3r = a[offa + 6];<a name="line.4976"></a>
<span class="sourceLineNo">4977</span>        x3i = a[offa + 7];<a name="line.4977"></a>
<span class="sourceLineNo">4978</span>        x4r = a[offa + 8];<a name="line.4978"></a>
<span class="sourceLineNo">4979</span>        x4i = a[offa + 9];<a name="line.4979"></a>
<span class="sourceLineNo">4980</span>        x5r = a[offa + 10];<a name="line.4980"></a>
<span class="sourceLineNo">4981</span>        x5i = a[offa + 11];<a name="line.4981"></a>
<span class="sourceLineNo">4982</span>        x6r = a[offa + 12];<a name="line.4982"></a>
<span class="sourceLineNo">4983</span>        x6i = a[offa + 13];<a name="line.4983"></a>
<span class="sourceLineNo">4984</span>        x7r = a[offa + 14];<a name="line.4984"></a>
<span class="sourceLineNo">4985</span>        x7i = a[offa + 15];<a name="line.4985"></a>
<span class="sourceLineNo">4986</span>        x8r = a[offa + 16];<a name="line.4986"></a>
<span class="sourceLineNo">4987</span>        x8i = a[offa + 17];<a name="line.4987"></a>
<span class="sourceLineNo">4988</span>        x9r = a[offa + 18];<a name="line.4988"></a>
<span class="sourceLineNo">4989</span>        x9i = a[offa + 19];<a name="line.4989"></a>
<span class="sourceLineNo">4990</span>        x10r = a[offa + 20];<a name="line.4990"></a>
<span class="sourceLineNo">4991</span>        x10i = a[offa + 21];<a name="line.4991"></a>
<span class="sourceLineNo">4992</span>        x11r = a[offa + 22];<a name="line.4992"></a>
<span class="sourceLineNo">4993</span>        x11i = a[offa + 23];<a name="line.4993"></a>
<span class="sourceLineNo">4994</span>        x12r = a[offa + 24];<a name="line.4994"></a>
<span class="sourceLineNo">4995</span>        x12i = a[offa + 25];<a name="line.4995"></a>
<span class="sourceLineNo">4996</span>        x13r = a[offa + 26];<a name="line.4996"></a>
<span class="sourceLineNo">4997</span>        x13i = a[offa + 27];<a name="line.4997"></a>
<span class="sourceLineNo">4998</span>        x14r = a[offa + 28];<a name="line.4998"></a>
<span class="sourceLineNo">4999</span>        x14i = a[offa + 29];<a name="line.4999"></a>
<span class="sourceLineNo">5000</span>        x15r = a[offa + 30];<a name="line.5000"></a>
<span class="sourceLineNo">5001</span>        x15i = a[offa + 31];<a name="line.5001"></a>
<span class="sourceLineNo">5002</span>        a[offa + 2] = x15r;<a name="line.5002"></a>
<span class="sourceLineNo">5003</span>        a[offa + 3] = x15i;<a name="line.5003"></a>
<span class="sourceLineNo">5004</span>        a[offa + 4] = x7r;<a name="line.5004"></a>
<span class="sourceLineNo">5005</span>        a[offa + 5] = x7i;<a name="line.5005"></a>
<span class="sourceLineNo">5006</span>        a[offa + 6] = x11r;<a name="line.5006"></a>
<span class="sourceLineNo">5007</span>        a[offa + 7] = x11i;<a name="line.5007"></a>
<span class="sourceLineNo">5008</span>        a[offa + 8] = x3r;<a name="line.5008"></a>
<span class="sourceLineNo">5009</span>        a[offa + 9] = x3i;<a name="line.5009"></a>
<span class="sourceLineNo">5010</span>        a[offa + 10] = x13r;<a name="line.5010"></a>
<span class="sourceLineNo">5011</span>        a[offa + 11] = x13i;<a name="line.5011"></a>
<span class="sourceLineNo">5012</span>        a[offa + 12] = x5r;<a name="line.5012"></a>
<span class="sourceLineNo">5013</span>        a[offa + 13] = x5i;<a name="line.5013"></a>
<span class="sourceLineNo">5014</span>        a[offa + 14] = x9r;<a name="line.5014"></a>
<span class="sourceLineNo">5015</span>        a[offa + 15] = x9i;<a name="line.5015"></a>
<span class="sourceLineNo">5016</span>        a[offa + 16] = x1r;<a name="line.5016"></a>
<span class="sourceLineNo">5017</span>        a[offa + 17] = x1i;<a name="line.5017"></a>
<span class="sourceLineNo">5018</span>        a[offa + 18] = x14r;<a name="line.5018"></a>
<span class="sourceLineNo">5019</span>        a[offa + 19] = x14i;<a name="line.5019"></a>
<span class="sourceLineNo">5020</span>        a[offa + 20] = x6r;<a name="line.5020"></a>
<span class="sourceLineNo">5021</span>        a[offa + 21] = x6i;<a name="line.5021"></a>
<span class="sourceLineNo">5022</span>        a[offa + 22] = x10r;<a name="line.5022"></a>
<span class="sourceLineNo">5023</span>        a[offa + 23] = x10i;<a name="line.5023"></a>
<span class="sourceLineNo">5024</span>        a[offa + 24] = x2r;<a name="line.5024"></a>
<span class="sourceLineNo">5025</span>        a[offa + 25] = x2i;<a name="line.5025"></a>
<span class="sourceLineNo">5026</span>        a[offa + 26] = x12r;<a name="line.5026"></a>
<span class="sourceLineNo">5027</span>        a[offa + 27] = x12i;<a name="line.5027"></a>
<span class="sourceLineNo">5028</span>        a[offa + 28] = x4r;<a name="line.5028"></a>
<span class="sourceLineNo">5029</span>        a[offa + 29] = x4i;<a name="line.5029"></a>
<span class="sourceLineNo">5030</span>        a[offa + 30] = x8r;<a name="line.5030"></a>
<span class="sourceLineNo">5031</span>        a[offa + 31] = x8i;<a name="line.5031"></a>
<span class="sourceLineNo">5032</span>    }<a name="line.5032"></a>
<span class="sourceLineNo">5033</span><a name="line.5033"></a>
<span class="sourceLineNo">5034</span>    private void bitrv208(float[] a, int offa) {<a name="line.5034"></a>
<span class="sourceLineNo">5035</span>        float x1r, x1i, x3r, x3i, x4r, x4i, x6r, x6i;<a name="line.5035"></a>
<span class="sourceLineNo">5036</span><a name="line.5036"></a>
<span class="sourceLineNo">5037</span>        x1r = a[offa + 2];<a name="line.5037"></a>
<span class="sourceLineNo">5038</span>        x1i = a[offa + 3];<a name="line.5038"></a>
<span class="sourceLineNo">5039</span>        x3r = a[offa + 6];<a name="line.5039"></a>
<span class="sourceLineNo">5040</span>        x3i = a[offa + 7];<a name="line.5040"></a>
<span class="sourceLineNo">5041</span>        x4r = a[offa + 8];<a name="line.5041"></a>
<span class="sourceLineNo">5042</span>        x4i = a[offa + 9];<a name="line.5042"></a>
<span class="sourceLineNo">5043</span>        x6r = a[offa + 12];<a name="line.5043"></a>
<span class="sourceLineNo">5044</span>        x6i = a[offa + 13];<a name="line.5044"></a>
<span class="sourceLineNo">5045</span>        a[offa + 2] = x4r;<a name="line.5045"></a>
<span class="sourceLineNo">5046</span>        a[offa + 3] = x4i;<a name="line.5046"></a>
<span class="sourceLineNo">5047</span>        a[offa + 6] = x6r;<a name="line.5047"></a>
<span class="sourceLineNo">5048</span>        a[offa + 7] = x6i;<a name="line.5048"></a>
<span class="sourceLineNo">5049</span>        a[offa + 8] = x1r;<a name="line.5049"></a>
<span class="sourceLineNo">5050</span>        a[offa + 9] = x1i;<a name="line.5050"></a>
<span class="sourceLineNo">5051</span>        a[offa + 12] = x3r;<a name="line.5051"></a>
<span class="sourceLineNo">5052</span>        a[offa + 13] = x3i;<a name="line.5052"></a>
<span class="sourceLineNo">5053</span>    }<a name="line.5053"></a>
<span class="sourceLineNo">5054</span><a name="line.5054"></a>
<span class="sourceLineNo">5055</span>    private void bitrv208neg(float[] a, int offa) {<a name="line.5055"></a>
<span class="sourceLineNo">5056</span>        float x1r, x1i, x2r, x2i, x3r, x3i, x4r, x4i, x5r, x5i, x6r, x6i, x7r, x7i;<a name="line.5056"></a>
<span class="sourceLineNo">5057</span><a name="line.5057"></a>
<span class="sourceLineNo">5058</span>        x1r = a[offa + 2];<a name="line.5058"></a>
<span class="sourceLineNo">5059</span>        x1i = a[offa + 3];<a name="line.5059"></a>
<span class="sourceLineNo">5060</span>        x2r = a[offa + 4];<a name="line.5060"></a>
<span class="sourceLineNo">5061</span>        x2i = a[offa + 5];<a name="line.5061"></a>
<span class="sourceLineNo">5062</span>        x3r = a[offa + 6];<a name="line.5062"></a>
<span class="sourceLineNo">5063</span>        x3i = a[offa + 7];<a name="line.5063"></a>
<span class="sourceLineNo">5064</span>        x4r = a[offa + 8];<a name="line.5064"></a>
<span class="sourceLineNo">5065</span>        x4i = a[offa + 9];<a name="line.5065"></a>
<span class="sourceLineNo">5066</span>        x5r = a[offa + 10];<a name="line.5066"></a>
<span class="sourceLineNo">5067</span>        x5i = a[offa + 11];<a name="line.5067"></a>
<span class="sourceLineNo">5068</span>        x6r = a[offa + 12];<a name="line.5068"></a>
<span class="sourceLineNo">5069</span>        x6i = a[offa + 13];<a name="line.5069"></a>
<span class="sourceLineNo">5070</span>        x7r = a[offa + 14];<a name="line.5070"></a>
<span class="sourceLineNo">5071</span>        x7i = a[offa + 15];<a name="line.5071"></a>
<span class="sourceLineNo">5072</span>        a[offa + 2] = x7r;<a name="line.5072"></a>
<span class="sourceLineNo">5073</span>        a[offa + 3] = x7i;<a name="line.5073"></a>
<span class="sourceLineNo">5074</span>        a[offa + 4] = x3r;<a name="line.5074"></a>
<span class="sourceLineNo">5075</span>        a[offa + 5] = x3i;<a name="line.5075"></a>
<span class="sourceLineNo">5076</span>        a[offa + 6] = x5r;<a name="line.5076"></a>
<span class="sourceLineNo">5077</span>        a[offa + 7] = x5i;<a name="line.5077"></a>
<span class="sourceLineNo">5078</span>        a[offa + 8] = x1r;<a name="line.5078"></a>
<span class="sourceLineNo">5079</span>        a[offa + 9] = x1i;<a name="line.5079"></a>
<span class="sourceLineNo">5080</span>        a[offa + 10] = x6r;<a name="line.5080"></a>
<span class="sourceLineNo">5081</span>        a[offa + 11] = x6i;<a name="line.5081"></a>
<span class="sourceLineNo">5082</span>        a[offa + 12] = x2r;<a name="line.5082"></a>
<span class="sourceLineNo">5083</span>        a[offa + 13] = x2i;<a name="line.5083"></a>
<span class="sourceLineNo">5084</span>        a[offa + 14] = x4r;<a name="line.5084"></a>
<span class="sourceLineNo">5085</span>        a[offa + 15] = x4i;<a name="line.5085"></a>
<span class="sourceLineNo">5086</span>    }<a name="line.5086"></a>
<span class="sourceLineNo">5087</span><a name="line.5087"></a>
<span class="sourceLineNo">5088</span>    private void cftf1st(int n, float[] a, int offa, float[] w, int startw) {<a name="line.5088"></a>
<span class="sourceLineNo">5089</span>        int j0, j1, j2, j3, k, m, mh;<a name="line.5089"></a>
<span class="sourceLineNo">5090</span>        float wn4r, csc1, csc3, wk1r, wk1i, wk3r, wk3i, wd1r, wd1i, wd3r, wd3i;<a name="line.5090"></a>
<span class="sourceLineNo">5091</span>        float x0r, x0i, x1r, x1i, x2r, x2i, x3r, x3i, y0r, y0i, y1r, y1i, y2r, y2i, y3r, y3i;<a name="line.5091"></a>
<span class="sourceLineNo">5092</span>        int idx0, idx1, idx2, idx3, idx4, idx5;<a name="line.5092"></a>
<span class="sourceLineNo">5093</span>        mh = n &gt;&gt; 3;<a name="line.5093"></a>
<span class="sourceLineNo">5094</span>        m = 2 * mh;<a name="line.5094"></a>
<span class="sourceLineNo">5095</span>        j1 = m;<a name="line.5095"></a>
<span class="sourceLineNo">5096</span>        j2 = j1 + m;<a name="line.5096"></a>
<span class="sourceLineNo">5097</span>        j3 = j2 + m;<a name="line.5097"></a>
<span class="sourceLineNo">5098</span>        idx1 = offa + j1;<a name="line.5098"></a>
<span class="sourceLineNo">5099</span>        idx2 = offa + j2;<a name="line.5099"></a>
<span class="sourceLineNo">5100</span>        idx3 = offa + j3;<a name="line.5100"></a>
<span class="sourceLineNo">5101</span>        x0r = a[offa] + a[idx2];<a name="line.5101"></a>
<span class="sourceLineNo">5102</span>        x0i = a[offa + 1] + a[idx2 + 1];<a name="line.5102"></a>
<span class="sourceLineNo">5103</span>        x1r = a[offa] - a[idx2];<a name="line.5103"></a>
<span class="sourceLineNo">5104</span>        x1i = a[offa + 1] - a[idx2 + 1];<a name="line.5104"></a>
<span class="sourceLineNo">5105</span>        x2r = a[idx1] + a[idx3];<a name="line.5105"></a>
<span class="sourceLineNo">5106</span>        x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5106"></a>
<span class="sourceLineNo">5107</span>        x3r = a[idx1] - a[idx3];<a name="line.5107"></a>
<span class="sourceLineNo">5108</span>        x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5108"></a>
<span class="sourceLineNo">5109</span>        a[offa] = x0r + x2r;<a name="line.5109"></a>
<span class="sourceLineNo">5110</span>        a[offa + 1] = x0i + x2i;<a name="line.5110"></a>
<span class="sourceLineNo">5111</span>        a[idx1] = x0r - x2r;<a name="line.5111"></a>
<span class="sourceLineNo">5112</span>        a[idx1 + 1] = x0i - x2i;<a name="line.5112"></a>
<span class="sourceLineNo">5113</span>        a[idx2] = x1r - x3i;<a name="line.5113"></a>
<span class="sourceLineNo">5114</span>        a[idx2 + 1] = x1i + x3r;<a name="line.5114"></a>
<span class="sourceLineNo">5115</span>        a[idx3] = x1r + x3i;<a name="line.5115"></a>
<span class="sourceLineNo">5116</span>        a[idx3 + 1] = x1i - x3r;<a name="line.5116"></a>
<span class="sourceLineNo">5117</span>        wn4r = w[startw + 1];<a name="line.5117"></a>
<span class="sourceLineNo">5118</span>        csc1 = w[startw + 2];<a name="line.5118"></a>
<span class="sourceLineNo">5119</span>        csc3 = w[startw + 3];<a name="line.5119"></a>
<span class="sourceLineNo">5120</span>        wd1r = 1;<a name="line.5120"></a>
<span class="sourceLineNo">5121</span>        wd1i = 0;<a name="line.5121"></a>
<span class="sourceLineNo">5122</span>        wd3r = 1;<a name="line.5122"></a>
<span class="sourceLineNo">5123</span>        wd3i = 0;<a name="line.5123"></a>
<span class="sourceLineNo">5124</span>        k = 0;<a name="line.5124"></a>
<span class="sourceLineNo">5125</span>        for (int j = 2; j &lt; mh - 2; j += 4) {<a name="line.5125"></a>
<span class="sourceLineNo">5126</span>            k += 4;<a name="line.5126"></a>
<span class="sourceLineNo">5127</span>            idx4 = startw + k;<a name="line.5127"></a>
<span class="sourceLineNo">5128</span>            wk1r = csc1 * (wd1r + w[idx4]);<a name="line.5128"></a>
<span class="sourceLineNo">5129</span>            wk1i = csc1 * (wd1i + w[idx4 + 1]);<a name="line.5129"></a>
<span class="sourceLineNo">5130</span>            wk3r = csc3 * (wd3r + w[idx4 + 2]);<a name="line.5130"></a>
<span class="sourceLineNo">5131</span>            wk3i = csc3 * (wd3i + w[idx4 + 3]);<a name="line.5131"></a>
<span class="sourceLineNo">5132</span>            wd1r = w[idx4];<a name="line.5132"></a>
<span class="sourceLineNo">5133</span>            wd1i = w[idx4 + 1];<a name="line.5133"></a>
<span class="sourceLineNo">5134</span>            wd3r = w[idx4 + 2];<a name="line.5134"></a>
<span class="sourceLineNo">5135</span>            wd3i = w[idx4 + 3];<a name="line.5135"></a>
<span class="sourceLineNo">5136</span>            j1 = j + m;<a name="line.5136"></a>
<span class="sourceLineNo">5137</span>            j2 = j1 + m;<a name="line.5137"></a>
<span class="sourceLineNo">5138</span>            j3 = j2 + m;<a name="line.5138"></a>
<span class="sourceLineNo">5139</span>            idx1 = offa + j1;<a name="line.5139"></a>
<span class="sourceLineNo">5140</span>            idx2 = offa + j2;<a name="line.5140"></a>
<span class="sourceLineNo">5141</span>            idx3 = offa + j3;<a name="line.5141"></a>
<span class="sourceLineNo">5142</span>            idx5 = offa + j;<a name="line.5142"></a>
<span class="sourceLineNo">5143</span>            x0r = a[idx5] + a[idx2];<a name="line.5143"></a>
<span class="sourceLineNo">5144</span>            x0i = a[idx5 + 1] + a[idx2 + 1];<a name="line.5144"></a>
<span class="sourceLineNo">5145</span>            x1r = a[idx5] - a[idx2];<a name="line.5145"></a>
<span class="sourceLineNo">5146</span>            x1i = a[idx5 + 1] - a[idx2 + 1];<a name="line.5146"></a>
<span class="sourceLineNo">5147</span>            y0r = a[idx5 + 2] + a[idx2 + 2];<a name="line.5147"></a>
<span class="sourceLineNo">5148</span>            y0i = a[idx5 + 3] + a[idx2 + 3];<a name="line.5148"></a>
<span class="sourceLineNo">5149</span>            y1r = a[idx5 + 2] - a[idx2 + 2];<a name="line.5149"></a>
<span class="sourceLineNo">5150</span>            y1i = a[idx5 + 3] - a[idx2 + 3];<a name="line.5150"></a>
<span class="sourceLineNo">5151</span>            x2r = a[idx1] + a[idx3];<a name="line.5151"></a>
<span class="sourceLineNo">5152</span>            x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5152"></a>
<span class="sourceLineNo">5153</span>            x3r = a[idx1] - a[idx3];<a name="line.5153"></a>
<span class="sourceLineNo">5154</span>            x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5154"></a>
<span class="sourceLineNo">5155</span>            y2r = a[idx1 + 2] + a[idx3 + 2];<a name="line.5155"></a>
<span class="sourceLineNo">5156</span>            y2i = a[idx1 + 3] + a[idx3 + 3];<a name="line.5156"></a>
<span class="sourceLineNo">5157</span>            y3r = a[idx1 + 2] - a[idx3 + 2];<a name="line.5157"></a>
<span class="sourceLineNo">5158</span>            y3i = a[idx1 + 3] - a[idx3 + 3];<a name="line.5158"></a>
<span class="sourceLineNo">5159</span>            a[idx5] = x0r + x2r;<a name="line.5159"></a>
<span class="sourceLineNo">5160</span>            a[idx5 + 1] = x0i + x2i;<a name="line.5160"></a>
<span class="sourceLineNo">5161</span>            a[idx5 + 2] = y0r + y2r;<a name="line.5161"></a>
<span class="sourceLineNo">5162</span>            a[idx5 + 3] = y0i + y2i;<a name="line.5162"></a>
<span class="sourceLineNo">5163</span>            a[idx1] = x0r - x2r;<a name="line.5163"></a>
<span class="sourceLineNo">5164</span>            a[idx1 + 1] = x0i - x2i;<a name="line.5164"></a>
<span class="sourceLineNo">5165</span>            a[idx1 + 2] = y0r - y2r;<a name="line.5165"></a>
<span class="sourceLineNo">5166</span>            a[idx1 + 3] = y0i - y2i;<a name="line.5166"></a>
<span class="sourceLineNo">5167</span>            x0r = x1r - x3i;<a name="line.5167"></a>
<span class="sourceLineNo">5168</span>            x0i = x1i + x3r;<a name="line.5168"></a>
<span class="sourceLineNo">5169</span>            a[idx2] = wk1r * x0r - wk1i * x0i;<a name="line.5169"></a>
<span class="sourceLineNo">5170</span>            a[idx2 + 1] = wk1r * x0i + wk1i * x0r;<a name="line.5170"></a>
<span class="sourceLineNo">5171</span>            x0r = y1r - y3i;<a name="line.5171"></a>
<span class="sourceLineNo">5172</span>            x0i = y1i + y3r;<a name="line.5172"></a>
<span class="sourceLineNo">5173</span>            a[idx2 + 2] = wd1r * x0r - wd1i * x0i;<a name="line.5173"></a>
<span class="sourceLineNo">5174</span>            a[idx2 + 3] = wd1r * x0i + wd1i * x0r;<a name="line.5174"></a>
<span class="sourceLineNo">5175</span>            x0r = x1r + x3i;<a name="line.5175"></a>
<span class="sourceLineNo">5176</span>            x0i = x1i - x3r;<a name="line.5176"></a>
<span class="sourceLineNo">5177</span>            a[idx3] = wk3r * x0r + wk3i * x0i;<a name="line.5177"></a>
<span class="sourceLineNo">5178</span>            a[idx3 + 1] = wk3r * x0i - wk3i * x0r;<a name="line.5178"></a>
<span class="sourceLineNo">5179</span>            x0r = y1r + y3i;<a name="line.5179"></a>
<span class="sourceLineNo">5180</span>            x0i = y1i - y3r;<a name="line.5180"></a>
<span class="sourceLineNo">5181</span>            a[idx3 + 2] = wd3r * x0r + wd3i * x0i;<a name="line.5181"></a>
<span class="sourceLineNo">5182</span>            a[idx3 + 3] = wd3r * x0i - wd3i * x0r;<a name="line.5182"></a>
<span class="sourceLineNo">5183</span>            j0 = m - j;<a name="line.5183"></a>
<span class="sourceLineNo">5184</span>            j1 = j0 + m;<a name="line.5184"></a>
<span class="sourceLineNo">5185</span>            j2 = j1 + m;<a name="line.5185"></a>
<span class="sourceLineNo">5186</span>            j3 = j2 + m;<a name="line.5186"></a>
<span class="sourceLineNo">5187</span>            idx0 = offa + j0;<a name="line.5187"></a>
<span class="sourceLineNo">5188</span>            idx1 = offa + j1;<a name="line.5188"></a>
<span class="sourceLineNo">5189</span>            idx2 = offa + j2;<a name="line.5189"></a>
<span class="sourceLineNo">5190</span>            idx3 = offa + j3;<a name="line.5190"></a>
<span class="sourceLineNo">5191</span>            x0r = a[idx0] + a[idx2];<a name="line.5191"></a>
<span class="sourceLineNo">5192</span>            x0i = a[idx0 + 1] + a[idx2 + 1];<a name="line.5192"></a>
<span class="sourceLineNo">5193</span>            x1r = a[idx0] - a[idx2];<a name="line.5193"></a>
<span class="sourceLineNo">5194</span>            x1i = a[idx0 + 1] - a[idx2 + 1];<a name="line.5194"></a>
<span class="sourceLineNo">5195</span>            y0r = a[idx0 - 2] + a[idx2 - 2];<a name="line.5195"></a>
<span class="sourceLineNo">5196</span>            y0i = a[idx0 - 1] + a[idx2 - 1];<a name="line.5196"></a>
<span class="sourceLineNo">5197</span>            y1r = a[idx0 - 2] - a[idx2 - 2];<a name="line.5197"></a>
<span class="sourceLineNo">5198</span>            y1i = a[idx0 - 1] - a[idx2 - 1];<a name="line.5198"></a>
<span class="sourceLineNo">5199</span>            x2r = a[idx1] + a[idx3];<a name="line.5199"></a>
<span class="sourceLineNo">5200</span>            x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5200"></a>
<span class="sourceLineNo">5201</span>            x3r = a[idx1] - a[idx3];<a name="line.5201"></a>
<span class="sourceLineNo">5202</span>            x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5202"></a>
<span class="sourceLineNo">5203</span>            y2r = a[idx1 - 2] + a[idx3 - 2];<a name="line.5203"></a>
<span class="sourceLineNo">5204</span>            y2i = a[idx1 - 1] + a[idx3 - 1];<a name="line.5204"></a>
<span class="sourceLineNo">5205</span>            y3r = a[idx1 - 2] - a[idx3 - 2];<a name="line.5205"></a>
<span class="sourceLineNo">5206</span>            y3i = a[idx1 - 1] - a[idx3 - 1];<a name="line.5206"></a>
<span class="sourceLineNo">5207</span>            a[idx0] = x0r + x2r;<a name="line.5207"></a>
<span class="sourceLineNo">5208</span>            a[idx0 + 1] = x0i + x2i;<a name="line.5208"></a>
<span class="sourceLineNo">5209</span>            a[idx0 - 2] = y0r + y2r;<a name="line.5209"></a>
<span class="sourceLineNo">5210</span>            a[idx0 - 1] = y0i + y2i;<a name="line.5210"></a>
<span class="sourceLineNo">5211</span>            a[idx1] = x0r - x2r;<a name="line.5211"></a>
<span class="sourceLineNo">5212</span>            a[idx1 + 1] = x0i - x2i;<a name="line.5212"></a>
<span class="sourceLineNo">5213</span>            a[idx1 - 2] = y0r - y2r;<a name="line.5213"></a>
<span class="sourceLineNo">5214</span>            a[idx1 - 1] = y0i - y2i;<a name="line.5214"></a>
<span class="sourceLineNo">5215</span>            x0r = x1r - x3i;<a name="line.5215"></a>
<span class="sourceLineNo">5216</span>            x0i = x1i + x3r;<a name="line.5216"></a>
<span class="sourceLineNo">5217</span>            a[idx2] = wk1i * x0r - wk1r * x0i;<a name="line.5217"></a>
<span class="sourceLineNo">5218</span>            a[idx2 + 1] = wk1i * x0i + wk1r * x0r;<a name="line.5218"></a>
<span class="sourceLineNo">5219</span>            x0r = y1r - y3i;<a name="line.5219"></a>
<span class="sourceLineNo">5220</span>            x0i = y1i + y3r;<a name="line.5220"></a>
<span class="sourceLineNo">5221</span>            a[idx2 - 2] = wd1i * x0r - wd1r * x0i;<a name="line.5221"></a>
<span class="sourceLineNo">5222</span>            a[idx2 - 1] = wd1i * x0i + wd1r * x0r;<a name="line.5222"></a>
<span class="sourceLineNo">5223</span>            x0r = x1r + x3i;<a name="line.5223"></a>
<span class="sourceLineNo">5224</span>            x0i = x1i - x3r;<a name="line.5224"></a>
<span class="sourceLineNo">5225</span>            a[idx3] = wk3i * x0r + wk3r * x0i;<a name="line.5225"></a>
<span class="sourceLineNo">5226</span>            a[idx3 + 1] = wk3i * x0i - wk3r * x0r;<a name="line.5226"></a>
<span class="sourceLineNo">5227</span>            x0r = y1r + y3i;<a name="line.5227"></a>
<span class="sourceLineNo">5228</span>            x0i = y1i - y3r;<a name="line.5228"></a>
<span class="sourceLineNo">5229</span>            a[offa + j3 - 2] = wd3i * x0r + wd3r * x0i;<a name="line.5229"></a>
<span class="sourceLineNo">5230</span>            a[offa + j3 - 1] = wd3i * x0i - wd3r * x0r;<a name="line.5230"></a>
<span class="sourceLineNo">5231</span>        }<a name="line.5231"></a>
<span class="sourceLineNo">5232</span>        wk1r = csc1 * (wd1r + wn4r);<a name="line.5232"></a>
<span class="sourceLineNo">5233</span>        wk1i = csc1 * (wd1i + wn4r);<a name="line.5233"></a>
<span class="sourceLineNo">5234</span>        wk3r = csc3 * (wd3r - wn4r);<a name="line.5234"></a>
<span class="sourceLineNo">5235</span>        wk3i = csc3 * (wd3i - wn4r);<a name="line.5235"></a>
<span class="sourceLineNo">5236</span>        j0 = mh;<a name="line.5236"></a>
<span class="sourceLineNo">5237</span>        j1 = j0 + m;<a name="line.5237"></a>
<span class="sourceLineNo">5238</span>        j2 = j1 + m;<a name="line.5238"></a>
<span class="sourceLineNo">5239</span>        j3 = j2 + m;<a name="line.5239"></a>
<span class="sourceLineNo">5240</span>        idx0 = offa + j0;<a name="line.5240"></a>
<span class="sourceLineNo">5241</span>        idx1 = offa + j1;<a name="line.5241"></a>
<span class="sourceLineNo">5242</span>        idx2 = offa + j2;<a name="line.5242"></a>
<span class="sourceLineNo">5243</span>        idx3 = offa + j3;<a name="line.5243"></a>
<span class="sourceLineNo">5244</span>        x0r = a[idx0 - 2] + a[idx2 - 2];<a name="line.5244"></a>
<span class="sourceLineNo">5245</span>        x0i = a[idx0 - 1] + a[idx2 - 1];<a name="line.5245"></a>
<span class="sourceLineNo">5246</span>        x1r = a[idx0 - 2] - a[idx2 - 2];<a name="line.5246"></a>
<span class="sourceLineNo">5247</span>        x1i = a[idx0 - 1] - a[idx2 - 1];<a name="line.5247"></a>
<span class="sourceLineNo">5248</span>        x2r = a[idx1 - 2] + a[idx3 - 2];<a name="line.5248"></a>
<span class="sourceLineNo">5249</span>        x2i = a[idx1 - 1] + a[idx3 - 1];<a name="line.5249"></a>
<span class="sourceLineNo">5250</span>        x3r = a[idx1 - 2] - a[idx3 - 2];<a name="line.5250"></a>
<span class="sourceLineNo">5251</span>        x3i = a[idx1 - 1] - a[idx3 - 1];<a name="line.5251"></a>
<span class="sourceLineNo">5252</span>        a[idx0 - 2] = x0r + x2r;<a name="line.5252"></a>
<span class="sourceLineNo">5253</span>        a[idx0 - 1] = x0i + x2i;<a name="line.5253"></a>
<span class="sourceLineNo">5254</span>        a[idx1 - 2] = x0r - x2r;<a name="line.5254"></a>
<span class="sourceLineNo">5255</span>        a[idx1 - 1] = x0i - x2i;<a name="line.5255"></a>
<span class="sourceLineNo">5256</span>        x0r = x1r - x3i;<a name="line.5256"></a>
<span class="sourceLineNo">5257</span>        x0i = x1i + x3r;<a name="line.5257"></a>
<span class="sourceLineNo">5258</span>        a[idx2 - 2] = wk1r * x0r - wk1i * x0i;<a name="line.5258"></a>
<span class="sourceLineNo">5259</span>        a[idx2 - 1] = wk1r * x0i + wk1i * x0r;<a name="line.5259"></a>
<span class="sourceLineNo">5260</span>        x0r = x1r + x3i;<a name="line.5260"></a>
<span class="sourceLineNo">5261</span>        x0i = x1i - x3r;<a name="line.5261"></a>
<span class="sourceLineNo">5262</span>        a[idx3 - 2] = wk3r * x0r + wk3i * x0i;<a name="line.5262"></a>
<span class="sourceLineNo">5263</span>        a[idx3 - 1] = wk3r * x0i - wk3i * x0r;<a name="line.5263"></a>
<span class="sourceLineNo">5264</span>        x0r = a[idx0] + a[idx2];<a name="line.5264"></a>
<span class="sourceLineNo">5265</span>        x0i = a[idx0 + 1] + a[idx2 + 1];<a name="line.5265"></a>
<span class="sourceLineNo">5266</span>        x1r = a[idx0] - a[idx2];<a name="line.5266"></a>
<span class="sourceLineNo">5267</span>        x1i = a[idx0 + 1] - a[idx2 + 1];<a name="line.5267"></a>
<span class="sourceLineNo">5268</span>        x2r = a[idx1] + a[idx3];<a name="line.5268"></a>
<span class="sourceLineNo">5269</span>        x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5269"></a>
<span class="sourceLineNo">5270</span>        x3r = a[idx1] - a[idx3];<a name="line.5270"></a>
<span class="sourceLineNo">5271</span>        x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5271"></a>
<span class="sourceLineNo">5272</span>        a[idx0] = x0r + x2r;<a name="line.5272"></a>
<span class="sourceLineNo">5273</span>        a[idx0 + 1] = x0i + x2i;<a name="line.5273"></a>
<span class="sourceLineNo">5274</span>        a[idx1] = x0r - x2r;<a name="line.5274"></a>
<span class="sourceLineNo">5275</span>        a[idx1 + 1] = x0i - x2i;<a name="line.5275"></a>
<span class="sourceLineNo">5276</span>        x0r = x1r - x3i;<a name="line.5276"></a>
<span class="sourceLineNo">5277</span>        x0i = x1i + x3r;<a name="line.5277"></a>
<span class="sourceLineNo">5278</span>        a[idx2] = wn4r * (x0r - x0i);<a name="line.5278"></a>
<span class="sourceLineNo">5279</span>        a[idx2 + 1] = wn4r * (x0i + x0r);<a name="line.5279"></a>
<span class="sourceLineNo">5280</span>        x0r = x1r + x3i;<a name="line.5280"></a>
<span class="sourceLineNo">5281</span>        x0i = x1i - x3r;<a name="line.5281"></a>
<span class="sourceLineNo">5282</span>        a[idx3] = -wn4r * (x0r + x0i);<a name="line.5282"></a>
<span class="sourceLineNo">5283</span>        a[idx3 + 1] = -wn4r * (x0i - x0r);<a name="line.5283"></a>
<span class="sourceLineNo">5284</span>        x0r = a[idx0 + 2] + a[idx2 + 2];<a name="line.5284"></a>
<span class="sourceLineNo">5285</span>        x0i = a[idx0 + 3] + a[idx2 + 3];<a name="line.5285"></a>
<span class="sourceLineNo">5286</span>        x1r = a[idx0 + 2] - a[idx2 + 2];<a name="line.5286"></a>
<span class="sourceLineNo">5287</span>        x1i = a[idx0 + 3] - a[idx2 + 3];<a name="line.5287"></a>
<span class="sourceLineNo">5288</span>        x2r = a[idx1 + 2] + a[idx3 + 2];<a name="line.5288"></a>
<span class="sourceLineNo">5289</span>        x2i = a[idx1 + 3] + a[idx3 + 3];<a name="line.5289"></a>
<span class="sourceLineNo">5290</span>        x3r = a[idx1 + 2] - a[idx3 + 2];<a name="line.5290"></a>
<span class="sourceLineNo">5291</span>        x3i = a[idx1 + 3] - a[idx3 + 3];<a name="line.5291"></a>
<span class="sourceLineNo">5292</span>        a[idx0 + 2] = x0r + x2r;<a name="line.5292"></a>
<span class="sourceLineNo">5293</span>        a[idx0 + 3] = x0i + x2i;<a name="line.5293"></a>
<span class="sourceLineNo">5294</span>        a[idx1 + 2] = x0r - x2r;<a name="line.5294"></a>
<span class="sourceLineNo">5295</span>        a[idx1 + 3] = x0i - x2i;<a name="line.5295"></a>
<span class="sourceLineNo">5296</span>        x0r = x1r - x3i;<a name="line.5296"></a>
<span class="sourceLineNo">5297</span>        x0i = x1i + x3r;<a name="line.5297"></a>
<span class="sourceLineNo">5298</span>        a[idx2 + 2] = wk1i * x0r - wk1r * x0i;<a name="line.5298"></a>
<span class="sourceLineNo">5299</span>        a[idx2 + 3] = wk1i * x0i + wk1r * x0r;<a name="line.5299"></a>
<span class="sourceLineNo">5300</span>        x0r = x1r + x3i;<a name="line.5300"></a>
<span class="sourceLineNo">5301</span>        x0i = x1i - x3r;<a name="line.5301"></a>
<span class="sourceLineNo">5302</span>        a[idx3 + 2] = wk3i * x0r + wk3r * x0i;<a name="line.5302"></a>
<span class="sourceLineNo">5303</span>        a[idx3 + 3] = wk3i * x0i - wk3r * x0r;<a name="line.5303"></a>
<span class="sourceLineNo">5304</span>    }<a name="line.5304"></a>
<span class="sourceLineNo">5305</span><a name="line.5305"></a>
<span class="sourceLineNo">5306</span>    private void cftb1st(int n, float[] a, int offa, float[] w, int startw) {<a name="line.5306"></a>
<span class="sourceLineNo">5307</span>        int j0, j1, j2, j3, k, m, mh;<a name="line.5307"></a>
<span class="sourceLineNo">5308</span>        float wn4r, csc1, csc3, wk1r, wk1i, wk3r, wk3i, wd1r, wd1i, wd3r, wd3i;<a name="line.5308"></a>
<span class="sourceLineNo">5309</span>        float x0r, x0i, x1r, x1i, x2r, x2i, x3r, x3i, y0r, y0i, y1r, y1i, y2r, y2i, y3r, y3i;<a name="line.5309"></a>
<span class="sourceLineNo">5310</span>        int idx0, idx1, idx2, idx3, idx4, idx5;<a name="line.5310"></a>
<span class="sourceLineNo">5311</span>        mh = n &gt;&gt; 3;<a name="line.5311"></a>
<span class="sourceLineNo">5312</span>        m = 2 * mh;<a name="line.5312"></a>
<span class="sourceLineNo">5313</span>        j1 = m;<a name="line.5313"></a>
<span class="sourceLineNo">5314</span>        j2 = j1 + m;<a name="line.5314"></a>
<span class="sourceLineNo">5315</span>        j3 = j2 + m;<a name="line.5315"></a>
<span class="sourceLineNo">5316</span>        idx1 = offa + j1;<a name="line.5316"></a>
<span class="sourceLineNo">5317</span>        idx2 = offa + j2;<a name="line.5317"></a>
<span class="sourceLineNo">5318</span>        idx3 = offa + j3;<a name="line.5318"></a>
<span class="sourceLineNo">5319</span><a name="line.5319"></a>
<span class="sourceLineNo">5320</span>        x0r = a[offa] + a[idx2];<a name="line.5320"></a>
<span class="sourceLineNo">5321</span>        x0i = -a[offa + 1] - a[idx2 + 1];<a name="line.5321"></a>
<span class="sourceLineNo">5322</span>        x1r = a[offa] - a[idx2];<a name="line.5322"></a>
<span class="sourceLineNo">5323</span>        x1i = -a[offa + 1] + a[idx2 + 1];<a name="line.5323"></a>
<span class="sourceLineNo">5324</span>        x2r = a[idx1] + a[idx3];<a name="line.5324"></a>
<span class="sourceLineNo">5325</span>        x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5325"></a>
<span class="sourceLineNo">5326</span>        x3r = a[idx1] - a[idx3];<a name="line.5326"></a>
<span class="sourceLineNo">5327</span>        x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5327"></a>
<span class="sourceLineNo">5328</span>        a[offa] = x0r + x2r;<a name="line.5328"></a>
<span class="sourceLineNo">5329</span>        a[offa + 1] = x0i - x2i;<a name="line.5329"></a>
<span class="sourceLineNo">5330</span>        a[idx1] = x0r - x2r;<a name="line.5330"></a>
<span class="sourceLineNo">5331</span>        a[idx1 + 1] = x0i + x2i;<a name="line.5331"></a>
<span class="sourceLineNo">5332</span>        a[idx2] = x1r + x3i;<a name="line.5332"></a>
<span class="sourceLineNo">5333</span>        a[idx2 + 1] = x1i + x3r;<a name="line.5333"></a>
<span class="sourceLineNo">5334</span>        a[idx3] = x1r - x3i;<a name="line.5334"></a>
<span class="sourceLineNo">5335</span>        a[idx3 + 1] = x1i - x3r;<a name="line.5335"></a>
<span class="sourceLineNo">5336</span>        wn4r = w[startw + 1];<a name="line.5336"></a>
<span class="sourceLineNo">5337</span>        csc1 = w[startw + 2];<a name="line.5337"></a>
<span class="sourceLineNo">5338</span>        csc3 = w[startw + 3];<a name="line.5338"></a>
<span class="sourceLineNo">5339</span>        wd1r = 1;<a name="line.5339"></a>
<span class="sourceLineNo">5340</span>        wd1i = 0;<a name="line.5340"></a>
<span class="sourceLineNo">5341</span>        wd3r = 1;<a name="line.5341"></a>
<span class="sourceLineNo">5342</span>        wd3i = 0;<a name="line.5342"></a>
<span class="sourceLineNo">5343</span>        k = 0;<a name="line.5343"></a>
<span class="sourceLineNo">5344</span>        for (int j = 2; j &lt; mh - 2; j += 4) {<a name="line.5344"></a>
<span class="sourceLineNo">5345</span>            k += 4;<a name="line.5345"></a>
<span class="sourceLineNo">5346</span>            idx4 = startw + k;<a name="line.5346"></a>
<span class="sourceLineNo">5347</span>            wk1r = csc1 * (wd1r + w[idx4]);<a name="line.5347"></a>
<span class="sourceLineNo">5348</span>            wk1i = csc1 * (wd1i + w[idx4 + 1]);<a name="line.5348"></a>
<span class="sourceLineNo">5349</span>            wk3r = csc3 * (wd3r + w[idx4 + 2]);<a name="line.5349"></a>
<span class="sourceLineNo">5350</span>            wk3i = csc3 * (wd3i + w[idx4 + 3]);<a name="line.5350"></a>
<span class="sourceLineNo">5351</span>            wd1r = w[idx4];<a name="line.5351"></a>
<span class="sourceLineNo">5352</span>            wd1i = w[idx4 + 1];<a name="line.5352"></a>
<span class="sourceLineNo">5353</span>            wd3r = w[idx4 + 2];<a name="line.5353"></a>
<span class="sourceLineNo">5354</span>            wd3i = w[idx4 + 3];<a name="line.5354"></a>
<span class="sourceLineNo">5355</span>            j1 = j + m;<a name="line.5355"></a>
<span class="sourceLineNo">5356</span>            j2 = j1 + m;<a name="line.5356"></a>
<span class="sourceLineNo">5357</span>            j3 = j2 + m;<a name="line.5357"></a>
<span class="sourceLineNo">5358</span>            idx1 = offa + j1;<a name="line.5358"></a>
<span class="sourceLineNo">5359</span>            idx2 = offa + j2;<a name="line.5359"></a>
<span class="sourceLineNo">5360</span>            idx3 = offa + j3;<a name="line.5360"></a>
<span class="sourceLineNo">5361</span>            idx5 = offa + j;<a name="line.5361"></a>
<span class="sourceLineNo">5362</span>            x0r = a[idx5] + a[idx2];<a name="line.5362"></a>
<span class="sourceLineNo">5363</span>            x0i = -a[idx5 + 1] - a[idx2 + 1];<a name="line.5363"></a>
<span class="sourceLineNo">5364</span>            x1r = a[idx5] - a[offa + j2];<a name="line.5364"></a>
<span class="sourceLineNo">5365</span>            x1i = -a[idx5 + 1] + a[idx2 + 1];<a name="line.5365"></a>
<span class="sourceLineNo">5366</span>            y0r = a[idx5 + 2] + a[idx2 + 2];<a name="line.5366"></a>
<span class="sourceLineNo">5367</span>            y0i = -a[idx5 + 3] - a[idx2 + 3];<a name="line.5367"></a>
<span class="sourceLineNo">5368</span>            y1r = a[idx5 + 2] - a[idx2 + 2];<a name="line.5368"></a>
<span class="sourceLineNo">5369</span>            y1i = -a[idx5 + 3] + a[idx2 + 3];<a name="line.5369"></a>
<span class="sourceLineNo">5370</span>            x2r = a[idx1] + a[idx3];<a name="line.5370"></a>
<span class="sourceLineNo">5371</span>            x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5371"></a>
<span class="sourceLineNo">5372</span>            x3r = a[idx1] - a[idx3];<a name="line.5372"></a>
<span class="sourceLineNo">5373</span>            x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5373"></a>
<span class="sourceLineNo">5374</span>            y2r = a[idx1 + 2] + a[idx3 + 2];<a name="line.5374"></a>
<span class="sourceLineNo">5375</span>            y2i = a[idx1 + 3] + a[idx3 + 3];<a name="line.5375"></a>
<span class="sourceLineNo">5376</span>            y3r = a[idx1 + 2] - a[idx3 + 2];<a name="line.5376"></a>
<span class="sourceLineNo">5377</span>            y3i = a[idx1 + 3] - a[idx3 + 3];<a name="line.5377"></a>
<span class="sourceLineNo">5378</span>            a[idx5] = x0r + x2r;<a name="line.5378"></a>
<span class="sourceLineNo">5379</span>            a[idx5 + 1] = x0i - x2i;<a name="line.5379"></a>
<span class="sourceLineNo">5380</span>            a[idx5 + 2] = y0r + y2r;<a name="line.5380"></a>
<span class="sourceLineNo">5381</span>            a[idx5 + 3] = y0i - y2i;<a name="line.5381"></a>
<span class="sourceLineNo">5382</span>            a[idx1] = x0r - x2r;<a name="line.5382"></a>
<span class="sourceLineNo">5383</span>            a[idx1 + 1] = x0i + x2i;<a name="line.5383"></a>
<span class="sourceLineNo">5384</span>            a[idx1 + 2] = y0r - y2r;<a name="line.5384"></a>
<span class="sourceLineNo">5385</span>            a[idx1 + 3] = y0i + y2i;<a name="line.5385"></a>
<span class="sourceLineNo">5386</span>            x0r = x1r + x3i;<a name="line.5386"></a>
<span class="sourceLineNo">5387</span>            x0i = x1i + x3r;<a name="line.5387"></a>
<span class="sourceLineNo">5388</span>            a[idx2] = wk1r * x0r - wk1i * x0i;<a name="line.5388"></a>
<span class="sourceLineNo">5389</span>            a[idx2 + 1] = wk1r * x0i + wk1i * x0r;<a name="line.5389"></a>
<span class="sourceLineNo">5390</span>            x0r = y1r + y3i;<a name="line.5390"></a>
<span class="sourceLineNo">5391</span>            x0i = y1i + y3r;<a name="line.5391"></a>
<span class="sourceLineNo">5392</span>            a[idx2 + 2] = wd1r * x0r - wd1i * x0i;<a name="line.5392"></a>
<span class="sourceLineNo">5393</span>            a[idx2 + 3] = wd1r * x0i + wd1i * x0r;<a name="line.5393"></a>
<span class="sourceLineNo">5394</span>            x0r = x1r - x3i;<a name="line.5394"></a>
<span class="sourceLineNo">5395</span>            x0i = x1i - x3r;<a name="line.5395"></a>
<span class="sourceLineNo">5396</span>            a[idx3] = wk3r * x0r + wk3i * x0i;<a name="line.5396"></a>
<span class="sourceLineNo">5397</span>            a[idx3 + 1] = wk3r * x0i - wk3i * x0r;<a name="line.5397"></a>
<span class="sourceLineNo">5398</span>            x0r = y1r - y3i;<a name="line.5398"></a>
<span class="sourceLineNo">5399</span>            x0i = y1i - y3r;<a name="line.5399"></a>
<span class="sourceLineNo">5400</span>            a[idx3 + 2] = wd3r * x0r + wd3i * x0i;<a name="line.5400"></a>
<span class="sourceLineNo">5401</span>            a[idx3 + 3] = wd3r * x0i - wd3i * x0r;<a name="line.5401"></a>
<span class="sourceLineNo">5402</span>            j0 = m - j;<a name="line.5402"></a>
<span class="sourceLineNo">5403</span>            j1 = j0 + m;<a name="line.5403"></a>
<span class="sourceLineNo">5404</span>            j2 = j1 + m;<a name="line.5404"></a>
<span class="sourceLineNo">5405</span>            j3 = j2 + m;<a name="line.5405"></a>
<span class="sourceLineNo">5406</span>            idx0 = offa + j0;<a name="line.5406"></a>
<span class="sourceLineNo">5407</span>            idx1 = offa + j1;<a name="line.5407"></a>
<span class="sourceLineNo">5408</span>            idx2 = offa + j2;<a name="line.5408"></a>
<span class="sourceLineNo">5409</span>            idx3 = offa + j3;<a name="line.5409"></a>
<span class="sourceLineNo">5410</span>            x0r = a[idx0] + a[idx2];<a name="line.5410"></a>
<span class="sourceLineNo">5411</span>            x0i = -a[idx0 + 1] - a[idx2 + 1];<a name="line.5411"></a>
<span class="sourceLineNo">5412</span>            x1r = a[idx0] - a[idx2];<a name="line.5412"></a>
<span class="sourceLineNo">5413</span>            x1i = -a[idx0 + 1] + a[idx2 + 1];<a name="line.5413"></a>
<span class="sourceLineNo">5414</span>            y0r = a[idx0 - 2] + a[idx2 - 2];<a name="line.5414"></a>
<span class="sourceLineNo">5415</span>            y0i = -a[idx0 - 1] - a[idx2 - 1];<a name="line.5415"></a>
<span class="sourceLineNo">5416</span>            y1r = a[idx0 - 2] - a[idx2 - 2];<a name="line.5416"></a>
<span class="sourceLineNo">5417</span>            y1i = -a[idx0 - 1] + a[idx2 - 1];<a name="line.5417"></a>
<span class="sourceLineNo">5418</span>            x2r = a[idx1] + a[idx3];<a name="line.5418"></a>
<span class="sourceLineNo">5419</span>            x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5419"></a>
<span class="sourceLineNo">5420</span>            x3r = a[idx1] - a[idx3];<a name="line.5420"></a>
<span class="sourceLineNo">5421</span>            x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5421"></a>
<span class="sourceLineNo">5422</span>            y2r = a[idx1 - 2] + a[idx3 - 2];<a name="line.5422"></a>
<span class="sourceLineNo">5423</span>            y2i = a[idx1 - 1] + a[idx3 - 1];<a name="line.5423"></a>
<span class="sourceLineNo">5424</span>            y3r = a[idx1 - 2] - a[idx3 - 2];<a name="line.5424"></a>
<span class="sourceLineNo">5425</span>            y3i = a[idx1 - 1] - a[idx3 - 1];<a name="line.5425"></a>
<span class="sourceLineNo">5426</span>            a[idx0] = x0r + x2r;<a name="line.5426"></a>
<span class="sourceLineNo">5427</span>            a[idx0 + 1] = x0i - x2i;<a name="line.5427"></a>
<span class="sourceLineNo">5428</span>            a[idx0 - 2] = y0r + y2r;<a name="line.5428"></a>
<span class="sourceLineNo">5429</span>            a[idx0 - 1] = y0i - y2i;<a name="line.5429"></a>
<span class="sourceLineNo">5430</span>            a[idx1] = x0r - x2r;<a name="line.5430"></a>
<span class="sourceLineNo">5431</span>            a[idx1 + 1] = x0i + x2i;<a name="line.5431"></a>
<span class="sourceLineNo">5432</span>            a[idx1 - 2] = y0r - y2r;<a name="line.5432"></a>
<span class="sourceLineNo">5433</span>            a[idx1 - 1] = y0i + y2i;<a name="line.5433"></a>
<span class="sourceLineNo">5434</span>            x0r = x1r + x3i;<a name="line.5434"></a>
<span class="sourceLineNo">5435</span>            x0i = x1i + x3r;<a name="line.5435"></a>
<span class="sourceLineNo">5436</span>            a[idx2] = wk1i * x0r - wk1r * x0i;<a name="line.5436"></a>
<span class="sourceLineNo">5437</span>            a[idx2 + 1] = wk1i * x0i + wk1r * x0r;<a name="line.5437"></a>
<span class="sourceLineNo">5438</span>            x0r = y1r + y3i;<a name="line.5438"></a>
<span class="sourceLineNo">5439</span>            x0i = y1i + y3r;<a name="line.5439"></a>
<span class="sourceLineNo">5440</span>            a[idx2 - 2] = wd1i * x0r - wd1r * x0i;<a name="line.5440"></a>
<span class="sourceLineNo">5441</span>            a[idx2 - 1] = wd1i * x0i + wd1r * x0r;<a name="line.5441"></a>
<span class="sourceLineNo">5442</span>            x0r = x1r - x3i;<a name="line.5442"></a>
<span class="sourceLineNo">5443</span>            x0i = x1i - x3r;<a name="line.5443"></a>
<span class="sourceLineNo">5444</span>            a[idx3] = wk3i * x0r + wk3r * x0i;<a name="line.5444"></a>
<span class="sourceLineNo">5445</span>            a[idx3 + 1] = wk3i * x0i - wk3r * x0r;<a name="line.5445"></a>
<span class="sourceLineNo">5446</span>            x0r = y1r - y3i;<a name="line.5446"></a>
<span class="sourceLineNo">5447</span>            x0i = y1i - y3r;<a name="line.5447"></a>
<span class="sourceLineNo">5448</span>            a[idx3 - 2] = wd3i * x0r + wd3r * x0i;<a name="line.5448"></a>
<span class="sourceLineNo">5449</span>            a[idx3 - 1] = wd3i * x0i - wd3r * x0r;<a name="line.5449"></a>
<span class="sourceLineNo">5450</span>        }<a name="line.5450"></a>
<span class="sourceLineNo">5451</span>        wk1r = csc1 * (wd1r + wn4r);<a name="line.5451"></a>
<span class="sourceLineNo">5452</span>        wk1i = csc1 * (wd1i + wn4r);<a name="line.5452"></a>
<span class="sourceLineNo">5453</span>        wk3r = csc3 * (wd3r - wn4r);<a name="line.5453"></a>
<span class="sourceLineNo">5454</span>        wk3i = csc3 * (wd3i - wn4r);<a name="line.5454"></a>
<span class="sourceLineNo">5455</span>        j0 = mh;<a name="line.5455"></a>
<span class="sourceLineNo">5456</span>        j1 = j0 + m;<a name="line.5456"></a>
<span class="sourceLineNo">5457</span>        j2 = j1 + m;<a name="line.5457"></a>
<span class="sourceLineNo">5458</span>        j3 = j2 + m;<a name="line.5458"></a>
<span class="sourceLineNo">5459</span>        idx0 = offa + j0;<a name="line.5459"></a>
<span class="sourceLineNo">5460</span>        idx1 = offa + j1;<a name="line.5460"></a>
<span class="sourceLineNo">5461</span>        idx2 = offa + j2;<a name="line.5461"></a>
<span class="sourceLineNo">5462</span>        idx3 = offa + j3;<a name="line.5462"></a>
<span class="sourceLineNo">5463</span>        x0r = a[idx0 - 2] + a[idx2 - 2];<a name="line.5463"></a>
<span class="sourceLineNo">5464</span>        x0i = -a[idx0 - 1] - a[idx2 - 1];<a name="line.5464"></a>
<span class="sourceLineNo">5465</span>        x1r = a[idx0 - 2] - a[idx2 - 2];<a name="line.5465"></a>
<span class="sourceLineNo">5466</span>        x1i = -a[idx0 - 1] + a[idx2 - 1];<a name="line.5466"></a>
<span class="sourceLineNo">5467</span>        x2r = a[idx1 - 2] + a[idx3 - 2];<a name="line.5467"></a>
<span class="sourceLineNo">5468</span>        x2i = a[idx1 - 1] + a[idx3 - 1];<a name="line.5468"></a>
<span class="sourceLineNo">5469</span>        x3r = a[idx1 - 2] - a[idx3 - 2];<a name="line.5469"></a>
<span class="sourceLineNo">5470</span>        x3i = a[idx1 - 1] - a[idx3 - 1];<a name="line.5470"></a>
<span class="sourceLineNo">5471</span>        a[idx0 - 2] = x0r + x2r;<a name="line.5471"></a>
<span class="sourceLineNo">5472</span>        a[idx0 - 1] = x0i - x2i;<a name="line.5472"></a>
<span class="sourceLineNo">5473</span>        a[idx1 - 2] = x0r - x2r;<a name="line.5473"></a>
<span class="sourceLineNo">5474</span>        a[idx1 - 1] = x0i + x2i;<a name="line.5474"></a>
<span class="sourceLineNo">5475</span>        x0r = x1r + x3i;<a name="line.5475"></a>
<span class="sourceLineNo">5476</span>        x0i = x1i + x3r;<a name="line.5476"></a>
<span class="sourceLineNo">5477</span>        a[idx2 - 2] = wk1r * x0r - wk1i * x0i;<a name="line.5477"></a>
<span class="sourceLineNo">5478</span>        a[idx2 - 1] = wk1r * x0i + wk1i * x0r;<a name="line.5478"></a>
<span class="sourceLineNo">5479</span>        x0r = x1r - x3i;<a name="line.5479"></a>
<span class="sourceLineNo">5480</span>        x0i = x1i - x3r;<a name="line.5480"></a>
<span class="sourceLineNo">5481</span>        a[idx3 - 2] = wk3r * x0r + wk3i * x0i;<a name="line.5481"></a>
<span class="sourceLineNo">5482</span>        a[idx3 - 1] = wk3r * x0i - wk3i * x0r;<a name="line.5482"></a>
<span class="sourceLineNo">5483</span>        x0r = a[idx0] + a[idx2];<a name="line.5483"></a>
<span class="sourceLineNo">5484</span>        x0i = -a[idx0 + 1] - a[idx2 + 1];<a name="line.5484"></a>
<span class="sourceLineNo">5485</span>        x1r = a[idx0] - a[idx2];<a name="line.5485"></a>
<span class="sourceLineNo">5486</span>        x1i = -a[idx0 + 1] + a[idx2 + 1];<a name="line.5486"></a>
<span class="sourceLineNo">5487</span>        x2r = a[idx1] + a[idx3];<a name="line.5487"></a>
<span class="sourceLineNo">5488</span>        x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5488"></a>
<span class="sourceLineNo">5489</span>        x3r = a[idx1] - a[idx3];<a name="line.5489"></a>
<span class="sourceLineNo">5490</span>        x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5490"></a>
<span class="sourceLineNo">5491</span>        a[idx0] = x0r + x2r;<a name="line.5491"></a>
<span class="sourceLineNo">5492</span>        a[idx0 + 1] = x0i - x2i;<a name="line.5492"></a>
<span class="sourceLineNo">5493</span>        a[idx1] = x0r - x2r;<a name="line.5493"></a>
<span class="sourceLineNo">5494</span>        a[idx1 + 1] = x0i + x2i;<a name="line.5494"></a>
<span class="sourceLineNo">5495</span>        x0r = x1r + x3i;<a name="line.5495"></a>
<span class="sourceLineNo">5496</span>        x0i = x1i + x3r;<a name="line.5496"></a>
<span class="sourceLineNo">5497</span>        a[idx2] = wn4r * (x0r - x0i);<a name="line.5497"></a>
<span class="sourceLineNo">5498</span>        a[idx2 + 1] = wn4r * (x0i + x0r);<a name="line.5498"></a>
<span class="sourceLineNo">5499</span>        x0r = x1r - x3i;<a name="line.5499"></a>
<span class="sourceLineNo">5500</span>        x0i = x1i - x3r;<a name="line.5500"></a>
<span class="sourceLineNo">5501</span>        a[idx3] = -wn4r * (x0r + x0i);<a name="line.5501"></a>
<span class="sourceLineNo">5502</span>        a[idx3 + 1] = -wn4r * (x0i - x0r);<a name="line.5502"></a>
<span class="sourceLineNo">5503</span>        x0r = a[idx0 + 2] + a[idx2 + 2];<a name="line.5503"></a>
<span class="sourceLineNo">5504</span>        x0i = -a[idx0 + 3] - a[idx2 + 3];<a name="line.5504"></a>
<span class="sourceLineNo">5505</span>        x1r = a[idx0 + 2] - a[idx2 + 2];<a name="line.5505"></a>
<span class="sourceLineNo">5506</span>        x1i = -a[idx0 + 3] + a[idx2 + 3];<a name="line.5506"></a>
<span class="sourceLineNo">5507</span>        x2r = a[idx1 + 2] + a[idx3 + 2];<a name="line.5507"></a>
<span class="sourceLineNo">5508</span>        x2i = a[idx1 + 3] + a[idx3 + 3];<a name="line.5508"></a>
<span class="sourceLineNo">5509</span>        x3r = a[idx1 + 2] - a[idx3 + 2];<a name="line.5509"></a>
<span class="sourceLineNo">5510</span>        x3i = a[idx1 + 3] - a[idx3 + 3];<a name="line.5510"></a>
<span class="sourceLineNo">5511</span>        a[idx0 + 2] = x0r + x2r;<a name="line.5511"></a>
<span class="sourceLineNo">5512</span>        a[idx0 + 3] = x0i - x2i;<a name="line.5512"></a>
<span class="sourceLineNo">5513</span>        a[idx1 + 2] = x0r - x2r;<a name="line.5513"></a>
<span class="sourceLineNo">5514</span>        a[idx1 + 3] = x0i + x2i;<a name="line.5514"></a>
<span class="sourceLineNo">5515</span>        x0r = x1r + x3i;<a name="line.5515"></a>
<span class="sourceLineNo">5516</span>        x0i = x1i + x3r;<a name="line.5516"></a>
<span class="sourceLineNo">5517</span>        a[idx2 + 2] = wk1i * x0r - wk1r * x0i;<a name="line.5517"></a>
<span class="sourceLineNo">5518</span>        a[idx2 + 3] = wk1i * x0i + wk1r * x0r;<a name="line.5518"></a>
<span class="sourceLineNo">5519</span>        x0r = x1r - x3i;<a name="line.5519"></a>
<span class="sourceLineNo">5520</span>        x0i = x1i - x3r;<a name="line.5520"></a>
<span class="sourceLineNo">5521</span>        a[idx3 + 2] = wk3i * x0r + wk3r * x0i;<a name="line.5521"></a>
<span class="sourceLineNo">5522</span>        a[idx3 + 3] = wk3i * x0i - wk3r * x0r;<a name="line.5522"></a>
<span class="sourceLineNo">5523</span>    }<a name="line.5523"></a>
<span class="sourceLineNo">5524</span><a name="line.5524"></a>
<span class="sourceLineNo">5525</span>    private void cftrec4_th(final int n, final float[] a, final int offa, final int nw, final float[] w) {<a name="line.5525"></a>
<span class="sourceLineNo">5526</span>        int i;<a name="line.5526"></a>
<span class="sourceLineNo">5527</span>        int idiv4, m, nthreads;<a name="line.5527"></a>
<span class="sourceLineNo">5528</span>        int idx = 0;<a name="line.5528"></a>
<span class="sourceLineNo">5529</span>        nthreads = 2;<a name="line.5529"></a>
<span class="sourceLineNo">5530</span>        idiv4 = 0;<a name="line.5530"></a>
<span class="sourceLineNo">5531</span>        m = n &gt;&gt; 1;<a name="line.5531"></a>
<span class="sourceLineNo">5532</span>        if (n &gt; ConcurrencyUtils.getThreadsBeginN_1D_FFT_4Threads()) {<a name="line.5532"></a>
<span class="sourceLineNo">5533</span>            nthreads = 4;<a name="line.5533"></a>
<span class="sourceLineNo">5534</span>            idiv4 = 1;<a name="line.5534"></a>
<span class="sourceLineNo">5535</span>            m &gt;&gt;= 1;<a name="line.5535"></a>
<span class="sourceLineNo">5536</span>        }<a name="line.5536"></a>
<span class="sourceLineNo">5537</span>        Future&lt;?&gt;[] futures = new Future[nthreads];<a name="line.5537"></a>
<span class="sourceLineNo">5538</span>        final int mf = m;<a name="line.5538"></a>
<span class="sourceLineNo">5539</span>        for (i = 0; i &lt; nthreads; i++) {<a name="line.5539"></a>
<span class="sourceLineNo">5540</span>            final int firstIdx = offa + i * m;<a name="line.5540"></a>
<span class="sourceLineNo">5541</span>            if (i != idiv4) {<a name="line.5541"></a>
<span class="sourceLineNo">5542</span>                futures[idx++] = ConcurrencyUtils.submit(new Runnable() {<a name="line.5542"></a>
<span class="sourceLineNo">5543</span>                    @Override<a name="line.5543"></a>
<span class="sourceLineNo">5544</span>                                        public void run() {<a name="line.5544"></a>
<span class="sourceLineNo">5545</span>                        int isplt, j, k, m;<a name="line.5545"></a>
<span class="sourceLineNo">5546</span>                        int idx1 = firstIdx + mf;<a name="line.5546"></a>
<span class="sourceLineNo">5547</span>                        m = n;<a name="line.5547"></a>
<span class="sourceLineNo">5548</span>                        while (m &gt; 512) {<a name="line.5548"></a>
<span class="sourceLineNo">5549</span>                            m &gt;&gt;= 2;<a name="line.5549"></a>
<span class="sourceLineNo">5550</span>                            cftmdl1(m, a, idx1 - m, w, nw - (m &gt;&gt; 1));<a name="line.5550"></a>
<span class="sourceLineNo">5551</span>                        }<a name="line.5551"></a>
<span class="sourceLineNo">5552</span>                        cftleaf(m, 1, a, idx1 - m, nw, w);<a name="line.5552"></a>
<span class="sourceLineNo">5553</span>                        k = 0;<a name="line.5553"></a>
<span class="sourceLineNo">5554</span>                        int idx2 = firstIdx - m;<a name="line.5554"></a>
<span class="sourceLineNo">5555</span>                        for (j = mf - m; j &gt; 0; j -= m) {<a name="line.5555"></a>
<span class="sourceLineNo">5556</span>                            k++;<a name="line.5556"></a>
<span class="sourceLineNo">5557</span>                            isplt = cfttree(m, j, k, a, firstIdx, nw, w);<a name="line.5557"></a>
<span class="sourceLineNo">5558</span>                            cftleaf(m, isplt, a, idx2 + j, nw, w);<a name="line.5558"></a>
<span class="sourceLineNo">5559</span>                        }<a name="line.5559"></a>
<span class="sourceLineNo">5560</span>                    }<a name="line.5560"></a>
<span class="sourceLineNo">5561</span>                });<a name="line.5561"></a>
<span class="sourceLineNo">5562</span>            } else {<a name="line.5562"></a>
<span class="sourceLineNo">5563</span>                futures[idx++] = ConcurrencyUtils.submit(new Runnable() {<a name="line.5563"></a>
<span class="sourceLineNo">5564</span>                    @Override<a name="line.5564"></a>
<span class="sourceLineNo">5565</span>                                        public void run() {<a name="line.5565"></a>
<span class="sourceLineNo">5566</span>                        int isplt, j, k, m;<a name="line.5566"></a>
<span class="sourceLineNo">5567</span>                        int idx1 = firstIdx + mf;<a name="line.5567"></a>
<span class="sourceLineNo">5568</span>                        k = 1;<a name="line.5568"></a>
<span class="sourceLineNo">5569</span>                        m = n;<a name="line.5569"></a>
<span class="sourceLineNo">5570</span>                        while (m &gt; 512) {<a name="line.5570"></a>
<span class="sourceLineNo">5571</span>                            m &gt;&gt;= 2;<a name="line.5571"></a>
<span class="sourceLineNo">5572</span>                            k &lt;&lt;= 2;<a name="line.5572"></a>
<span class="sourceLineNo">5573</span>                            cftmdl2(m, a, idx1 - m, w, nw - m);<a name="line.5573"></a>
<span class="sourceLineNo">5574</span>                        }<a name="line.5574"></a>
<span class="sourceLineNo">5575</span>                        cftleaf(m, 0, a, idx1 - m, nw, w);<a name="line.5575"></a>
<span class="sourceLineNo">5576</span>                        k &gt;&gt;= 1;<a name="line.5576"></a>
<span class="sourceLineNo">5577</span>                        int idx2 = firstIdx - m;<a name="line.5577"></a>
<span class="sourceLineNo">5578</span>                        for (j = mf - m; j &gt; 0; j -= m) {<a name="line.5578"></a>
<span class="sourceLineNo">5579</span>                            k++;<a name="line.5579"></a>
<span class="sourceLineNo">5580</span>                            isplt = cfttree(m, j, k, a, firstIdx, nw, w);<a name="line.5580"></a>
<span class="sourceLineNo">5581</span>                            cftleaf(m, isplt, a, idx2 + j, nw, w);<a name="line.5581"></a>
<span class="sourceLineNo">5582</span>                        }<a name="line.5582"></a>
<span class="sourceLineNo">5583</span>                    }<a name="line.5583"></a>
<span class="sourceLineNo">5584</span>                });<a name="line.5584"></a>
<span class="sourceLineNo">5585</span>            }<a name="line.5585"></a>
<span class="sourceLineNo">5586</span>        }<a name="line.5586"></a>
<span class="sourceLineNo">5587</span>        ConcurrencyUtils.waitForCompletion(futures);<a name="line.5587"></a>
<span class="sourceLineNo">5588</span>    }<a name="line.5588"></a>
<span class="sourceLineNo">5589</span><a name="line.5589"></a>
<span class="sourceLineNo">5590</span>    private void cftrec4(int n, float[] a, int offa, int nw, float[] w) {<a name="line.5590"></a>
<span class="sourceLineNo">5591</span>        int isplt, j, k, m;<a name="line.5591"></a>
<span class="sourceLineNo">5592</span><a name="line.5592"></a>
<span class="sourceLineNo">5593</span>        m = n;<a name="line.5593"></a>
<span class="sourceLineNo">5594</span>        int idx1 = offa + n;<a name="line.5594"></a>
<span class="sourceLineNo">5595</span>        while (m &gt; 512) {<a name="line.5595"></a>
<span class="sourceLineNo">5596</span>            m &gt;&gt;= 2;<a name="line.5596"></a>
<span class="sourceLineNo">5597</span>            cftmdl1(m, a, idx1 - m, w, nw - (m &gt;&gt; 1));<a name="line.5597"></a>
<span class="sourceLineNo">5598</span>        }<a name="line.5598"></a>
<span class="sourceLineNo">5599</span>        cftleaf(m, 1, a, idx1 - m, nw, w);<a name="line.5599"></a>
<span class="sourceLineNo">5600</span>        k = 0;<a name="line.5600"></a>
<span class="sourceLineNo">5601</span>        int idx2 = offa - m;<a name="line.5601"></a>
<span class="sourceLineNo">5602</span>        for (j = n - m; j &gt; 0; j -= m) {<a name="line.5602"></a>
<span class="sourceLineNo">5603</span>            k++;<a name="line.5603"></a>
<span class="sourceLineNo">5604</span>            isplt = cfttree(m, j, k, a, offa, nw, w);<a name="line.5604"></a>
<span class="sourceLineNo">5605</span>            cftleaf(m, isplt, a, idx2 + j, nw, w);<a name="line.5605"></a>
<span class="sourceLineNo">5606</span>        }<a name="line.5606"></a>
<span class="sourceLineNo">5607</span>    }<a name="line.5607"></a>
<span class="sourceLineNo">5608</span><a name="line.5608"></a>
<span class="sourceLineNo">5609</span>    private int cfttree(int n, int j, int k, float[] a, int offa, int nw, float[] w) {<a name="line.5609"></a>
<span class="sourceLineNo">5610</span>        int i, isplt, m;<a name="line.5610"></a>
<span class="sourceLineNo">5611</span>        int idx1 = offa - n;<a name="line.5611"></a>
<span class="sourceLineNo">5612</span>        if ((k &amp; 3) != 0) {<a name="line.5612"></a>
<span class="sourceLineNo">5613</span>            isplt = k &amp; 1;<a name="line.5613"></a>
<span class="sourceLineNo">5614</span>            if (isplt != 0) {<a name="line.5614"></a>
<span class="sourceLineNo">5615</span>                cftmdl1(n, a, idx1 + j, w, nw - (n &gt;&gt; 1));<a name="line.5615"></a>
<span class="sourceLineNo">5616</span>            } else {<a name="line.5616"></a>
<span class="sourceLineNo">5617</span>                cftmdl2(n, a, idx1 + j, w, nw - n);<a name="line.5617"></a>
<span class="sourceLineNo">5618</span>            }<a name="line.5618"></a>
<span class="sourceLineNo">5619</span>        } else {<a name="line.5619"></a>
<span class="sourceLineNo">5620</span>            m = n;<a name="line.5620"></a>
<span class="sourceLineNo">5621</span>            for (i = k; (i &amp; 3) == 0; i &gt;&gt;= 2) {<a name="line.5621"></a>
<span class="sourceLineNo">5622</span>                m &lt;&lt;= 2;<a name="line.5622"></a>
<span class="sourceLineNo">5623</span>            }<a name="line.5623"></a>
<span class="sourceLineNo">5624</span>            isplt = i &amp; 1;<a name="line.5624"></a>
<span class="sourceLineNo">5625</span>            int idx2 = offa + j;<a name="line.5625"></a>
<span class="sourceLineNo">5626</span>            if (isplt != 0) {<a name="line.5626"></a>
<span class="sourceLineNo">5627</span>                while (m &gt; 128) {<a name="line.5627"></a>
<span class="sourceLineNo">5628</span>                    cftmdl1(m, a, idx2 - m, w, nw - (m &gt;&gt; 1));<a name="line.5628"></a>
<span class="sourceLineNo">5629</span>                    m &gt;&gt;= 2;<a name="line.5629"></a>
<span class="sourceLineNo">5630</span>                }<a name="line.5630"></a>
<span class="sourceLineNo">5631</span>            } else {<a name="line.5631"></a>
<span class="sourceLineNo">5632</span>                while (m &gt; 128) {<a name="line.5632"></a>
<span class="sourceLineNo">5633</span>                    cftmdl2(m, a, idx2 - m, w, nw - m);<a name="line.5633"></a>
<span class="sourceLineNo">5634</span>                    m &gt;&gt;= 2;<a name="line.5634"></a>
<span class="sourceLineNo">5635</span>                }<a name="line.5635"></a>
<span class="sourceLineNo">5636</span>            }<a name="line.5636"></a>
<span class="sourceLineNo">5637</span>        }<a name="line.5637"></a>
<span class="sourceLineNo">5638</span>        return isplt;<a name="line.5638"></a>
<span class="sourceLineNo">5639</span>    }<a name="line.5639"></a>
<span class="sourceLineNo">5640</span><a name="line.5640"></a>
<span class="sourceLineNo">5641</span>    private void cftleaf(int n, int isplt, float[] a, int offa, int nw, float[] w) {<a name="line.5641"></a>
<span class="sourceLineNo">5642</span>        if (n == 512) {<a name="line.5642"></a>
<span class="sourceLineNo">5643</span>            cftmdl1(128, a, offa, w, nw - 64);<a name="line.5643"></a>
<span class="sourceLineNo">5644</span>            cftf161(a, offa, w, nw - 8);<a name="line.5644"></a>
<span class="sourceLineNo">5645</span>            cftf162(a, offa + 32, w, nw - 32);<a name="line.5645"></a>
<span class="sourceLineNo">5646</span>            cftf161(a, offa + 64, w, nw - 8);<a name="line.5646"></a>
<span class="sourceLineNo">5647</span>            cftf161(a, offa + 96, w, nw - 8);<a name="line.5647"></a>
<span class="sourceLineNo">5648</span>            cftmdl2(128, a, offa + 128, w, nw - 128);<a name="line.5648"></a>
<span class="sourceLineNo">5649</span>            cftf161(a, offa + 128, w, nw - 8);<a name="line.5649"></a>
<span class="sourceLineNo">5650</span>            cftf162(a, offa + 160, w, nw - 32);<a name="line.5650"></a>
<span class="sourceLineNo">5651</span>            cftf161(a, offa + 192, w, nw - 8);<a name="line.5651"></a>
<span class="sourceLineNo">5652</span>            cftf162(a, offa + 224, w, nw - 32);<a name="line.5652"></a>
<span class="sourceLineNo">5653</span>            cftmdl1(128, a, offa + 256, w, nw - 64);<a name="line.5653"></a>
<span class="sourceLineNo">5654</span>            cftf161(a, offa + 256, w, nw - 8);<a name="line.5654"></a>
<span class="sourceLineNo">5655</span>            cftf162(a, offa + 288, w, nw - 32);<a name="line.5655"></a>
<span class="sourceLineNo">5656</span>            cftf161(a, offa + 320, w, nw - 8);<a name="line.5656"></a>
<span class="sourceLineNo">5657</span>            cftf161(a, offa + 352, w, nw - 8);<a name="line.5657"></a>
<span class="sourceLineNo">5658</span>            if (isplt != 0) {<a name="line.5658"></a>
<span class="sourceLineNo">5659</span>                cftmdl1(128, a, offa + 384, w, nw - 64);<a name="line.5659"></a>
<span class="sourceLineNo">5660</span>                cftf161(a, offa + 480, w, nw - 8);<a name="line.5660"></a>
<span class="sourceLineNo">5661</span>            } else {<a name="line.5661"></a>
<span class="sourceLineNo">5662</span>                cftmdl2(128, a, offa + 384, w, nw - 128);<a name="line.5662"></a>
<span class="sourceLineNo">5663</span>                cftf162(a, offa + 480, w, nw - 32);<a name="line.5663"></a>
<span class="sourceLineNo">5664</span>            }<a name="line.5664"></a>
<span class="sourceLineNo">5665</span>            cftf161(a, offa + 384, w, nw - 8);<a name="line.5665"></a>
<span class="sourceLineNo">5666</span>            cftf162(a, offa + 416, w, nw - 32);<a name="line.5666"></a>
<span class="sourceLineNo">5667</span>            cftf161(a, offa + 448, w, nw - 8);<a name="line.5667"></a>
<span class="sourceLineNo">5668</span>        } else {<a name="line.5668"></a>
<span class="sourceLineNo">5669</span>            cftmdl1(64, a, offa, w, nw - 32);<a name="line.5669"></a>
<span class="sourceLineNo">5670</span>            cftf081(a, offa, w, nw - 8);<a name="line.5670"></a>
<span class="sourceLineNo">5671</span>            cftf082(a, offa + 16, w, nw - 8);<a name="line.5671"></a>
<span class="sourceLineNo">5672</span>            cftf081(a, offa + 32, w, nw - 8);<a name="line.5672"></a>
<span class="sourceLineNo">5673</span>            cftf081(a, offa + 48, w, nw - 8);<a name="line.5673"></a>
<span class="sourceLineNo">5674</span>            cftmdl2(64, a, offa + 64, w, nw - 64);<a name="line.5674"></a>
<span class="sourceLineNo">5675</span>            cftf081(a, offa + 64, w, nw - 8);<a name="line.5675"></a>
<span class="sourceLineNo">5676</span>            cftf082(a, offa + 80, w, nw - 8);<a name="line.5676"></a>
<span class="sourceLineNo">5677</span>            cftf081(a, offa + 96, w, nw - 8);<a name="line.5677"></a>
<span class="sourceLineNo">5678</span>            cftf082(a, offa + 112, w, nw - 8);<a name="line.5678"></a>
<span class="sourceLineNo">5679</span>            cftmdl1(64, a, offa + 128, w, nw - 32);<a name="line.5679"></a>
<span class="sourceLineNo">5680</span>            cftf081(a, offa + 128, w, nw - 8);<a name="line.5680"></a>
<span class="sourceLineNo">5681</span>            cftf082(a, offa + 144, w, nw - 8);<a name="line.5681"></a>
<span class="sourceLineNo">5682</span>            cftf081(a, offa + 160, w, nw - 8);<a name="line.5682"></a>
<span class="sourceLineNo">5683</span>            cftf081(a, offa + 176, w, nw - 8);<a name="line.5683"></a>
<span class="sourceLineNo">5684</span>            if (isplt != 0) {<a name="line.5684"></a>
<span class="sourceLineNo">5685</span>                cftmdl1(64, a, offa + 192, w, nw - 32);<a name="line.5685"></a>
<span class="sourceLineNo">5686</span>                cftf081(a, offa + 240, w, nw - 8);<a name="line.5686"></a>
<span class="sourceLineNo">5687</span>            } else {<a name="line.5687"></a>
<span class="sourceLineNo">5688</span>                cftmdl2(64, a, offa + 192, w, nw - 64);<a name="line.5688"></a>
<span class="sourceLineNo">5689</span>                cftf082(a, offa + 240, w, nw - 8);<a name="line.5689"></a>
<span class="sourceLineNo">5690</span>            }<a name="line.5690"></a>
<span class="sourceLineNo">5691</span>            cftf081(a, offa + 192, w, nw - 8);<a name="line.5691"></a>
<span class="sourceLineNo">5692</span>            cftf082(a, offa + 208, w, nw - 8);<a name="line.5692"></a>
<span class="sourceLineNo">5693</span>            cftf081(a, offa + 224, w, nw - 8);<a name="line.5693"></a>
<span class="sourceLineNo">5694</span>        }<a name="line.5694"></a>
<span class="sourceLineNo">5695</span>    }<a name="line.5695"></a>
<span class="sourceLineNo">5696</span><a name="line.5696"></a>
<span class="sourceLineNo">5697</span>    private void cftmdl1(int n, float[] a, int offa, float[] w, int startw) {<a name="line.5697"></a>
<span class="sourceLineNo">5698</span>        int j0, j1, j2, j3, k, m, mh;<a name="line.5698"></a>
<span class="sourceLineNo">5699</span>        float wn4r, wk1r, wk1i, wk3r, wk3i;<a name="line.5699"></a>
<span class="sourceLineNo">5700</span>        float x0r, x0i, x1r, x1i, x2r, x2i, x3r, x3i;<a name="line.5700"></a>
<span class="sourceLineNo">5701</span>        int idx0, idx1, idx2, idx3, idx4, idx5;<a name="line.5701"></a>
<span class="sourceLineNo">5702</span><a name="line.5702"></a>
<span class="sourceLineNo">5703</span>        mh = n &gt;&gt; 3;<a name="line.5703"></a>
<span class="sourceLineNo">5704</span>        m = 2 * mh;<a name="line.5704"></a>
<span class="sourceLineNo">5705</span>        j1 = m;<a name="line.5705"></a>
<span class="sourceLineNo">5706</span>        j2 = j1 + m;<a name="line.5706"></a>
<span class="sourceLineNo">5707</span>        j3 = j2 + m;<a name="line.5707"></a>
<span class="sourceLineNo">5708</span>        idx1 = offa + j1;<a name="line.5708"></a>
<span class="sourceLineNo">5709</span>        idx2 = offa + j2;<a name="line.5709"></a>
<span class="sourceLineNo">5710</span>        idx3 = offa + j3;<a name="line.5710"></a>
<span class="sourceLineNo">5711</span>        x0r = a[offa] + a[idx2];<a name="line.5711"></a>
<span class="sourceLineNo">5712</span>        x0i = a[offa + 1] + a[idx2 + 1];<a name="line.5712"></a>
<span class="sourceLineNo">5713</span>        x1r = a[offa] - a[idx2];<a name="line.5713"></a>
<span class="sourceLineNo">5714</span>        x1i = a[offa + 1] - a[idx2 + 1];<a name="line.5714"></a>
<span class="sourceLineNo">5715</span>        x2r = a[idx1] + a[idx3];<a name="line.5715"></a>
<span class="sourceLineNo">5716</span>        x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5716"></a>
<span class="sourceLineNo">5717</span>        x3r = a[idx1] - a[idx3];<a name="line.5717"></a>
<span class="sourceLineNo">5718</span>        x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5718"></a>
<span class="sourceLineNo">5719</span>        a[offa] = x0r + x2r;<a name="line.5719"></a>
<span class="sourceLineNo">5720</span>        a[offa + 1] = x0i + x2i;<a name="line.5720"></a>
<span class="sourceLineNo">5721</span>        a[idx1] = x0r - x2r;<a name="line.5721"></a>
<span class="sourceLineNo">5722</span>        a[idx1 + 1] = x0i - x2i;<a name="line.5722"></a>
<span class="sourceLineNo">5723</span>        a[idx2] = x1r - x3i;<a name="line.5723"></a>
<span class="sourceLineNo">5724</span>        a[idx2 + 1] = x1i + x3r;<a name="line.5724"></a>
<span class="sourceLineNo">5725</span>        a[idx3] = x1r + x3i;<a name="line.5725"></a>
<span class="sourceLineNo">5726</span>        a[idx3 + 1] = x1i - x3r;<a name="line.5726"></a>
<span class="sourceLineNo">5727</span>        wn4r = w[startw + 1];<a name="line.5727"></a>
<span class="sourceLineNo">5728</span>        k = 0;<a name="line.5728"></a>
<span class="sourceLineNo">5729</span>        for (int j = 2; j &lt; mh; j += 2) {<a name="line.5729"></a>
<span class="sourceLineNo">5730</span>            k += 4;<a name="line.5730"></a>
<span class="sourceLineNo">5731</span>            idx4 = startw + k;<a name="line.5731"></a>
<span class="sourceLineNo">5732</span>            wk1r = w[idx4];<a name="line.5732"></a>
<span class="sourceLineNo">5733</span>            wk1i = w[idx4 + 1];<a name="line.5733"></a>
<span class="sourceLineNo">5734</span>            wk3r = w[idx4 + 2];<a name="line.5734"></a>
<span class="sourceLineNo">5735</span>            wk3i = w[idx4 + 3];<a name="line.5735"></a>
<span class="sourceLineNo">5736</span>            j1 = j + m;<a name="line.5736"></a>
<span class="sourceLineNo">5737</span>            j2 = j1 + m;<a name="line.5737"></a>
<span class="sourceLineNo">5738</span>            j3 = j2 + m;<a name="line.5738"></a>
<span class="sourceLineNo">5739</span>            idx1 = offa + j1;<a name="line.5739"></a>
<span class="sourceLineNo">5740</span>            idx2 = offa + j2;<a name="line.5740"></a>
<span class="sourceLineNo">5741</span>            idx3 = offa + j3;<a name="line.5741"></a>
<span class="sourceLineNo">5742</span>            idx5 = offa + j;<a name="line.5742"></a>
<span class="sourceLineNo">5743</span>            x0r = a[idx5] + a[idx2];<a name="line.5743"></a>
<span class="sourceLineNo">5744</span>            x0i = a[idx5 + 1] + a[idx2 + 1];<a name="line.5744"></a>
<span class="sourceLineNo">5745</span>            x1r = a[idx5] - a[idx2];<a name="line.5745"></a>
<span class="sourceLineNo">5746</span>            x1i = a[idx5 + 1] - a[idx2 + 1];<a name="line.5746"></a>
<span class="sourceLineNo">5747</span>            x2r = a[idx1] + a[idx3];<a name="line.5747"></a>
<span class="sourceLineNo">5748</span>            x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5748"></a>
<span class="sourceLineNo">5749</span>            x3r = a[idx1] - a[idx3];<a name="line.5749"></a>
<span class="sourceLineNo">5750</span>            x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5750"></a>
<span class="sourceLineNo">5751</span>            a[idx5] = x0r + x2r;<a name="line.5751"></a>
<span class="sourceLineNo">5752</span>            a[idx5 + 1] = x0i + x2i;<a name="line.5752"></a>
<span class="sourceLineNo">5753</span>            a[idx1] = x0r - x2r;<a name="line.5753"></a>
<span class="sourceLineNo">5754</span>            a[idx1 + 1] = x0i - x2i;<a name="line.5754"></a>
<span class="sourceLineNo">5755</span>            x0r = x1r - x3i;<a name="line.5755"></a>
<span class="sourceLineNo">5756</span>            x0i = x1i + x3r;<a name="line.5756"></a>
<span class="sourceLineNo">5757</span>            a[idx2] = wk1r * x0r - wk1i * x0i;<a name="line.5757"></a>
<span class="sourceLineNo">5758</span>            a[idx2 + 1] = wk1r * x0i + wk1i * x0r;<a name="line.5758"></a>
<span class="sourceLineNo">5759</span>            x0r = x1r + x3i;<a name="line.5759"></a>
<span class="sourceLineNo">5760</span>            x0i = x1i - x3r;<a name="line.5760"></a>
<span class="sourceLineNo">5761</span>            a[idx3] = wk3r * x0r + wk3i * x0i;<a name="line.5761"></a>
<span class="sourceLineNo">5762</span>            a[idx3 + 1] = wk3r * x0i - wk3i * x0r;<a name="line.5762"></a>
<span class="sourceLineNo">5763</span>            j0 = m - j;<a name="line.5763"></a>
<span class="sourceLineNo">5764</span>            j1 = j0 + m;<a name="line.5764"></a>
<span class="sourceLineNo">5765</span>            j2 = j1 + m;<a name="line.5765"></a>
<span class="sourceLineNo">5766</span>            j3 = j2 + m;<a name="line.5766"></a>
<span class="sourceLineNo">5767</span>            idx0 = offa + j0;<a name="line.5767"></a>
<span class="sourceLineNo">5768</span>            idx1 = offa + j1;<a name="line.5768"></a>
<span class="sourceLineNo">5769</span>            idx2 = offa + j2;<a name="line.5769"></a>
<span class="sourceLineNo">5770</span>            idx3 = offa + j3;<a name="line.5770"></a>
<span class="sourceLineNo">5771</span>            x0r = a[idx0] + a[idx2];<a name="line.5771"></a>
<span class="sourceLineNo">5772</span>            x0i = a[idx0 + 1] + a[idx2 + 1];<a name="line.5772"></a>
<span class="sourceLineNo">5773</span>            x1r = a[idx0] - a[idx2];<a name="line.5773"></a>
<span class="sourceLineNo">5774</span>            x1i = a[idx0 + 1] - a[idx2 + 1];<a name="line.5774"></a>
<span class="sourceLineNo">5775</span>            x2r = a[idx1] + a[idx3];<a name="line.5775"></a>
<span class="sourceLineNo">5776</span>            x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5776"></a>
<span class="sourceLineNo">5777</span>            x3r = a[idx1] - a[idx3];<a name="line.5777"></a>
<span class="sourceLineNo">5778</span>            x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5778"></a>
<span class="sourceLineNo">5779</span>            a[idx0] = x0r + x2r;<a name="line.5779"></a>
<span class="sourceLineNo">5780</span>            a[idx0 + 1] = x0i + x2i;<a name="line.5780"></a>
<span class="sourceLineNo">5781</span>            a[idx1] = x0r - x2r;<a name="line.5781"></a>
<span class="sourceLineNo">5782</span>            a[idx1 + 1] = x0i - x2i;<a name="line.5782"></a>
<span class="sourceLineNo">5783</span>            x0r = x1r - x3i;<a name="line.5783"></a>
<span class="sourceLineNo">5784</span>            x0i = x1i + x3r;<a name="line.5784"></a>
<span class="sourceLineNo">5785</span>            a[idx2] = wk1i * x0r - wk1r * x0i;<a name="line.5785"></a>
<span class="sourceLineNo">5786</span>            a[idx2 + 1] = wk1i * x0i + wk1r * x0r;<a name="line.5786"></a>
<span class="sourceLineNo">5787</span>            x0r = x1r + x3i;<a name="line.5787"></a>
<span class="sourceLineNo">5788</span>            x0i = x1i - x3r;<a name="line.5788"></a>
<span class="sourceLineNo">5789</span>            a[idx3] = wk3i * x0r + wk3r * x0i;<a name="line.5789"></a>
<span class="sourceLineNo">5790</span>            a[idx3 + 1] = wk3i * x0i - wk3r * x0r;<a name="line.5790"></a>
<span class="sourceLineNo">5791</span>        }<a name="line.5791"></a>
<span class="sourceLineNo">5792</span>        j0 = mh;<a name="line.5792"></a>
<span class="sourceLineNo">5793</span>        j1 = j0 + m;<a name="line.5793"></a>
<span class="sourceLineNo">5794</span>        j2 = j1 + m;<a name="line.5794"></a>
<span class="sourceLineNo">5795</span>        j3 = j2 + m;<a name="line.5795"></a>
<span class="sourceLineNo">5796</span>        idx0 = offa + j0;<a name="line.5796"></a>
<span class="sourceLineNo">5797</span>        idx1 = offa + j1;<a name="line.5797"></a>
<span class="sourceLineNo">5798</span>        idx2 = offa + j2;<a name="line.5798"></a>
<span class="sourceLineNo">5799</span>        idx3 = offa + j3;<a name="line.5799"></a>
<span class="sourceLineNo">5800</span>        x0r = a[idx0] + a[idx2];<a name="line.5800"></a>
<span class="sourceLineNo">5801</span>        x0i = a[idx0 + 1] + a[idx2 + 1];<a name="line.5801"></a>
<span class="sourceLineNo">5802</span>        x1r = a[idx0] - a[idx2];<a name="line.5802"></a>
<span class="sourceLineNo">5803</span>        x1i = a[idx0 + 1] - a[idx2 + 1];<a name="line.5803"></a>
<span class="sourceLineNo">5804</span>        x2r = a[idx1] + a[idx3];<a name="line.5804"></a>
<span class="sourceLineNo">5805</span>        x2i = a[idx1 + 1] + a[idx3 + 1];<a name="line.5805"></a>
<span class="sourceLineNo">5806</span>        x3r = a[idx1] - a[idx3];<a name="line.5806"></a>
<span class="sourceLineNo">5807</span>        x3i = a[idx1 + 1] - a[idx3 + 1];<a name="line.5807"></a>
<span class="sourceLineNo">5808</span>        a[idx0] = x0r + x2r;<a name="line.5808"></a>
<span class="sourceLineNo">5809</span>        a[idx0 + 1] = x0i + x2i;<a name="line.5809"></a>
<span class="sourceLineNo">5810</span>        a[idx1] = x0r - x2r;<a name="line.5810"></a>
<span class="sourceLineNo">5811</span>        a[idx1 + 1] = x0i - x2i;<a name="line.5811"></a>
<span class="sourceLineNo">5812</span>        x0r = x1r - x3i;<a name="line.5812"></a>
<span class="sourceLineNo">5813</span>        x0i = x1i + x3r;<a name="line.5813"></a>
<span class="sourceLineNo">5814</span>        a[idx2] = wn4r * (x0r - x0i);<a name="line.5814"></a>
<span class="sourceLineNo">5815</span>        a[idx2 + 1] = wn4r * (x0i + x0r);<a name="line.5815"></a>
<span class="sourceLineNo">5816</span>        x0r = x1r + x3i;<a name="line.5816"></a>
<span class="sourceLineNo">5817</span>        x0i = x1i - x3r;<a name="line.5817"></a>
<span class="sourceLineNo">5818</span>        a[idx3] = -wn4r * (x0r + x0i);<a name="line.5818"></a>
<span class="sourceLineNo">5819</span>        a[idx3 + 1] = -wn4r * (x0i - x0r);<a name="line.5819"></a>
<span class="sourceLineNo">5820</span>    }<a name="line.5820"></a>
<span class="sourceLineNo">5821</span><a name="line.5821"></a>
<span class="sourceLineNo">5822</span>    private void cftmdl2(int n, float[] a, int offa, float[] w, int startw) {<a name="line.5822"></a>
<span class="sourceLineNo">5823</span>        int j0, j1, j2, j3, k, kr, m, mh;<a name="line.5823"></a>
<span class="sourceLineNo">5824</span>        float wn4r, wk1r, wk1i, wk3r, wk3i, wd1r, wd1i, wd3r, wd3i;<a name="line.5824"></a>
<span class="sourceLineNo">5825</span>        float x0r, x0i, x1r, x1i, x2r, x2i, x3r, x3i, y0r, y0i, y2r, y2i;<a name="line.5825"></a>
<span class="sourceLineNo">5826</span>        int idx0, idx1, idx2, idx3, idx4, idx5, idx6;<a name="line.5826"></a>
<span class="sourceLineNo">5827</span><a name="line.5827"></a>
<span class="sourceLineNo">5828</span>        mh = n &gt;&gt; 3;<a name="line.5828"></a>
<span class="sourceLineNo">5829</span>        m = 2 * mh;<a name="line.5829"></a>
<span class="sourceLineNo">5830</span>        wn4r = w[startw + 1];<a name="line.5830"></a>
<span class="sourceLineNo">5831</span>        j1 = m;<a name="line.5831"></a>
<span class="sourceLineNo">5832</span>        j2 = j1 + m;<a name="line.5832"></a>
<span class="sourceLineNo">5833</span>        j3 = j2 + m;<a name="line.5833"></a>
<span class="sourceLineNo">5834</span>        idx1 = offa + j1;<a name="line.5834"></a>
<span class="sourceLineNo">5835</span>        idx2 = offa + j2;<a name="line.5835"></a>
<span class="sourceLineNo">5836</span>        idx3 = offa + j3;<a name="line.5836"></a>
<span class="sourceLineNo">5837</span>        x0r = a[offa] - a[idx2 + 1];<a name="line.5837"></a>
<span class="sourceLineNo">5838</span>        x0i = a[offa + 1] + a[idx2];<a name="line.5838"></a>
<span class="sourceLineNo">5839</span>        x1r = a[offa] + a[idx2 + 1];<a name="line.5839"></a>
<span class="sourceLineNo">5840</span>        x1i = a[offa + 1] - a[idx2];<a name="line.5840"></a>
<span class="sourceLineNo">5841</span>        x2r = a[idx1] - a[idx3 + 1];<a name="line.5841"></a>
<span class="sourceLineNo">5842</span>        x2i = a[idx1 + 1] + a[idx3];<a name="line.5842"></a>
<span class="sourceLineNo">5843</span>        x3r = a[idx1] + a[idx3 + 1];<a name="line.5843"></a>
<span class="sourceLineNo">5844</span>        x3i = a[idx1 + 1] - a[idx3];<a name="line.5844"></a>
<span class="sourceLineNo">5845</span>        y0r = wn4r * (x2r - x2i);<a name="line.5845"></a>
<span class="sourceLineNo">5846</span>        y0i = wn4r * (x2i + x2r);<a name="line.5846"></a>
<span class="sourceLineNo">5847</span>        a[offa] = x0r + y0r;<a name="line.5847"></a>
<span class="sourceLineNo">5848</span>        a[offa + 1] = x0i + y0i;<a name="line.5848"></a>
<span class="sourceLineNo">5849</span>        a[idx1] = x0r - y0r;<a name="line.5849"></a>
<span class="sourceLineNo">5850</span>        a[idx1 + 1] = x0i - y0i;<a name="line.5850"></a>
<span class="sourceLineNo">5851</span>        y0r = wn4r * (x3r - x3i);<a name="line.5851"></a>
<span class="sourceLineNo">5852</span>        y0i = wn4r * (x3i + x3r);<a name="line.5852"></a>
<span class="sourceLineNo">5853</span>        a[idx2] = x1r - y0i;<a name="line.5853"></a>
<span class="sourceLineNo">5854</span>        a[idx2 + 1] = x1i + y0r;<a name="line.5854"></a>
<span class="sourceLineNo">5855</span>        a[idx3] = x1r + y0i;<a name="line.5855"></a>
<span class="sourceLineNo">5856</span>        a[idx3 + 1] = x1i - y0r;<a name="line.5856"></a>
<span class="sourceLineNo">5857</span>        k = 0;<a name="line.5857"></a>
<span class="sourceLineNo">5858</span>        kr = 2 * m;<a name="line.5858"></a>
<span class="sourceLineNo">5859</span>        for (int j = 2; j &lt; mh; j += 2) {<a name="line.5859"></a>
<span class="sourceLineNo">5860</span>            k += 4;<a name="line.5860"></a>
<span class="sourceLineNo">5861</span>            idx4 = startw + k;<a name="line.5861"></a>
<span class="sourceLineNo">5862</span>            wk1r = w[idx4];<a name="line.5862"></a>
<span class="sourceLineNo">5863</span>            wk1i = w[idx4 + 1];<a name="line.5863"></a>
<span class="sourceLineNo">5864</span>            wk3r = w[idx4 + 2];<a name="line.5864"></a>
<span class="sourceLineNo">5865</span>            wk3i = w[idx4 + 3];<a name="line.5865"></a>
<span class="sourceLineNo">5866</span>            kr -= 4;<a name="line.5866"></a>
<span class="sourceLineNo">5867</span>            idx5 = startw + kr;<a name="line.5867"></a>
<span class="sourceLineNo">5868</span>            wd1i = w[idx5];<a name="line.5868"></a>
<span class="sourceLineNo">5869</span>            wd1r = w[idx5 + 1];<a name="line.5869"></a>
<span class="sourceLineNo">5870</span>            wd3i = w[idx5 + 2];<a name="line.5870"></a>
<span class="sourceLineNo">5871</span>            wd3r = w[idx5 + 3];<a name="line.5871"></a>
<span class="sourceLineNo">5872</span>            j1 = j + m;<a name="line.5872"></a>
<span class="sourceLineNo">5873</span>            j2 = j1 + m;<a name="line.5873"></a>
<span class="sourceLineNo">5874</span>            j3 = j2 + m;<a name="line.5874"></a>
<span class="sourceLineNo">5875</span>            idx1 = offa + j1;<a name="line.5875"></a>
<span class="sourceLineNo">5876</span>            idx2 = offa + j2;<a name="line.5876"></a>
<span class="sourceLineNo">5877</span>            idx3 = offa + j3;<a name="line.5877"></a>
<span class="sourceLineNo">5878</span>            idx6 = offa + j;<a name="line.5878"></a>
<span class="sourceLineNo">5879</span>            x0r = a[idx6] - a[idx2 + 1];<a name="line.5879"></a>
<span class="sourceLineNo">5880</span>            x0i = a[idx6 + 1] + a[idx2];<a name="line.5880"></a>
<span class="sourceLineNo">5881</span>            x1r = a[idx6] + a[idx2 + 1];<a name="line.5881"></a>
<span class="sourceLineNo">5882</span>            x1i = a[idx6 + 1] - a[idx2];<a name="line.5882"></a>
<span class="sourceLineNo">5883</span>            x2r = a[idx1] - a[idx3 + 1];<a name="line.5883"></a>
<span class="sourceLineNo">5884</span>            x2i = a[idx1 + 1] + a[idx3];<a name="line.5884"></a>
<span class="sourceLineNo">5885</span>            x3r = a[idx1] + a[idx3 + 1];<a name="line.5885"></a>
<span class="sourceLineNo">5886</span>            x3i = a[idx1 + 1] - a[idx3];<a name="line.5886"></a>
<span class="sourceLineNo">5887</span>            y0r = wk1r * x0r - wk1i * x0i;<a name="line.5887"></a>
<span class="sourceLineNo">5888</span>            y0i = wk1r * x0i + wk1i * x0r;<a name="line.5888"></a>
<span class="sourceLineNo">5889</span>            y2r = wd1r * x2r - wd1i * x2i;<a name="line.5889"></a>
<span class="sourceLineNo">5890</span>            y2i = wd1r * x2i + wd1i * x2r;<a name="line.5890"></a>
<span class="sourceLineNo">5891</span>            a[idx6] = y0r + y2r;<a name="line.5891"></a>
<span class="sourceLineNo">5892</span>            a[idx6 + 1] = y0i + y2i;<a name="line.5892"></a>
<span class="sourceLineNo">5893</span>            a[idx1] = y0r - y2r;<a name="line.5893"></a>
<span class="sourceLineNo">5894</span>            a[idx1 + 1] = y0i - y2i;<a name="line.5894"></a>
<span class="sourceLineNo">5895</span>            y0r = wk3r * x1r + wk3i * x1i;<a name="line.5895"></a>
<span class="sourceLineNo">5896</span>            y0i = wk3r * x1i - wk3i * x1r;<a name="line.5896"></a>
<span class="sourceLineNo">5897</span>            y2r = wd3r * x3r + wd3i * x3i;<a name="line.5897"></a>
<span class="sourceLineNo">5898</span>            y2i = wd3r * x3i - wd3i * x3r;<a name="line.5898"></a>
<span class="sourceLineNo">5899</span>            a[idx2] = y0r + y2r;<a name="line.5899"></a>
<span class="sourceLineNo">5900</span>            a[idx2 + 1] = y0i + y2i;<a name="line.5900"></a>
<span class="sourceLineNo">5901</span>            a[idx3] = y0r - y2r;<a name="line.5901"></a>
<span class="sourceLineNo">5902</span>            a[idx3 + 1] = y0i - y2i;<a name="line.5902"></a>
<span class="sourceLineNo">5903</span>            j0 = m - j;<a name="line.5903"></a>
<span class="sourceLineNo">5904</span>            j1 = j0 + m;<a name="line.5904"></a>
<span class="sourceLineNo">5905</span>            j2 = j1 + m;<a name="line.5905"></a>
<span class="sourceLineNo">5906</span>            j3 = j2 + m;<a name="line.5906"></a>
<span class="sourceLineNo">5907</span>            idx0 = offa + j0;<a name="line.5907"></a>
<span class="sourceLineNo">5908</span>            idx1 = offa + j1;<a name="line.5908"></a>
<span class="sourceLineNo">5909</span>            idx2 = offa + j2;<a name="line.5909"></a>
<span class="sourceLineNo">5910</span>            idx3 = offa + j3;<a name="line.5910"></a>
<span class="sourceLineNo">5911</span>            x0r = a[idx0] - a[idx2 + 1];<a name="line.5911"></a>
<span class="sourceLineNo">5912</span>            x0i = a[idx0 + 1] + a[idx2];<a name="line.5912"></a>
<span class="sourceLineNo">5913</span>            x1r = a[idx0] + a[idx2 + 1];<a name="line.5913"></a>
<span class="sourceLineNo">5914</span>            x1i = a[idx0 + 1] - a[idx2];<a name="line.5914"></a>
<span class="sourceLineNo">5915</span>            x2r = a[idx1] - a[idx3 + 1];<a name="line.5915"></a>
<span class="sourceLineNo">5916</span>            x2i = a[idx1 + 1] + a[idx3];<a name="line.5916"></a>
<span class="sourceLineNo">5917</span>            x3r = a[idx1] + a[idx3 + 1];<a name="line.5917"></a>
<span class="sourceLineNo">5918</span>            x3i = a[idx1 + 1] - a[idx3];<a name="line.5918"></a>
<span class="sourceLineNo">5919</span>            y0r = wd1i * x0r - wd1r * x0i;<a name="line.5919"></a>
<span class="sourceLineNo">5920</span>            y0i = wd1i * x0i + wd1r * x0r;<a name="line.5920"></a>
<span class="sourceLineNo">5921</span>            y2r = wk1i * x2r - wk1r * x2i;<a name="line.5921"></a>
<span class="sourceLineNo">5922</span>            y2i = wk1i * x2i + wk1r * x2r;<a name="line.5922"></a>
<span class="sourceLineNo">5923</span>            a[idx0] = y0r + y2r;<a name="line.5923"></a>
<span class="sourceLineNo">5924</span>            a[idx0 + 1] = y0i + y2i;<a name="line.5924"></a>
<span class="sourceLineNo">5925</span>            a[idx1] = y0r - y2r;<a name="line.5925"></a>
<span class="sourceLineNo">5926</span>            a[idx1 + 1] = y0i - y2i;<a name="line.5926"></a>
<span class="sourceLineNo">5927</span>            y0r = wd3i * x1r + wd3r * x1i;<a name="line.5927"></a>
<span class="sourceLineNo">5928</span>            y0i = wd3i * x1i - wd3r * x1r;<a name="line.5928"></a>
<span class="sourceLineNo">5929</span>            y2r = wk3i * x3r + wk3r * x3i;<a name="line.5929"></a>
<span class="sourceLineNo">5930</span>            y2i = wk3i * x3i - wk3r * x3r;<a name="line.5930"></a>
<span class="sourceLineNo">5931</span>            a[idx2] = y0r + y2r;<a name="line.5931"></a>
<span class="sourceLineNo">5932</span>            a[idx2 + 1] = y0i + y2i;<a name="line.5932"></a>
<span class="sourceLineNo">5933</span>            a[idx3] = y0r - y2r;<a name="line.5933"></a>
<span class="sourceLineNo">5934</span>            a[idx3 + 1] = y0i - y2i;<a name="line.5934"></a>
<span class="sourceLineNo">5935</span>        }<a name="line.5935"></a>
<span class="sourceLineNo">5936</span>        wk1r = w[startw + m];<a name="line.5936"></a>
<span class="sourceLineNo">5937</span>        wk1i = w[startw + m + 1];<a name="line.5937"></a>
<span class="sourceLineNo">5938</span>        j0 = mh;<a name="line.5938"></a>
<span class="sourceLineNo">5939</span>        j1 = j0 + m;<a name="line.5939"></a>
<span class="sourceLineNo">5940</span>        j2 = j1 + m;<a name="line.5940"></a>
<span class="sourceLineNo">5941</span>        j3 = j2 + m;<a name="line.5941"></a>
<span class="sourceLineNo">5942</span>        idx0 = offa + j0;<a name="line.5942"></a>
<span class="sourceLineNo">5943</span>        idx1 = offa + j1;<a name="line.5943"></a>
<span class="sourceLineNo">5944</span>        idx2 = offa + j2;<a name="line.5944"></a>
<span class="sourceLineNo">5945</span>        idx3 = offa + j3;<a name="line.5945"></a>
<span class="sourceLineNo">5946</span>        x0r = a[idx0] - a[idx2 + 1];<a name="line.5946"></a>
<span class="sourceLineNo">5947</span>        x0i = a[idx0 + 1] + a[idx2];<a name="line.5947"></a>
<span class="sourceLineNo">5948</span>        x1r = a[idx0] + a[idx2 + 1];<a name="line.5948"></a>
<span class="sourceLineNo">5949</span>        x1i = a[idx0 + 1] - a[idx2];<a name="line.5949"></a>
<span class="sourceLineNo">5950</span>        x2r = a[idx1] - a[idx3 + 1];<a name="line.5950"></a>
<span class="sourceLineNo">5951</span>        x2i = a[idx1 + 1] + a[idx3];<a name="line.5951"></a>
<span class="sourceLineNo">5952</span>        x3r = a[idx1] + a[idx3 + 1];<a name="line.5952"></a>
<span class="sourceLineNo">5953</span>        x3i = a[idx1 + 1] - a[idx3];<a name="line.5953"></a>
<span class="sourceLineNo">5954</span>        y0r = wk1r * x0r - wk1i * x0i;<a name="line.5954"></a>
<span class="sourceLineNo">5955</span>        y0i = wk1r * x0i + wk1i * x0r;<a name="line.5955"></a>
<span class="sourceLineNo">5956</span>        y2r = wk1i * x2r - wk1r * x2i;<a name="line.5956"></a>
<span class="sourceLineNo">5957</span>        y2i = wk1i * x2i + wk1r * x2r;<a name="line.5957"></a>
<span class="sourceLineNo">5958</span>        a[idx0] = y0r + y2r;<a name="line.5958"></a>
<span class="sourceLineNo">5959</span>        a[idx0 + 1] = y0i + y2i;<a name="line.5959"></a>
<span class="sourceLineNo">5960</span>        a[idx1] = y0r - y2r;<a name="line.5960"></a>
<span class="sourceLineNo">5961</span>        a[idx1 + 1] = y0i - y2i;<a name="line.5961"></a>
<span class="sourceLineNo">5962</span>        y0r = wk1i * x1r - wk1r * x1i;<a name="line.5962"></a>
<span class="sourceLineNo">5963</span>        y0i = wk1i * x1i + wk1r * x1r;<a name="line.5963"></a>
<span class="sourceLineNo">5964</span>        y2r = wk1r * x3r - wk1i * x3i;<a name="line.5964"></a>
<span class="sourceLineNo">5965</span>        y2i = wk1r * x3i + wk1i * x3r;<a name="line.5965"></a>
<span class="sourceLineNo">5966</span>        a[idx2] = y0r - y2r;<a name="line.5966"></a>
<span class="sourceLineNo">5967</span>        a[idx2 + 1] = y0i - y2i;<a name="line.5967"></a>
<span class="sourceLineNo">5968</span>        a[idx3] = y0r + y2r;<a name="line.5968"></a>
<span class="sourceLineNo">5969</span>        a[idx3 + 1] = y0i + y2i;<a name="line.5969"></a>
<span class="sourceLineNo">5970</span>    }<a name="line.5970"></a>
<span class="sourceLineNo">5971</span><a name="line.5971"></a>
<span class="sourceLineNo">5972</span>    private void cftfx41(int n, float[] a, int offa, int nw, float[] w) {<a name="line.5972"></a>
<span class="sourceLineNo">5973</span>        if (n == 128) {<a name="line.5973"></a>
<span class="sourceLineNo">5974</span>            cftf161(a, offa, w, nw - 8);<a name="line.5974"></a>
<span class="sourceLineNo">5975</span>            cftf162(a, offa + 32, w, nw - 32);<a name="line.5975"></a>
<span class="sourceLineNo">5976</span>            cftf161(a, offa + 64, w, nw - 8);<a name="line.5976"></a>
<span class="sourceLineNo">5977</span>            cftf161(a, offa + 96, w, nw - 8);<a name="line.5977"></a>
<span class="sourceLineNo">5978</span>        } else {<a name="line.5978"></a>
<span class="sourceLineNo">5979</span>            cftf081(a, offa, w, nw - 8);<a name="line.5979"></a>
<span class="sourceLineNo">5980</span>            cftf082(a, offa + 16, w, nw - 8);<a name="line.5980"></a>
<span class="sourceLineNo">5981</span>            cftf081(a, offa + 32, w, nw - 8);<a name="line.5981"></a>
<span class="sourceLineNo">5982</span>            cftf081(a, offa + 48, w, nw - 8);<a name="line.5982"></a>
<span class="sourceLineNo">5983</span>        }<a name="line.5983"></a>
<span class="sourceLineNo">5984</span>    }<a name="line.5984"></a>
<span class="sourceLineNo">5985</span><a name="line.5985"></a>
<span class="sourceLineNo">5986</span>    private void cftf161(float[] a, int offa, float[] w, int startw) {<a name="line.5986"></a>
<span class="sourceLineNo">5987</span>        float wn4r, wk1r, wk1i, x0r, x0i, x1r, x1i, x2r, x2i, x3r, x3i, y0r, y0i, y1r, y1i, y2r, y2i, y3r, y3i, y4r, y4i, y5r, y5i, y6r, y6i, y7r, y7i, y8r, y8i, y9r, y9i, y10r, y10i, y11r, y11i, y12r, y12i, y13r, y13i, y14r, y14i, y15r, y15i;<a name="line.5987"></a>
<span class="sourceLineNo">5988</span><a name="line.5988"></a>
<span class="sourceLineNo">5989</span>        wn4r = w[startw + 1];<a name="line.5989"></a>
<span class="sourceLineNo">5990</span>        wk1r = w[startw + 2];<a name="line.5990"></a>
<span class="sourceLineNo">5991</span>        wk1i = w[startw + 3];<a name="line.5991"></a>
<span class="sourceLineNo">5992</span><a name="line.5992"></a>
<span class="sourceLineNo">5993</span>        x0r = a[offa] + a[offa + 16];<a name="line.5993"></a>
<span class="sourceLineNo">5994</span>        x0i = a[offa + 1] + a[offa + 17];<a name="line.5994"></a>
<span class="sourceLineNo">5995</span>        x1r = a[offa] - a[offa + 16];<a name="line.5995"></a>
<span class="sourceLineNo">5996</span>        x1i = a[offa + 1] - a[offa + 17];<a name="line.5996"></a>
<span class="sourceLineNo">5997</span>        x2r = a[offa + 8] + a[offa + 24];<a name="line.5997"></a>
<span class="sourceLineNo">5998</span>        x2i = a[offa + 9] + a[offa + 25];<a name="line.5998"></a>
<span class="sourceLineNo">5999</span>        x3r = a[offa + 8] - a[offa + 24];<a name="line.5999"></a>
<span class="sourceLineNo">6000</span>        x3i = a[offa + 9] - a[offa + 25];<a name="line.6000"></a>
<span class="sourceLineNo">6001</span>        y0r = x0r + x2r;<a name="line.6001"></a>
<span class="sourceLineNo">6002</span>        y0i = x0i + x2i;<a name="line.6002"></a>
<span class="sourceLineNo">6003</span>        y4r = x0r - x2r;<a name="line.6003"></a>
<span class="sourceLineNo">6004</span>        y4i = x0i - x2i;<a name="line.6004"></a>
<span class="sourceLineNo">6005</span>        y8r = x1r - x3i;<a name="line.6005"></a>
<span class="sourceLineNo">6006</span>        y8i = x1i + x3r;<a name="line.6006"></a>
<span class="sourceLineNo">6007</span>        y12r = x1r + x3i;<a name="line.6007"></a>
<span class="sourceLineNo">6008</span>        y12i = x1i - x3r;<a name="line.6008"></a>
<span class="sourceLineNo">6009</span>        x0r = a[offa + 2] + a[offa + 18];<a name="line.6009"></a>
<span class="sourceLineNo">6010</span>        x0i = a[offa + 3] + a[offa + 19];<a name="line.6010"></a>
<span class="sourceLineNo">6011</span>        x1r = a[offa + 2] - a[offa + 18];<a name="line.6011"></a>
<span class="sourceLineNo">6012</span>        x1i = a[offa + 3] - a[offa + 19];<a name="line.6012"></a>
<span class="sourceLineNo">6013</span>        x2r = a[offa + 10] + a[offa + 26];<a name="line.6013"></a>
<span class="sourceLineNo">6014</span>        x2i = a[offa + 11] + a[offa + 27];<a name="line.6014"></a>
<span class="sourceLineNo">6015</span>        x3r = a[offa + 10] - a[offa + 26];<a name="line.6015"></a>
<span class="sourceLineNo">6016</span>        x3i = a[offa + 11] - a[offa + 27];<a name="line.6016"></a>
<span class="sourceLineNo">6017</span>        y1r = x0r + x2r;<a name="line.6017"></a>
<span class="sourceLineNo">6018</span>        y1i = x0i + x2i;<a name="line.6018"></a>
<span class="sourceLineNo">6019</span>        y5r = x0r - x2r;<a name="line.6019"></a>
<span class="sourceLineNo">6020</span>        y5i = x0i - x2i;<a name="line.6020"></a>
<span class="sourceLineNo">6021</span>        x0r = x1r - x3i;<a name="line.6021"></a>
<span class="sourceLineNo">6022</span>        x0i = x1i + x3r;<a name="line.6022"></a>
<span class="sourceLineNo">6023</span>        y9r = wk1r * x0r - wk1i * x0i;<a name="line.6023"></a>
<span class="sourceLineNo">6024</span>        y9i = wk1r * x0i + wk1i * x0r;<a name="line.6024"></a>
<span class="sourceLineNo">6025</span>        x0r = x1r + x3i;<a name="line.6025"></a>
<span class="sourceLineNo">6026</span>        x0i = x1i - x3r;<a name="line.6026"></a>
<span class="sourceLineNo">6027</span>        y13r = wk1i * x0r - wk1r * x0i;<a name="line.6027"></a>
<span class="sourceLineNo">6028</span>        y13i = wk1i * x0i + wk1r * x0r;<a name="line.6028"></a>
<span class="sourceLineNo">6029</span>        x0r = a[offa + 4] + a[offa + 20];<a name="line.6029"></a>
<span class="sourceLineNo">6030</span>        x0i = a[offa + 5] + a[offa + 21];<a name="line.6030"></a>
<span class="sourceLineNo">6031</span>        x1r = a[offa + 4] - a[offa + 20];<a name="line.6031"></a>
<span class="sourceLineNo">6032</span>        x1i = a[offa + 5] - a[offa + 21];<a name="line.6032"></a>
<span class="sourceLineNo">6033</span>        x2r = a[offa + 12] + a[offa + 28];<a name="line.6033"></a>
<span class="sourceLineNo">6034</span>        x2i = a[offa + 13] + a[offa + 29];<a name="line.6034"></a>
<span class="sourceLineNo">6035</span>        x3r = a[offa + 12] - a[offa + 28];<a name="line.6035"></a>
<span class="sourceLineNo">6036</span>        x3i = a[offa + 13] - a[offa + 29];<a name="line.6036"></a>
<span class="sourceLineNo">6037</span>        y2r = x0r + x2r;<a name="line.6037"></a>
<span class="sourceLineNo">6038</span>        y2i = x0i + x2i;<a name="line.6038"></a>
<span class="sourceLineNo">6039</span>        y6r = x0r - x2r;<a name="line.6039"></a>
<span class="sourceLineNo">6040</span>        y6i = x0i - x2i;<a name="line.6040"></a>
<span class="sourceLineNo">6041</span>        x0r = x1r - x3i;<a name="line.6041"></a>
<span class="sourceLineNo">6042</span>        x0i = x1i + x3r;<a name="line.6042"></a>
<span class="sourceLineNo">6043</span>        y10r = wn4r * (x0r - x0i);<a name="line.6043"></a>
<span class="sourceLineNo">6044</span>        y10i = wn4r * (x0i + x0r);<a name="line.6044"></a>
<span class="sourceLineNo">6045</span>        x0r = x1r + x3i;<a name="line.6045"></a>
<span class="sourceLineNo">6046</span>        x0i = x1i - x3r;<a name="line.6046"></a>
<span class="sourceLineNo">6047</span>        y14r = wn4r * (x0r + x0i);<a name="line.6047"></a>
<span class="sourceLineNo">6048</span>        y14i = wn4r * (x0i - x0r);<a name="line.6048"></a>
<span class="sourceLineNo">6049</span>        x0r = a[offa + 6] + a[offa + 22];<a name="line.6049"></a>
<span class="sourceLineNo">6050</span>        x0i = a[offa + 7] + a[offa + 23];<a name="line.6050"></a>
<span class="sourceLineNo">6051</span>        x1r = a[offa + 6] - a[offa + 22];<a name="line.6051"></a>
<span class="sourceLineNo">6052</span>        x1i = a[offa + 7] - a[offa + 23];<a name="line.6052"></a>
<span class="sourceLineNo">6053</span>        x2r = a[offa + 14] + a[offa + 30];<a name="line.6053"></a>
<span class="sourceLineNo">6054</span>        x2i = a[offa + 15] + a[offa + 31];<a name="line.6054"></a>
<span class="sourceLineNo">6055</span>        x3r = a[offa + 14] - a[offa + 30];<a name="line.6055"></a>
<span class="sourceLineNo">6056</span>        x3i = a[offa + 15] - a[offa + 31];<a name="line.6056"></a>
<span class="sourceLineNo">6057</span>        y3r = x0r + x2r;<a name="line.6057"></a>
<span class="sourceLineNo">6058</span>        y3i = x0i + x2i;<a name="line.6058"></a>
<span class="sourceLineNo">6059</span>        y7r = x0r - x2r;<a name="line.6059"></a>
<span class="sourceLineNo">6060</span>        y7i = x0i - x2i;<a name="line.6060"></a>
<span class="sourceLineNo">6061</span>        x0r = x1r - x3i;<a name="line.6061"></a>
<span class="sourceLineNo">6062</span>        x0i = x1i + x3r;<a name="line.6062"></a>
<span class="sourceLineNo">6063</span>        y11r = wk1i * x0r - wk1r * x0i;<a name="line.6063"></a>
<span class="sourceLineNo">6064</span>        y11i = wk1i * x0i + wk1r * x0r;<a name="line.6064"></a>
<span class="sourceLineNo">6065</span>        x0r = x1r + x3i;<a name="line.6065"></a>
<span class="sourceLineNo">6066</span>        x0i = x1i - x3r;<a name="line.6066"></a>
<span class="sourceLineNo">6067</span>        y15r = wk1r * x0r - wk1i * x0i;<a name="line.6067"></a>
<span class="sourceLineNo">6068</span>        y15i = wk1r * x0i + wk1i * x0r;<a name="line.6068"></a>
<span class="sourceLineNo">6069</span>        x0r = y12r - y14r;<a name="line.6069"></a>
<span class="sourceLineNo">6070</span>        x0i = y12i - y14i;<a name="line.6070"></a>
<span class="sourceLineNo">6071</span>        x1r = y12r + y14r;<a name="line.6071"></a>
<span class="sourceLineNo">6072</span>        x1i = y12i + y14i;<a name="line.6072"></a>
<span class="sourceLineNo">6073</span>        x2r = y13r - y15r;<a name="line.6073"></a>
<span class="sourceLineNo">6074</span>        x2i = y13i - y15i;<a name="line.6074"></a>
<span class="sourceLineNo">6075</span>        x3r = y13r + y15r;<a name="line.6075"></a>
<span class="sourceLineNo">6076</span>        x3i = y13i + y15i;<a name="line.6076"></a>
<span class="sourceLineNo">6077</span>        a[offa + 24] = x0r + x2r;<a name="line.6077"></a>
<span class="sourceLineNo">6078</span>        a[offa + 25] = x0i + x2i;<a name="line.6078"></a>
<span class="sourceLineNo">6079</span>        a[offa + 26] = x0r - x2r;<a name="line.6079"></a>
<span class="sourceLineNo">6080</span>        a[offa + 27] = x0i - x2i;<a name="line.6080"></a>
<span class="sourceLineNo">6081</span>        a[offa + 28] = x1r - x3i;<a name="line.6081"></a>
<span class="sourceLineNo">6082</span>        a[offa + 29] = x1i + x3r;<a name="line.6082"></a>
<span class="sourceLineNo">6083</span>        a[offa + 30] = x1r + x3i;<a name="line.6083"></a>
<span class="sourceLineNo">6084</span>        a[offa + 31] = x1i - x3r;<a name="line.6084"></a>
<span class="sourceLineNo">6085</span>        x0r = y8r + y10r;<a name="line.6085"></a>
<span class="sourceLineNo">6086</span>        x0i = y8i + y10i;<a name="line.6086"></a>
<span class="sourceLineNo">6087</span>        x1r = y8r - y10r;<a name="line.6087"></a>
<span class="sourceLineNo">6088</span>        x1i = y8i - y10i;<a name="line.6088"></a>
<span class="sourceLineNo">6089</span>        x2r = y9r + y11r;<a name="line.6089"></a>
<span class="sourceLineNo">6090</span>        x2i = y9i + y11i;<a name="line.6090"></a>
<span class="sourceLineNo">6091</span>        x3r = y9r - y11r;<a name="line.6091"></a>
<span class="sourceLineNo">6092</span>        x3i = y9i - y11i;<a name="line.6092"></a>
<span class="sourceLineNo">6093</span>        a[offa + 16] = x0r + x2r;<a name="line.6093"></a>
<span class="sourceLineNo">6094</span>        a[offa + 17] = x0i + x2i;<a name="line.6094"></a>
<span class="sourceLineNo">6095</span>        a[offa + 18] = x0r - x2r;<a name="line.6095"></a>
<span class="sourceLineNo">6096</span>        a[offa + 19] = x0i - x2i;<a name="line.6096"></a>
<span class="sourceLineNo">6097</span>        a[offa + 20] = x1r - x3i;<a name="line.6097"></a>
<span class="sourceLineNo">6098</span>        a[offa + 21] = x1i + x3r;<a name="line.6098"></a>
<span class="sourceLineNo">6099</span>        a[offa + 22] = x1r + x3i;<a name="line.6099"></a>
<span class="sourceLineNo">6100</span>        a[offa + 23] = x1i - x3r;<a name="line.6100"></a>
<span class="sourceLineNo">6101</span>        x0r = y5r - y7i;<a name="line.6101"></a>
<span class="sourceLineNo">6102</span>        x0i = y5i + y7r;<a name="line.6102"></a>
<span class="sourceLineNo">6103</span>        x2r = wn4r * (x0r - x0i);<a name="line.6103"></a>
<span class="sourceLineNo">6104</span>        x2i = wn4r * (x0i + x0r);<a name="line.6104"></a>
<span class="sourceLineNo">6105</span>        x0r = y5r + y7i;<a name="line.6105"></a>
<span class="sourceLineNo">6106</span>        x0i = y5i - y7r;<a name="line.6106"></a>
<span class="sourceLineNo">6107</span>        x3r = wn4r * (x0r - x0i);<a name="line.6107"></a>
<span class="sourceLineNo">6108</span>        x3i = wn4r * (x0i + x0r);<a name="line.6108"></a>
<span class="sourceLineNo">6109</span>        x0r = y4r - y6i;<a name="line.6109"></a>
<span class="sourceLineNo">6110</span>        x0i = y4i + y6r;<a name="line.6110"></a>
<span class="sourceLineNo">6111</span>        x1r = y4r + y6i;<a name="line.6111"></a>
<span class="sourceLineNo">6112</span>        x1i = y4i - y6r;<a name="line.6112"></a>
<span class="sourceLineNo">6113</span>        a[offa + 8] = x0r + x2r;<a name="line.6113"></a>
<span class="sourceLineNo">6114</span>        a[offa + 9] = x0i + x2i;<a name="line.6114"></a>
<span class="sourceLineNo">6115</span>        a[offa + 10] = x0r - x2r;<a name="line.6115"></a>
<span class="sourceLineNo">6116</span>        a[offa + 11] = x0i - x2i;<a name="line.6116"></a>
<span class="sourceLineNo">6117</span>        a[offa + 12] = x1r - x3i;<a name="line.6117"></a>
<span class="sourceLineNo">6118</span>        a[offa + 13] = x1i + x3r;<a name="line.6118"></a>
<span class="sourceLineNo">6119</span>        a[offa + 14] = x1r + x3i;<a name="line.6119"></a>
<span class="sourceLineNo">6120</span>        a[offa + 15] = x1i - x3r;<a name="line.6120"></a>
<span class="sourceLineNo">6121</span>        x0r = y0r + y2r;<a name="line.6121"></a>
<span class="sourceLineNo">6122</span>        x0i = y0i + y2i;<a name="line.6122"></a>
<span class="sourceLineNo">6123</span>        x1r = y0r - y2r;<a name="line.6123"></a>
<span class="sourceLineNo">6124</span>        x1i = y0i - y2i;<a name="line.6124"></a>
<span class="sourceLineNo">6125</span>        x2r = y1r + y3r;<a name="line.6125"></a>
<span class="sourceLineNo">6126</span>        x2i = y1i + y3i;<a name="line.6126"></a>
<span class="sourceLineNo">6127</span>        x3r = y1r - y3r;<a name="line.6127"></a>
<span class="sourceLineNo">6128</span>        x3i = y1i - y3i;<a name="line.6128"></a>
<span class="sourceLineNo">6129</span>        a[offa] = x0r + x2r;<a name="line.6129"></a>
<span class="sourceLineNo">6130</span>        a[offa + 1] = x0i + x2i;<a name="line.6130"></a>
<span class="sourceLineNo">6131</span>        a[offa + 2] = x0r - x2r;<a name="line.6131"></a>
<span class="sourceLineNo">6132</span>        a[offa + 3] = x0i - x2i;<a name="line.6132"></a>
<span class="sourceLineNo">6133</span>        a[offa + 4] = x1r - x3i;<a name="line.6133"></a>
<span class="sourceLineNo">6134</span>        a[offa + 5] = x1i + x3r;<a name="line.6134"></a>
<span class="sourceLineNo">6135</span>        a[offa + 6] = x1r + x3i;<a name="line.6135"></a>
<span class="sourceLineNo">6136</span>        a[offa + 7] = x1i - x3r;<a name="line.6136"></a>
<span class="sourceLineNo">6137</span>    }<a name="line.6137"></a>
<span class="sourceLineNo">6138</span><a name="line.6138"></a>
<span class="sourceLineNo">6139</span>    private void cftf162(float[] a, int offa, float[] w, int startw) {<a name="line.6139"></a>
<span class="sourceLineNo">6140</span>        float wn4r, wk1r, wk1i, wk2r, wk2i, wk3r, wk3i, x0r, x0i, x1r, x1i, x2r, x2i, y0r, y0i, y1r, y1i, y2r, y2i, y3r, y3i, y4r, y4i, y5r, y5i, y6r, y6i, y7r, y7i, y8r, y8i, y9r, y9i, y10r, y10i, y11r, y11i, y12r, y12i, y13r, y13i, y14r, y14i, y15r, y15i;<a name="line.6140"></a>
<span class="sourceLineNo">6141</span><a name="line.6141"></a>
<span class="sourceLineNo">6142</span>        wn4r = w[startw + 1];<a name="line.6142"></a>
<span class="sourceLineNo">6143</span>        wk1r = w[startw + 4];<a name="line.6143"></a>
<span class="sourceLineNo">6144</span>        wk1i = w[startw + 5];<a name="line.6144"></a>
<span class="sourceLineNo">6145</span>        wk3r = w[startw + 6];<a name="line.6145"></a>
<span class="sourceLineNo">6146</span>        wk3i = -w[startw + 7];<a name="line.6146"></a>
<span class="sourceLineNo">6147</span>        wk2r = w[startw + 8];<a name="line.6147"></a>
<span class="sourceLineNo">6148</span>        wk2i = w[startw + 9];<a name="line.6148"></a>
<span class="sourceLineNo">6149</span>        x1r = a[offa] - a[offa + 17];<a name="line.6149"></a>
<span class="sourceLineNo">6150</span>        x1i = a[offa + 1] + a[offa + 16];<a name="line.6150"></a>
<span class="sourceLineNo">6151</span>        x0r = a[offa + 8] - a[offa + 25];<a name="line.6151"></a>
<span class="sourceLineNo">6152</span>        x0i = a[offa + 9] + a[offa + 24];<a name="line.6152"></a>
<span class="sourceLineNo">6153</span>        x2r = wn4r * (x0r - x0i);<a name="line.6153"></a>
<span class="sourceLineNo">6154</span>        x2i = wn4r * (x0i + x0r);<a name="line.6154"></a>
<span class="sourceLineNo">6155</span>        y0r = x1r + x2r;<a name="line.6155"></a>
<span class="sourceLineNo">6156</span>        y0i = x1i + x2i;<a name="line.6156"></a>
<span class="sourceLineNo">6157</span>        y4r = x1r - x2r;<a name="line.6157"></a>
<span class="sourceLineNo">6158</span>        y4i = x1i - x2i;<a name="line.6158"></a>
<span class="sourceLineNo">6159</span>        x1r = a[offa] + a[offa + 17];<a name="line.6159"></a>
<span class="sourceLineNo">6160</span>        x1i = a[offa + 1] - a[offa + 16];<a name="line.6160"></a>
<span class="sourceLineNo">6161</span>        x0r = a[offa + 8] + a[offa + 25];<a name="line.6161"></a>
<span class="sourceLineNo">6162</span>        x0i = a[offa + 9] - a[offa + 24];<a name="line.6162"></a>
<span class="sourceLineNo">6163</span>        x2r = wn4r * (x0r - x0i);<a name="line.6163"></a>
<span class="sourceLineNo">6164</span>        x2i = wn4r * (x0i + x0r);<a name="line.6164"></a>
<span class="sourceLineNo">6165</span>        y8r = x1r - x2i;<a name="line.6165"></a>
<span class="sourceLineNo">6166</span>        y8i = x1i + x2r;<a name="line.6166"></a>
<span class="sourceLineNo">6167</span>        y12r = x1r + x2i;<a name="line.6167"></a>
<span class="sourceLineNo">6168</span>        y12i = x1i - x2r;<a name="line.6168"></a>
<span class="sourceLineNo">6169</span>        x0r = a[offa + 2] - a[offa + 19];<a name="line.6169"></a>
<span class="sourceLineNo">6170</span>        x0i = a[offa + 3] + a[offa + 18];<a name="line.6170"></a>
<span class="sourceLineNo">6171</span>        x1r = wk1r * x0r - wk1i * x0i;<a name="line.6171"></a>
<span class="sourceLineNo">6172</span>        x1i = wk1r * x0i + wk1i * x0r;<a name="line.6172"></a>
<span class="sourceLineNo">6173</span>        x0r = a[offa + 10] - a[offa + 27];<a name="line.6173"></a>
<span class="sourceLineNo">6174</span>        x0i = a[offa + 11] + a[offa + 26];<a name="line.6174"></a>
<span class="sourceLineNo">6175</span>        x2r = wk3i * x0r - wk3r * x0i;<a name="line.6175"></a>
<span class="sourceLineNo">6176</span>        x2i = wk3i * x0i + wk3r * x0r;<a name="line.6176"></a>
<span class="sourceLineNo">6177</span>        y1r = x1r + x2r;<a name="line.6177"></a>
<span class="sourceLineNo">6178</span>        y1i = x1i + x2i;<a name="line.6178"></a>
<span class="sourceLineNo">6179</span>        y5r = x1r - x2r;<a name="line.6179"></a>
<span class="sourceLineNo">6180</span>        y5i = x1i - x2i;<a name="line.6180"></a>
<span class="sourceLineNo">6181</span>        x0r = a[offa + 2] + a[offa + 19];<a name="line.6181"></a>
<span class="sourceLineNo">6182</span>        x0i = a[offa + 3] - a[offa + 18];<a name="line.6182"></a>
<span class="sourceLineNo">6183</span>        x1r = wk3r * x0r - wk3i * x0i;<a name="line.6183"></a>
<span class="sourceLineNo">6184</span>        x1i = wk3r * x0i + wk3i * x0r;<a name="line.6184"></a>
<span class="sourceLineNo">6185</span>        x0r = a[offa + 10] + a[offa + 27];<a name="line.6185"></a>
<span class="sourceLineNo">6186</span>        x0i = a[offa + 11] - a[offa + 26];<a name="line.6186"></a>
<span class="sourceLineNo">6187</span>        x2r = wk1r * x0r + wk1i * x0i;<a name="line.6187"></a>
<span class="sourceLineNo">6188</span>        x2i = wk1r * x0i - wk1i * x0r;<a name="line.6188"></a>
<span class="sourceLineNo">6189</span>        y9r = x1r - x2r;<a name="line.6189"></a>
<span class="sourceLineNo">6190</span>        y9i = x1i - x2i;<a name="line.6190"></a>
<span class="sourceLineNo">6191</span>        y13r = x1r + x2r;<a name="line.6191"></a>
<span class="sourceLineNo">6192</span>        y13i = x1i + x2i;<a name="line.6192"></a>
<span class="sourceLineNo">6193</span>        x0r = a[offa + 4] - a[offa + 21];<a name="line.6193"></a>
<span class="sourceLineNo">6194</span>        x0i = a[offa + 5] + a[offa + 20];<a name="line.6194"></a>
<span class="sourceLineNo">6195</span>        x1r = wk2r * x0r - wk2i * x0i;<a name="line.6195"></a>
<span class="sourceLineNo">6196</span>        x1i = wk2r * x0i + wk2i * x0r;<a name="line.6196"></a>
<span class="sourceLineNo">6197</span>        x0r = a[offa + 12] - a[offa + 29];<a name="line.6197"></a>
<span class="sourceLineNo">6198</span>        x0i = a[offa + 13] + a[offa + 28];<a name="line.6198"></a>
<span class="sourceLineNo">6199</span>        x2r = wk2i * x0r - wk2r * x0i;<a name="line.6199"></a>
<span class="sourceLineNo">6200</span>        x2i = wk2i * x0i + wk2r * x0r;<a name="line.6200"></a>
<span class="sourceLineNo">6201</span>        y2r = x1r + x2r;<a name="line.6201"></a>
<span class="sourceLineNo">6202</span>        y2i = x1i + x2i;<a name="line.6202"></a>
<span class="sourceLineNo">6203</span>        y6r = x1r - x2r;<a name="line.6203"></a>
<span class="sourceLineNo">6204</span>        y6i = x1i - x2i;<a name="line.6204"></a>
<span class="sourceLineNo">6205</span>        x0r = a[offa + 4] + a[offa + 21];<a name="line.6205"></a>
<span class="sourceLineNo">6206</span>        x0i = a[offa + 5] - a[offa + 20];<a name="line.6206"></a>
<span class="sourceLineNo">6207</span>        x1r = wk2i * x0r - wk2r * x0i;<a name="line.6207"></a>
<span class="sourceLineNo">6208</span>        x1i = wk2i * x0i + wk2r * x0r;<a name="line.6208"></a>
<span class="sourceLineNo">6209</span>        x0r = a[offa + 12] + a[offa + 29];<a name="line.6209"></a>
<span class="sourceLineNo">6210</span>        x0i = a[offa + 13] - a[offa + 28];<a name="line.6210"></a>
<span class="sourceLineNo">6211</span>        x2r = wk2r * x0r - wk2i * x0i;<a name="line.6211"></a>
<span class="sourceLineNo">6212</span>        x2i = wk2r * x0i + wk2i * x0r;<a name="line.6212"></a>
<span class="sourceLineNo">6213</span>        y10r = x1r - x2r;<a name="line.6213"></a>
<span class="sourceLineNo">6214</span>        y10i = x1i - x2i;<a name="line.6214"></a>
<span class="sourceLineNo">6215</span>        y14r = x1r + x2r;<a name="line.6215"></a>
<span class="sourceLineNo">6216</span>        y14i = x1i + x2i;<a name="line.6216"></a>
<span class="sourceLineNo">6217</span>        x0r = a[offa + 6] - a[offa + 23];<a name="line.6217"></a>
<span class="sourceLineNo">6218</span>        x0i = a[offa + 7] + a[offa + 22];<a name="line.6218"></a>
<span class="sourceLineNo">6219</span>        x1r = wk3r * x0r - wk3i * x0i;<a name="line.6219"></a>
<span class="sourceLineNo">6220</span>        x1i = wk3r * x0i + wk3i * x0r;<a name="line.6220"></a>
<span class="sourceLineNo">6221</span>        x0r = a[offa + 14] - a[offa + 31];<a name="line.6221"></a>
<span class="sourceLineNo">6222</span>        x0i = a[offa + 15] + a[offa + 30];<a name="line.6222"></a>
<span class="sourceLineNo">6223</span>        x2r = wk1i * x0r - wk1r * x0i;<a name="line.6223"></a>
<span class="sourceLineNo">6224</span>        x2i = wk1i * x0i + wk1r * x0r;<a name="line.6224"></a>
<span class="sourceLineNo">6225</span>        y3r = x1r + x2r;<a name="line.6225"></a>
<span class="sourceLineNo">6226</span>        y3i = x1i + x2i;<a name="line.6226"></a>
<span class="sourceLineNo">6227</span>        y7r = x1r - x2r;<a name="line.6227"></a>
<span class="sourceLineNo">6228</span>        y7i = x1i - x2i;<a name="line.6228"></a>
<span class="sourceLineNo">6229</span>        x0r = a[offa + 6] + a[offa + 23];<a name="line.6229"></a>
<span class="sourceLineNo">6230</span>        x0i = a[offa + 7] - a[offa + 22];<a name="line.6230"></a>
<span class="sourceLineNo">6231</span>        x1r = wk1i * x0r + wk1r * x0i;<a name="line.6231"></a>
<span class="sourceLineNo">6232</span>        x1i = wk1i * x0i - wk1r * x0r;<a name="line.6232"></a>
<span class="sourceLineNo">6233</span>        x0r = a[offa + 14] + a[offa + 31];<a name="line.6233"></a>
<span class="sourceLineNo">6234</span>        x0i = a[offa + 15] - a[offa + 30];<a name="line.6234"></a>
<span class="sourceLineNo">6235</span>        x2r = wk3i * x0r - wk3r * x0i;<a name="line.6235"></a>
<span class="sourceLineNo">6236</span>        x2i = wk3i * x0i + wk3r * x0r;<a name="line.6236"></a>
<span class="sourceLineNo">6237</span>        y11r = x1r + x2r;<a name="line.6237"></a>
<span class="sourceLineNo">6238</span>        y11i = x1i + x2i;<a name="line.6238"></a>
<span class="sourceLineNo">6239</span>        y15r = x1r - x2r;<a name="line.6239"></a>
<span class="sourceLineNo">6240</span>        y15i = x1i - x2i;<a name="line.6240"></a>
<span class="sourceLineNo">6241</span>        x1r = y0r + y2r;<a name="line.6241"></a>
<span class="sourceLineNo">6242</span>        x1i = y0i + y2i;<a name="line.6242"></a>
<span class="sourceLineNo">6243</span>        x2r = y1r + y3r;<a name="line.6243"></a>
<span class="sourceLineNo">6244</span>        x2i = y1i + y3i;<a name="line.6244"></a>
<span class="sourceLineNo">6245</span>        a[offa] = x1r + x2r;<a name="line.6245"></a>
<span class="sourceLineNo">6246</span>        a[offa + 1] = x1i + x2i;<a name="line.6246"></a>
<span class="sourceLineNo">6247</span>        a[offa + 2] = x1r - x2r;<a name="line.6247"></a>
<span class="sourceLineNo">6248</span>        a[offa + 3] = x1i - x2i;<a name="line.6248"></a>
<span class="sourceLineNo">6249</span>        x1r = y0r - y2r;<a name="line.6249"></a>
<span class="sourceLineNo">6250</span>        x1i = y0i - y2i;<a name="line.6250"></a>
<span class="sourceLineNo">6251</span>        x2r = y1r - y3r;<a name="line.6251"></a>
<span class="sourceLineNo">6252</span>        x2i = y1i - y3i;<a name="line.6252"></a>
<span class="sourceLineNo">6253</span>        a[offa + 4] = x1r - x2i;<a name="line.6253"></a>
<span class="sourceLineNo">6254</span>        a[offa + 5] = x1i + x2r;<a name="line.6254"></a>
<span class="sourceLineNo">6255</span>        a[offa + 6] = x1r + x2i;<a name="line.6255"></a>
<span class="sourceLineNo">6256</span>        a[offa + 7] = x1i - x2r;<a name="line.6256"></a>
<span class="sourceLineNo">6257</span>        x1r = y4r - y6i;<a name="line.6257"></a>
<span class="sourceLineNo">6258</span>        x1i = y4i + y6r;<a name="line.6258"></a>
<span class="sourceLineNo">6259</span>        x0r = y5r - y7i;<a name="line.6259"></a>
<span class="sourceLineNo">6260</span>        x0i = y5i + y7r;<a name="line.6260"></a>
<span class="sourceLineNo">6261</span>        x2r = wn4r * (x0r - x0i);<a name="line.6261"></a>
<span class="sourceLineNo">6262</span>        x2i = wn4r * (x0i + x0r);<a name="line.6262"></a>
<span class="sourceLineNo">6263</span>        a[offa + 8] = x1r + x2r;<a name="line.6263"></a>
<span class="sourceLineNo">6264</span>        a[offa + 9] = x1i + x2i;<a name="line.6264"></a>
<span class="sourceLineNo">6265</span>        a[offa + 10] = x1r - x2r;<a name="line.6265"></a>
<span class="sourceLineNo">6266</span>        a[offa + 11] = x1i - x2i;<a name="line.6266"></a>
<span class="sourceLineNo">6267</span>        x1r = y4r + y6i;<a name="line.6267"></a>
<span class="sourceLineNo">6268</span>        x1i = y4i - y6r;<a name="line.6268"></a>
<span class="sourceLineNo">6269</span>        x0r = y5r + y7i;<a name="line.6269"></a>
<span class="sourceLineNo">6270</span>        x0i = y5i - y7r;<a name="line.6270"></a>
<span class="sourceLineNo">6271</span>        x2r = wn4r * (x0r - x0i);<a name="line.6271"></a>
<span class="sourceLineNo">6272</span>        x2i = wn4r * (x0i + x0r);<a name="line.6272"></a>
<span class="sourceLineNo">6273</span>        a[offa + 12] = x1r - x2i;<a name="line.6273"></a>
<span class="sourceLineNo">6274</span>        a[offa + 13] = x1i + x2r;<a name="line.6274"></a>
<span class="sourceLineNo">6275</span>        a[offa + 14] = x1r + x2i;<a name="line.6275"></a>
<span class="sourceLineNo">6276</span>        a[offa + 15] = x1i - x2r;<a name="line.6276"></a>
<span class="sourceLineNo">6277</span>        x1r = y8r + y10r;<a name="line.6277"></a>
<span class="sourceLineNo">6278</span>        x1i = y8i + y10i;<a name="line.6278"></a>
<span class="sourceLineNo">6279</span>        x2r = y9r - y11r;<a name="line.6279"></a>
<span class="sourceLineNo">6280</span>        x2i = y9i - y11i;<a name="line.6280"></a>
<span class="sourceLineNo">6281</span>        a[offa + 16] = x1r + x2r;<a name="line.6281"></a>
<span class="sourceLineNo">6282</span>        a[offa + 17] = x1i + x2i;<a name="line.6282"></a>
<span class="sourceLineNo">6283</span>        a[offa + 18] = x1r - x2r;<a name="line.6283"></a>
<span class="sourceLineNo">6284</span>        a[offa + 19] = x1i - x2i;<a name="line.6284"></a>
<span class="sourceLineNo">6285</span>        x1r = y8r - y10r;<a name="line.6285"></a>
<span class="sourceLineNo">6286</span>        x1i = y8i - y10i;<a name="line.6286"></a>
<span class="sourceLineNo">6287</span>        x2r = y9r + y11r;<a name="line.6287"></a>
<span class="sourceLineNo">6288</span>        x2i = y9i + y11i;<a name="line.6288"></a>
<span class="sourceLineNo">6289</span>        a[offa + 20] = x1r - x2i;<a name="line.6289"></a>
<span class="sourceLineNo">6290</span>        a[offa + 21] = x1i + x2r;<a name="line.6290"></a>
<span class="sourceLineNo">6291</span>        a[offa + 22] = x1r + x2i;<a name="line.6291"></a>
<span class="sourceLineNo">6292</span>        a[offa + 23] = x1i - x2r;<a name="line.6292"></a>
<span class="sourceLineNo">6293</span>        x1r = y12r - y14i;<a name="line.6293"></a>
<span class="sourceLineNo">6294</span>        x1i = y12i + y14r;<a name="line.6294"></a>
<span class="sourceLineNo">6295</span>        x0r = y13r + y15i;<a name="line.6295"></a>
<span class="sourceLineNo">6296</span>        x0i = y13i - y15r;<a name="line.6296"></a>
<span class="sourceLineNo">6297</span>        x2r = wn4r * (x0r - x0i);<a name="line.6297"></a>
<span class="sourceLineNo">6298</span>        x2i = wn4r * (x0i + x0r);<a name="line.6298"></a>
<span class="sourceLineNo">6299</span>        a[offa + 24] = x1r + x2r;<a name="line.6299"></a>
<span class="sourceLineNo">6300</span>        a[offa + 25] = x1i + x2i;<a name="line.6300"></a>
<span class="sourceLineNo">6301</span>        a[offa + 26] = x1r - x2r;<a name="line.6301"></a>
<span class="sourceLineNo">6302</span>        a[offa + 27] = x1i - x2i;<a name="line.6302"></a>
<span class="sourceLineNo">6303</span>        x1r = y12r + y14i;<a name="line.6303"></a>
<span class="sourceLineNo">6304</span>        x1i = y12i - y14r;<a name="line.6304"></a>
<span class="sourceLineNo">6305</span>        x0r = y13r - y15i;<a name="line.6305"></a>
<span class="sourceLineNo">6306</span>        x0i = y13i + y15r;<a name="line.6306"></a>
<span class="sourceLineNo">6307</span>        x2r = wn4r * (x0r - x0i);<a name="line.6307"></a>
<span class="sourceLineNo">6308</span>        x2i = wn4r * (x0i + x0r);<a name="line.6308"></a>
<span class="sourceLineNo">6309</span>        a[offa + 28] = x1r - x2i;<a name="line.6309"></a>
<span class="sourceLineNo">6310</span>        a[offa + 29] = x1i + x2r;<a name="line.6310"></a>
<span class="sourceLineNo">6311</span>        a[offa + 30] = x1r + x2i;<a name="line.6311"></a>
<span class="sourceLineNo">6312</span>        a[offa + 31] = x1i - x2r;<a name="line.6312"></a>
<span class="sourceLineNo">6313</span>    }<a name="line.6313"></a>
<span class="sourceLineNo">6314</span><a name="line.6314"></a>
<span class="sourceLineNo">6315</span>    private void cftf081(float[] a, int offa, float[] w, int startw) {<a name="line.6315"></a>
<span class="sourceLineNo">6316</span>        float wn4r, x0r, x0i, x1r, x1i, x2r, x2i, x3r, x3i, y0r, y0i, y1r, y1i, y2r, y2i, y3r, y3i, y4r, y4i, y5r, y5i, y6r, y6i, y7r, y7i;<a name="line.6316"></a>
<span class="sourceLineNo">6317</span><a name="line.6317"></a>
<span class="sourceLineNo">6318</span>        wn4r = w[startw + 1];<a name="line.6318"></a>
<span class="sourceLineNo">6319</span>        x0r = a[offa] + a[offa + 8];<a name="line.6319"></a>
<span class="sourceLineNo">6320</span>        x0i = a[offa + 1] + a[offa + 9];<a name="line.6320"></a>
<span class="sourceLineNo">6321</span>        x1r = a[offa] - a[offa + 8];<a name="line.6321"></a>
<span class="sourceLineNo">6322</span>        x1i = a[offa + 1] - a[offa + 9];<a name="line.6322"></a>
<span class="sourceLineNo">6323</span>        x2r = a[offa + 4] + a[offa + 12];<a name="line.6323"></a>
<span class="sourceLineNo">6324</span>        x2i = a[offa + 5] + a[offa + 13];<a name="line.6324"></a>
<span class="sourceLineNo">6325</span>        x3r = a[offa + 4] - a[offa + 12];<a name="line.6325"></a>
<span class="sourceLineNo">6326</span>        x3i = a[offa + 5] - a[offa + 13];<a name="line.6326"></a>
<span class="sourceLineNo">6327</span>        y0r = x0r + x2r;<a name="line.6327"></a>
<span class="sourceLineNo">6328</span>        y0i = x0i + x2i;<a name="line.6328"></a>
<span class="sourceLineNo">6329</span>        y2r = x0r - x2r;<a name="line.6329"></a>
<span class="sourceLineNo">6330</span>        y2i = x0i - x2i;<a name="line.6330"></a>
<span class="sourceLineNo">6331</span>        y1r = x1r - x3i;<a name="line.6331"></a>
<span class="sourceLineNo">6332</span>        y1i = x1i + x3r;<a name="line.6332"></a>
<span class="sourceLineNo">6333</span>        y3r = x1r + x3i;<a name="line.6333"></a>
<span class="sourceLineNo">6334</span>        y3i = x1i - x3r;<a name="line.6334"></a>
<span class="sourceLineNo">6335</span>        x0r = a[offa + 2] + a[offa + 10];<a name="line.6335"></a>
<span class="sourceLineNo">6336</span>        x0i = a[offa + 3] + a[offa + 11];<a name="line.6336"></a>
<span class="sourceLineNo">6337</span>        x1r = a[offa + 2] - a[offa + 10];<a name="line.6337"></a>
<span class="sourceLineNo">6338</span>        x1i = a[offa + 3] - a[offa + 11];<a name="line.6338"></a>
<span class="sourceLineNo">6339</span>        x2r = a[offa + 6] + a[offa + 14];<a name="line.6339"></a>
<span class="sourceLineNo">6340</span>        x2i = a[offa + 7] + a[offa + 15];<a name="line.6340"></a>
<span class="sourceLineNo">6341</span>        x3r = a[offa + 6] - a[offa + 14];<a name="line.6341"></a>
<span class="sourceLineNo">6342</span>        x3i = a[offa + 7] - a[offa + 15];<a name="line.6342"></a>
<span class="sourceLineNo">6343</span>        y4r = x0r + x2r;<a name="line.6343"></a>
<span class="sourceLineNo">6344</span>        y4i = x0i + x2i;<a name="line.6344"></a>
<span class="sourceLineNo">6345</span>        y6r = x0r - x2r;<a name="line.6345"></a>
<span class="sourceLineNo">6346</span>        y6i = x0i - x2i;<a name="line.6346"></a>
<span class="sourceLineNo">6347</span>        x0r = x1r - x3i;<a name="line.6347"></a>
<span class="sourceLineNo">6348</span>        x0i = x1i + x3r;<a name="line.6348"></a>
<span class="sourceLineNo">6349</span>        x2r = x1r + x3i;<a name="line.6349"></a>
<span class="sourceLineNo">6350</span>        x2i = x1i - x3r;<a name="line.6350"></a>
<span class="sourceLineNo">6351</span>        y5r = wn4r * (x0r - x0i);<a name="line.6351"></a>
<span class="sourceLineNo">6352</span>        y5i = wn4r * (x0r + x0i);<a name="line.6352"></a>
<span class="sourceLineNo">6353</span>        y7r = wn4r * (x2r - x2i);<a name="line.6353"></a>
<span class="sourceLineNo">6354</span>        y7i = wn4r * (x2r + x2i);<a name="line.6354"></a>
<span class="sourceLineNo">6355</span>        a[offa + 8] = y1r + y5r;<a name="line.6355"></a>
<span class="sourceLineNo">6356</span>        a[offa + 9] = y1i + y5i;<a name="line.6356"></a>
<span class="sourceLineNo">6357</span>        a[offa + 10] = y1r - y5r;<a name="line.6357"></a>
<span class="sourceLineNo">6358</span>        a[offa + 11] = y1i - y5i;<a name="line.6358"></a>
<span class="sourceLineNo">6359</span>        a[offa + 12] = y3r - y7i;<a name="line.6359"></a>
<span class="sourceLineNo">6360</span>        a[offa + 13] = y3i + y7r;<a name="line.6360"></a>
<span class="sourceLineNo">6361</span>        a[offa + 14] = y3r + y7i;<a name="line.6361"></a>
<span class="sourceLineNo">6362</span>        a[offa + 15] = y3i - y7r;<a name="line.6362"></a>
<span class="sourceLineNo">6363</span>        a[offa] = y0r + y4r;<a name="line.6363"></a>
<span class="sourceLineNo">6364</span>        a[offa + 1] = y0i + y4i;<a name="line.6364"></a>
<span class="sourceLineNo">6365</span>        a[offa + 2] = y0r - y4r;<a name="line.6365"></a>
<span class="sourceLineNo">6366</span>        a[offa + 3] = y0i - y4i;<a name="line.6366"></a>
<span class="sourceLineNo">6367</span>        a[offa + 4] = y2r - y6i;<a name="line.6367"></a>
<span class="sourceLineNo">6368</span>        a[offa + 5] = y2i + y6r;<a name="line.6368"></a>
<span class="sourceLineNo">6369</span>        a[offa + 6] = y2r + y6i;<a name="line.6369"></a>
<span class="sourceLineNo">6370</span>        a[offa + 7] = y2i - y6r;<a name="line.6370"></a>
<span class="sourceLineNo">6371</span>    }<a name="line.6371"></a>
<span class="sourceLineNo">6372</span><a name="line.6372"></a>
<span class="sourceLineNo">6373</span>    private void cftf082(float[] a, int offa, float[] w, int startw) {<a name="line.6373"></a>
<span class="sourceLineNo">6374</span>        float wn4r, wk1r, wk1i, x0r, x0i, x1r, x1i, y0r, y0i, y1r, y1i, y2r, y2i, y3r, y3i, y4r, y4i, y5r, y5i, y6r, y6i, y7r, y7i;<a name="line.6374"></a>
<span class="sourceLineNo">6375</span><a name="line.6375"></a>
<span class="sourceLineNo">6376</span>        wn4r = w[startw + 1];<a name="line.6376"></a>
<span class="sourceLineNo">6377</span>        wk1r = w[startw + 2];<a name="line.6377"></a>
<span class="sourceLineNo">6378</span>        wk1i = w[startw + 3];<a name="line.6378"></a>
<span class="sourceLineNo">6379</span>        y0r = a[offa] - a[offa + 9];<a name="line.6379"></a>
<span class="sourceLineNo">6380</span>        y0i = a[offa + 1] + a[offa + 8];<a name="line.6380"></a>
<span class="sourceLineNo">6381</span>        y1r = a[offa] + a[offa + 9];<a name="line.6381"></a>
<span class="sourceLineNo">6382</span>        y1i = a[offa + 1] - a[offa + 8];<a name="line.6382"></a>
<span class="sourceLineNo">6383</span>        x0r = a[offa + 4] - a[offa + 13];<a name="line.6383"></a>
<span class="sourceLineNo">6384</span>        x0i = a[offa + 5] + a[offa + 12];<a name="line.6384"></a>
<span class="sourceLineNo">6385</span>        y2r = wn4r * (x0r - x0i);<a name="line.6385"></a>
<span class="sourceLineNo">6386</span>        y2i = wn4r * (x0i + x0r);<a name="line.6386"></a>
<span class="sourceLineNo">6387</span>        x0r = a[offa + 4] + a[offa + 13];<a name="line.6387"></a>
<span class="sourceLineNo">6388</span>        x0i = a[offa + 5] - a[offa + 12];<a name="line.6388"></a>
<span class="sourceLineNo">6389</span>        y3r = wn4r * (x0r - x0i);<a name="line.6389"></a>
<span class="sourceLineNo">6390</span>        y3i = wn4r * (x0i + x0r);<a name="line.6390"></a>
<span class="sourceLineNo">6391</span>        x0r = a[offa + 2] - a[offa + 11];<a name="line.6391"></a>
<span class="sourceLineNo">6392</span>        x0i = a[offa + 3] + a[offa + 10];<a name="line.6392"></a>
<span class="sourceLineNo">6393</span>        y4r = wk1r * x0r - wk1i * x0i;<a name="line.6393"></a>
<span class="sourceLineNo">6394</span>        y4i = wk1r * x0i + wk1i * x0r;<a name="line.6394"></a>
<span class="sourceLineNo">6395</span>        x0r = a[offa + 2] + a[offa + 11];<a name="line.6395"></a>
<span class="sourceLineNo">6396</span>        x0i = a[offa + 3] - a[offa + 10];<a name="line.6396"></a>
<span class="sourceLineNo">6397</span>        y5r = wk1i * x0r - wk1r * x0i;<a name="line.6397"></a>
<span class="sourceLineNo">6398</span>        y5i = wk1i * x0i + wk1r * x0r;<a name="line.6398"></a>
<span class="sourceLineNo">6399</span>        x0r = a[offa + 6] - a[offa + 15];<a name="line.6399"></a>
<span class="sourceLineNo">6400</span>        x0i = a[offa + 7] + a[offa + 14];<a name="line.6400"></a>
<span class="sourceLineNo">6401</span>        y6r = wk1i * x0r - wk1r * x0i;<a name="line.6401"></a>
<span class="sourceLineNo">6402</span>        y6i = wk1i * x0i + wk1r * x0r;<a name="line.6402"></a>
<span class="sourceLineNo">6403</span>        x0r = a[offa + 6] + a[offa + 15];<a name="line.6403"></a>
<span class="sourceLineNo">6404</span>        x0i = a[offa + 7] - a[offa + 14];<a name="line.6404"></a>
<span class="sourceLineNo">6405</span>        y7r = wk1r * x0r - wk1i * x0i;<a name="line.6405"></a>
<span class="sourceLineNo">6406</span>        y7i = wk1r * x0i + wk1i * x0r;<a name="line.6406"></a>
<span class="sourceLineNo">6407</span>        x0r = y0r + y2r;<a name="line.6407"></a>
<span class="sourceLineNo">6408</span>        x0i = y0i + y2i;<a name="line.6408"></a>
<span class="sourceLineNo">6409</span>        x1r = y4r + y6r;<a name="line.6409"></a>
<span class="sourceLineNo">6410</span>        x1i = y4i + y6i;<a name="line.6410"></a>
<span class="sourceLineNo">6411</span>        a[offa] = x0r + x1r;<a name="line.6411"></a>
<span class="sourceLineNo">6412</span>        a[offa + 1] = x0i + x1i;<a name="line.6412"></a>
<span class="sourceLineNo">6413</span>        a[offa + 2] = x0r - x1r;<a name="line.6413"></a>
<span class="sourceLineNo">6414</span>        a[offa + 3] = x0i - x1i;<a name="line.6414"></a>
<span class="sourceLineNo">6415</span>        x0r = y0r - y2r;<a name="line.6415"></a>
<span class="sourceLineNo">6416</span>        x0i = y0i - y2i;<a name="line.6416"></a>
<span class="sourceLineNo">6417</span>        x1r = y4r - y6r;<a name="line.6417"></a>
<span class="sourceLineNo">6418</span>        x1i = y4i - y6i;<a name="line.6418"></a>
<span class="sourceLineNo">6419</span>        a[offa + 4] = x0r - x1i;<a name="line.6419"></a>
<span class="sourceLineNo">6420</span>        a[offa + 5] = x0i + x1r;<a name="line.6420"></a>
<span class="sourceLineNo">6421</span>        a[offa + 6] = x0r + x1i;<a name="line.6421"></a>
<span class="sourceLineNo">6422</span>        a[offa + 7] = x0i - x1r;<a name="line.6422"></a>
<span class="sourceLineNo">6423</span>        x0r = y1r - y3i;<a name="line.6423"></a>
<span class="sourceLineNo">6424</span>        x0i = y1i + y3r;<a name="line.6424"></a>
<span class="sourceLineNo">6425</span>        x1r = y5r - y7r;<a name="line.6425"></a>
<span class="sourceLineNo">6426</span>        x1i = y5i - y7i;<a name="line.6426"></a>
<span class="sourceLineNo">6427</span>        a[offa + 8] = x0r + x1r;<a name="line.6427"></a>
<span class="sourceLineNo">6428</span>        a[offa + 9] = x0i + x1i;<a name="line.6428"></a>
<span class="sourceLineNo">6429</span>        a[offa + 10] = x0r - x1r;<a name="line.6429"></a>
<span class="sourceLineNo">6430</span>        a[offa + 11] = x0i - x1i;<a name="line.6430"></a>
<span class="sourceLineNo">6431</span>        x0r = y1r + y3i;<a name="line.6431"></a>
<span class="sourceLineNo">6432</span>        x0i = y1i - y3r;<a name="line.6432"></a>
<span class="sourceLineNo">6433</span>        x1r = y5r + y7r;<a name="line.6433"></a>
<span class="sourceLineNo">6434</span>        x1i = y5i + y7i;<a name="line.6434"></a>
<span class="sourceLineNo">6435</span>        a[offa + 12] = x0r - x1i;<a name="line.6435"></a>
<span class="sourceLineNo">6436</span>        a[offa + 13] = x0i + x1r;<a name="line.6436"></a>
<span class="sourceLineNo">6437</span>        a[offa + 14] = x0r + x1i;<a name="line.6437"></a>
<span class="sourceLineNo">6438</span>        a[offa + 15] = x0i - x1r;<a name="line.6438"></a>
<span class="sourceLineNo">6439</span>    }<a name="line.6439"></a>
<span class="sourceLineNo">6440</span><a name="line.6440"></a>
<span class="sourceLineNo">6441</span>    private void cftf040(float[] a, int offa) {<a name="line.6441"></a>
<span class="sourceLineNo">6442</span>        float x0r, x0i, x1r, x1i, x2r, x2i, x3r, x3i;<a name="line.6442"></a>
<span class="sourceLineNo">6443</span><a name="line.6443"></a>
<span class="sourceLineNo">6444</span>        x0r = a[offa] + a[offa + 4];<a name="line.6444"></a>
<span class="sourceLineNo">6445</span>        x0i = a[offa + 1] + a[offa + 5];<a name="line.6445"></a>
<span class="sourceLineNo">6446</span>        x1r = a[offa] - a[offa + 4];<a name="line.6446"></a>
<span class="sourceLineNo">6447</span>        x1i = a[offa + 1] - a[offa + 5];<a name="line.6447"></a>
<span class="sourceLineNo">6448</span>        x2r = a[offa + 2] + a[offa + 6];<a name="line.6448"></a>
<span class="sourceLineNo">6449</span>        x2i = a[offa + 3] + a[offa + 7];<a name="line.6449"></a>
<span class="sourceLineNo">6450</span>        x3r = a[offa + 2] - a[offa + 6];<a name="line.6450"></a>
<span class="sourceLineNo">6451</span>        x3i = a[offa + 3] - a[offa + 7];<a name="line.6451"></a>
<span class="sourceLineNo">6452</span>        a[offa] = x0r + x2r;<a name="line.6452"></a>
<span class="sourceLineNo">6453</span>        a[offa + 1] = x0i + x2i;<a name="line.6453"></a>
<span class="sourceLineNo">6454</span>        a[offa + 2] = x1r - x3i;<a name="line.6454"></a>
<span class="sourceLineNo">6455</span>        a[offa + 3] = x1i + x3r;<a name="line.6455"></a>
<span class="sourceLineNo">6456</span>        a[offa + 4] = x0r - x2r;<a name="line.6456"></a>
<span class="sourceLineNo">6457</span>        a[offa + 5] = x0i - x2i;<a name="line.6457"></a>
<span class="sourceLineNo">6458</span>        a[offa + 6] = x1r + x3i;<a name="line.6458"></a>
<span class="sourceLineNo">6459</span>        a[offa + 7] = x1i - x3r;<a name="line.6459"></a>
<span class="sourceLineNo">6460</span>    }<a name="line.6460"></a>
<span class="sourceLineNo">6461</span><a name="line.6461"></a>
<span class="sourceLineNo">6462</span>    private void cftb040(float[] a, int offa) {<a name="line.6462"></a>
<span class="sourceLineNo">6463</span>        float x0r, x0i, x1r, x1i, x2r, x2i, x3r, x3i;<a name="line.6463"></a>
<span class="sourceLineNo">6464</span><a name="line.6464"></a>
<span class="sourceLineNo">6465</span>        x0r = a[offa] + a[offa + 4];<a name="line.6465"></a>
<span class="sourceLineNo">6466</span>        x0i = a[offa + 1] + a[offa + 5];<a name="line.6466"></a>
<span class="sourceLineNo">6467</span>        x1r = a[offa] - a[offa + 4];<a name="line.6467"></a>
<span class="sourceLineNo">6468</span>        x1i = a[offa + 1] - a[offa + 5];<a name="line.6468"></a>
<span class="sourceLineNo">6469</span>        x2r = a[offa + 2] + a[offa + 6];<a name="line.6469"></a>
<span class="sourceLineNo">6470</span>        x2i = a[offa + 3] + a[offa + 7];<a name="line.6470"></a>
<span class="sourceLineNo">6471</span>        x3r = a[offa + 2] - a[offa + 6];<a name="line.6471"></a>
<span class="sourceLineNo">6472</span>        x3i = a[offa + 3] - a[offa + 7];<a name="line.6472"></a>
<span class="sourceLineNo">6473</span>        a[offa] = x0r + x2r;<a name="line.6473"></a>
<span class="sourceLineNo">6474</span>        a[offa + 1] = x0i + x2i;<a name="line.6474"></a>
<span class="sourceLineNo">6475</span>        a[offa + 2] = x1r + x3i;<a name="line.6475"></a>
<span class="sourceLineNo">6476</span>        a[offa + 3] = x1i - x3r;<a name="line.6476"></a>
<span class="sourceLineNo">6477</span>        a[offa + 4] = x0r - x2r;<a name="line.6477"></a>
<span class="sourceLineNo">6478</span>        a[offa + 5] = x0i - x2i;<a name="line.6478"></a>
<span class="sourceLineNo">6479</span>        a[offa + 6] = x1r - x3i;<a name="line.6479"></a>
<span class="sourceLineNo">6480</span>        a[offa + 7] = x1i + x3r;<a name="line.6480"></a>
<span class="sourceLineNo">6481</span>    }<a name="line.6481"></a>
<span class="sourceLineNo">6482</span><a name="line.6482"></a>
<span class="sourceLineNo">6483</span>    private void cftx020(float[] a, int offa) {<a name="line.6483"></a>
<span class="sourceLineNo">6484</span>        float x0r, x0i;<a name="line.6484"></a>
<span class="sourceLineNo">6485</span>        x0r = a[offa] - a[offa + 2];<a name="line.6485"></a>
<span class="sourceLineNo">6486</span>        x0i = -a[offa + 1] + a[offa + 3];<a name="line.6486"></a>
<span class="sourceLineNo">6487</span>        a[offa] += a[offa + 2];<a name="line.6487"></a>
<span class="sourceLineNo">6488</span>        a[offa + 1] += a[offa + 3];<a name="line.6488"></a>
<span class="sourceLineNo">6489</span>        a[offa + 2] = x0r;<a name="line.6489"></a>
<span class="sourceLineNo">6490</span>        a[offa + 3] = x0i;<a name="line.6490"></a>
<span class="sourceLineNo">6491</span>    }<a name="line.6491"></a>
<span class="sourceLineNo">6492</span><a name="line.6492"></a>
<span class="sourceLineNo">6493</span>    private void cftxb020(float[] a, int offa) {<a name="line.6493"></a>
<span class="sourceLineNo">6494</span>        float x0r, x0i;<a name="line.6494"></a>
<span class="sourceLineNo">6495</span><a name="line.6495"></a>
<span class="sourceLineNo">6496</span>        x0r = a[offa] - a[offa + 2];<a name="line.6496"></a>
<span class="sourceLineNo">6497</span>        x0i = a[offa + 1] - a[offa + 3];<a name="line.6497"></a>
<span class="sourceLineNo">6498</span>        a[offa] += a[offa + 2];<a name="line.6498"></a>
<span class="sourceLineNo">6499</span>        a[offa + 1] += a[offa + 3];<a name="line.6499"></a>
<span class="sourceLineNo">6500</span>        a[offa + 2] = x0r;<a name="line.6500"></a>
<span class="sourceLineNo">6501</span>        a[offa + 3] = x0i;<a name="line.6501"></a>
<span class="sourceLineNo">6502</span>    }<a name="line.6502"></a>
<span class="sourceLineNo">6503</span><a name="line.6503"></a>
<span class="sourceLineNo">6504</span>    private void cftxc020(float[] a, int offa) {<a name="line.6504"></a>
<span class="sourceLineNo">6505</span>        float x0r, x0i;<a name="line.6505"></a>
<span class="sourceLineNo">6506</span>        x0r = a[offa] - a[offa + 2];<a name="line.6506"></a>
<span class="sourceLineNo">6507</span>        x0i = a[offa + 1] + a[offa + 3];<a name="line.6507"></a>
<span class="sourceLineNo">6508</span>        a[offa] += a[offa + 2];<a name="line.6508"></a>
<span class="sourceLineNo">6509</span>        a[offa + 1] -= a[offa + 3];<a name="line.6509"></a>
<span class="sourceLineNo">6510</span>        a[offa + 2] = x0r;<a name="line.6510"></a>
<span class="sourceLineNo">6511</span>        a[offa + 3] = x0i;<a name="line.6511"></a>
<span class="sourceLineNo">6512</span>    }<a name="line.6512"></a>
<span class="sourceLineNo">6513</span><a name="line.6513"></a>
<span class="sourceLineNo">6514</span>    private void rftfsub(int n, float[] a, int offa, int nc, float[] c, int startc) {<a name="line.6514"></a>
<span class="sourceLineNo">6515</span>        int k, kk, ks, m;<a name="line.6515"></a>
<span class="sourceLineNo">6516</span>        float wkr, wki, xr, xi, yr, yi;<a name="line.6516"></a>
<span class="sourceLineNo">6517</span>        int idx1, idx2;<a name="line.6517"></a>
<span class="sourceLineNo">6518</span><a name="line.6518"></a>
<span class="sourceLineNo">6519</span>        m = n &gt;&gt; 1;<a name="line.6519"></a>
<span class="sourceLineNo">6520</span>        ks = 2 * nc / m;<a name="line.6520"></a>
<span class="sourceLineNo">6521</span>        kk = 0;<a name="line.6521"></a>
<span class="sourceLineNo">6522</span>        for (int j = 2; j &lt; m; j += 2) {<a name="line.6522"></a>
<span class="sourceLineNo">6523</span>            k = n - j;<a name="line.6523"></a>
<span class="sourceLineNo">6524</span>            kk += ks;<a name="line.6524"></a>
<span class="sourceLineNo">6525</span>            wkr = (float)(0.5 - c[startc + nc - kk]);<a name="line.6525"></a>
<span class="sourceLineNo">6526</span>            wki = c[startc + kk];<a name="line.6526"></a>
<span class="sourceLineNo">6527</span>            idx1 = offa + j;<a name="line.6527"></a>
<span class="sourceLineNo">6528</span>            idx2 = offa + k;<a name="line.6528"></a>
<span class="sourceLineNo">6529</span>            xr = a[idx1] - a[idx2];<a name="line.6529"></a>
<span class="sourceLineNo">6530</span>            xi = a[idx1 + 1] + a[idx2 + 1];<a name="line.6530"></a>
<span class="sourceLineNo">6531</span>            yr = wkr * xr - wki * xi;<a name="line.6531"></a>
<span class="sourceLineNo">6532</span>            yi = wkr * xi + wki * xr;<a name="line.6532"></a>
<span class="sourceLineNo">6533</span>            a[idx1] -= yr;<a name="line.6533"></a>
<span class="sourceLineNo">6534</span>            a[idx1 + 1] = yi - a[idx1 + 1];<a name="line.6534"></a>
<span class="sourceLineNo">6535</span>            a[idx2] += yr;<a name="line.6535"></a>
<span class="sourceLineNo">6536</span>            a[idx2 + 1] = yi - a[idx2 + 1];<a name="line.6536"></a>
<span class="sourceLineNo">6537</span>        }<a name="line.6537"></a>
<span class="sourceLineNo">6538</span>        a[offa + m + 1] = -a[offa + m + 1];<a name="line.6538"></a>
<span class="sourceLineNo">6539</span>    }<a name="line.6539"></a>
<span class="sourceLineNo">6540</span><a name="line.6540"></a>
<span class="sourceLineNo">6541</span>    private void rftbsub(int n, float[] a, int offa, int nc, float[] c, int startc) {<a name="line.6541"></a>
<span class="sourceLineNo">6542</span>        int k, kk, ks, m;<a name="line.6542"></a>
<span class="sourceLineNo">6543</span>        float wkr, wki, xr, xi, yr, yi;<a name="line.6543"></a>
<span class="sourceLineNo">6544</span>        int idx1, idx2;<a name="line.6544"></a>
<span class="sourceLineNo">6545</span><a name="line.6545"></a>
<span class="sourceLineNo">6546</span>        m = n &gt;&gt; 1;<a name="line.6546"></a>
<span class="sourceLineNo">6547</span>        ks = 2 * nc / m;<a name="line.6547"></a>
<span class="sourceLineNo">6548</span>        kk = 0;<a name="line.6548"></a>
<span class="sourceLineNo">6549</span>        for (int j = 2; j &lt; m; j += 2) {<a name="line.6549"></a>
<span class="sourceLineNo">6550</span>            k = n - j;<a name="line.6550"></a>
<span class="sourceLineNo">6551</span>            kk += ks;<a name="line.6551"></a>
<span class="sourceLineNo">6552</span>            wkr = (float)(0.5 - c[startc + nc - kk]);<a name="line.6552"></a>
<span class="sourceLineNo">6553</span>            wki = c[startc + kk];<a name="line.6553"></a>
<span class="sourceLineNo">6554</span>            idx1 = offa + j;<a name="line.6554"></a>
<span class="sourceLineNo">6555</span>            idx2 = offa + k;<a name="line.6555"></a>
<span class="sourceLineNo">6556</span>            xr = a[idx1] - a[idx2];<a name="line.6556"></a>
<span class="sourceLineNo">6557</span>            xi = a[idx1 + 1] + a[idx2 + 1];<a name="line.6557"></a>
<span class="sourceLineNo">6558</span>            yr = wkr * xr - wki * xi;<a name="line.6558"></a>
<span class="sourceLineNo">6559</span>            yi = wkr * xi + wki * xr;<a name="line.6559"></a>
<span class="sourceLineNo">6560</span>            a[idx1] -= yr;<a name="line.6560"></a>
<span class="sourceLineNo">6561</span>            a[idx1 + 1] -= yi;<a name="line.6561"></a>
<span class="sourceLineNo">6562</span>            a[idx2] += yr;<a name="line.6562"></a>
<span class="sourceLineNo">6563</span>            a[idx2 + 1] -= yi;<a name="line.6563"></a>
<span class="sourceLineNo">6564</span>        }<a name="line.6564"></a>
<span class="sourceLineNo">6565</span>    }<a name="line.6565"></a>
<span class="sourceLineNo">6566</span><a name="line.6566"></a>
<span class="sourceLineNo">6567</span>    private void scale(final float m, final float[] a, int offa, boolean complex) {<a name="line.6567"></a>
<span class="sourceLineNo">6568</span>        final float norm = (float)(1.0 / m);<a name="line.6568"></a>
<span class="sourceLineNo">6569</span>        int n2;<a name="line.6569"></a>
<span class="sourceLineNo">6570</span>        if (complex) {<a name="line.6570"></a>
<span class="sourceLineNo">6571</span>            n2 = 2 * n;<a name="line.6571"></a>
<span class="sourceLineNo">6572</span>        } else {<a name="line.6572"></a>
<span class="sourceLineNo">6573</span>            n2 = n;<a name="line.6573"></a>
<span class="sourceLineNo">6574</span>        }<a name="line.6574"></a>
<span class="sourceLineNo">6575</span>        int nthreads = ConcurrencyUtils.getNumberOfThreads();<a name="line.6575"></a>
<span class="sourceLineNo">6576</span>        if ((nthreads &gt; 1) &amp;&amp; (n2 &gt;= ConcurrencyUtils.getThreadsBeginN_1D_FFT_2Threads())) {<a name="line.6576"></a>
<span class="sourceLineNo">6577</span>            final int k = n2 / nthreads;<a name="line.6577"></a>
<span class="sourceLineNo">6578</span>            Future&lt;?&gt;[] futures = new Future[nthreads];<a name="line.6578"></a>
<span class="sourceLineNo">6579</span>            for (int i = 0; i &lt; nthreads; i++) {<a name="line.6579"></a>
<span class="sourceLineNo">6580</span>                final int firstIdx = offa + i * k;<a name="line.6580"></a>
<span class="sourceLineNo">6581</span>                final int lastIdx = (i == (nthreads - 1)) ? offa + n2 : firstIdx + k;<a name="line.6581"></a>
<span class="sourceLineNo">6582</span>                futures[i] = ConcurrencyUtils.submit(new Runnable() {<a name="line.6582"></a>
<span class="sourceLineNo">6583</span><a name="line.6583"></a>
<span class="sourceLineNo">6584</span>                    @Override<a name="line.6584"></a>
<span class="sourceLineNo">6585</span>                                        public void run() {<a name="line.6585"></a>
<span class="sourceLineNo">6586</span>                        for (int i = firstIdx; i &lt; lastIdx; i++) {<a name="line.6586"></a>
<span class="sourceLineNo">6587</span>                            a[i] *= norm;<a name="line.6587"></a>
<span class="sourceLineNo">6588</span>                        }<a name="line.6588"></a>
<span class="sourceLineNo">6589</span>                    }<a name="line.6589"></a>
<span class="sourceLineNo">6590</span>                });<a name="line.6590"></a>
<span class="sourceLineNo">6591</span>            }<a name="line.6591"></a>
<span class="sourceLineNo">6592</span>            ConcurrencyUtils.waitForCompletion(futures);<a name="line.6592"></a>
<span class="sourceLineNo">6593</span>        } else {<a name="line.6593"></a>
<span class="sourceLineNo">6594</span>            for (int i = offa; i &lt; offa + n2; i++) {<a name="line.6594"></a>
<span class="sourceLineNo">6595</span>                a[i] *= norm;<a name="line.6595"></a>
<span class="sourceLineNo">6596</span>            }<a name="line.6596"></a>
<span class="sourceLineNo">6597</span><a name="line.6597"></a>
<span class="sourceLineNo">6598</span>        }<a name="line.6598"></a>
<span class="sourceLineNo">6599</span>    }<a name="line.6599"></a>
<span class="sourceLineNo">6600</span>}<a name="line.6600"></a>




























































</pre>
</div>
</body>
</html>