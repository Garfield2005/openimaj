<!DOCTYPE html><html xmlns:d="http://docbook.org/ns/docbook" xmlns:fo="http://www.w3.org/1999/XSL/Format">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>Chapter&nbsp;6.&nbsp;Image Datasets</title>
      <link rel="stylesheet" type="text/css" href="css/apache-maven-fluido-1.3.0.min.css">
      <link rel="stylesheet" type="text/css" href="css/stylesheet.css">
      <link rel="stylesheet" type="text/css" href="fonts/fonts.css">
      <meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1">
      <link rel="home" href="index.html" title="The OpenIMAJ Tutorial">
      <link rel="up" href="pt02.html" title="Part&nbsp;II.&nbsp;Image Fundamentals">
      <link rel="prev" href="sift-and-feature-matching.html" title="Chapter&nbsp;5.&nbsp;SIFT and feature matching">
      <link rel="next" href="pt03.html" title="Part&nbsp;III.&nbsp;Video Fundamentals">
      <meta property="fb:admins" content="286108206">
      <meta property="og:type" content="website">
      <link rel="image_src" href="../images/OpenImaj-sq.png">
      <meta property="og:image" content="http://openimaj.org/images/OpenImaj-sq.png">
      <meta property="og:title" content="OpenIMAJ: Open Intelligent Multimedia Analysis">
      <meta property="og:url" content="http://www.openimaj.org">
      <meta property="og:description" content="OpenIMAJ is an award-winning set of libraries and tools for multimedia content analysis and content generation."><script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script><script type="text/javascript">
	      var _gaq = _gaq || [];
	      _gaq.push(['_setAccount', 'UA-38338744-1']);
	      _gaq.push(['_trackPageview']);

	      (function() {
	        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	      })();
	    </script></head>
   <body class="topBarEnabled">
      <div id="topbar" class="navbar navbar-fixed-top navbar-inverse">
         <div class="navbar-inner">
            <div class="container">
               <div class="nav-collapse"><a class="brand" href="../index.html" title="OpenIMAJ"><img src="images/logo-tiny.png" alt="OpenIMAJ"></a><ul class="nav">
                     <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a><ul class="dropdown-menu">
                           <li><a href="../index.html" title="Introduction">Introduction</a></li>
                           <li><a href="../sponsors.html" title="History &amp; Sponsors">History &amp; Sponsors</a></li>
                           <li><a href="../contact.html" title="Support &amp; Contacts">Support &amp; Contacts</a></li>
                           <li><a href="team.html" title="Team">Team</a></li>
                           <li><a href="http://blogs.ecs.soton.ac.uk/multimedia" title="The Blog">The Blog</a></li>
                           <li><a href="http://www.sf.net/p/openimaj/code" title="Source Code">Source Code</a></li>
                           <li class="dropdown-submenu"><a href="../#related" title="Related Projects">Related Projects</a><ul class="dropdown-menu">
                                 <li><a href="http://www.imageterrier.org/" title="ImageTerrier">ImageTerrier</a></li>
                              </ul>
                           </li>
                        </ul>
                     </li>
                     <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a><ul class="dropdown-menu">
                           <li class="dropdown-submenu"><a href="../#gettingstarted" title="Getting Started">Getting Started</a><ul class="dropdown-menu">
                                 <li><a href="../tutorial-pdf.pdf" title="The Tutorial (PDF)">The Tutorial (PDF)</a></li>
                                 <li><a href="../tutorial/index.html" title="The Tutorial (HTML)">The Tutorial (HTML)</a></li>
                              </ul>
                           </li>
                           <li class="dropdown-submenu"><a href="../#using" title="Using OpenIMAJ">Using OpenIMAJ</a><ul class="dropdown-menu">
                                 <li><a href="../BuildFromSource.html" title="Building OpenIMAJ from Source">Building OpenIMAJ from Source</a></li>
                                 <li><a href="../UseLibrary.html" title="Using OpenIMAJ as a Library">Using OpenIMAJ as a Library</a></li>
                                 <li><a href="../Groovy.html" title="Using OpenIMAJ with Groovy">Using OpenIMAJ with Groovy</a></li>
                                 <li><a href="../tools.html" title="OpenIMAJ commandline tools introduction">OpenIMAJ commandline tools introduction</a></li>
                                 <li><a href="../flickrCrawler.html" title="The FlickrCrawler Tool">The FlickrCrawler Tool</a></li>
                                 <li><a href="../bibliography.html" title="Bibliography">Bibliography</a></li>
                              </ul>
                           </li>
                           <li><a href="../apidocs/index.html" title="API Reference">API Reference</a></li>
                           <li class="dropdown-submenu"><a href="#info" title="Project Information">Project Information</a><ul class="dropdown-menu">
                                 <li><a href="../plugin-management.html" title="Plugin Management">Plugin Management</a></li>
                                 <li><a href="../mail-lists.html" title="Mailing Lists">Mailing Lists</a></li>
                                 <li><a href="../integration.html" title="Continuous Integration">Continuous Integration</a></li>
                                 <li><a href="../license.html" title="Project License">Project License</a></li>
                                 <li><a href="../team-list.html" title="Project Team">Project Team</a></li>
                                 <li><a href="../source-repository.html" title="Source Repository">Source Repository</a></li>
                                 <li><a href="../index.html" title="About">About</a></li>
                                 <li><a href="../issue-tracking.html" title="Issue Tracking">Issue Tracking</a></li>
                                 <li><a href="../project-summary.html" title="Project Summary">Project Summary</a></li>
                                 <li><a href="../plugins.html" title="Project Plugins">Project Plugins</a></li>
                                 <li><a href="../dependency-convergence.html" title="Dependency Convergence">Dependency Convergence</a></li>
                                 <li><a href="../dependencies.html" title="Dependencies">Dependencies</a></li>
                              </ul>
                           </li>
                        </ul>
                     </li>
                     <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Modules <b class="caret"></b></a><ul class="dropdown-menu">
                           <li><a href="/openimaj-maven-archetypes/index.html" title="OpenIMAJ Maven Archetypes">OpenIMAJ Maven Archetypes</a></li>
                           <li><a href="/openimaj-core-libs/index.html" title="OpenIMAJ Core Libraries">OpenIMAJ Core Libraries</a></li>
                           <li><a href="/openimaj-image/index.html" title="OpenIMAJ Image Processing Libraries">OpenIMAJ Image Processing Libraries</a></li>
                           <li><a href="/openimaj-video/index.html" title="OpenIMAJ Video Processing Libraries">OpenIMAJ Video Processing Libraries</a></li>
                           <li><a href="/openimaj-audio/index.html" title="OpenIMAJ Audio Processing Libraries">OpenIMAJ Audio Processing Libraries</a></li>
                           <li><a href="/openimaj-machine-learning/index.html" title="OpenIMAJ Machine Learning Subprojects">OpenIMAJ Machine Learning Subprojects</a></li>
                           <li><a href="/openimaj-text/index.html" title="OpenIMAJ Text Analysis Subprojects">OpenIMAJ Text Analysis Subprojects</a></li>
                           <li><a href="/thirdparty/index.html" title="OpenIMAJ Third Party Ported Libraries">OpenIMAJ Third Party Ported Libraries</a></li>
                           <li><a href="/openimaj-demos/index.html" title="OpenIMAJ Demos Subproject">OpenIMAJ Demos Subproject</a></li>
                           <li><a href="/openimaj-knowledge/index.html" title="OpenIMAJ Knowledge Representation and Reasoning Libraries">OpenIMAJ Knowledge Representation and Reasoning Libraries</a></li>
                           <li><a href="/test-resources/index.html" title="OpenIMAJ Unit Test Resources">OpenIMAJ Unit Test Resources</a></li>
                           <li><a href="/openimaj-tools/index.html" title="OpenIMAJ Tools">OpenIMAJ Tools</a></li>
                           <li><a href="/openimaj-hadoop/index.html" title="OpenIMAJ Hadoop Subproject">OpenIMAJ Hadoop Subproject</a></li>
                           <li><a href="/openimaj-storm/index.html" title="OpenIMAJ Storm Subproject">OpenIMAJ Storm Subproject</a></li>
                           <li><a href="/openimaj-web/index.html" title="OpenIMAJ web subproject">OpenIMAJ web subproject</a></li>
                           <li><a href="/openimaj-hardware/index.html" title="OpenIMAJ Hardware Subprojects">OpenIMAJ Hardware Subprojects</a></li>
                           <li><a href="/openimaj-content-libs/index.html" title="OpenIMAJ Content Creation Libraries">OpenIMAJ Content Creation Libraries</a></li>
                           <li><a href="/openimaj-ide-integration/index.html" title="OpenIMAJ IDE Integration Plugins">OpenIMAJ IDE Integration Plugins</a></li>
                           <li><a href="/openimaj-documentation/index.html" title="OpenIMAJ Documentation">OpenIMAJ Documentation</a></li>
                        </ul>
                     </li>
                  </ul>
                  <form id="search-form" action="http://www.google.com/search" method="get" class="navbar-search pull-right" name="search-form"><input value="" name="sitesearch" type="hidden"><input class="search-query" name="q" id="query" type="text"></form><script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script><iframe src="http://www.facebook.com/plugins/like.php?href=http://www.openimaj.org/&amp;send=false&amp;layout=button_count&amp;show-faces=false&amp;action=like&amp;colorscheme=dark" scrolling="no" frameborder="0" style="border:none; width:80px; height:20px; margin-top: 10px;" class="pull-right"></iframe><script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script><ul class="nav pull-right">
                     <li style="margin-top: 10px;">
                        <div class="g-plusone" data-href="http://www.openimaj.org/" data-size="medium" width="60px" align="right"></div>
                     </li>
                  </ul>
               </div>
            </div>
         </div>
      </div>
      <div class="container">
         <div id="banner">
            <div class="pull-left">
               <div id="bannerLeft">
                  <h2>OpenIMAJ</h2>
               </div>
            </div>
            <div class="pull-right"></div>
            <div class="clear">
               <hr>
            </div>
         </div>
         <div id="breadcrumbs">
            <ul class="breadcrumb">
               <li id="publishDate" class="pull-right">Last Published: 2015-02-25</li>
               <li class="divider pull-right">|</li>
               <li id="projectVersion" class="pull-right">Version: 1.4-SNAPSHOT</li>
            </ul>
         </div>
         <div id="nav-sub-block"><a class="hide" name="nav-sub-a"></a><ul id="nav-sub">
               <li class="first"><a accesskey="p" href="sift-and-feature-matching.html"><span>Prev : SIFT and feature matching</span></a></li>
               <li><a accesskey="h" href="index.html"><span>Contents</span></a></li>
               <li class="last"><a accesskey="n" href="pt03.html"><span>Next : Video Fundamentals</span></a></li>
            </ul>
         </div>
         <div class="chapter" title="Chapter&nbsp;6.&nbsp;Image Datasets">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title"><a name="image-datasets"></a>Chapter&nbsp;6.&nbsp;Image Datasets
                     </h2>
                  </div>
               </div>
            </div>
              
            	
            <p>
               	<span class="strong"><strong>Datasets</strong></span> are an important concept in OpenIMAJ. Fundamentally, a dataset is a collection of data items. OpenIMAJ supports two types
               of dataset: <code class="code">ListDataset</code>s and <code class="code">GroupedDataset</code>s. As the name suggests, a <code class="code">ListDataset</code> is basically like a list of data items and indeed the <code class="code">ListDataset</code> class extends the java <code class="code">List</code> interface. A <code class="code">GroupedDataset</code> is essentially a keyed map of <code class="code">Dataset</code>s and is an extension of the Java <code class="code">Map</code> interface. The datasets classes are designed to provide a useful way of manipulating collections of items, and are particularly
               useful for applying machine-learning techniques to data as we'll see later in the tutorial.
               	
            </p>
            	
            <p>
               		This tutorial explores the use of datasets that contain images. OpenIMAJ contains methods and classes to help you efficiently
               deal with the construction and manipulation of image datasets (and indeed datasets of other types). To get started, create
               a new project using the Maven archetype, or add a new class to an existing OpenIMAJ Maven project and add a main method.
               	
            </p>
            	
            <p>
               		We'll start by looking at how you can create a simple list dataset from a directory of images you have on your computer's
               disk. If you don't have a directory of images to hand, create an empty one somewhere on your computer and add a couple of
               images to it. Now, add some code to your main method to construct an instance of a <code class="code">VFSListDataset</code> as follows:
               	
            </p>
            	<pre class="programlisting">VFSListDataset&lt;FImage&gt; images = 
		new VFSListDataset&lt;FImage&gt;("/path/to/image_dir", ImageUtilities.FIMAGE_READER);</pre>
            	<p>
               		In your code you'll need to replace the <code class="code">/path/to/image_dir</code> string with the path to your directory of images. Notice that the dataset we've created is typed on the <code class="code">FImage</code> class, and in the constructor we've passed a reference to <code class="code">ImageUtilities.FIMAGE_READER</code>. This means that this dataset will contain grey-scale versions of the images on the disk (irrespective of whether they are
               actually colour images). The <code class="code">ImageUtilities.FIMAGE_READER</code> is a special object called an <code class="code">ObjectReader</code>. If you wanted to load colour images in your dataset, you would just need to change the type to <code class="code">MBFImage</code>, and use the <code class="code">ImageUtilities.MBFIMAGE_READER</code> <code class="code">ObjectReader</code> instead.
               	
            </p>
            	
            <p>
               		As we mentioned earlier, a <code class="code">ListDataset</code> extends a normal Java <code class="code">List</code>, so you can do standard things like getting the number of items in the dataset:
               	
            </p>
            	<pre class="programlisting">System.out.println(images.size());</pre>
            	<p>
               		The dataset interface also allows you to easily get a random item from the dataset. As we're dealing with images, we can
               display a random image as follows:
               	
            </p>
            	<pre class="programlisting">DisplayUtilities.display(images.getRandomInstance(), "A random image from the dataset");</pre>
            		<p>
               		Also, because we're dealing with a list of images, we can display them all in a window as follows:
               	
            </p>
            	<pre class="programlisting">DisplayUtilities.display("My images", images);</pre>
            	<p>
               		The <code class="code">VFSListDataset</code> class is very powerful. It can be used to create datasets from any kinds of data given an appropriate <code class="code">ObjectReader</code> implementation. Beyond this, it is also able to create datasets from other sources, such as compressed archives containing
               data items, and even from remote data that is not stored on the local disk. Try running the following code which creates an
               image dataset from images in a zip file which is hosted on a web-server:
               	
            </p>
            	<pre class="programlisting">VFSListDataset&lt;FImage&gt; faces = 
		new VFSListDataset&lt;FImage&gt;("zip:http://datasets.openimaj.org/att_faces.zip", ImageUtilities.FIMAGE_READER);
DisplayUtilities.display("ATT faces", faces);</pre>
            	<p>
               		As was mentioned in the introduction to this chapter, a grouped dataset maps a set of keys to sub-datasets. Grouped datasets
               are useful for things like machine-learning when you want to train classifiers to distinguish between groups. If you download
               and unzip the faces dataset that we used above (http://datasets.openimaj.org/att_faces.zip), you'll see that the images are
               actually grouped into directories, with all the images of a single individual stored in the same directory. When we loaded
               the list dataset from the zip file, we lost the associations between images of each individual. Using a <code class="code">VFSGroupDataset</code> we can maintain the associations:
               	
            </p>		
            <pre class="programlisting">VFSGroupDataset&lt;FImage&gt; groupedFaces = 
	new VFSGroupDataset&lt;FImage&gt;( "zip:http://datasets.openimaj.org/att_faces.zip", ImageUtilities.FIMAGE_READER);</pre>
            		<p>Using the grouped dataset, we can iterate through the keys, which are actually created from the names of the directories containing
               the images, and display all the images from each individual in a window:
               		
            </p>
            		<pre class="programlisting">for (final Entry&lt;String, VFSListDataset&lt;FImage&gt;&gt; entry : groupedFaces.entrySet()) {
	DisplayUtilities.display(entry.getKey(), entry.getValue());
}</pre>
            	<p>
               		Sometimes, it can be useful to be able to dynamically create a dataset of images from the web. In the image analysis community,
               Flickr is often used as a source of tagged images for performing activities such as training classifiers. The <code class="code">FlickrImageDataset</code> class makes it easy to dynamically construct a dataset of images from a Flickr search:
               	
            </p>
            	<pre class="programlisting">FlickrAPIToken flickrToken = DefaultTokenFactory.get(FlickrAPIToken.class);
FlickrImageDataset&lt;FImage&gt; cats = 
		FlickrImageDataset.create(ImageUtilities.FIMAGE_READER, flickrToken, "cat", 10);
DisplayUtilities.display("Cats", cats);</pre>
            	<p>
               		The Flickr website requires you authenticate to use its API. The first time you run the above code, you will see instructions
               on obtaining a Flickr API key and secret, which you then have to enter at the prompt. Once you've done this once, the key
               and secret will be stored and automatically retrieved in the future by the <code class="code">DefaultTokenFactory</code>. It is also possible to for-go the <code class="code">DefaultTokenFactory</code> and construct a <code class="code">FlickrAPIToken</code> and fill in the api key and secret field manually.
               	
            </p>	
            	
            <div class="sect1" title="6.1.&nbsp;Exercises">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="image-datasets-exercises"></a>6.1.&nbsp;Exercises
                        </h2>
                     </div>
                  </div>
               </div>
                   
                   
               <div class="sect2" title="6.1.1.&nbsp;Exercise 1: Exploring Grouped Datasets">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="exercise-1-exploring-datasets"></a>6.1.1.&nbsp;Exercise 1: Exploring Grouped Datasets
                           </h3>
                        </div>
                     </div>
                  </div>
                        
                        
                  <p>
                     				Using the faces dataset available from <code class="code">http://datasets.openimaj.org/att_faces.zip</code>, can you display an image that shows a randomly selected photo of each person in the dataset?
                           
                  </p>
                      
               </div>
                   
               <div class="sect2" title="6.1.2.&nbsp;Exercise 2: Find out more about VFS datasets">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="exercise-2-exploring-VFS"></a>6.1.2.&nbsp;Exercise 2: Find out more about VFS datasets
                           </h3>
                        </div>
                     </div>
                  </div>
                        
                        
                  <p>
                     				<code class="code">VFSListDataset</code>s and <code class="code">VFSGroupDataset</code>s are based on a technology from the Apache Software Foundation called Commons Virtual File System (Commons VFS). Explore
                     the documentation of the Commons VFS to see what other kinds of sources are supported for building datasets.
                           
                  </p>
                      
               </div>
                   
               <div class="sect2" title="6.1.3.&nbsp;Exercise 3: Try the BingImageDataset dataset">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="exercise-3-bing"></a>6.1.3.&nbsp;Exercise 3: Try the BingImageDataset dataset
                           </h3>
                        </div>
                     </div>
                  </div>
                        
                        
                  <p>
                     				The <code class="code">BingImageDataset</code> class allows you to create a dataset of images by performing a search using the Bing search engine. The <code class="code">BingImageDataset</code> class works in a similar way to the <code class="code">FlickrImageDataset</code> described above. Try it out!
                           
                  </p>
                      
               </div>
                   
               <div class="sect2" title="6.1.4.&nbsp;Exercise 4: Using MapBackedDataset">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="exercise-4-grouped-bing"></a>6.1.4.&nbsp;Exercise 4: Using MapBackedDataset
                           </h3>
                        </div>
                     </div>
                  </div>
                        
                        
                  <p>
                     				The <code class="code">MapBackedDataset</code> class provides a concrete implementation of a <code class="code">GroupedDataset</code>. See if you can use the static <code class="code">MapBackedDataset.of</code> method to construct a grouped dataset of images of some famous people. Use a <code class="code">BingImageDataset</code> to get the images of each person.
                           
                  </p>
                      
               </div>
                 
            </div>
            
         </div>
      </div>
      <div id="nav-sub-block" class="bottom"><a class="hide" name="nav-sub-a"></a><ul id="nav-sub">
            <li class="first"><a accesskey="p" href="sift-and-feature-matching.html"><span>Prev : SIFT and feature matching</span></a></li>
            <li><a accesskey="h" href="index.html"><span>Contents</span></a></li>
            <li class="last"><a accesskey="n" href="pt03.html"><span>Next : Video Fundamentals</span></a></li>
         </ul>
      </div>
      <footer>
         <div class="container">
            <div class="row span12">Copyright &copy; 2011-2014 <a href="http://www.soton.ac.uk">The University of Southampton</a>. All Rights Reserved.
                 				
            </div>
            <p id="poweredBy" class="pull-right"><a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png"></a></p>
            <div id="ohloh" class="pull-right"><script type="text/javascript" src="http://www.ohloh.net/p/openimaj/widgets/project_partner_badge.js"></script></div>
         </div>
      </footer>
   </body>
</html>