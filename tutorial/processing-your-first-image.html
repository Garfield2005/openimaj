<!DOCTYPE html><html xmlns:d="http://docbook.org/ns/docbook" xmlns:fo="http://www.w3.org/1999/XSL/Format">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>Chapter&nbsp;2.&nbsp;Processing your first image</title>
      <link rel="stylesheet" type="text/css" href="css/apache-maven-fluido-1.3.0.min.css">
      <link rel="stylesheet" type="text/css" href="css/stylesheet.css">
      <link rel="stylesheet" type="text/css" href="fonts/fonts.css">
      <meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1">
      <link rel="home" href="index.html" title="The OpenIMAJ Tutorial">
      <link rel="up" href="pt02.html" title="Part&nbsp;II.&nbsp;Image Fundamentals">
      <link rel="prev" href="pt02.html" title="Part&nbsp;II.&nbsp;Image Fundamentals">
      <link rel="next" href="introduction-to-clustering-segmentation-and-connected-components.html" title="Chapter&nbsp;3.&nbsp;Introduction to clustering, segmentation and connected components">
      <meta property="fb:admins" content="286108206">
      <meta property="og:type" content="website">
      <link rel="image_src" href="../images/OpenImaj-sq.png">
      <meta property="og:image" content="http://openimaj.org/images/OpenImaj-sq.png">
      <meta property="og:title" content="OpenIMAJ: Open Intelligent Multimedia Analysis">
      <meta property="og:url" content="http://www.openimaj.org">
      <meta property="og:description" content="OpenIMAJ is an award-winning set of libraries and tools for multimedia content analysis and content generation."><script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script><script type="text/javascript">
	      var _gaq = _gaq || [];
	      _gaq.push(['_setAccount', 'UA-38338744-1']);
	      _gaq.push(['_trackPageview']);

	      (function() {
	        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	      })();
	    </script></head>
   <body class="topBarEnabled">
      <div id="topbar" class="navbar navbar-fixed-top navbar-inverse">
         <div class="navbar-inner">
            <div class="container">
               <div class="nav-collapse"><a class="brand" href="../index.html" title="OpenIMAJ"><img src="images/logo-tiny.png" alt="OpenIMAJ"></a><ul class="nav">
                     <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a><ul class="dropdown-menu">
                           <li><a href="../index.html" title="Introduction">Introduction</a></li>
                           <li><a href="../sponsors.html" title="History &amp; Sponsors">History &amp; Sponsors</a></li>
                           <li><a href="../contact.html" title="Support &amp; Contacts">Support &amp; Contacts</a></li>
                           <li><a href="team.html" title="Team">Team</a></li>
                           <li><a href="http://blogs.ecs.soton.ac.uk/multimedia" title="The Blog">The Blog</a></li>
                           <li><a href="http://www.sf.net/p/openimaj/code" title="Source Code">Source Code</a></li>
                           <li class="dropdown-submenu"><a href="../#related" title="Related Projects">Related Projects</a><ul class="dropdown-menu">
                                 <li><a href="http://www.imageterrier.org/" title="ImageTerrier">ImageTerrier</a></li>
                              </ul>
                           </li>
                        </ul>
                     </li>
                     <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a><ul class="dropdown-menu">
                           <li class="dropdown-submenu"><a href="../#gettingstarted" title="Getting Started">Getting Started</a><ul class="dropdown-menu">
                                 <li><a href="../tutorial-pdf.pdf" title="The Tutorial (PDF)">The Tutorial (PDF)</a></li>
                                 <li><a href="../tutorial/index.html" title="The Tutorial (HTML)">The Tutorial (HTML)</a></li>
                              </ul>
                           </li>
                           <li class="dropdown-submenu"><a href="../#using" title="Using OpenIMAJ">Using OpenIMAJ</a><ul class="dropdown-menu">
                                 <li><a href="../BuildFromSource.html" title="Building OpenIMAJ from Source">Building OpenIMAJ from Source</a></li>
                                 <li><a href="../UseLibrary.html" title="Using OpenIMAJ as a Library">Using OpenIMAJ as a Library</a></li>
                                 <li><a href="../Groovy.html" title="Using OpenIMAJ with Groovy">Using OpenIMAJ with Groovy</a></li>
                                 <li><a href="../tools.html" title="OpenIMAJ commandline tools introduction">OpenIMAJ commandline tools introduction</a></li>
                                 <li><a href="../flickrCrawler.html" title="The FlickrCrawler Tool">The FlickrCrawler Tool</a></li>
                                 <li><a href="../bibliography.html" title="Bibliography">Bibliography</a></li>
                              </ul>
                           </li>
                           <li><a href="../apidocs/index.html" title="API Reference">API Reference</a></li>
                           <li class="dropdown-submenu"><a href="#info" title="Project Information">Project Information</a><ul class="dropdown-menu">
                                 <li><a href="../plugin-management.html" title="Plugin Management">Plugin Management</a></li>
                                 <li><a href="../mail-lists.html" title="Mailing Lists">Mailing Lists</a></li>
                                 <li><a href="../integration.html" title="Continuous Integration">Continuous Integration</a></li>
                                 <li><a href="../license.html" title="Project License">Project License</a></li>
                                 <li><a href="../team-list.html" title="Project Team">Project Team</a></li>
                                 <li><a href="../source-repository.html" title="Source Repository">Source Repository</a></li>
                                 <li><a href="../index.html" title="About">About</a></li>
                                 <li><a href="../issue-tracking.html" title="Issue Tracking">Issue Tracking</a></li>
                                 <li><a href="../project-summary.html" title="Project Summary">Project Summary</a></li>
                                 <li><a href="../plugins.html" title="Project Plugins">Project Plugins</a></li>
                                 <li><a href="../dependency-convergence.html" title="Dependency Convergence">Dependency Convergence</a></li>
                                 <li><a href="../dependencies.html" title="Dependencies">Dependencies</a></li>
                              </ul>
                           </li>
                        </ul>
                     </li>
                     <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Modules <b class="caret"></b></a><ul class="dropdown-menu">
                           <li><a href="/openimaj-maven-archetypes/index.html" title="OpenIMAJ Maven Archetypes">OpenIMAJ Maven Archetypes</a></li>
                           <li><a href="/openimaj-core-libs/index.html" title="OpenIMAJ Core Libraries">OpenIMAJ Core Libraries</a></li>
                           <li><a href="/openimaj-image/index.html" title="OpenIMAJ Image Processing Libraries">OpenIMAJ Image Processing Libraries</a></li>
                           <li><a href="/openimaj-video/index.html" title="OpenIMAJ Video Processing Libraries">OpenIMAJ Video Processing Libraries</a></li>
                           <li><a href="/openimaj-audio/index.html" title="OpenIMAJ Audio Processing Libraries">OpenIMAJ Audio Processing Libraries</a></li>
                           <li><a href="/openimaj-machine-learning/index.html" title="OpenIMAJ Machine Learning Subprojects">OpenIMAJ Machine Learning Subprojects</a></li>
                           <li><a href="/openimaj-text/index.html" title="OpenIMAJ Text Analysis Subprojects">OpenIMAJ Text Analysis Subprojects</a></li>
                           <li><a href="/thirdparty/index.html" title="OpenIMAJ Third Party Ported Libraries">OpenIMAJ Third Party Ported Libraries</a></li>
                           <li><a href="/openimaj-demos/index.html" title="OpenIMAJ Demos Subproject">OpenIMAJ Demos Subproject</a></li>
                           <li><a href="/openimaj-knowledge/index.html" title="OpenIMAJ Knowledge Representation and Reasoning Libraries">OpenIMAJ Knowledge Representation and Reasoning Libraries</a></li>
                           <li><a href="/test-resources/index.html" title="OpenIMAJ Unit Test Resources">OpenIMAJ Unit Test Resources</a></li>
                           <li><a href="/openimaj-tools/index.html" title="OpenIMAJ Tools">OpenIMAJ Tools</a></li>
                           <li><a href="/openimaj-hadoop/index.html" title="OpenIMAJ Hadoop Subproject">OpenIMAJ Hadoop Subproject</a></li>
                           <li><a href="/openimaj-storm/index.html" title="OpenIMAJ Storm Subproject">OpenIMAJ Storm Subproject</a></li>
                           <li><a href="/openimaj-web/index.html" title="OpenIMAJ web subproject">OpenIMAJ web subproject</a></li>
                           <li><a href="/openimaj-hardware/index.html" title="OpenIMAJ Hardware Subprojects">OpenIMAJ Hardware Subprojects</a></li>
                           <li><a href="/openimaj-content-libs/index.html" title="OpenIMAJ Content Creation Libraries">OpenIMAJ Content Creation Libraries</a></li>
                           <li><a href="/openimaj-ide-integration/index.html" title="OpenIMAJ IDE Integration Plugins">OpenIMAJ IDE Integration Plugins</a></li>
                           <li><a href="/openimaj-documentation/index.html" title="OpenIMAJ Documentation">OpenIMAJ Documentation</a></li>
                        </ul>
                     </li>
                  </ul>
                  <form id="search-form" action="http://www.google.com/search" method="get" class="navbar-search pull-right" name="search-form"><input value="" name="sitesearch" type="hidden"><input class="search-query" name="q" id="query" type="text"></form><script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script><iframe src="http://www.facebook.com/plugins/like.php?href=http://www.openimaj.org/&amp;send=false&amp;layout=button_count&amp;show-faces=false&amp;action=like&amp;colorscheme=dark" scrolling="no" frameborder="0" style="border:none; width:80px; height:20px; margin-top: 10px;" class="pull-right"></iframe><script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script><ul class="nav pull-right">
                     <li style="margin-top: 10px;">
                        <div class="g-plusone" data-href="http://www.openimaj.org/" data-size="medium" width="60px" align="right"></div>
                     </li>
                  </ul>
               </div>
            </div>
         </div>
      </div>
      <div class="container">
         <div id="banner">
            <div class="pull-left">
               <div id="bannerLeft">
                  <h2>OpenIMAJ</h2>
               </div>
            </div>
            <div class="pull-right"></div>
            <div class="clear">
               <hr>
            </div>
         </div>
         <div id="breadcrumbs">
            <ul class="breadcrumb">
               <li id="publishDate" class="pull-right">Last Published: 2015-02-25</li>
               <li class="divider pull-right">|</li>
               <li id="projectVersion" class="pull-right">Version: 1.4-SNAPSHOT</li>
            </ul>
         </div>
         <div id="nav-sub-block"><a class="hide" name="nav-sub-a"></a><ul id="nav-sub">
               <li class="first"><a accesskey="p" href="pt02.html"><span>Prev : Image Fundamentals</span></a></li>
               <li><a accesskey="h" href="index.html"><span>Contents</span></a></li>
               <li class="last"><a accesskey="n" href="introduction-to-clustering-segmentation-and-connected-components.html"><span>Next : Introduction to clustering, segmentation and connected components</span></a></li>
            </ul>
         </div>
         <div class="chapter" title="Chapter&nbsp;2.&nbsp;Processing your first image">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title"><a name="processing-your-first-image"></a>Chapter&nbsp;2.&nbsp;Processing your first image
                     </h2>
                  </div>
               </div>
            </div>
              
              
            <p>
                   In this section we&#8217;ll start with the <span class="quote">&#8220;<span class="quote">hello world</span>&#8221;</span> app
                   and show you how you can load an image, perform some basic
                   processing on the image, draw some stuff on your image and then
                   display your results.
                 
            </p>
              
            <p>
                   Loading images into Java is usually a horrible experience. Using
                   Java <code class="code">ImageIO</code>, one can use the
                   <code class="code">read()</code> method to create a
                   <code class="code">BufferedImage</code> object. Unfortunately the
                   <code class="code">BufferedImage</code> object hides the fact that it is
                   (and in fact all digital raster images are) simply arrays of pixel
                   values. A defining philosophy of OpenIMAJ is to <span class="emphasis"><em>keep
                         things simple</em></span> which in turn means in OpenIMAJ images are
                   as close as one can get to being <span class="strong"><strong>just arrays
                         of pixel values</strong></span>.
                 
            </p>
              
            <p>
                   To read and write images in OpenIMAJ we use the
                   <code class="code">ImageUtilities</code> class. In the
                   <code class="filename">App.java</code> class file remove the sample code within
                   the main method and add the following line:
                 
            </p>
              <pre class="programlisting">MBFImage image = ImageUtilities.readMBF(new File("file.jpg"));</pre>
              <p>
                   For this tutorial, read the image from the following URL:
                 
            </p>
              <pre class="programlisting">MBFImage image = ImageUtilities.readMBF(new URL("http://static.openimaj.org/media/tutorial/sinaface.jpg"));</pre>
              <p>
                   The <code class="code">ImageUtilities</code> class provides the ability to
                   read <code class="code">MBFImage</code>s and <code class="code">FImage</code>s. An
                   <code class="code">FImage</code> is a greyscale image which represents each
                   pixel as a value between <code class="literal">0</code> and
                   <code class="literal">1</code>. An <code class="code">MBFImage</code> is a multi-band
                   version of the <code class="code">FImage</code>; under the hood it actually
                   contains a number <code class="code">FImage</code> objects held in a list
                   each representing a band of the image. What these bands represent is
                   given by the image&#8217;s public <code class="code">colourSpace</code> field,
                   which we can print as follows:
                 
            </p>
              <pre class="programlisting">System.out.println(image.colourSpace);</pre>
              <p>
                   If we run the code, we&#8217;ll see that the image is an RGB image with
                   three <code class="code">FImage</code>s representing the red, blue and
                   green components of the image in that order.
                 
            </p>
              
            <p>
                   You can display any OpenIMAJ image object using the
                   <code class="code">DisplayUtilities</code> class. In this example we
                   display the image we have loaded then we display the red channel of
                   the image alone:
                 
            </p>
              <pre class="programlisting">DisplayUtilities.display(image);
DisplayUtilities.display(image.getBand(0), "Red Channel");</pre>
            
            	<p class="centered">
               		<span class="inlinemediaobject"><img src="figs/sinaface.png" align="middle" width="177.16535433070868"></span>
               	
               		<span class="inlinemediaobject"><img src="figs/sinaface-rc.png" align="middle" width="177.16535433070868"></span>
               	
            </p>
            
              
            <p>
                   In an image-processing library, images are no good unless you can do
                   something to them. The most basic thing you can do to an image is
                   fiddle with its pixels. In OpenIMAJ, as an image is just an array of
                   floats, we make this is quite easy. Let&#8217;s go through our colour
                   image and set all its blue and green pixels to black:
                 
            </p>
              <pre class="programlisting">MBFImage clone = image.clone();
for (int y=0; y&lt;image.getHeight(); y++) {
    for(int x=0; x&lt;image.getWidth(); x++) {
        clone.getBand(1).pixels[y][x] = 0;
        clone.getBand(2).pixels[y][x] = 0;
    }
}
DisplayUtilities.display(clone);</pre>
            
            <div class="mediaobject" align="center"><img src="figs//sinaface-red.png" align="middle" width="177.16535433070868"></div>
            
              
            <p>
                   Note that the first thing we do here is to <code class="code">clone</code>
                   the image to preserve the original image for the remainder of the
                   tutorial. The pixels in an <code class="code">FImage</code> are held in a
                   2D float array. The rows of the image are held in the first array
                   that, in turn, holds each of the column values for that row:
                   <code class="code">[y][x]</code>. By displaying this image we should see an
                   image where two channels are black and one channel is not. This
                   results in an image that looks rather red.
                 
            </p>
              
            <p>
                   Though it is helpful to sometimes get access to individual image
                   pixels, OpenIMAJ provides a lot of methods to make things easier.
                   For example, we could have done the above like this instead:
                 
            </p>
              <pre class="programlisting">clone.getBand(1).fill(0f);
clone.getBand(2).fill(0f);</pre>
              <p>
                   More complex image operations are wrapped up by OpenIMAJ processor
                   interfaces: <code class="code">ImageProcessor</code>s,
                   <code class="code">KernelProcessor</code>s,
                   <code class="code">PixelProcessor</code>s and
                   <code class="code">GridProcessor</code>s. The distinction between these is
                   how their algorithm works internally. The overarching similarity is
                   that an image goes in and a processed image (or data) comes out. For
                   example, a basic operation in image processing is
                   <span class="strong"><strong>edge detection</strong></span>. A popular edge
                   detection algorithm is the <span class="emphasis"><em>Canny edge detector</em></span>.
                   We can call the Canny edge detector like so:
                 
            </p>
              <pre class="programlisting">image.processInplace(new CannyEdgeDetector());</pre>
              <p>
                   When applied to a colour image, each pixel of each band is replaced
                   with the edge response at that point (for simplicity you can think
                   of this as the difference between that pixel and its neighbouring
                   pixels). If a particular edge is only strong in one band or another
                   then that colour will be strong, resulting in the psychedelic
                   colours you should see if you display the image:
                 
            </p>
              <pre class="programlisting">DisplayUtilities.display(image);</pre>
            
            	<div class="mediaobject" align="center"><img src="figs//sinaface-canny.png" align="middle" width="177.16535433070868"></div>
            
              
            <p>
                   Finally, we can also draw on our image in OpenIMAJ. On every
                   <code class="code">Image</code> object there is a set of drawing functions
                   that can be called to draw points, lines, shapes and text on images.
                   Let&#8217;s draw some speech bubbles on our image:
                 
            </p>
              <pre class="programlisting">image.drawShapeFilled(new Ellipse(700f, 450f, 20f, 10f, 0f), RGBColour.WHITE);
image.drawShapeFilled(new Ellipse(650f, 425f, 25f, 12f, 0f), RGBColour.WHITE);
image.drawShapeFilled(new Ellipse(600f, 380f, 30f, 15f, 0f), RGBColour.WHITE);
image.drawShapeFilled(new Ellipse(500f, 300f, 100f, 70f, 0f), RGBColour.WHITE);
image.drawText("OpenIMAJ is", 425, 300, HersheyFont.ASTROLOGY, 20, RGBColour.BLACK);
image.drawText("Awesome", 425, 330, HersheyFont.ASTROLOGY, 20, RGBColour.BLACK);
DisplayUtilities.display(image);</pre>
              <p>
                   Here we construct a series of ellipses (defined by their centre [x,
                   y], axes [major, minor] and rotation) and draw them as white filled
                   shapes. Finally, we draw some text on the image and display it.
                 
            </p>
            
            	
            <div class="mediaobject" align="center"><img src="figs//sinaface-awesome.png" align="middle" width="177.16535433070868"></div>
            
              
            <div class="sect1" title="2.1.&nbsp;Exercises">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="exercises-1"></a>2.1.&nbsp;Exercises
                        </h2>
                     </div>
                  </div>
               </div>
                   
                   
               <div class="sect2" title="2.1.1.&nbsp;Exercise 1: DisplayUtilities">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="exercise-1-displayutilities"></a>2.1.1.&nbsp;Exercise 1: DisplayUtilities
                           </h3>
                        </div>
                     </div>
                  </div>
                        
                        
                  <p>
                             Opening lots of windows can waste time and space (for example if
                             you wanted to view images on every iteration of a process within
                             a loop). In OpenIMAJ we provide a facility to open a
                             <span class="emphasis"><em>named display</em></span> so that was can reuse the
                             display referring to it by name. Try to do this with all the
                             images we display in this tutorial. Only 1 window should open
                             for the whole tutorial.
                           
                  </p>
                      
               </div>
                   
               <div class="sect2" title="2.1.2.&nbsp;Exercise 2: Drawing">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="exercise-2-drawing"></a>2.1.2.&nbsp;Exercise 2: Drawing
                           </h3>
                        </div>
                     </div>
                  </div>
                        
                        
                  <p>
                             Those speech bubbles look rather plain; why not give them a nice
                             border?
                           
                  </p>
                      
               </div>
                 
            </div>
            
         </div>
      </div>
      <div id="nav-sub-block" class="bottom"><a class="hide" name="nav-sub-a"></a><ul id="nav-sub">
            <li class="first"><a accesskey="p" href="pt02.html"><span>Prev : Image Fundamentals</span></a></li>
            <li><a accesskey="h" href="index.html"><span>Contents</span></a></li>
            <li class="last"><a accesskey="n" href="introduction-to-clustering-segmentation-and-connected-components.html"><span>Next : Introduction to clustering, segmentation and connected components</span></a></li>
         </ul>
      </div>
      <footer>
         <div class="container">
            <div class="row span12">Copyright &copy; 2011-2014 <a href="http://www.soton.ac.uk">The University of Southampton</a>. All Rights Reserved.
                 				
            </div>
            <p id="poweredBy" class="pull-right"><a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png"></a></p>
            <div id="ohloh" class="pull-right"><script type="text/javascript" src="http://www.ohloh.net/p/openimaj/widgets/project_partner_badge.js"></script></div>
         </div>
      </footer>
   </body>
</html>